{
  "openapi": "3.1.0",
  "info": {
    "title": "Canvas Learning System API",
    "description": "Multi-agent learning system backend using Feynman method",
    "version": "1.0.0",
    "x-generated-at": "2026-02-07T08:29:10.639951+00:00",
    "x-generator": "Canvas Learning System OpenAPI Exporter"
  },
  "paths": {
    "/api/v1/health": {
      "get": {
        "tags": [
          "System"
        ],
        "summary": "健康检查",
        "description": "返回应用状态、名称、版本和时间戳",
        "operationId": "health_check",
        "responses": {
          "200": {
            "description": "应用健康",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HealthCheckResponse"
                }
              }
            }
          },
          "500": {
            "description": "应用异常"
          }
        }
      }
    },
    "/api/v1/health/metrics": {
      "get": {
        "tags": [
          "System"
        ],
        "summary": "Prometheus指标",
        "description": "返回Prometheus格式的监控指标",
        "operationId": "get_prometheus_metrics",
        "responses": {
          "200": {
            "description": "Prometheus格式指标",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "string"
                },
                "example": "# HELP canvas_agent_execution_seconds Agent execution time\n# TYPE canvas_agent_execution_seconds histogram\n"
              }
            }
          },
          "500": {
            "description": "Internal server error"
          }
        }
      }
    },
    "/api/v1/health/metrics/summary": {
      "get": {
        "tags": [
          "System"
        ],
        "summary": "指标摘要",
        "description": "返回JSON格式的监控指标摘要，包含Agent、记忆系统和资源使用统计",
        "operationId": "get_metrics_summary",
        "responses": {
          "200": {
            "description": "指标摘要",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MetricsSummary"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error"
          }
        }
      }
    },
    "/api/v1/health/agents": {
      "get": {
        "tags": [
          "System"
        ],
        "summary": "Agent端点状态检查",
        "description": "检查所有Agent端点的可用状态",
        "operationId": "check_agents_health",
        "responses": {
          "200": {
            "description": "Agent端点状态",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Check Agents Health"
                },
                "example": {
                  "status": "ok",
                  "agents": {
                    "decompose_basic": "available",
                    "explain_oral": "available"
                  },
                  "total_agents": 11,
                  "available_count": 11
                }
              }
            }
          },
          "500": {
            "description": "Internal server error"
          }
        }
      }
    },
    "/api/v1/health/ai": {
      "get": {
        "tags": [
          "System"
        ],
        "summary": "AI连接状态检查",
        "description": "测试AI Provider API连接是否正常，返回连接状态、模型名称和延迟信息",
        "operationId": "check_ai_health",
        "responses": {
          "200": {
            "description": "AI连接正常",
            "content": {
              "application/json": {
                "schema": {
                  "title": "Response Check Ai Health"
                },
                "example": {
                  "status": "ok",
                  "model": "gemini-2.0-flash-exp",
                  "provider": "google",
                  "latency_ms": 245
                }
              }
            }
          },
          "500": {
            "description": "Internal server error"
          },
          "503": {
            "description": "AI连接失败",
            "content": {
              "application/json": {
                "example": {
                  "status": "error",
                  "model": "gemini-2.0-flash-exp",
                  "provider": "google",
                  "error": "Invalid API key",
                  "error_code": "LLM_API_ERROR"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/health/full": {
      "get": {
        "tags": [
          "System"
        ],
        "summary": "完整系统诊断",
        "description": "返回所有组件的完整健康状态和配置信息",
        "operationId": "full_health_check",
        "responses": {
          "200": {
            "description": "所有组件正常",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Full Health Check"
                },
                "example": {
                  "status": "ok",
                  "components": {
                    "api": "ok",
                    "ai_provider": {
                      "status": "ok",
                      "model": "gemini-2.0-flash-exp"
                    },
                    "canvas_service": "ok",
                    "agents": "ok"
                  },
                  "config": {
                    "ai_model": "gemini-2.0-flash-exp",
                    "ai_provider": "google",
                    "cors_origins": [
                      "app://obsidian.md"
                    ]
                  },
                  "timestamp": "2025-12-14T10:00:00Z"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error"
          },
          "503": {
            "description": "部分组件异常(degraded状态)，与/health/ai保持一致",
            "content": {
              "application/json": {
                "example": {
                  "status": "degraded",
                  "components": {
                    "api": "ok",
                    "ai_provider": {
                      "status": "error",
                      "error": "AI not configured"
                    },
                    "canvas_service": "ok",
                    "agents": "ok"
                  },
                  "config": {
                    "ai_model": "gemini-2.0-flash-exp",
                    "ai_provider": "google",
                    "cors_origins": [
                      "app://obsidian.md"
                    ]
                  },
                  "timestamp": "2025-12-14T10:00:00Z"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/health/neo4j": {
      "get": {
        "tags": [
          "System"
        ],
        "summary": "Neo4j连接状态检查",
        "description": "检查Neo4j图数据库连接健康状态",
        "operationId": "check_neo4j_health",
        "responses": {
          "200": {
            "description": "Neo4j健康检查结果",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Neo4jHealthResponse"
                },
                "examples": {
                  "healthy": {
                    "summary": "连接正常",
                    "value": {
                      "status": "healthy",
                      "checks": {
                        "neo4j_enabled": true,
                        "neo4j_connection": true,
                        "driver_initialized": true,
                        "database_accessible": true,
                        "uri": "bolt://localhost:7687"
                      },
                      "cached": false,
                      "timestamp": "2026-01-16T10:30:00Z"
                    }
                  },
                  "degraded": {
                    "summary": "Neo4j已禁用",
                    "value": {
                      "status": "degraded",
                      "checks": {
                        "neo4j_enabled": false,
                        "reason": "Neo4j is disabled in configuration"
                      },
                      "cached": false,
                      "timestamp": "2026-01-16T10:30:00Z"
                    }
                  },
                  "unhealthy": {
                    "summary": "连接失败",
                    "value": {
                      "status": "unhealthy",
                      "checks": {
                        "neo4j_enabled": true,
                        "neo4j_connection": false,
                        "error": "Connection timeout (>500ms)"
                      },
                      "cached": false,
                      "timestamp": "2026-01-16T10:30:00Z"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal server error"
          }
        }
      }
    },
    "/api/v1/health/graphiti": {
      "get": {
        "tags": [
          "System"
        ],
        "summary": "Graphiti连接状态检查",
        "description": "检查Graphiti客户端初始化状态和图统计信息",
        "operationId": "check_graphiti_health",
        "responses": {
          "200": {
            "description": "Graphiti健康检查结果",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GraphitiHealthResponse"
                },
                "examples": {
                  "ok": {
                    "summary": "Graphiti正常",
                    "value": {
                      "status": "ok",
                      "graph_stats": {
                        "node_count": 1234,
                        "edge_count": 5678,
                        "episode_count": 890
                      },
                      "last_episode_timestamp": "2026-01-15T15:30:00Z"
                    }
                  },
                  "error": {
                    "summary": "Graphiti不可用",
                    "value": {
                      "status": "error",
                      "error": "Graphiti client not initialized: Neo4j connection failed"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal server error"
          }
        }
      }
    },
    "/api/v1/health/lancedb": {
      "get": {
        "tags": [
          "System"
        ],
        "summary": "LanceDB连接状态检查",
        "description": "检查LanceDB向量库连接状态和统计信息",
        "operationId": "check_lancedb_health",
        "responses": {
          "200": {
            "description": "LanceDB健康检查结果",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LanceDBHealthResponse"
                },
                "examples": {
                  "ok": {
                    "summary": "LanceDB正常",
                    "value": {
                      "status": "ok",
                      "table_count": 3,
                      "total_vectors": 50000,
                      "embedding_model": "text-embedding-3-small"
                    }
                  },
                  "error": {
                    "summary": "LanceDB不可用",
                    "value": {
                      "status": "error",
                      "error": "LanceDB directory not found: /data/lancedb"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal server error"
          }
        }
      }
    },
    "/api/v1/health/storage": {
      "get": {
        "tags": [
          "System"
        ],
        "summary": "统一存储健康检查",
        "description": "检查所有存储后端(Neo4j/MCP/JSON)的健康状态，包含连接池指标和P95延迟",
        "operationId": "check_storage_health",
        "responses": {
          "200": {
            "description": "存储健康检查结果",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/StorageHealthResponse"
                },
                "examples": {
                  "healthy": {
                    "summary": "所有存储正常",
                    "value": {
                      "status": "healthy",
                      "storage_backends": [
                        {
                          "name": "neo4j",
                          "status": "ok",
                          "latency_ms": 45
                        },
                        {
                          "name": "mcp",
                          "status": "ok",
                          "latency_ms": 120
                        },
                        {
                          "name": "json",
                          "status": "ok",
                          "latency_ms": 5
                        }
                      ],
                      "connection_pool": {
                        "neo4j": {
                          "active": 3,
                          "idle": 7,
                          "max_size": 50,
                          "utilization_percent": 6.0
                        }
                      },
                      "latency_metrics": {
                        "p95_ms": 85,
                        "p50_ms": 42,
                        "sample_count": 150,
                        "window_seconds": 300
                      },
                      "cached": false,
                      "cache_ttl_remaining_seconds": 0,
                      "timestamp": "2026-01-20T10:30:00Z"
                    }
                  },
                  "degraded": {
                    "summary": "部分存储异常",
                    "value": {
                      "status": "degraded",
                      "storage_backends": [
                        {
                          "name": "neo4j",
                          "status": "ok",
                          "latency_ms": 50
                        },
                        {
                          "name": "mcp",
                          "status": "error",
                          "error": "MCP server timeout"
                        },
                        {
                          "name": "json",
                          "status": "ok",
                          "latency_ms": 3
                        }
                      ],
                      "connection_pool": {
                        "neo4j": {
                          "active": 5,
                          "idle": 5,
                          "max_size": 50,
                          "utilization_percent": 10.0
                        }
                      },
                      "latency_metrics": {
                        "p95_ms": 120,
                        "window_seconds": 300
                      },
                      "cached": true,
                      "cache_ttl_remaining_seconds": 15,
                      "timestamp": "2026-01-20T10:29:45Z"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal server error"
          }
        }
      }
    },
    "/api/v1/health/memory-logs": {
      "get": {
        "tags": [
          "System"
        ],
        "summary": "获取记忆系统错误日志",
        "description": "获取记忆系统（Neo4j/LanceDB/Graphiti）的最近日志，用于前端调试面板",
        "operationId": "get_memory_system_logs",
        "parameters": [
          {
            "name": "lines",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "maximum": 500,
              "minimum": 1,
              "description": "返回最近 N 行日志",
              "default": 50,
              "title": "Lines"
            },
            "description": "返回最近 N 行日志"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MemoryLogsResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/canvas-meta/metadata": {
      "get": {
        "tags": [
          "Canvas Metadata"
        ],
        "summary": "Get Canvas metadata",
        "description": "Get metadata for a Canvas file.\n\nReturns:\n- **subject**: Subject identifier (e.g., \"math54\")\n- **category**: Category identifier (e.g., \"math\")\n- **group_id**: Graphiti group_id (e.g., \"math54:离散数学\")\n- **source**: How the metadata was resolved\n\nResolution priority:\n1. Configuration file mapping\n2. Path-based auto-inference\n3. Default values\n\n[Source: Design doc - Phase 1.1 Canvas Metadata Query API]",
        "operationId": "get_canvas_metadata",
        "parameters": [
          {
            "name": "canvas_path",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string",
              "description": "Canvas file path (relative to vault)",
              "title": "Canvas Path"
            },
            "description": "Canvas file path (relative to vault)",
            "example": "Math 54/离散数学.canvas"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CanvasMetadataResponse"
                }
              }
            }
          },
          "400": {
            "description": "Validation error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/canvas-meta/index-status": {
      "get": {
        "tags": [
          "Canvas Metadata"
        ],
        "summary": "Get Canvas index status",
        "description": "Get LanceDB index status for a Canvas file.\n\nReturns:\n- **indexed**: Whether the Canvas is indexed\n- **node_count**: Number of indexed nodes\n- **last_indexed**: Last indexing timestamp\n- **subject**: Subject used during indexing\n\n[Source: Design doc - Phase 1.2 LanceDB Index Status API]",
        "operationId": "get_canvas_index_status",
        "parameters": [
          {
            "name": "canvas_path",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string",
              "description": "Canvas file path",
              "title": "Canvas Path"
            },
            "description": "Canvas file path",
            "example": "Math 54/离散数学.canvas"
          },
          {
            "name": "table_name",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "description": "LanceDB table name",
              "default": "canvas_nodes",
              "title": "Table Name"
            },
            "description": "LanceDB table name"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CanvasIndexStatusResponse"
                }
              }
            }
          },
          "400": {
            "description": "Validation error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/canvas-meta/index": {
      "post": {
        "tags": [
          "Canvas Metadata"
        ],
        "summary": "Index Canvas to LanceDB",
        "description": "Index a Canvas file to LanceDB.\n\nThis endpoint:\n1. Resolves subject/category for the Canvas\n2. Reads Canvas nodes\n3. Vectorizes text content\n4. Stores in LanceDB with metadata\n\n[Source: Design doc - Phase 1.3 Manual Index Trigger API]",
        "operationId": "index_canvas",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CanvasIndexRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CanvasIndexResponse"
                }
              }
            }
          },
          "400": {
            "description": "Validation error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/canvas-meta/index/batch": {
      "post": {
        "tags": [
          "Canvas Metadata"
        ],
        "summary": "Batch index multiple Canvas files",
        "description": "Index multiple Canvas files to LanceDB.\n\nLimited to 50 files per request.\n\n[Source: Design doc - Batch Operations]",
        "operationId": "batch_index_canvas",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/BatchIndexRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BatchIndexResponse"
                }
              }
            }
          },
          "400": {
            "description": "Validation error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/canvas-meta/config/subject-mapping": {
      "get": {
        "tags": [
          "Canvas Metadata"
        ],
        "summary": "Get subject mapping configuration",
        "description": "Get the current subject mapping configuration.\n\nReturns the configuration used to resolve Canvas metadata.\n\n[Source: Design doc - Phase 2 Configuration System]",
        "operationId": "get_subject_mapping",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SubjectMappingConfig"
                }
              }
            }
          },
          "400": {
            "description": "Validation error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": [
          "Canvas Metadata"
        ],
        "summary": "Update subject mapping configuration",
        "description": "Update the subject mapping configuration.\n\nSaves to subject_mapping.yaml and reloads.\n\n[Source: Design doc - Phase 2 Configuration System]",
        "operationId": "update_subject_mapping",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SubjectMappingConfig"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SubjectMappingConfig"
                }
              }
            }
          },
          "400": {
            "description": "Validation error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/canvas-meta/config/subject-mapping/add": {
      "post": {
        "tags": [
          "Canvas Metadata"
        ],
        "summary": "Add a subject mapping rule",
        "description": "Add or update a subject mapping rule.\n\nIf a rule with the same pattern exists, it will be updated.",
        "operationId": "add_subject_mapping_rule",
        "parameters": [
          {
            "name": "pattern",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string",
              "description": "Folder pattern",
              "title": "Pattern"
            },
            "description": "Folder pattern"
          },
          {
            "name": "subject",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string",
              "description": "Subject identifier",
              "title": "Subject"
            },
            "description": "Subject identifier"
          },
          {
            "name": "category",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string",
              "description": "Category identifier",
              "title": "Category"
            },
            "description": "Category identifier"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SubjectMappingConfig"
                }
              }
            }
          },
          "400": {
            "description": "Validation error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/canvas-meta/config/subject-mapping/remove": {
      "delete": {
        "tags": [
          "Canvas Metadata"
        ],
        "summary": "Remove a subject mapping rule",
        "description": "Remove a subject mapping rule by pattern.",
        "operationId": "remove_subject_mapping_rule",
        "parameters": [
          {
            "name": "pattern",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string",
              "description": "Pattern to remove",
              "title": "Pattern"
            },
            "description": "Pattern to remove"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SubjectMappingConfig"
                }
              }
            }
          },
          "400": {
            "description": "Validation error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/canvas/{canvas_name}": {
      "get": {
        "tags": [
          "Canvas"
        ],
        "summary": "Read Canvas file",
        "description": "Read a Canvas file and return its contents.\n\n- **canvas_name**: Canvas file name (without .canvas suffix)\n\n[Source: specs/api/fastapi-backend-api.openapi.yml#/paths/~1api~1v1~1canvas~1{canvas_name}]",
        "operationId": "read_canvas",
        "parameters": [
          {
            "name": "canvas_name",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Canvas Name"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CanvasResponse"
                }
              }
            }
          },
          "404": {
            "description": "Not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "400": {
            "description": "Validation error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/canvas/{canvas_name}/nodes": {
      "post": {
        "tags": [
          "Canvas"
        ],
        "summary": "Create node",
        "description": "Create a new node in a Canvas.\n\n- **canvas_name**: Canvas file name\n- **node**: Node creation data\n\n[Source: specs/api/fastapi-backend-api.openapi.yml#/paths/~1api~1v1~1canvas~1{canvas_name}~1nodes]",
        "operationId": "create_node",
        "parameters": [
          {
            "name": "canvas_name",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Canvas Name"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/NodeCreate"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NodeRead"
                }
              }
            }
          },
          "404": {
            "description": "Not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "400": {
            "description": "Validation error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/canvas/{canvas_name}/nodes/{node_id}": {
      "put": {
        "tags": [
          "Canvas"
        ],
        "summary": "Update node",
        "description": "Update an existing node in a Canvas.\n\n- **canvas_name**: Canvas file name\n- **node_id**: Node ID to update\n- **node**: Node update data\n\n[Source: specs/api/fastapi-backend-api.openapi.yml#/paths/~1api~1v1~1canvas~1{canvas_name}~1nodes~1{node_id}]",
        "operationId": "update_node",
        "parameters": [
          {
            "name": "canvas_name",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Canvas Name"
            }
          },
          {
            "name": "node_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Node Id"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/NodeUpdate"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NodeRead"
                }
              }
            }
          },
          "404": {
            "description": "Not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "400": {
            "description": "Validation error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": [
          "Canvas"
        ],
        "summary": "Delete node",
        "description": "Delete a node from a Canvas.\n\n- **canvas_name**: Canvas file name\n- **node_id**: Node ID to delete\n\n[Source: specs/api/fastapi-backend-api.openapi.yml#/paths/~1api~1v1~1canvas~1{canvas_name}~1nodes~1{node_id}]",
        "operationId": "delete_node",
        "parameters": [
          {
            "name": "canvas_name",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Canvas Name"
            }
          },
          {
            "name": "node_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Node Id"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Successful Response"
          },
          "404": {
            "description": "Not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "400": {
            "description": "Validation error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/canvas/{canvas_name}/edges": {
      "post": {
        "tags": [
          "Canvas"
        ],
        "summary": "Create edge",
        "description": "Create a new edge in a Canvas.\n\n- **canvas_name**: Canvas file name\n- **edge**: Edge creation data\n\n[Source: specs/api/fastapi-backend-api.openapi.yml#/paths/~1api~1v1~1canvas~1{canvas_name}~1edges]",
        "operationId": "create_edge",
        "parameters": [
          {
            "name": "canvas_name",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Canvas Name"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/EdgeCreate"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/EdgeRead"
                }
              }
            }
          },
          "404": {
            "description": "Not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "400": {
            "description": "Validation error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/canvas/{canvas_name}/edges/{edge_id}": {
      "delete": {
        "tags": [
          "Canvas"
        ],
        "summary": "Delete edge",
        "description": "Delete an edge from a Canvas.\n\n- **canvas_name**: Canvas file name\n- **edge_id**: Edge ID to delete\n\n[Source: specs/api/fastapi-backend-api.openapi.yml#/paths/~1api~1v1~1canvas~1{canvas_name}~1edges~1{edge_id}]",
        "operationId": "delete_edge",
        "parameters": [
          {
            "name": "canvas_name",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Canvas Name"
            }
          },
          {
            "name": "edge_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Edge Id"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Successful Response"
          },
          "404": {
            "description": "Not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "400": {
            "description": "Validation error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/canvas/{canvas_name}/sync-edges": {
      "post": {
        "tags": [
          "Canvas",
          "Layer4-Knowledge"
        ],
        "summary": "Sync all Canvas edges to Neo4j",
        "description": "Sync all Canvas edges to Neo4j knowledge graph.\n\n- **canvas_name**: Canvas file name (without .canvas extension)\n- Idempotent: repeated calls do not create duplicate relationships (MERGE semantics)\n- Concurrent: up to 12 edges synced in parallel\n- Partial failure handling: single edge failure does not block batch\n\nStory 36.4: Canvas打开时全量Edge同步\n[Source: docs/stories/36.4.story.md#AC-1]",
        "operationId": "sync_canvas_edges",
        "parameters": [
          {
            "name": "canvas_name",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Canvas Name"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SyncEdgesSummaryResponse"
                }
              }
            }
          },
          "404": {
            "description": "Not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "400": {
            "description": "Validation error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/agents/health": {
      "get": {
        "tags": [
          "Agents",
          "health"
        ],
        "summary": "Agent System Health Check",
        "description": "Check health status of Agent system components including API key, client initialization, and prompt templates.",
        "operationId": "get_agent_health_api_v1_agents_health_get",
        "parameters": [
          {
            "name": "include_api_test",
            "in": "query",
            "required": false,
            "schema": {
              "type": "boolean",
              "default": false,
              "title": "Include Api Test"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Health check successful",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AgentHealthCheckResponse"
                }
              }
            }
          },
          "500": {
            "description": "Agent service error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "400": {
            "description": "Validation error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Canvas or node not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/agents/decompose/basic": {
      "post": {
        "tags": [
          "Agents"
        ],
        "summary": "Basic concept decomposition",
        "description": "Perform basic concept decomposition on a node.\n\n- **canvas_name**: Canvas file name\n- **node_id**: Target node ID to decompose\n\n[Source: specs/api/fastapi-backend-api.openapi.yml#/paths/~1api~1v1~1agents~1decompose~1basic]\n[Source: specs/data/decompose-request.schema.json]\n[Story 21.1: 统一位置信息提取 - 连接真实AgentService]\n[Story 25.2: TextbookContextService Integration]\n[Story 12.A.2: Agent-RAG Bridge Layer]\n[Story 12.A.5: 学习事件自动记录]\n[Story 12.H.5: Request Deduplication]",
        "operationId": "decompose_basic",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DecomposeRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DecomposeResponse"
                }
              }
            }
          },
          "500": {
            "description": "Agent service error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "400": {
            "description": "Validation error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Canvas or node not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/agents/decompose/deep": {
      "post": {
        "tags": [
          "Agents"
        ],
        "summary": "Deep concept decomposition",
        "description": "Perform deep concept decomposition on a node.\n\n- **canvas_name**: Canvas file name\n- **node_id**: Target node ID for deep decomposition\n\n[Source: specs/api/fastapi-backend-api.openapi.yml#/paths/~1api~1v1~1agents~1decompose~1deep]\n[Story 21.1: 统一位置信息提取 - 连接真实AgentService]\n[Story 25.2: TextbookContextService Integration]\n[Story 12.A.2: Agent-RAG Bridge Layer]\n[Story 12.A.5: 学习事件自动记录]\n[Story 12.H.5: Request Deduplication]",
        "operationId": "decompose_deep",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DecomposeRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DecomposeResponse"
                }
              }
            }
          },
          "500": {
            "description": "Agent service error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "400": {
            "description": "Validation error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Canvas or node not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/agents/score": {
      "post": {
        "tags": [
          "Agents"
        ],
        "summary": "Score user understanding",
        "description": "Score user's understanding based on their explanations.\n\n- **canvas_name**: Canvas file name\n- **node_ids**: List of node IDs to score\n\n[Source: specs/api/fastapi-backend-api.openapi.yml#/paths/~1api~1v1~1agents~1score]\n[Source: specs/data/node-score.schema.json]\n[Story 21.1: 统一位置信息提取 - 连接真实AgentService]\n[Story 12.A.2: Agent-RAG Bridge Layer]\n[Story 12.A.5: 学习事件自动记录]\n[Story 12.H.5: Request Deduplication]",
        "operationId": "score_understanding",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ScoreRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ScoreResponse"
                }
              }
            }
          },
          "500": {
            "description": "Agent service error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "400": {
            "description": "Validation error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Canvas or node not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/agents/explain/oral": {
      "post": {
        "tags": [
          "Agents"
        ],
        "summary": "Oral-style explanation",
        "description": "Generate oral-style explanation for a concept.\n\n- **canvas_name**: Canvas file name\n- **node_id**: Target node ID\n\n[Source: specs/api/fastapi-backend-api.openapi.yml#/paths/~1api~1v1~1agents~1explain~1oral]\n[Story 21.1: 统一位置信息提取 - 连接真实AgentService]\n[Story 25.2: TextbookContextService Integration]\n[Story 12.A.2: Agent-RAG Bridge Layer]\n[Story 12.A.5: 学习事件自动记录]",
        "operationId": "explain_oral",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ExplainRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ExplainResponse"
                }
              }
            }
          },
          "500": {
            "description": "Agent service error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "400": {
            "description": "Validation error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Canvas or node not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/agents/explain/clarification": {
      "post": {
        "tags": [
          "Agents"
        ],
        "summary": "Clarification path generation",
        "description": "Generate clarification path for a concept.\n\n- **canvas_name**: Canvas file name\n- **node_id**: Target node ID\n\n[Source: specs/api/fastapi-backend-api.openapi.yml#/paths/~1api~1v1~1agents~1explain~1clarification]\n[Story 21.1: 统一位置信息提取 - 连接真实AgentService]\n[Story 25.2: TextbookContextService Integration]\n[Story 12.A.2: Agent-RAG Bridge Layer]\n[Story 12.A.5: 学习事件自动记录]",
        "operationId": "explain_clarification",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ExplainRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ExplainResponse"
                }
              }
            }
          },
          "500": {
            "description": "Agent service error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "400": {
            "description": "Validation error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Canvas or node not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/agents/explain/comparison": {
      "post": {
        "tags": [
          "Agents"
        ],
        "summary": "Comparison table generation",
        "description": "Generate comparison table for a concept.\n\n- **canvas_name**: Canvas file name\n- **node_id**: Target node ID\n\n[Source: specs/api/fastapi-backend-api.openapi.yml#/paths/~1api~1v1~1agents~1explain~1comparison]\n[Story 21.1: 统一位置信息提取 - 连接真实AgentService]\n[Story 25.2: TextbookContextService Integration]\n[Story 12.A.2: Agent-RAG Bridge Layer]\n[Story 12.A.5: 学习事件自动记录]",
        "operationId": "explain_comparison",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ExplainRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ExplainResponse"
                }
              }
            }
          },
          "500": {
            "description": "Agent service error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "400": {
            "description": "Validation error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Canvas or node not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/agents/explain/memory": {
      "post": {
        "tags": [
          "Agents"
        ],
        "summary": "Memory anchor generation",
        "description": "Generate memory anchor for a concept.\n\n- **canvas_name**: Canvas file name\n- **node_id**: Target node ID\n\n[Source: specs/api/fastapi-backend-api.openapi.yml#/paths/~1api~1v1~1agents~1explain~1memory]\n[Story 21.1: 统一位置信息提取 - 连接真实AgentService]\n[Story 25.2: TextbookContextService Integration]\n[Story 12.A.2: Agent-RAG Bridge Layer]\n[Story 12.A.5: 学习事件自动记录]",
        "operationId": "explain_memory",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ExplainRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ExplainResponse"
                }
              }
            }
          },
          "500": {
            "description": "Agent service error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "400": {
            "description": "Validation error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Canvas or node not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/agents/explain/four-level": {
      "post": {
        "tags": [
          "Agents"
        ],
        "summary": "Four-level explanation",
        "description": "Generate four-level progressive explanation.\n\n- **canvas_name**: Canvas file name\n- **node_id**: Target node ID\n\n[Source: specs/api/fastapi-backend-api.openapi.yml#/paths/~1api~1v1~1agents~1explain~1four-level]\n[Story 21.1: 统一位置信息提取 - 连接真实AgentService]\n[Story 25.2: TextbookContextService Integration]\n[Story 12.A.2: Agent-RAG Bridge Layer]\n[Story 12.A.5: 学习事件自动记录]",
        "operationId": "explain_four_level",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ExplainRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ExplainResponse"
                }
              }
            }
          },
          "500": {
            "description": "Agent service error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "400": {
            "description": "Validation error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Canvas or node not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/agents/explain/example": {
      "post": {
        "tags": [
          "Agents"
        ],
        "summary": "Example-based teaching",
        "description": "Generate example-based teaching content.\n\n- **canvas_name**: Canvas file name\n- **node_id**: Target node ID\n\n[Source: specs/api/fastapi-backend-api.openapi.yml#/paths/~1api~1v1~1agents~1explain~1example]\n[Story 21.1: 统一位置信息提取 - 连接真实AgentService]\n[Story 25.2: TextbookContextService Integration]\n[Story 12.A.2: Agent-RAG Bridge Layer]\n[Story 12.A.5: 学习事件自动记录]",
        "operationId": "explain_example",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ExplainRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ExplainResponse"
                }
              }
            }
          },
          "500": {
            "description": "Agent service error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "400": {
            "description": "Validation error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Canvas or node not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/agents/verification/question": {
      "post": {
        "tags": [
          "Agents"
        ],
        "summary": "Generate verification questions",
        "description": "Generate verification questions for a concept node.\n\nCreates 2-4 verification questions based on the node content,\nsuitable for testing understanding of red/purple nodes.\n\n- **canvas_name**: Canvas file name\n- **node_id**: Target node ID (typically red or purple)\n\n[Source: docs/stories/story-12.A.6-complete-agents.md#AC1]\n[Source: .claude/agents/verification-question-agent.md]\n[Story 12.A.2: Agent-RAG Bridge Layer]\n[Story 12.H.5: Request Deduplication]",
        "operationId": "generate_verification_questions",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/VerificationQuestionRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/VerificationQuestionResponse"
                }
              }
            }
          },
          "500": {
            "description": "Agent service error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "400": {
            "description": "Validation error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Canvas or node not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/agents/decompose/question": {
      "post": {
        "tags": [
          "Agents"
        ],
        "summary": "Decompose question into sub-questions",
        "description": "Decompose a verification question into 2-5 sub-questions.\n\nTakes a purple node (verification question) and creates smaller,\nmore focused sub-questions to guide understanding.\n\n- **canvas_name**: Canvas file name\n- **node_id**: Target node ID (purple verification question)\n\n[Source: docs/stories/story-12.A.6-complete-agents.md#AC2]\n[Source: .claude/agents/question-decomposition.md]\n[Story 12.A.2: Agent-RAG Bridge Layer]\n[Story 12.H.5: Request Deduplication]",
        "operationId": "decompose_question",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/QuestionDecomposeRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/QuestionDecomposeResponse"
                }
              }
            }
          },
          "500": {
            "description": "Agent service error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "400": {
            "description": "Validation error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Canvas or node not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/agents/recommend-action": {
      "post": {
        "tags": [
          "Agents",
          "agents"
        ],
        "summary": "Intelligent Action Recommendation",
        "description": "Recommend next learning action based on scoring results and historical performance.",
        "operationId": "recommend_action_api_v1_agents_recommend_action_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RecommendActionRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Action recommendation successful",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RecommendActionResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "400": {
            "description": "Validation error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Canvas or node not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/review/schedule": {
      "get": {
        "tags": [
          "Review"
        ],
        "summary": "Get review schedule",
        "description": "Get review schedule based on Ebbinghaus forgetting curve.\n\n- **days**: Number of days to look ahead (default: 7)\n\n[Source: specs/api/fastapi-backend-api.openapi.yml#/paths/~1api~1v1~1review~1schedule]",
        "operationId": "get_review_schedule",
        "parameters": [
          {
            "name": "days",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "default": 7,
              "title": "Days"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReviewScheduleResponse"
                }
              }
            }
          },
          "404": {
            "description": "Not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/review/history": {
      "get": {
        "tags": [
          "Review"
        ],
        "summary": "Get review history",
        "description": "Get review history with pagination support.\n\nStory 34.4 AC1: Default display shows most recent 5 records (limit=5).\nStory 34.4 AC2: show_all=True loads complete history.\nStory 34.4 AC3: API supports `limit` and `show_all` parameters.\n\n- **days**: Number of days to look back (7, 30, or 90)\n- **canvas_path**: Filter by canvas file path\n- **concept_name**: Filter by concept name\n- **limit**: Maximum records to return (default: 5, Story 34.4 AC1)\n- **show_all**: If True, ignore limit and return all records (Story 34.4 AC2)\n\n[Source: specs/api/review-api.openapi.yml#L185-216]\n[Source: docs/stories/34.4.story.md]",
        "operationId": "get_review_history",
        "parameters": [
          {
            "name": "days",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "default": 7,
              "title": "Days"
            }
          },
          {
            "name": "canvas_path",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Canvas Path"
            }
          },
          {
            "name": "concept_name",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Concept Name"
            }
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "default": 5,
              "title": "Limit"
            }
          },
          {
            "name": "show_all",
            "in": "query",
            "required": false,
            "schema": {
              "type": "boolean",
              "default": false,
              "title": "Show All"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HistoryResponse"
                }
              }
            }
          },
          "404": {
            "description": "No history found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/review/generate": {
      "post": {
        "tags": [
          "Review"
        ],
        "summary": "Generate verification canvas",
        "description": "Generate verification canvas for review.\n\n- **source_canvas**: Source Canvas file name\n- **node_ids**: Specific node IDs (optional)\n- **mode**: \"fresh\" (all red+purple) or \"targeted\" (70% weak + 30% partial)\n- **weak_weight**: Weight for weak concepts in targeted mode (default: 0.7)\n- **mastered_weight**: Weight for mastered concepts in targeted mode (default: 0.3)\n\nPRD F8: Extract red+purple nodes, generate questions, topic clustering\n[Source: docs/prd/FULL-PRD-REFERENCE.md - F8, Story 4.1-4.4]\n[Source: specs/api/fastapi-backend-api.openapi.yml#/paths/~1api~1v1~1review~1generate]\n[Source: Story 24.1 - Mode Support]",
        "operationId": "generate_verification_canvas",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/GenerateReviewRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GenerateReviewResponse"
                }
              }
            }
          },
          "404": {
            "description": "Not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/review/record": {
      "put": {
        "tags": [
          "Review"
        ],
        "summary": "Record review result",
        "description": "Record review result and update next review date using FSRS-4.5 algorithm.\n\nStory 32.2: FSRS Integration for optimal spaced repetition intervals.\n\n- **canvas_name**: Canvas file name\n- **node_id**: Node ID (maps to concept_id)\n- **rating**: FSRS rating (1=Again, 2=Hard, 3=Good, 4=Easy) - preferred\n- **score**: Legacy score (0-100) - auto-converted to rating\n- **card_state**: Optional serialized FSRS card JSON for persistence\n- **review_duration**: Optional review time in seconds\n\nRating Conversion (Story 32.2 AC-32.2.4):\n- score < 40 → rating 1 (Again/Forgot)\n- score 40-59 → rating 2 (Hard)\n- score 60-84 → rating 3 (Good)\n- score >= 85 → rating 4 (Easy)\n\n[Source: specs/api/fastapi-backend-api.openapi.yml#/paths/~1api~1v1~1review~1record]\n[Source: docs/stories/32.2.story.md - FSRS Integration]",
        "operationId": "record_review_result",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RecordReviewRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RecordReviewResponse"
                }
              }
            }
          },
          "404": {
            "description": "Not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/review/progress/multi/{original_canvas_path}": {
      "get": {
        "tags": [
          "Review"
        ],
        "summary": "Get multi-review trend analysis",
        "description": "Get trend analysis for multiple verification canvas sessions.\n\nReturns:\n- List of all verification canvases for this original canvas\n- Pass rate trend over time\n- Weak concept improvement tracking\n- Overall progress metrics\n\n[Source: specs/api/review-api.openapi.yml#L346-378]\n[Source: Story 24.4 - Multi-Review Trend Analysis]",
        "operationId": "get_multi_review_progress",
        "parameters": [
          {
            "name": "original_canvas_path",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Original Canvas Path"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MultiReviewProgressResponse"
                }
              }
            }
          },
          "404": {
            "description": "No review history",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/review/verification/history/{concept}": {
      "get": {
        "tags": [
          "Review",
          "verification"
        ],
        "summary": "Get verification question history",
        "description": "Get verification question history for a concept.\n\nStory 31.4 AC-31.4.3: New endpoint for querying verification question history.\nStory 31.4 AC-31.4.4: Returns question, answer, score, timestamp for each record.\n\n- **concept**: Concept name to query history for\n- **canvas_name**: Optional filter by canvas name\n- **limit**: Number of items per page (default: 20, max: 100)\n- **offset**: Offset for pagination (default: 0)\n- **group_id**: Optional group ID for multi-subject isolation\n\nReturns:\n- Total count of history records\n- List of verification history items\n- Pagination metadata\n\n[Source: specs/api/review-api.openapi.yml#/verification/history/{concept}]\n[Source: docs/stories/31.4.story.md#Task-4]",
        "operationId": "get_verification_history",
        "parameters": [
          {
            "name": "concept",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Concept"
            }
          },
          {
            "name": "canvas_name",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Canvas Name"
            }
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "default": 20,
              "title": "Limit"
            }
          },
          {
            "name": "offset",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "default": 0,
              "title": "Offset"
            }
          },
          {
            "name": "group_id",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Group Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/VerificationHistoryResponse"
                }
              }
            }
          },
          "404": {
            "description": "No history found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/review/fsrs-state/{concept_id}": {
      "get": {
        "tags": [
          "Review",
          "fsrs"
        ],
        "summary": "Get FSRS state for a concept",
        "description": "Get FSRS card state for a concept.\n\nStory 32.3 AC-32.3.1: Plugin queries backend for FSRS state before calculating priority.\nStory 32.3 AC-32.3.2: Returns stability, difficulty, state, reps, lapses, retrievability, due.\nStory 32.3 AC-32.3.3: Includes full card_state JSON for plugin-side deserialization.\n\n- **concept_id**: Concept identifier (node_id from canvas)\n\nReturns:\n- FSRS state with all algorithm parameters\n- card_state: Serialized FSRS card JSON for local caching\n- found: Boolean indicating if a card exists\n\n[Source: specs/api/review-api.openapi.yml#/review/fsrs-state/{concept_id}]\n[Source: docs/stories/32.3.story.md#Task-1]",
        "operationId": "get_fsrs_state",
        "parameters": [
          {
            "name": "concept_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Concept Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "FSRS state found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/FSRSStateQueryResponse"
                }
              }
            }
          },
          "404": {
            "description": "Concept not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/review/session/{session_id}/progress": {
      "get": {
        "tags": [
          "Review",
          "verification-session"
        ],
        "summary": "Get verification session progress",
        "description": "Get real-time progress for a verification session.\n\nStory 31.6 AC-31.6.1: Frontend displays \"已验证 X/Y 个概念\" progress bar.\nStory 31.6 AC-31.6.2: Color distribution real-time updates (green/yellow/purple/red).\nStory 31.6 AC-31.6.3: Mastery percentage = green / total * 100%.\n\n- **session_id**: Unique session identifier\n\nReturns:\n- Session progress with concept counts, color distribution, and status\n- progress_percentage: Completion rate (0-100)\n- mastery_percentage: Mastery rate (0-100)\n\n[Source: docs/stories/31.6.story.md#Task-2]",
        "operationId": "get_session_progress",
        "parameters": [
          {
            "name": "session_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Session Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Session progress",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SessionProgressResponse"
                }
              }
            }
          },
          "404": {
            "description": "Session not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/review/session/{session_id}/pause": {
      "post": {
        "tags": [
          "Review",
          "verification-session"
        ],
        "summary": "Pause verification session",
        "description": "Pause an active verification session.\n\nStory 31.6 AC-31.6.4: Support pause/resume session functionality.\n\n- **session_id**: Session identifier to pause\n\nReturns:\n- New session status (paused)\n- Operation result message\n\n[Source: docs/stories/31.6.story.md#Task-3]",
        "operationId": "pause_session",
        "parameters": [
          {
            "name": "session_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Session Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Session paused",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SessionPauseResumeResponse"
                }
              }
            }
          },
          "404": {
            "description": "Session not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "400": {
            "description": "Session cannot be paused",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/review/session/{session_id}/resume": {
      "post": {
        "tags": [
          "Review",
          "verification-session"
        ],
        "summary": "Resume verification session",
        "description": "Resume a paused verification session.\n\nStory 31.6 AC-31.6.4: Support pause/resume session functionality.\n\n- **session_id**: Session identifier to resume\n\nReturns:\n- New session status (in_progress)\n- Operation result message\n\n[Source: docs/stories/31.6.story.md#Task-3]",
        "operationId": "resume_session",
        "parameters": [
          {
            "name": "session_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Session Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Session resumed",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SessionPauseResumeResponse"
                }
              }
            }
          },
          "404": {
            "description": "Session not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "400": {
            "description": "Session cannot be resumed",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/metrics/alerts": {
      "get": {
        "tags": [
          "Monitoring"
        ],
        "summary": "Get active alerts",
        "description": "Returns list of currently active (firing) alerts",
        "operationId": "get_active_alerts_api_v1_metrics_alerts_get",
        "parameters": [
          {
            "name": "severity",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "description": "Filter by severity: critical, warning, info",
              "enum": [
                "critical",
                "warning",
                "info"
              ],
              "title": "Severity"
            },
            "description": "Filter by severity: critical, warning, info"
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "maximum": 1000,
              "minimum": 1,
              "description": "Maximum number of alerts to return",
              "default": 100,
              "title": "Limit"
            },
            "description": "Maximum number of alerts to return"
          },
          {
            "name": "offset",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "minimum": 0,
              "description": "Offset for pagination",
              "default": 0,
              "title": "Offset"
            },
            "description": "Offset for pagination"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AlertListResponse"
                }
              }
            }
          },
          "500": {
            "description": "Monitoring service error"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/metrics/summary": {
      "get": {
        "tags": [
          "Monitoring"
        ],
        "summary": "Get metrics summary",
        "description": "Returns comprehensive metrics summary for dashboard display",
        "operationId": "get_metrics_summary_api_v1_metrics_summary_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MetricsSummaryResponse"
                }
              }
            }
          },
          "500": {
            "description": "Monitoring service error"
          }
        }
      }
    },
    "/api/v1/rollback/history/{canvas_path}": {
      "get": {
        "tags": [
          "Rollback"
        ],
        "summary": "Get operation history",
        "description": "Get operation history for a Canvas file.\n\nReturns a paginated list of operations in reverse chronological order\n(newest first).\n\n- **canvas_path**: Canvas file path (e.g., \"离散数学.canvas\")\n- **limit**: Maximum number of records to return (1-100, default: 50)\n- **offset**: Number of records to skip (default: 0)\n\n[Source: docs/architecture/rollback-recovery-architecture.md:296-310]\n[Source: docs/stories/18.1.story.md - AC 6]",
        "operationId": "get_operation_history",
        "parameters": [
          {
            "name": "canvas_path",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Canvas Path"
            }
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "maximum": 100,
              "minimum": 1,
              "description": "Maximum number of records to return",
              "default": 50,
              "title": "Limit"
            },
            "description": "Maximum number of records to return"
          },
          {
            "name": "offset",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "minimum": 0,
              "description": "Number of records to skip",
              "default": 0,
              "title": "Offset"
            },
            "description": "Number of records to skip"
          }
        ],
        "responses": {
          "200": {
            "description": "Operation history retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OperationHistoryResponse"
                }
              }
            }
          },
          "404": {
            "description": "Resource not found"
          },
          "500": {
            "description": "Internal server error"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/rollback/operation/{operation_id}": {
      "get": {
        "tags": [
          "Rollback"
        ],
        "summary": "Get single operation",
        "description": "Get a single operation by ID.\n\n- **operation_id**: Operation UUID\n\n[Source: docs/architecture/rollback-recovery-architecture.md:296-310]",
        "operationId": "get_operation",
        "parameters": [
          {
            "name": "operation_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Operation Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Operation retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OperationResponse"
                }
              }
            }
          },
          "404": {
            "description": "Operation not found"
          },
          "500": {
            "description": "Internal server error"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/rollback/snapshots/{canvas_path}": {
      "get": {
        "tags": [
          "Rollback"
        ],
        "summary": "List snapshots",
        "description": "List snapshots for a Canvas file.\n\nReturns a paginated list of snapshots in reverse chronological order\n(newest first). Does not include full canvas data, only metadata.\n\n- **canvas_path**: Canvas file path (e.g., \"离散数学.canvas\")\n- **limit**: Maximum number of snapshots to return (1-100, default: 20)\n- **offset**: Number of snapshots to skip (default: 0)\n\n[Source: docs/architecture/rollback-recovery-architecture.md:312-326]\n[Source: docs/stories/18.2.story.md - AC 6]",
        "operationId": "list_snapshots",
        "parameters": [
          {
            "name": "canvas_path",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Canvas Path"
            }
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "maximum": 100,
              "minimum": 1,
              "description": "Maximum number of snapshots to return",
              "default": 20,
              "title": "Limit"
            },
            "description": "Maximum number of snapshots to return"
          },
          {
            "name": "offset",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "minimum": 0,
              "description": "Number of snapshots to skip",
              "default": 0,
              "title": "Offset"
            },
            "description": "Number of snapshots to skip"
          }
        ],
        "responses": {
          "200": {
            "description": "Snapshot list retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SnapshotListResponse"
                }
              }
            }
          },
          "404": {
            "description": "Resource not found"
          },
          "500": {
            "description": "Internal server error"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/rollback/snapshot": {
      "post": {
        "tags": [
          "Rollback"
        ],
        "summary": "Create manual snapshot",
        "description": "Create a manual snapshot for a Canvas file.\n\nCreates a new snapshot with type \"manual\" that captures the current\nstate of the Canvas file.\n\n- **canvas_path**: Canvas file path (e.g., \"离散数学.canvas\")\n- **description**: Optional description for the snapshot\n- **tags**: Optional list of tags\n\n[Source: docs/architecture/rollback-recovery-architecture.md:328-342]\n[Source: docs/stories/18.2.story.md - AC 7]",
        "operationId": "create_snapshot",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateSnapshotRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Snapshot created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SnapshotResponse"
                }
              }
            }
          },
          "404": {
            "description": "Resource not found"
          },
          "500": {
            "description": "Internal server error"
          },
          "400": {
            "description": "Invalid request"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/rollback/snapshot/{snapshot_id}": {
      "get": {
        "tags": [
          "Rollback"
        ],
        "summary": "Get single snapshot",
        "description": "Get a single snapshot by ID.\n\n- **snapshot_id**: Snapshot UUID\n- **canvas_path**: Canvas file path (required for storage lookup)\n\n[Source: docs/architecture/rollback-recovery-architecture.md:312-326]",
        "operationId": "get_snapshot",
        "parameters": [
          {
            "name": "snapshot_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Snapshot Id"
            }
          },
          {
            "name": "canvas_path",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string",
              "description": "Canvas file path",
              "title": "Canvas Path"
            },
            "description": "Canvas file path"
          }
        ],
        "responses": {
          "200": {
            "description": "Snapshot retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SnapshotResponse"
                }
              }
            }
          },
          "404": {
            "description": "Snapshot not found"
          },
          "500": {
            "description": "Internal server error"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/rollback/rollback": {
      "post": {
        "tags": [
          "Rollback"
        ],
        "summary": "Execute rollback",
        "description": "Execute a rollback operation on a Canvas file.\n\nSupports three rollback types:\n- **operation**: Undo a single operation by applying its reverse\n- **snapshot**: Restore to a specific snapshot state\n- **timepoint**: Restore to the nearest snapshot before a given time\n\n[Source: docs/architecture/rollback-recovery-architecture.md:122-180]\n[Source: docs/stories/18.3.story.md - AC 6]",
        "operationId": "execute_rollback",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RollbackRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Rollback executed successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RollbackResult"
                }
              }
            }
          },
          "404": {
            "description": "Resource not found"
          },
          "500": {
            "description": "Rollback failed"
          },
          "400": {
            "description": "Invalid rollback request"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/rollback/diff/{snapshot_id}": {
      "get": {
        "tags": [
          "Rollback"
        ],
        "summary": "Get diff between snapshot and current Canvas",
        "description": "Get the difference between a snapshot and the current Canvas state.\n\nCompares nodes and edges between the snapshot and current Canvas,\nreturning lists of added, removed, and modified elements.\n\n- **snapshot_id**: Snapshot UUID to compare against\n- **canvas_path**: Canvas file path (required for loading current state)\n\n[Source: docs/architecture/rollback-recovery-architecture.md:382-400]\n[Source: docs/stories/18.5.story.md - AC 1]",
        "operationId": "get_diff",
        "parameters": [
          {
            "name": "snapshot_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Snapshot Id"
            }
          },
          {
            "name": "canvas_path",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string",
              "description": "Canvas file path",
              "title": "Canvas Path"
            },
            "description": "Canvas file path"
          }
        ],
        "responses": {
          "200": {
            "description": "Diff retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DiffResponse"
                }
              }
            }
          },
          "404": {
            "description": "Snapshot not found"
          },
          "500": {
            "description": "Internal server error"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/memory/episodes": {
      "post": {
        "tags": [
          "Memory"
        ],
        "summary": "记录学习事件",
        "description": "记录用户的学习事件，存储到Neo4j和Graphiti",
        "operationId": "create_learning_episode_api_v1_memory_episodes_post",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/LearningEpisodeCreate"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LearningEpisodeResponse"
                }
              }
            }
          },
          "404": {
            "description": "Episode/concept not found"
          },
          "500": {
            "description": "Memory service error"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      },
      "get": {
        "tags": [
          "Memory"
        ],
        "summary": "查询学习历史",
        "description": "查询用户的学习历史，支持分页和过滤",
        "operationId": "get_learning_history_api_v1_memory_episodes_get",
        "parameters": [
          {
            "name": "user_id",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string",
              "description": "用户ID",
              "title": "User Id"
            },
            "description": "用户ID"
          },
          {
            "name": "start_date",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string",
                  "format": "date-time"
                },
                {
                  "type": "null"
                }
              ],
              "description": "开始日期",
              "title": "Start Date"
            },
            "description": "开始日期"
          },
          {
            "name": "end_date",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string",
                  "format": "date-time"
                },
                {
                  "type": "null"
                }
              ],
              "description": "结束日期",
              "title": "End Date"
            },
            "description": "结束日期"
          },
          {
            "name": "concept",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "description": "概念过滤",
              "title": "Concept"
            },
            "description": "概念过滤"
          },
          {
            "name": "subject",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "description": "学科过滤 (AC-30.8.3)",
              "title": "Subject"
            },
            "description": "学科过滤 (AC-30.8.3)"
          },
          {
            "name": "page",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "minimum": 1,
              "description": "页码",
              "default": 1,
              "title": "Page"
            },
            "description": "页码"
          },
          {
            "name": "page_size",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "maximum": 100,
              "minimum": 1,
              "description": "每页大小",
              "default": 50,
              "title": "Page Size"
            },
            "description": "每页大小"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LearningHistoryResponse"
                }
              }
            }
          },
          "404": {
            "description": "Episode/concept not found"
          },
          "500": {
            "description": "Memory service error"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/memory/concepts/{concept_id}/history": {
      "get": {
        "tags": [
          "Memory"
        ],
        "summary": "查询概念学习历史",
        "description": "查询特定概念的学习历史，包含时间线和得分变化",
        "operationId": "get_concept_history_api_v1_memory_concepts__concept_id__history_get",
        "parameters": [
          {
            "name": "concept_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Concept Id"
            }
          },
          {
            "name": "user_id",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "description": "用户ID (optional)",
              "title": "User Id"
            },
            "description": "用户ID (optional)"
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "maximum": 200,
              "minimum": 1,
              "description": "最大返回数量",
              "default": 50,
              "title": "Limit"
            },
            "description": "最大返回数量"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ConceptHistoryResponse"
                }
              }
            }
          },
          "404": {
            "description": "Episode/concept not found"
          },
          "500": {
            "description": "Memory service error"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/memory/review-suggestions": {
      "get": {
        "tags": [
          "Memory"
        ],
        "summary": "获取复习建议",
        "description": "获取基于艾宾浩斯遗忘曲线的复习建议",
        "operationId": "get_review_suggestions_api_v1_memory_review_suggestions_get",
        "parameters": [
          {
            "name": "user_id",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string",
              "description": "用户ID",
              "title": "User Id"
            },
            "description": "用户ID"
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "maximum": 50,
              "minimum": 1,
              "description": "返回数量",
              "default": 10,
              "title": "Limit"
            },
            "description": "返回数量"
          },
          {
            "name": "subject",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "description": "学科过滤 (AC-30.8.3)",
              "title": "Subject"
            },
            "description": "学科过滤 (AC-30.8.3)"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/ReviewSuggestionResponse"
                  },
                  "title": "Response Get Review Suggestions Api V1 Memory Review Suggestions Get"
                }
              }
            }
          },
          "404": {
            "description": "Episode/concept not found"
          },
          "500": {
            "description": "Memory service error"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/memory/health": {
      "get": {
        "tags": [
          "Memory"
        ],
        "summary": "Memory系统健康检查",
        "description": "获取3层记忆系统的健康状态",
        "operationId": "get_memory_health_api_v1_memory_health_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MemoryHealthResponse"
                }
              }
            }
          },
          "404": {
            "description": "Episode/concept not found"
          },
          "500": {
            "description": "Memory service error"
          }
        }
      }
    },
    "/api/v1/memory/episodes/batch": {
      "post": {
        "tags": [
          "Memory"
        ],
        "summary": "批量记录学习事件",
        "description": "批量记录Canvas节点颜色变化等学习事件(最多50个)",
        "operationId": "create_batch_episodes_api_v1_memory_episodes_batch_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/BatchEpisodesRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BatchEpisodesResponse"
                }
              }
            }
          },
          "404": {
            "description": "Episode/concept not found"
          },
          "500": {
            "description": "Memory service error"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/debug/bugs": {
      "get": {
        "tags": [
          "Debug"
        ],
        "summary": "获取最近的Bug日志",
        "description": "返回最近记录的Bug列表，按时间倒序排列（最新在前）",
        "operationId": "get_recent_bugs",
        "parameters": [
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "maximum": 200,
              "minimum": 1,
              "description": "返回的最大记录数（1-200）",
              "default": 50,
              "title": "Limit"
            },
            "description": "返回的最大记录数（1-200）"
          }
        ],
        "responses": {
          "200": {
            "description": "Bug日志列表",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "additionalProperties": true
                  },
                  "title": "Response Get Recent Bugs"
                },
                "example": [
                  {
                    "bug_id": "BUG-A1B2C3D4",
                    "timestamp": "2025-12-14T10:30:00Z",
                    "endpoint": "/api/v1/agents/scoring",
                    "error_type": "ValueError",
                    "error_message": "Invalid input"
                  }
                ]
              }
            }
          },
          "404": {
            "description": "Bug not found"
          },
          "500": {
            "description": "Debug service error"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/debug/bugs/stats": {
      "get": {
        "tags": [
          "Debug"
        ],
        "summary": "获取Bug统计信息",
        "description": "返回Bug日志的统计摘要，包括总数、按类型分组等",
        "operationId": "get_bug_stats",
        "responses": {
          "200": {
            "description": "Bug统计信息",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Get Bug Stats"
                },
                "example": {
                  "total_bugs": 42,
                  "by_error_type": {
                    "ValueError": 15,
                    "KeyError": 10,
                    "TypeError": 17
                  },
                  "by_endpoint": {
                    "/api/v1/agents/scoring": 20,
                    "/api/v1/canvas/nodes": 22
                  }
                }
              }
            }
          },
          "404": {
            "description": "Bug not found"
          },
          "500": {
            "description": "Debug service error"
          }
        }
      }
    },
    "/api/v1/debug/bugs/{bug_id}": {
      "get": {
        "tags": [
          "Debug"
        ],
        "summary": "获取特定Bug详情",
        "description": "根据bug_id获取特定Bug的详细信息",
        "operationId": "get_bug_by_id",
        "parameters": [
          {
            "name": "bug_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Bug Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Bug详细信息",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true,
                  "title": "Response Get Bug By Id"
                },
                "example": {
                  "bug_id": "BUG-A1B2C3D4",
                  "timestamp": "2025-12-14T10:30:00Z",
                  "endpoint": "/api/v1/agents/scoring",
                  "error_type": "ValueError",
                  "error_message": "Invalid input",
                  "request_params": {
                    "canvas_path": "test.canvas"
                  },
                  "stack_trace": "Traceback..."
                }
              }
            }
          },
          "404": {
            "description": "Bug不存在",
            "content": {
              "application/json": {
                "example": {
                  "code": 404,
                  "message": "Bug 'BUG-A1B2C3D4' not found"
                }
              }
            }
          },
          "500": {
            "description": "Debug service error"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/rag/query": {
      "post": {
        "tags": [
          "RAG"
        ],
        "summary": "RAG 智能检索",
        "description": "执行智能检索查询，支持多源检索、融合和质量控制",
        "operationId": "rag_query",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RAGQueryRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "查询成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RAGQueryResponse"
                }
              }
            }
          },
          "503": {
            "description": "RAG 服务不可用"
          },
          "500": {
            "description": "查询执行失败"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/rag/weak-concepts/{canvas_file}": {
      "get": {
        "tags": [
          "RAG"
        ],
        "summary": "获取薄弱概念",
        "description": "从 Temporal Memory 获取指定 Canvas 的薄弱概念列表",
        "operationId": "get_weak_concepts",
        "parameters": [
          {
            "name": "canvas_file",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Canvas File"
            }
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "default": 10,
              "title": "Limit"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WeakConceptsResponse"
                }
              }
            }
          },
          "503": {
            "description": "RAG 服务不可用"
          },
          "500": {
            "description": "RAG query failed"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/rag/status": {
      "get": {
        "tags": [
          "RAG"
        ],
        "summary": "RAG 服务状态",
        "description": "获取 RAG 服务状态信息",
        "operationId": "get_rag_status",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RAGStatusResponse"
                }
              }
            }
          },
          "503": {
            "description": "RAG service unavailable"
          },
          "500": {
            "description": "RAG query failed"
          }
        }
      }
    },
    "/api/v1/textbook/sync-mount": {
      "post": {
        "tags": [
          "Textbook"
        ],
        "summary": "Sync mounted textbook to backend",
        "description": "Syncs a textbook mounted in the frontend to the backend .canvas-links.json file.\n\n    This bridges the gap between frontend localStorage and backend filesystem,\n    enabling Agent services to access textbook context when generating responses.\n\n    [Source: 方案A - 前端同步到后端]",
        "operationId": "sync_mount_textbook_api_v1_textbook_sync_mount_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SyncMountRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SyncMountResponse"
                }
              }
            }
          },
          "404": {
            "description": "Textbook not found"
          },
          "500": {
            "description": "Textbook sync failed"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/textbook/unmount": {
      "post": {
        "tags": [
          "Textbook"
        ],
        "summary": "Unmount a textbook",
        "description": "Removes a textbook association from .canvas-links.json",
        "operationId": "unmount_textbook_api_v1_textbook_unmount_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UnmountRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UnmountResponse"
                }
              }
            }
          },
          "404": {
            "description": "Textbook not found"
          },
          "500": {
            "description": "Textbook sync failed"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/textbook/mounted/{canvas_path}": {
      "get": {
        "tags": [
          "Textbook"
        ],
        "summary": "List mounted textbooks for a canvas",
        "description": "Returns all textbook associations from .canvas-links.json",
        "operationId": "list_mounted_textbooks_api_v1_textbook_mounted__canvas_path__get",
        "parameters": [
          {
            "name": "canvas_path",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Canvas Path"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ListMountedResponse"
                }
              }
            }
          },
          "404": {
            "description": "Textbook not found"
          },
          "500": {
            "description": "Textbook sync failed"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/multimodal/upload": {
      "post": {
        "tags": [
          "Multimodal"
        ],
        "summary": "Upload a file",
        "description": "Upload a multimodal file (image, PDF, audio, video) and associate it with a Canvas concept.",
        "operationId": "upload_file_api_v1_multimodal_upload_post",
        "requestBody": {
          "content": {
            "multipart/form-data": {
              "schema": {
                "$ref": "#/components/schemas/Body_upload_file_api_v1_multimodal_upload_post"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MultimodalUploadResponse"
                }
              }
            }
          },
          "413": {
            "description": "File too large (max 50MB)"
          },
          "415": {
            "description": "Unsupported media type"
          },
          "500": {
            "description": "Internal server error"
          },
          "400": {
            "description": "Invalid request - validation error"
          },
          "404": {
            "description": "Content not found"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/multimodal/upload-url": {
      "post": {
        "tags": [
          "Multimodal"
        ],
        "summary": "Upload from URL",
        "description": "Fetch content from a URL and upload it as multimodal content.",
        "operationId": "upload_from_url_api_v1_multimodal_upload_url_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/MultimodalUploadUrlRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MultimodalUploadResponse"
                }
              }
            }
          },
          "413": {
            "description": "File too large (max 50MB)"
          },
          "415": {
            "description": "Unsupported media type"
          },
          "500": {
            "description": "Internal server error"
          },
          "400": {
            "description": "Invalid request - validation error"
          },
          "404": {
            "description": "Content not found"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/multimodal": {
      "get": {
        "tags": [
          "Multimodal"
        ],
        "summary": "List content",
        "description": "List multimodal content with optional filters.",
        "operationId": "list_content_api_v1_multimodal_get",
        "parameters": [
          {
            "name": "concept_id",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "description": "Filter by concept ID",
              "title": "Concept Id"
            },
            "description": "Filter by concept ID"
          },
          {
            "name": "media_type",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "$ref": "#/components/schemas/MultimodalMediaType"
                },
                {
                  "type": "null"
                }
              ],
              "description": "Filter by media type",
              "title": "Media Type"
            },
            "description": "Filter by media type"
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "maximum": 1000,
              "minimum": 1,
              "description": "Maximum items to return",
              "default": 100,
              "title": "Limit"
            },
            "description": "Maximum items to return"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MultimodalListResponse"
                }
              }
            }
          },
          "413": {
            "description": "File too large (max 50MB)"
          },
          "415": {
            "description": "Unsupported media type"
          },
          "500": {
            "description": "Internal server error"
          },
          "400": {
            "description": "Invalid request - validation error"
          },
          "404": {
            "description": "Content not found"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/multimodal/health": {
      "get": {
        "tags": [
          "Multimodal"
        ],
        "summary": "Health check",
        "description": "Check the health status of the multimodal service.",
        "operationId": "health_check_api_v1_multimodal_health_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MultimodalHealthResponse"
                }
              }
            }
          },
          "413": {
            "description": "File too large (max 50MB)"
          },
          "415": {
            "description": "Unsupported media type"
          },
          "500": {
            "description": "Internal server error"
          },
          "400": {
            "description": "Invalid request - validation error"
          },
          "404": {
            "description": "Content not found"
          }
        }
      }
    },
    "/api/v1/multimodal/list": {
      "get": {
        "tags": [
          "Multimodal"
        ],
        "summary": "List all content with pagination",
        "description": "List all multimodal content with pagination and filtering.",
        "operationId": "list_multimodal_api_v1_multimodal_list_get",
        "parameters": [
          {
            "name": "page",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "minimum": 1,
              "description": "Page number (1-indexed)",
              "default": 1,
              "title": "Page"
            },
            "description": "Page number (1-indexed)"
          },
          {
            "name": "page_size",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "maximum": 100,
              "minimum": 1,
              "description": "Items per page",
              "default": 20,
              "title": "Page Size"
            },
            "description": "Items per page"
          },
          {
            "name": "media_type",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "$ref": "#/components/schemas/MultimodalMediaType"
                },
                {
                  "type": "null"
                }
              ],
              "description": "Filter by media type",
              "title": "Media Type"
            },
            "description": "Filter by media type"
          },
          {
            "name": "sort_by",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "pattern": "^(created_at|updated_at)$",
              "description": "Sort field",
              "default": "created_at",
              "title": "Sort By"
            },
            "description": "Sort field"
          },
          {
            "name": "sort_order",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "pattern": "^(asc|desc)$",
              "description": "Sort direction",
              "default": "desc",
              "title": "Sort Order"
            },
            "description": "Sort direction"
          },
          {
            "name": "include_thumbnail",
            "in": "query",
            "required": false,
            "schema": {
              "type": "boolean",
              "description": "Include base64 encoded thumbnails",
              "default": false,
              "title": "Include Thumbnail"
            },
            "description": "Include base64 encoded thumbnails"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MultimodalPaginatedListResponse"
                }
              }
            }
          },
          "413": {
            "description": "File too large (max 50MB)"
          },
          "415": {
            "description": "Unsupported media type"
          },
          "500": {
            "description": "Internal server error"
          },
          "400": {
            "description": "Invalid request - validation error"
          },
          "404": {
            "description": "Content not found"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/multimodal/search": {
      "post": {
        "tags": [
          "Multimodal"
        ],
        "summary": "Search content",
        "description": "Search multimodal content using semantic similarity.",
        "operationId": "search_multimodal_api_v1_multimodal_search_post",
        "parameters": [
          {
            "name": "include_thumbnail",
            "in": "query",
            "required": false,
            "schema": {
              "type": "boolean",
              "description": "Include base64 encoded thumbnails",
              "default": false,
              "title": "Include Thumbnail"
            },
            "description": "Include base64 encoded thumbnails"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/MultimodalSearchRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MultimodalSearchResponse"
                }
              }
            }
          },
          "413": {
            "description": "File too large (max 50MB)"
          },
          "415": {
            "description": "Unsupported media type"
          },
          "500": {
            "description": "Internal server error"
          },
          "400": {
            "description": "Invalid request - validation error"
          },
          "404": {
            "description": "Content not found"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/multimodal/by-concept/{concept_id}": {
      "get": {
        "tags": [
          "Multimodal"
        ],
        "summary": "Get content by concept",
        "description": "Retrieve all multimodal content associated with a Canvas concept node.",
        "operationId": "get_by_concept_api_v1_multimodal_by_concept__concept_id__get",
        "parameters": [
          {
            "name": "concept_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "description": "Canvas concept node ID",
              "title": "Concept Id"
            },
            "description": "Canvas concept node ID"
          },
          {
            "name": "media_type",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "$ref": "#/components/schemas/MultimodalMediaType"
                },
                {
                  "type": "null"
                }
              ],
              "description": "Filter by media type",
              "title": "Media Type"
            },
            "description": "Filter by media type"
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "maximum": 200,
              "minimum": 1,
              "description": "Maximum items to return",
              "default": 100,
              "title": "Limit"
            },
            "description": "Maximum items to return"
          },
          {
            "name": "include_thumbnail",
            "in": "query",
            "required": false,
            "schema": {
              "type": "boolean",
              "description": "Include base64 encoded thumbnails",
              "default": false,
              "title": "Include Thumbnail"
            },
            "description": "Include base64 encoded thumbnails"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MultimodalByConceptResponse"
                }
              }
            }
          },
          "413": {
            "description": "File too large (max 50MB)"
          },
          "415": {
            "description": "Unsupported media type"
          },
          "500": {
            "description": "Internal server error"
          },
          "400": {
            "description": "Invalid request - validation error"
          },
          "404": {
            "description": "Content not found"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/multimodal/{content_id}": {
      "get": {
        "tags": [
          "Multimodal"
        ],
        "summary": "Get content by ID",
        "description": "Retrieve multimodal content details by its unique ID.",
        "operationId": "get_content_api_v1_multimodal__content_id__get",
        "parameters": [
          {
            "name": "content_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "description": "Content UUID",
              "title": "Content Id"
            },
            "description": "Content UUID"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MultimodalResponse"
                }
              }
            }
          },
          "413": {
            "description": "File too large (max 50MB)"
          },
          "415": {
            "description": "Unsupported media type"
          },
          "500": {
            "description": "Internal server error"
          },
          "400": {
            "description": "Invalid request - validation error"
          },
          "404": {
            "description": "Content not found"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": [
          "Multimodal"
        ],
        "summary": "Update content metadata",
        "description": "Update metadata for existing multimodal content.",
        "operationId": "update_content_api_v1_multimodal__content_id__put",
        "parameters": [
          {
            "name": "content_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "description": "Content UUID",
              "title": "Content Id"
            },
            "description": "Content UUID"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/MultimodalUpdateRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MultimodalResponse"
                }
              }
            }
          },
          "413": {
            "description": "File too large (max 50MB)"
          },
          "415": {
            "description": "Unsupported media type"
          },
          "500": {
            "description": "Internal server error"
          },
          "400": {
            "description": "Invalid request - validation error"
          },
          "404": {
            "description": "Content not found"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": [
          "Multimodal"
        ],
        "summary": "Delete content",
        "description": "Delete multimodal content and its associated files.",
        "operationId": "delete_content_api_v1_multimodal__content_id__delete",
        "parameters": [
          {
            "name": "content_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "description": "Content UUID",
              "title": "Content Id"
            },
            "description": "Content UUID"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MultimodalDeleteResponse"
                }
              }
            }
          },
          "413": {
            "description": "File too large (max 50MB)"
          },
          "415": {
            "description": "Unsupported media type"
          },
          "500": {
            "description": "Internal server error"
          },
          "400": {
            "description": "Invalid request - validation error"
          },
          "404": {
            "description": "Content not found"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/canvas/intelligent-parallel/": {
      "post": {
        "tags": [
          "Intelligent Parallel"
        ],
        "summary": "Analyze canvas and group nodes for parallel processing",
        "description": "Analyzes the specified canvas file and groups nodes of the target color\nusing TF-IDF + K-Means clustering algorithm.\n\nReturns grouped nodes with recommended agents and confidence scores.\nResponse time target: < 3 seconds.",
        "operationId": "analyze_canvas_api_v1_canvas_intelligent_parallel__post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/IntelligentParallelRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Grouping analysis completed successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/IntelligentParallelResponse"
                }
              }
            }
          },
          "400": {
            "description": "Bad request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ParallelErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Canvas file not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ParallelErrorResponse"
                }
              }
            }
          },
          "409": {
            "description": "Conflict",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ParallelErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ParallelErrorResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/canvas/intelligent-parallel/confirm": {
      "post": {
        "tags": [
          "Intelligent Parallel"
        ],
        "summary": "Confirm and start batch processing",
        "description": "Starts batch processing for the confirmed node groups.\nReturns immediately with session ID for tracking progress.\n\nClient can override recommended agents in the request.",
        "operationId": "confirm_batch_api_v1_canvas_intelligent_parallel_confirm_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ConfirmRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "202": {
            "description": "Batch processing started",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SessionResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid group configuration",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ParallelErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Canvas file not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ParallelErrorResponse"
                }
              }
            }
          },
          "409": {
            "description": "Conflict",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ParallelErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ParallelErrorResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/canvas/intelligent-parallel/{session_id}": {
      "get": {
        "tags": [
          "Intelligent Parallel"
        ],
        "summary": "Get batch processing progress",
        "description": "Returns current progress status for a batch processing session.\nIncludes completed/failed node counts, per-group details, and performance metrics.",
        "operationId": "get_progress_api_v1_canvas_intelligent_parallel__session_id__get",
        "parameters": [
          {
            "name": "session_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "description": "Session ID returned from confirm endpoint",
              "examples": [
                "parallel-20250118-001"
              ],
              "title": "Session Id"
            },
            "description": "Session ID returned from confirm endpoint"
          }
        ],
        "responses": {
          "200": {
            "description": "Progress status retrieved",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProgressResponse"
                }
              }
            }
          },
          "400": {
            "description": "Bad request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ParallelErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Session not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ParallelErrorResponse"
                }
              }
            }
          },
          "409": {
            "description": "Conflict",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ParallelErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ParallelErrorResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/canvas/intelligent-parallel/cancel/{session_id}": {
      "post": {
        "tags": [
          "Intelligent Parallel"
        ],
        "summary": "Cancel batch processing session",
        "description": "Cancels an in-progress batch processing session.\nReturns the count of nodes completed before cancellation.\n\nReturns 409 Conflict if session is already completed or cancelled.",
        "operationId": "cancel_session_api_v1_canvas_intelligent_parallel_cancel__session_id__post",
        "parameters": [
          {
            "name": "session_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "description": "Session ID to cancel",
              "examples": [
                "parallel-20250118-001"
              ],
              "title": "Session Id"
            },
            "description": "Session ID to cancel"
          }
        ],
        "responses": {
          "200": {
            "description": "Session cancelled successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CancelResponse"
                }
              }
            }
          },
          "400": {
            "description": "Bad request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ParallelErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Session not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ParallelErrorResponse"
                }
              }
            }
          },
          "409": {
            "description": "Session already completed or cancelled",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ParallelErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ParallelErrorResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/canvas/single-agent": {
      "post": {
        "tags": [
          "Intelligent Parallel"
        ],
        "summary": "Retry single node with specified agent",
        "description": "Executes a single agent on a specific node.\nUseful for retrying failed nodes from batch processing.\n\nThis endpoint is independent of any batch session.",
        "operationId": "retry_single_node_api_v1_canvas_single_agent_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SingleAgentRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Agent execution completed",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SingleAgentResponse"
                }
              }
            }
          },
          "404": {
            "description": "Node or canvas not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ParallelErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ParallelErrorResponse"
                }
              }
            }
          },
          "400": {
            "description": "Bad request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ParallelErrorResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/": {
      "get": {
        "tags": [
          "Root"
        ],
        "summary": "Root",
        "description": "Root endpoint providing API information.\n\nReturns basic API metadata including name, version, and documentation URL.\n\nReturns:\n    dict: API information.",
        "operationId": "root__get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "APIMetricsSummary": {
        "properties": {
          "requests_total": {
            "type": "integer",
            "title": "Requests Total",
            "description": "Total requests count"
          },
          "requests_per_second": {
            "type": "number",
            "title": "Requests Per Second",
            "description": "Current RPS"
          },
          "avg_latency_ms": {
            "type": "number",
            "title": "Avg Latency Ms",
            "description": "Average latency in ms"
          },
          "p95_latency_ms": {
            "type": "number",
            "title": "P95 Latency Ms",
            "description": "P95 latency in ms"
          },
          "error_rate": {
            "type": "number",
            "title": "Error Rate",
            "description": "Error rate (0.0 - 1.0)"
          }
        },
        "type": "object",
        "required": [
          "requests_total",
          "requests_per_second",
          "avg_latency_ms",
          "p95_latency_ms",
          "error_rate"
        ],
        "title": "APIMetricsSummary",
        "description": "API metrics summary.\n\n[Source: specs/api/canvas-api.openapi.yml:987-1000]"
      },
      "ActionTrend": {
        "type": "string",
        "enum": [
          "improving",
          "stable",
          "declining"
        ],
        "title": "ActionTrend",
        "description": "Score trend direction for history analysis.\n\n[Source: specs/data/recommend-action-response.schema.json#history_context.trend]"
      },
      "ActionType": {
        "type": "string",
        "enum": [
          "decompose",
          "explain",
          "next"
        ],
        "title": "ActionType",
        "description": "Recommended action type based on score thresholds.\n\n[Source: specs/data/recommend-action-response.schema.json#action]\n[Source: docs/stories/31.3.story.md#AC-31.3.3]\n\nThresholds (0-100 scale):\n- decompose: score < 60\n- explain: score 60-79\n- next: score >= 80"
      },
      "AgentHealthCheckResponse": {
        "properties": {
          "status": {
            "$ref": "#/components/schemas/AgentHealthStatus",
            "description": "Overall health status: healthy=all checks pass, degraded=some templates missing, unhealthy=critical components unavailable"
          },
          "checks": {
            "$ref": "#/components/schemas/AgentHealthChecks",
            "description": "Individual check results"
          },
          "cached": {
            "type": "boolean",
            "title": "Cached",
            "description": "Whether this is a cached result (cache TTL: 60s, ref: ADR-007)",
            "default": false
          },
          "timestamp": {
            "type": "string",
            "format": "date-time",
            "title": "Timestamp",
            "description": "Check timestamp (ISO 8601 format)"
          }
        },
        "type": "object",
        "required": [
          "status",
          "checks",
          "timestamp"
        ],
        "title": "AgentHealthCheckResponse",
        "description": "Agent system health check response.\n\n[Source: docs/stories/story-12.G.3-api-health-check.md]\n[Source: specs/data/health-check-response.schema.json]\n[Source: specs/api/agent-api.openapi.yml#AgentHealthCheckResponse]"
      },
      "AgentHealthChecks": {
        "properties": {
          "api_key_configured": {
            "type": "boolean",
            "title": "Api Key Configured",
            "description": "Whether API Key is configured (does not return actual key value)"
          },
          "gemini_client_initialized": {
            "type": "boolean",
            "title": "Gemini Client Initialized",
            "description": "Whether GeminiClient is successfully initialized"
          },
          "prompt_templates": {
            "$ref": "#/components/schemas/PromptTemplateCheck",
            "description": "Prompt template check results"
          },
          "api_test": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/ApiTestResult"
              },
              {
                "type": "null"
              }
            ],
            "description": "Optional API call test result"
          }
        },
        "type": "object",
        "required": [
          "api_key_configured",
          "gemini_client_initialized",
          "prompt_templates"
        ],
        "title": "AgentHealthChecks",
        "description": "Individual health check results.\n\n[Source: specs/data/health-check-response.schema.json#L24-75]"
      },
      "AgentHealthStatus": {
        "type": "string",
        "enum": [
          "healthy",
          "degraded",
          "unhealthy"
        ],
        "title": "AgentHealthStatus",
        "description": "Agent system health status enum.\n\n- healthy: All checks pass\n- degraded: Configuration OK but some templates missing\n- unhealthy: API Key not configured or GeminiClient not initialized\n\n[Source: specs/data/health-check-response.schema.json#L20-22]\n[Source: specs/api/agent-api.openapi.yml#AgentHealthCheckResponse]"
      },
      "AgentTypeStats": {
        "properties": {
          "count": {
            "type": "integer",
            "title": "Count",
            "description": "Total invocations"
          },
          "success_count": {
            "type": "integer",
            "title": "Success Count",
            "description": "Successful invocations",
            "default": 0
          },
          "error_count": {
            "type": "integer",
            "title": "Error Count",
            "description": "Failed invocations",
            "default": 0
          },
          "avg_time_s": {
            "type": "number",
            "title": "Avg Time S",
            "description": "Average execution time in seconds",
            "default": 0.0
          }
        },
        "type": "object",
        "required": [
          "count"
        ],
        "title": "AgentTypeStats",
        "description": "Statistics for a single agent type."
      },
      "AgentTypeSummary": {
        "properties": {
          "agent_type": {
            "type": "string",
            "title": "Agent Type"
          },
          "invocations": {
            "type": "integer",
            "title": "Invocations"
          },
          "avg_execution_time_s": {
            "type": "number",
            "title": "Avg Execution Time S"
          }
        },
        "type": "object",
        "required": [
          "agent_type",
          "invocations",
          "avg_execution_time_s"
        ],
        "title": "AgentTypeSummary",
        "description": "Agent type summary."
      },
      "AlertListResponse": {
        "properties": {
          "alerts": {
            "items": {
              "$ref": "#/components/schemas/AlertResponse"
            },
            "type": "array",
            "title": "Alerts",
            "description": "List of active alerts"
          },
          "total": {
            "type": "integer",
            "title": "Total",
            "description": "Total count of active alerts"
          }
        },
        "type": "object",
        "required": [
          "alerts",
          "total"
        ],
        "title": "AlertListResponse",
        "description": "Alert list response.\n\n[Source: specs/api/canvas-api.openapi.yml:644-662]"
      },
      "AlertResponse": {
        "properties": {
          "id": {
            "type": "string",
            "title": "Id",
            "description": "Unique alert identifier"
          },
          "name": {
            "type": "string",
            "title": "Name",
            "description": "Alert name (e.g., 'HighAPILatency')"
          },
          "severity": {
            "type": "string",
            "title": "Severity",
            "description": "Alert severity: critical, warning, info"
          },
          "message": {
            "type": "string",
            "title": "Message",
            "description": "Human-readable alert message"
          },
          "triggered_at": {
            "type": "string",
            "format": "date-time",
            "title": "Triggered At",
            "description": "When alert was triggered"
          },
          "value": {
            "anyOf": [
              {
                "type": "number"
              },
              {
                "type": "null"
              }
            ],
            "title": "Value",
            "description": "Current metric value"
          },
          "threshold": {
            "anyOf": [
              {
                "type": "number"
              },
              {
                "type": "null"
              }
            ],
            "title": "Threshold",
            "description": "Alert threshold"
          },
          "labels": {
            "additionalProperties": {
              "type": "string"
            },
            "type": "object",
            "title": "Labels",
            "description": "Additional labels"
          }
        },
        "type": "object",
        "required": [
          "id",
          "name",
          "severity",
          "message",
          "triggered_at"
        ],
        "title": "AlertResponse",
        "description": "Alert response model.\n\n[Source: specs/api/canvas-api.openapi.yml:1062-1091]\n\nMatches the OpenAPI Alert schema definition.",
        "example": {
          "id": "abc123def456",
          "labels": {
            "endpoint": "/api/v1/canvas"
          },
          "message": "95分位API响应时间超过1秒，当前值: 1.5s",
          "name": "HighAPILatency",
          "severity": "warning",
          "threshold": 1.0,
          "triggered_at": "2025-12-03T20:15:00",
          "value": 1.5
        }
      },
      "AlertsSummary": {
        "properties": {
          "active_count": {
            "type": "integer",
            "title": "Active Count",
            "description": "Total active alerts"
          },
          "critical_count": {
            "type": "integer",
            "title": "Critical Count",
            "description": "Critical alerts count"
          },
          "warning_count": {
            "type": "integer",
            "title": "Warning Count",
            "description": "Warning alerts count"
          },
          "info_count": {
            "type": "integer",
            "title": "Info Count",
            "description": "Info alerts count",
            "default": 0
          }
        },
        "type": "object",
        "required": [
          "active_count",
          "critical_count",
          "warning_count"
        ],
        "title": "AlertsSummary",
        "description": "Alerts summary for dashboard."
      },
      "AlternativeAgent": {
        "properties": {
          "agent": {
            "type": "string",
            "title": "Agent",
            "description": "Agent endpoint path"
          },
          "reason": {
            "type": "string",
            "title": "Reason",
            "description": "Reason for this alternative"
          }
        },
        "type": "object",
        "required": [
          "agent",
          "reason"
        ],
        "title": "AlternativeAgent",
        "description": "Alternative agent recommendation.\n\n[Source: specs/data/recommend-action-response.schema.json#alternative_agents]"
      },
      "ApiTestResult": {
        "properties": {
          "enabled": {
            "type": "boolean",
            "title": "Enabled",
            "description": "Whether API call test was enabled"
          },
          "result": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Result",
            "description": "Test result: 'success' or error message"
          }
        },
        "type": "object",
        "required": [
          "enabled"
        ],
        "title": "ApiTestResult",
        "description": "Optional API call test result.\n\n[Source: specs/data/health-check-response.schema.json#L61-74]"
      },
      "BatchEpisodesRequest": {
        "properties": {
          "events": {
            "items": {
              "$ref": "#/components/schemas/BatchEventItem"
            },
            "type": "array",
            "maxItems": 50,
            "title": "Events",
            "description": "批量事件列表(最多50个)"
          }
        },
        "type": "object",
        "required": [
          "events"
        ],
        "title": "BatchEpisodesRequest",
        "description": "Request model for batch learning episodes.\n\n✅ Verified from Story 30.3 AC-30.3.10:\n- 最多50个事件\n- 每个事件包含 event_type, timestamp, canvas_path, node_id\n- 可选 metadata 包含颜色变化信息\n\n[Source: docs/stories/30.3.memory-api-health-endpoints.story.md#AC-30.3.10]",
        "example": {
          "events": [
            {
              "canvas_path": "离散数学/命题逻辑.canvas",
              "event_type": "color_changed",
              "metadata": {
                "new_color": "2",
                "new_level": "mastered",
                "old_color": "1",
                "old_level": "not_understood"
              },
              "node_id": "b33c50660173e5d3",
              "timestamp": "2026-01-16T12:00:00Z"
            }
          ]
        }
      },
      "BatchEpisodesResponse": {
        "properties": {
          "success": {
            "type": "boolean",
            "title": "Success",
            "description": "整体操作是否成功"
          },
          "processed": {
            "type": "integer",
            "minimum": 0.0,
            "title": "Processed",
            "description": "成功处理的事件数量"
          },
          "failed": {
            "type": "integer",
            "minimum": 0.0,
            "title": "Failed",
            "description": "处理失败的事件数量"
          },
          "errors": {
            "items": {
              "$ref": "#/components/schemas/BatchErrorItem"
            },
            "type": "array",
            "title": "Errors",
            "description": "错误详情列表"
          },
          "timestamp": {
            "type": "string",
            "title": "Timestamp",
            "description": "响应时间戳"
          }
        },
        "type": "object",
        "required": [
          "success",
          "processed",
          "failed",
          "timestamp"
        ],
        "title": "BatchEpisodesResponse",
        "description": "Response model for batch learning episodes.\n\n✅ Verified from Story 30.3 AC-30.3.10:\n- success: 整体操作是否成功\n- processed: 成功处理的事件数量\n- failed: 处理失败的事件数量\n- errors: 错误详情列表\n\n[Source: docs/stories/30.3.memory-api-health-endpoints.story.md#AC-30.3.10]",
        "example": {
          "errors": [],
          "failed": 0,
          "processed": 5,
          "success": true,
          "timestamp": "2026-01-16T12:00:00Z"
        }
      },
      "BatchErrorItem": {
        "properties": {
          "index": {
            "type": "integer",
            "title": "Index",
            "description": "失败事件在请求数组中的索引"
          },
          "error": {
            "type": "string",
            "title": "Error",
            "description": "错误信息"
          }
        },
        "type": "object",
        "required": [
          "index",
          "error"
        ],
        "title": "BatchErrorItem",
        "description": "Error detail for failed batch event."
      },
      "BatchEventItem": {
        "properties": {
          "event_type": {
            "type": "string",
            "title": "Event Type",
            "description": "事件类型"
          },
          "timestamp": {
            "type": "string",
            "title": "Timestamp",
            "description": "事件时间戳 (ISO format)"
          },
          "canvas_path": {
            "type": "string",
            "title": "Canvas Path",
            "description": "Canvas文件路径"
          },
          "node_id": {
            "type": "string",
            "title": "Node Id",
            "description": "节点ID"
          },
          "metadata": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/BatchEventMetadata"
              },
              {
                "type": "null"
              }
            ],
            "description": "事件元数据"
          }
        },
        "type": "object",
        "required": [
          "event_type",
          "timestamp",
          "canvas_path",
          "node_id"
        ],
        "title": "BatchEventItem",
        "description": "Single event item in batch request."
      },
      "BatchEventMetadata": {
        "properties": {
          "old_color": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/ColorCode"
              },
              {
                "type": "null"
              }
            ],
            "description": "变化前颜色代码"
          },
          "new_color": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/ColorCode"
              },
              {
                "type": "null"
              }
            ],
            "description": "变化后颜色代码"
          },
          "old_level": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/MasteryLevel"
              },
              {
                "type": "null"
              }
            ],
            "description": "变化前掌握等级"
          },
          "new_level": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/MasteryLevel"
              },
              {
                "type": "null"
              }
            ],
            "description": "变化后掌握等级"
          }
        },
        "type": "object",
        "title": "BatchEventMetadata",
        "description": "Metadata for batch learning events."
      },
      "BatchIndexRequest": {
        "properties": {
          "canvas_paths": {
            "items": {
              "type": "string"
            },
            "type": "array",
            "maxItems": 50,
            "minItems": 1,
            "title": "Canvas Paths",
            "description": "List of Canvas file paths to index"
          },
          "force": {
            "type": "boolean",
            "title": "Force",
            "description": "Force re-index even if already indexed",
            "default": false
          }
        },
        "type": "object",
        "required": [
          "canvas_paths"
        ],
        "title": "BatchIndexRequest",
        "description": "Batch Canvas index request.\n\nIndex multiple Canvas files at once."
      },
      "BatchIndexResponse": {
        "properties": {
          "total": {
            "type": "integer",
            "title": "Total",
            "description": "Total Canvas files requested"
          },
          "success_count": {
            "type": "integer",
            "title": "Success Count",
            "description": "Number of successfully indexed files",
            "default": 0
          },
          "failed_count": {
            "type": "integer",
            "title": "Failed Count",
            "description": "Number of failed files",
            "default": 0
          },
          "results": {
            "items": {
              "$ref": "#/components/schemas/CanvasIndexResponse"
            },
            "type": "array",
            "title": "Results",
            "description": "Individual results for each Canvas"
          },
          "total_duration_ms": {
            "type": "number",
            "title": "Total Duration Ms",
            "description": "Total operation duration in milliseconds",
            "default": 0.0
          }
        },
        "type": "object",
        "required": [
          "total"
        ],
        "title": "BatchIndexResponse",
        "description": "Batch Canvas index response."
      },
      "Body_upload_file_api_v1_multimodal_upload_post": {
        "properties": {
          "file": {
            "type": "string",
            "format": "binary",
            "title": "File",
            "description": "File to upload"
          },
          "related_concept_id": {
            "type": "string",
            "title": "Related Concept Id",
            "description": "Canvas node ID to associate"
          },
          "canvas_path": {
            "type": "string",
            "title": "Canvas Path",
            "description": "Canvas file path"
          },
          "description": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Description",
            "description": "Optional description"
          }
        },
        "type": "object",
        "required": [
          "file",
          "related_concept_id",
          "canvas_path"
        ],
        "title": "Body_upload_file_api_v1_multimodal_upload_post"
      },
      "CancelResponse": {
        "properties": {
          "success": {
            "type": "boolean",
            "title": "Success",
            "description": "Whether cancellation succeeded"
          },
          "message": {
            "type": "string",
            "title": "Message",
            "description": "Status message",
            "examples": [
              "Task cancelled successfully"
            ]
          },
          "completed_count": {
            "type": "integer",
            "title": "Completed Count",
            "description": "Number of tasks completed before cancellation",
            "default": 0
          }
        },
        "type": "object",
        "required": [
          "success",
          "message"
        ],
        "title": "CancelResponse",
        "description": "Response model for session cancellation.\n\n[Source: specs/api/parallel-api.openapi.yml#/paths/cancel/responses/200]"
      },
      "CanvasIndexRequest": {
        "properties": {
          "canvas_path": {
            "type": "string",
            "title": "Canvas Path",
            "description": "Canvas file path"
          },
          "subject": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Subject",
            "description": "Override subject (optional)"
          },
          "category": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Category",
            "description": "Override category (optional)"
          },
          "force": {
            "type": "boolean",
            "title": "Force",
            "description": "Force re-index even if already indexed",
            "default": false
          }
        },
        "type": "object",
        "required": [
          "canvas_path"
        ],
        "title": "CanvasIndexRequest",
        "description": "Canvas index request model.\n\nTriggers indexing of a Canvas to LanceDB.\n\n[Source: Design doc - Phase 1.3]",
        "example": {
          "canvas_path": "Math 54/离散数学.canvas",
          "category": "math",
          "force": false,
          "subject": "math54"
        }
      },
      "CanvasIndexResponse": {
        "properties": {
          "canvas_path": {
            "type": "string",
            "title": "Canvas Path",
            "description": "Canvas file path"
          },
          "success": {
            "type": "boolean",
            "title": "Success",
            "description": "Whether indexing succeeded"
          },
          "node_count": {
            "type": "integer",
            "minimum": 0.0,
            "title": "Node Count",
            "description": "Number of nodes indexed",
            "default": 0
          },
          "subject": {
            "type": "string",
            "title": "Subject",
            "description": "Subject used for indexing"
          },
          "category": {
            "type": "string",
            "title": "Category",
            "description": "Category used for indexing"
          },
          "group_id": {
            "type": "string",
            "title": "Group Id",
            "description": "Group ID used for indexing"
          },
          "duration_ms": {
            "type": "number",
            "minimum": 0.0,
            "title": "Duration Ms",
            "description": "Indexing duration in milliseconds",
            "default": 0.0
          },
          "message": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Message",
            "description": "Additional message or error details"
          }
        },
        "type": "object",
        "required": [
          "canvas_path",
          "success",
          "subject",
          "category",
          "group_id"
        ],
        "title": "CanvasIndexResponse",
        "description": "Canvas index response model.\n\nResult of a Canvas indexing operation.",
        "example": {
          "canvas_path": "Math 54/离散数学.canvas",
          "category": "math",
          "duration_ms": 1250.5,
          "group_id": "math54:离散数学",
          "node_count": 42,
          "subject": "math54",
          "success": true
        }
      },
      "CanvasIndexStatusResponse": {
        "properties": {
          "canvas_path": {
            "type": "string",
            "title": "Canvas Path",
            "description": "Canvas file path"
          },
          "indexed": {
            "type": "boolean",
            "title": "Indexed",
            "description": "Whether the Canvas is indexed"
          },
          "node_count": {
            "type": "integer",
            "minimum": 0.0,
            "title": "Node Count",
            "description": "Number of indexed nodes",
            "default": 0
          },
          "last_indexed": {
            "anyOf": [
              {
                "type": "string",
                "format": "date-time"
              },
              {
                "type": "null"
              }
            ],
            "title": "Last Indexed",
            "description": "Last indexing timestamp"
          },
          "subject": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Subject",
            "description": "Subject used during indexing"
          },
          "table_name": {
            "type": "string",
            "title": "Table Name",
            "description": "LanceDB table name",
            "default": "canvas_nodes"
          }
        },
        "type": "object",
        "required": [
          "canvas_path",
          "indexed"
        ],
        "title": "CanvasIndexStatusResponse",
        "description": "LanceDB index status response model.\n\nShows whether a Canvas has been indexed and relevant statistics.\n\n[Source: Design doc - Phase 1.2]",
        "example": {
          "canvas_path": "Math 54/离散数学.canvas",
          "indexed": true,
          "last_indexed": "2026-02-04T12:30:00",
          "node_count": 42,
          "subject": "math54",
          "table_name": "canvas_nodes"
        }
      },
      "CanvasMetadataResponse": {
        "properties": {
          "canvas_path": {
            "type": "string",
            "title": "Canvas Path",
            "description": "Canvas file path"
          },
          "subject": {
            "type": "string",
            "title": "Subject",
            "description": "Subject identifier (e.g., 'math54')"
          },
          "category": {
            "type": "string",
            "title": "Category",
            "description": "Category identifier (e.g., 'math')"
          },
          "group_id": {
            "type": "string",
            "title": "Group Id",
            "description": "Graphiti group_id (e.g., 'math54:离散数学')"
          },
          "source": {
            "$ref": "#/components/schemas/MetadataSource",
            "description": "How the metadata was resolved"
          }
        },
        "type": "object",
        "required": [
          "canvas_path",
          "subject",
          "category",
          "group_id",
          "source"
        ],
        "title": "CanvasMetadataResponse",
        "description": "Canvas metadata response model.\n\nReturns subject, category, and group_id for a Canvas file.\n\n[Source: Design doc - Phase 1.1]",
        "example": {
          "canvas_path": "Math 54/离散数学.canvas",
          "category": "math",
          "group_id": "math54:离散数学",
          "source": "config",
          "subject": "math54"
        }
      },
      "CanvasResponse": {
        "properties": {
          "name": {
            "type": "string",
            "title": "Name",
            "description": "Canvas file name"
          },
          "nodes": {
            "items": {
              "$ref": "#/components/schemas/NodeRead"
            },
            "type": "array",
            "title": "Nodes",
            "description": "List of nodes"
          },
          "edges": {
            "items": {
              "$ref": "#/components/schemas/EdgeRead"
            },
            "type": "array",
            "title": "Edges",
            "description": "List of edges"
          }
        },
        "type": "object",
        "required": [
          "name",
          "nodes",
          "edges"
        ],
        "title": "CanvasResponse",
        "description": "Response model for a Canvas.\n\n[Source: specs/api/fastapi-backend-api.openapi.yml#/components/schemas/CanvasResponse]"
      },
      "ColorCode": {
        "type": "string",
        "enum": [
          "1",
          "2",
          "3",
          "4",
          "5",
          "6"
        ],
        "title": "ColorCode",
        "description": "Canvas color codes (1-6)."
      },
      "ConceptHistoryResponse": {
        "properties": {
          "concept_id": {
            "type": "string",
            "title": "Concept Id",
            "description": "概念ID"
          },
          "timeline": {
            "items": {
              "$ref": "#/components/schemas/ConceptHistoryTimeline"
            },
            "type": "array",
            "title": "Timeline",
            "description": "时间线数据"
          },
          "score_trend": {
            "$ref": "#/components/schemas/ScoreTrend",
            "description": "得分趋势"
          },
          "total_reviews": {
            "type": "integer",
            "title": "Total Reviews",
            "description": "总复习次数"
          }
        },
        "type": "object",
        "required": [
          "concept_id",
          "timeline",
          "score_trend",
          "total_reviews"
        ],
        "title": "ConceptHistoryResponse",
        "description": "Response for concept learning history.\n\n✅ Verified from AC-22.4.3: GET /api/v1/memory/concepts/{id}/history\n\n[Source: docs/stories/22.4.story.md#Dev-Notes]",
        "example": {
          "concept_id": "concept-123",
          "score_trend": {
            "average": 72.5,
            "first": 60,
            "improvement": 25,
            "last": 85
          },
          "timeline": [
            {
              "concept": "逆否命题",
              "review_count": 3,
              "score": 85,
              "timestamp": "2025-12-12T10:30:00",
              "user_id": "user-123"
            }
          ],
          "total_reviews": 5
        }
      },
      "ConceptHistoryTimeline": {
        "properties": {
          "timestamp": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Timestamp",
            "description": "时间戳"
          },
          "score": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Score",
            "description": "得分"
          },
          "user_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "User Id",
            "description": "用户ID"
          },
          "concept": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Concept",
            "description": "概念名称"
          },
          "review_count": {
            "type": "integer",
            "title": "Review Count",
            "description": "复习次数",
            "default": 0
          }
        },
        "type": "object",
        "title": "ConceptHistoryTimeline",
        "description": "Single timeline entry for concept history.\n\n[Source: AC-22.4.3]"
      },
      "ConceptStatus": {
        "type": "string",
        "enum": [
          "weak",
          "improving",
          "mastered"
        ],
        "title": "ConceptStatus",
        "description": "Concept mastery status.\n\n[Source: specs/api/review-api.openapi.yml#L771-775]"
      },
      "ConfirmRequest": {
        "properties": {
          "canvas_path": {
            "type": "string",
            "title": "Canvas Path",
            "description": "Canvas file path",
            "examples": [
              "离散数学.canvas"
            ]
          },
          "groups": {
            "items": {
              "$ref": "#/components/schemas/GroupExecuteConfig"
            },
            "type": "array",
            "title": "Groups",
            "description": "Group configurations with agent assignments (can override recommendations)"
          },
          "max_concurrent": {
            "anyOf": [
              {
                "type": "integer",
                "maximum": 50.0,
                "minimum": 1.0
              },
              {
                "type": "null"
              }
            ],
            "title": "Max Concurrent",
            "description": "Maximum concurrent executions (optional, scheduler decides if not specified)"
          },
          "timeout": {
            "type": "integer",
            "maximum": 3600.0,
            "minimum": 60.0,
            "title": "Timeout",
            "description": "Total timeout in seconds",
            "default": 600
          }
        },
        "type": "object",
        "required": [
          "canvas_path",
          "groups"
        ],
        "title": "ConfirmRequest",
        "description": "Request model for confirming and executing parallel processing (POST /canvas/intelligent-parallel/confirm).\n\n[Source: specs/api/parallel-api.openapi.yml#/components/schemas/ParallelExecuteRequest]"
      },
      "CreateSnapshotRequest": {
        "properties": {
          "canvas_path": {
            "type": "string",
            "title": "Canvas Path",
            "description": "Canvas文件路径"
          },
          "description": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Description",
            "description": "快照描述"
          },
          "tags": {
            "anyOf": [
              {
                "items": {
                  "type": "string"
                },
                "type": "array"
              },
              {
                "type": "null"
              }
            ],
            "title": "Tags",
            "description": "标签列表"
          }
        },
        "type": "object",
        "required": [
          "canvas_path"
        ],
        "title": "CreateSnapshotRequest",
        "description": "创建快照请求模型\n\n[Source: docs/architecture/rollback-recovery-architecture.md:328-342]"
      },
      "DecomposeRequest": {
        "properties": {
          "canvas_name": {
            "type": "string",
            "title": "Canvas Name",
            "description": "Canvas file name"
          },
          "node_id": {
            "type": "string",
            "title": "Node Id",
            "description": "Target node ID"
          }
        },
        "type": "object",
        "required": [
          "canvas_name",
          "node_id"
        ],
        "title": "DecomposeRequest",
        "description": "Request model for concept decomposition.\n\n[Source: specs/api/fastapi-backend-api.openapi.yml#/components/schemas/DecomposeRequest]\n[Source: specs/data/decompose-request.schema.json]"
      },
      "DecomposeResponse": {
        "properties": {
          "questions": {
            "items": {
              "type": "string"
            },
            "type": "array",
            "title": "Questions",
            "description": "Generated guiding questions"
          },
          "created_nodes": {
            "items": {
              "$ref": "#/components/schemas/NodeRead"
            },
            "type": "array",
            "title": "Created Nodes",
            "description": "Created nodes"
          },
          "created_edges": {
            "items": {
              "$ref": "#/components/schemas/EdgeRead"
            },
            "type": "array",
            "title": "Created Edges",
            "description": "Created edges connecting nodes"
          }
        },
        "type": "object",
        "required": [
          "questions",
          "created_nodes"
        ],
        "title": "DecomposeResponse",
        "description": "Response model for concept decomposition.\n\n[Source: specs/api/fastapi-backend-api.openapi.yml#/components/schemas/DecomposeResponse]\n[Source: specs/data/decompose-response.schema.json]\n[Story 12.M.2: Added created_edges for Canvas edge connections]"
      },
      "DiffResponse": {
        "properties": {
          "snapshot_id": {
            "type": "string",
            "title": "Snapshot Id",
            "description": "快照ID"
          },
          "canvas_path": {
            "type": "string",
            "title": "Canvas Path",
            "description": "Canvas文件路径"
          },
          "timestamp": {
            "type": "string",
            "format": "date-time",
            "title": "Timestamp",
            "description": "比较时间戳"
          },
          "nodes_diff": {
            "additionalProperties": true,
            "type": "object",
            "title": "Nodes Diff",
            "description": "节点差异"
          },
          "edges_diff": {
            "additionalProperties": true,
            "type": "object",
            "title": "Edges Diff",
            "description": "边差异"
          }
        },
        "type": "object",
        "required": [
          "snapshot_id",
          "canvas_path",
          "timestamp"
        ],
        "title": "DiffResponse",
        "description": "差异响应模型\n\n[Source: docs/architecture/rollback-recovery-architecture.md:382-400]"
      },
      "EdgeCreate": {
        "properties": {
          "fromNode": {
            "type": "string",
            "title": "Fromnode",
            "description": "Source node ID"
          },
          "toNode": {
            "type": "string",
            "title": "Tonode",
            "description": "Target node ID"
          },
          "fromSide": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/EdgeSide"
              },
              {
                "type": "null"
              }
            ],
            "description": "Source side"
          },
          "toSide": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/EdgeSide"
              },
              {
                "type": "null"
              }
            ],
            "description": "Target side"
          },
          "label": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Label",
            "description": "Edge label"
          }
        },
        "type": "object",
        "required": [
          "fromNode",
          "toNode"
        ],
        "title": "EdgeCreate",
        "description": "Request model for creating an edge.\n\n[Source: specs/api/fastapi-backend-api.openapi.yml#/components/schemas/EdgeCreate]"
      },
      "EdgeRead": {
        "properties": {
          "id": {
            "type": "string",
            "title": "Id",
            "description": "Edge ID"
          },
          "fromNode": {
            "type": "string",
            "title": "Fromnode",
            "description": "Source node ID"
          },
          "toNode": {
            "type": "string",
            "title": "Tonode",
            "description": "Target node ID"
          },
          "fromSide": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Fromside",
            "description": "Source side"
          },
          "toSide": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Toside",
            "description": "Target side"
          },
          "label": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Label",
            "description": "Edge label"
          }
        },
        "type": "object",
        "required": [
          "id",
          "fromNode",
          "toNode"
        ],
        "title": "EdgeRead",
        "description": "Response model for an edge.\n\n[Source: specs/api/fastapi-backend-api.openapi.yml#/components/schemas/EdgeRead]"
      },
      "EdgeSide": {
        "type": "string",
        "enum": [
          "top",
          "bottom",
          "left",
          "right"
        ],
        "title": "EdgeSide",
        "description": "Edge connection side."
      },
      "ErrorResponse": {
        "properties": {
          "code": {
            "type": "integer",
            "title": "Code",
            "description": "Error code"
          },
          "message": {
            "type": "string",
            "title": "Message",
            "description": "Error message"
          },
          "details": {
            "anyOf": [
              {
                "additionalProperties": true,
                "type": "object"
              },
              {
                "type": "null"
              }
            ],
            "title": "Details",
            "description": "Additional error details"
          }
        },
        "type": "object",
        "required": [
          "code",
          "message"
        ],
        "title": "ErrorResponse",
        "description": "Standard error response model.\n\n[Source: specs/api/fastapi-backend-api.openapi.yml#/components/schemas/ErrorResponse]"
      },
      "ExplainRequest": {
        "properties": {
          "canvas_name": {
            "type": "string",
            "title": "Canvas Name",
            "description": "Canvas file name"
          },
          "node_id": {
            "type": "string",
            "title": "Node Id",
            "description": "Target node ID"
          },
          "node_content": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Node Content",
            "description": "Real-time node content from plugin (Story 12.B.2). If provided, used directly instead of reading from disk."
          }
        },
        "type": "object",
        "required": [
          "canvas_name",
          "node_id"
        ],
        "title": "ExplainRequest",
        "description": "Request model for explanation generation.\n\n[Source: specs/api/fastapi-backend-api.openapi.yml#/components/schemas/ExplainRequest]\n[Story 12.B.2: 节点内容实时传递]"
      },
      "ExplainResponse": {
        "properties": {
          "explanation": {
            "type": "string",
            "title": "Explanation",
            "description": "Generated explanation"
          },
          "created_node_id": {
            "type": "string",
            "title": "Created Node Id",
            "description": "Created explanation node ID"
          }
        },
        "type": "object",
        "required": [
          "explanation",
          "created_node_id"
        ],
        "title": "ExplainResponse",
        "description": "Response model for explanation generation.\n\n[Source: specs/api/fastapi-backend-api.openapi.yml#/components/schemas/ExplainResponse]"
      },
      "FSRSStateQueryResponse": {
        "properties": {
          "concept_id": {
            "type": "string",
            "title": "Concept Id",
            "description": "Concept identifier"
          },
          "fsrs_state": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/FSRSStateResponse"
              },
              {
                "type": "null"
              }
            ],
            "description": "FSRS algorithm state (None if no card exists)"
          },
          "card_state": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Card State",
            "description": "Serialized FSRS card JSON for plugin to deserialize"
          },
          "found": {
            "type": "boolean",
            "title": "Found",
            "description": "Whether a card was found for this concept",
            "default": true
          },
          "reason": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Reason",
            "description": "Reason when found=false: 'no_card_created', 'fsrs_not_initialized', or error details"
          }
        },
        "type": "object",
        "required": [
          "concept_id"
        ],
        "title": "FSRSStateQueryResponse",
        "description": "Response model for GET /api/v1/review/fsrs-state/{concept_id} endpoint.\n\nStory 32.3: Plugin queries this endpoint to get FSRS state for priority calculation.\n\n[Source: specs/api/review-api.openapi.yml#FSRSStateQueryResponse]\n[Source: docs/stories/32.3.story.md#Task-1]"
      },
      "FSRSStateResponse": {
        "properties": {
          "stability": {
            "type": "number",
            "title": "Stability",
            "description": "Memory stability (days)"
          },
          "difficulty": {
            "type": "number",
            "maximum": 10.0,
            "minimum": 1.0,
            "title": "Difficulty",
            "description": "Card difficulty (1-10)"
          },
          "state": {
            "type": "integer",
            "title": "State",
            "description": "Card state: 0=New, 1=Learning, 2=Review, 3=Relearning"
          },
          "reps": {
            "type": "integer",
            "title": "Reps",
            "description": "Successful review count",
            "default": 0
          },
          "lapses": {
            "type": "integer",
            "title": "Lapses",
            "description": "Failed review count (rating=1)",
            "default": 0
          },
          "retrievability": {
            "anyOf": [
              {
                "type": "number",
                "maximum": 1.0,
                "minimum": 0.0
              },
              {
                "type": "null"
              }
            ],
            "title": "Retrievability",
            "description": "Current retrievability probability (0-1)"
          },
          "due": {
            "anyOf": [
              {
                "type": "string",
                "format": "date-time"
              },
              {
                "type": "null"
              }
            ],
            "title": "Due",
            "description": "Next due date/time for review"
          },
          "last_review": {
            "anyOf": [
              {
                "type": "string",
                "format": "date-time"
              },
              {
                "type": "null"
              }
            ],
            "title": "Last Review",
            "description": "Last review date/time"
          }
        },
        "type": "object",
        "required": [
          "stability",
          "difficulty",
          "state"
        ],
        "title": "FSRSStateResponse",
        "description": "FSRS card state in response.\n\nStory 32.2: Exposes FSRS algorithm internal state for transparency.\nStory 32.3: Extended with retrievability and due for plugin priority calculation.\n\n[Source: specs/data/fsrs-card.schema.json]\n[Source: docs/stories/32.3.story.md]"
      },
      "GenerateReviewRequest": {
        "properties": {
          "source_canvas": {
            "type": "string",
            "title": "Source Canvas",
            "description": "Source Canvas file name"
          },
          "node_ids": {
            "anyOf": [
              {
                "items": {
                  "type": "string"
                },
                "type": "array"
              },
              {
                "type": "null"
              }
            ],
            "title": "Node Ids",
            "description": "Specific node IDs (optional, defaults to all green nodes)"
          },
          "mode": {
            "type": "string",
            "enum": [
              "fresh",
              "targeted"
            ],
            "title": "Mode",
            "description": "Review mode: fresh=blind test, targeted=weakness-focused",
            "default": "fresh"
          },
          "weak_weight": {
            "type": "number",
            "maximum": 1.0,
            "minimum": 0.0,
            "title": "Weak Weight",
            "description": "Weight for weak concepts in targeted mode",
            "default": 0.7
          },
          "mastered_weight": {
            "type": "number",
            "maximum": 1.0,
            "minimum": 0.0,
            "title": "Mastered Weight",
            "description": "Weight for mastered concepts in targeted mode",
            "default": 0.3
          }
        },
        "type": "object",
        "required": [
          "source_canvas"
        ],
        "title": "GenerateReviewRequest",
        "description": "Request model for generating verification canvas.\n\n[Source: specs/api/fastapi-backend-api.openapi.yml#/components/schemas/GenerateReviewRequest]\n[Source: specs/data/review-generate-request.schema.json - Story 24.1]"
      },
      "GenerateReviewResponse": {
        "properties": {
          "verification_canvas_name": {
            "type": "string",
            "title": "Verification Canvas Name",
            "description": "Generated verification canvas name"
          },
          "node_count": {
            "type": "integer",
            "title": "Node Count",
            "description": "Number of verification nodes"
          },
          "mode_used": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Mode Used",
            "description": "Mode used for generation (fresh/targeted)"
          },
          "weak_concepts": {
            "items": {
              "$ref": "#/components/schemas/WeakConceptData"
            },
            "type": "array",
            "title": "Weak Concepts",
            "description": "Weak concepts identified in targeted mode"
          },
          "weight_config": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/WeightConfig"
              },
              {
                "type": "null"
              }
            ],
            "description": "Weight configuration used in targeted mode"
          }
        },
        "type": "object",
        "required": [
          "verification_canvas_name",
          "node_count"
        ],
        "title": "GenerateReviewResponse",
        "description": "Response model for generated verification canvas.\n\n[Source: specs/api/fastapi-backend-api.openapi.yml#/components/schemas/GenerateReviewResponse]\n[Source: specs/data/review-generate-response.schema.json - Story 24.1]\n[Source: Story 24.3 - Added weak_concepts and weight_config fields]"
      },
      "GraphSyncStatusEnum": {
        "type": "string",
        "enum": [
          "synced",
          "pending",
          "skipped"
        ],
        "title": "GraphSyncStatusEnum",
        "description": "图谱同步状态"
      },
      "GraphitiHealthResponse": {
        "properties": {
          "status": {
            "type": "string",
            "title": "Status",
            "description": "状态: ok=正常, error=不可用"
          },
          "graph_stats": {
            "anyOf": [
              {
                "additionalProperties": true,
                "type": "object"
              },
              {
                "type": "null"
              }
            ],
            "title": "Graph Stats",
            "description": "图统计信息: node_count, edge_count, episode_count"
          },
          "last_episode_timestamp": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Last Episode Timestamp",
            "description": "最近episode的时间戳"
          },
          "error": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Error",
            "description": "错误信息(仅error时存在)"
          }
        },
        "type": "object",
        "required": [
          "status"
        ],
        "title": "GraphitiHealthResponse",
        "description": "Graphiti健康检查响应.\n\n[Source: specs/data/graphiti-health-response.schema.json]\n[Source: docs/stories/30.3.memory-api-health-endpoints.story.md - AC-30.3.7]"
      },
      "GroupExecuteConfig": {
        "properties": {
          "group_id": {
            "type": "string",
            "title": "Group Id",
            "description": "Group ID",
            "examples": [
              "group-1"
            ]
          },
          "agent_type": {
            "type": "string",
            "title": "Agent Type",
            "description": "Agent type to use",
            "examples": [
              "comparison-table"
            ]
          },
          "node_ids": {
            "items": {
              "type": "string"
            },
            "type": "array",
            "title": "Node Ids",
            "description": "Node IDs to process",
            "examples": [
              [
                "node-001",
                "node-002"
              ]
            ]
          }
        },
        "type": "object",
        "required": [
          "group_id",
          "agent_type",
          "node_ids"
        ],
        "title": "GroupExecuteConfig",
        "description": "Group configuration for batch execution (used in confirm request).\n\n[Source: specs/api/parallel-api.openapi.yml#/components/schemas/ParallelExecuteRequest/groups]"
      },
      "GroupPriority": {
        "type": "string",
        "enum": [
          "urgent",
          "high",
          "medium",
          "low"
        ],
        "title": "GroupPriority",
        "description": "Group priority enum.\n\n[Source: specs/api/parallel-api.openapi.yml#/components/schemas/NodeGroup/priority]"
      },
      "GroupProgress": {
        "properties": {
          "group_id": {
            "type": "string",
            "title": "Group Id",
            "description": "Group ID",
            "examples": [
              "group-1"
            ]
          },
          "status": {
            "$ref": "#/components/schemas/GroupStatus",
            "description": "Group status"
          },
          "agent_type": {
            "type": "string",
            "title": "Agent Type",
            "description": "Agent type used",
            "examples": [
              "comparison-table"
            ]
          },
          "completed_nodes": {
            "type": "integer",
            "title": "Completed Nodes",
            "description": "Completed nodes count",
            "default": 0
          },
          "total_nodes": {
            "type": "integer",
            "title": "Total Nodes",
            "description": "Total nodes in group"
          },
          "results": {
            "items": {
              "$ref": "#/components/schemas/NodeResult"
            },
            "type": "array",
            "title": "Results",
            "description": "Generated files"
          },
          "errors": {
            "items": {
              "$ref": "#/components/schemas/NodeError"
            },
            "type": "array",
            "title": "Errors",
            "description": "Error list"
          }
        },
        "type": "object",
        "required": [
          "group_id",
          "status",
          "agent_type",
          "total_nodes"
        ],
        "title": "GroupProgress",
        "description": "Progress information for a group.\n\n[Source: specs/api/parallel-api.openapi.yml#/components/schemas/ParallelTaskStatus/groups]"
      },
      "GroupStatus": {
        "type": "string",
        "enum": [
          "pending",
          "running",
          "completed",
          "failed"
        ],
        "title": "GroupStatus",
        "description": "Individual group status enum.\n\n[Source: specs/api/parallel-api.openapi.yml#/components/schemas/ParallelTaskStatus/groups/status]"
      },
      "HTTPValidationError": {
        "properties": {
          "detail": {
            "items": {
              "$ref": "#/components/schemas/ValidationError"
            },
            "type": "array",
            "title": "Detail"
          }
        },
        "type": "object",
        "title": "HTTPValidationError"
      },
      "HealthCheckResponse": {
        "properties": {
          "status": {
            "type": "string",
            "enum": [
              "healthy",
              "unhealthy"
            ],
            "title": "Status",
            "description": "Application health status"
          },
          "app_name": {
            "type": "string",
            "title": "App Name",
            "description": "Application name"
          },
          "version": {
            "type": "string",
            "title": "Version",
            "description": "Application version"
          },
          "timestamp": {
            "type": "string",
            "format": "date-time",
            "title": "Timestamp",
            "description": "Health check timestamp (ISO 8601 format)"
          }
        },
        "type": "object",
        "required": [
          "status",
          "app_name",
          "version",
          "timestamp"
        ],
        "title": "HealthCheckResponse",
        "description": "Health check response model.\n\n✅ Verified from specs/data/health-check-response.schema.json\nSchema fields: status, app_name, version, timestamp (all required)\n\nAttributes:\n    status: Application health status (\"healthy\" or \"unhealthy\")\n    app_name: Application name\n    version: Application version\n    timestamp: ISO 8601 timestamp of the health check",
        "examples": [
          {
            "app_name": "Canvas Learning System",
            "status": "healthy",
            "timestamp": "2025-11-24T10:30:00Z",
            "version": "1.0.0"
          }
        ]
      },
      "HistoryContext": {
        "properties": {
          "recent_scores": {
            "items": {
              "type": "integer"
            },
            "type": "array",
            "maxItems": 5,
            "title": "Recent Scores",
            "description": "Recent score history (most recent first, up to 5)"
          },
          "average_score": {
            "anyOf": [
              {
                "type": "number",
                "maximum": 100.0,
                "minimum": 0.0
              },
              {
                "type": "null"
              }
            ],
            "title": "Average Score",
            "description": "Average of recent scores"
          },
          "trend": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/ActionTrend"
              },
              {
                "type": "null"
              }
            ],
            "description": "Score trend direction"
          },
          "consecutive_low_count": {
            "type": "integer",
            "minimum": 0.0,
            "title": "Consecutive Low Count",
            "description": "Number of consecutive scores below 60",
            "default": 0
          }
        },
        "type": "object",
        "title": "HistoryContext",
        "description": "Historical score context for recommendation.\n\n[Source: specs/data/recommend-action-response.schema.json#history_context]\n[Source: docs/stories/31.3.story.md#AC-31.3.4]"
      },
      "HistoryDayRecord": {
        "properties": {
          "date": {
            "type": "string",
            "title": "Date",
            "description": "Date (YYYY-MM-DD)",
            "example": "2025-01-18"
          },
          "reviews": {
            "items": {
              "$ref": "#/components/schemas/HistoryReviewRecord"
            },
            "type": "array",
            "title": "Reviews",
            "description": "Reviews completed on this date"
          }
        },
        "type": "object",
        "required": [
          "date"
        ],
        "title": "HistoryDayRecord",
        "description": "Daily review history record.\n\n[Source: specs/api/review-api.openapi.yml#L682-706]"
      },
      "HistoryPeriod": {
        "properties": {
          "start": {
            "type": "string",
            "title": "Start",
            "description": "Start date (ISO format)",
            "example": "2025-01-11"
          },
          "end": {
            "type": "string",
            "title": "End",
            "description": "End date (ISO format)",
            "example": "2025-01-18"
          }
        },
        "type": "object",
        "required": [
          "start",
          "end"
        ],
        "title": "HistoryPeriod",
        "description": "Time period for history query.\n\n[Source: specs/api/review-api.openapi.yml#L668-677]"
      },
      "HistoryResponse": {
        "properties": {
          "period": {
            "$ref": "#/components/schemas/HistoryPeriod",
            "description": "Query time period"
          },
          "total_reviews": {
            "type": "integer",
            "minimum": 0.0,
            "title": "Total Reviews",
            "description": "Total review count",
            "example": 45
          },
          "records": {
            "items": {
              "$ref": "#/components/schemas/HistoryDayRecord"
            },
            "type": "array",
            "title": "Records",
            "description": "Daily review records (newest first)"
          },
          "statistics": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/HistoryStatistics"
              },
              {
                "type": "null"
              }
            ],
            "description": "Aggregate statistics"
          },
          "pagination": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/PaginationInfo"
              },
              {
                "type": "null"
              }
            ],
            "description": "Pagination info (Story 34.4)"
          }
        },
        "type": "object",
        "required": [
          "period",
          "total_reviews"
        ],
        "title": "HistoryResponse",
        "description": "Review history response with pagination support.\n\nStory 34.4: Default limit=5, show_all=False for pagination.\n\n[Source: specs/api/review-api.openapi.yml#L663-729]\n[Source: docs/stories/34.4.story.md]"
      },
      "HistoryReviewRecord": {
        "properties": {
          "concept_id": {
            "type": "string",
            "title": "Concept Id",
            "description": "Concept identifier"
          },
          "concept_name": {
            "type": "string",
            "title": "Concept Name",
            "description": "Concept name"
          },
          "canvas_path": {
            "type": "string",
            "title": "Canvas Path",
            "description": "Canvas file path"
          },
          "rating": {
            "type": "integer",
            "maximum": 4.0,
            "minimum": 1.0,
            "title": "Rating",
            "description": "FSRS rating (1-4)"
          },
          "review_time": {
            "type": "string",
            "format": "date-time",
            "title": "Review Time",
            "description": "Review timestamp"
          }
        },
        "type": "object",
        "required": [
          "concept_id",
          "concept_name",
          "canvas_path",
          "rating",
          "review_time"
        ],
        "title": "HistoryReviewRecord",
        "description": "Single review record within a day.\n\n[Source: specs/api/review-api.openapi.yml#L693-706]"
      },
      "HistoryStatistics": {
        "properties": {
          "average_rating": {
            "anyOf": [
              {
                "type": "number"
              },
              {
                "type": "null"
              }
            ],
            "title": "Average Rating",
            "description": "Average FSRS rating",
            "example": 3.2
          },
          "retention_rate": {
            "anyOf": [
              {
                "type": "number",
                "maximum": 1.0,
                "minimum": 0.0
              },
              {
                "type": "null"
              }
            ],
            "title": "Retention Rate",
            "description": "Memory retention rate",
            "example": 0.85
          },
          "streak_days": {
            "type": "integer",
            "minimum": 0.0,
            "title": "Streak Days",
            "description": "Consecutive review days",
            "default": 0,
            "example": 7
          },
          "by_canvas": {
            "anyOf": [
              {
                "additionalProperties": true,
                "type": "object"
              },
              {
                "type": "null"
              }
            ],
            "title": "By Canvas",
            "description": "Review count by canvas",
            "example": {
              "离散数学.canvas": 15,
              "线性代数.canvas": 10
            }
          }
        },
        "type": "object",
        "title": "HistoryStatistics",
        "description": "Review history statistics.\n\n[Source: specs/api/review-api.openapi.yml#L707-728]"
      },
      "IntelligentParallelRequest": {
        "properties": {
          "canvas_path": {
            "type": "string",
            "title": "Canvas Path",
            "description": "Canvas file path",
            "examples": [
              "离散数学.canvas"
            ]
          },
          "target_color": {
            "type": "string",
            "pattern": "^[1-6]$",
            "title": "Target Color",
            "description": "Target node color (default purple). 1=gray, 2=green, 3=purple, 4=red, 5=blue, 6=yellow",
            "default": "3"
          },
          "max_groups": {
            "anyOf": [
              {
                "type": "integer",
                "maximum": 20.0,
                "minimum": 1.0
              },
              {
                "type": "null"
              }
            ],
            "title": "Max Groups",
            "description": "Maximum number of groups (optional, auto-determined if not specified)"
          },
          "min_nodes_per_group": {
            "type": "integer",
            "minimum": 1.0,
            "title": "Min Nodes Per Group",
            "description": "Minimum nodes per group",
            "default": 2
          }
        },
        "type": "object",
        "required": [
          "canvas_path"
        ],
        "title": "IntelligentParallelRequest",
        "description": "Request model for intelligent parallel grouping analysis (POST /canvas/intelligent-parallel).\n\n[Source: specs/api/parallel-api.openapi.yml#/components/schemas/ParallelAnalyzeRequest]"
      },
      "IntelligentParallelResponse": {
        "properties": {
          "canvas_path": {
            "type": "string",
            "title": "Canvas Path",
            "description": "Canvas file path",
            "examples": [
              "离散数学.canvas"
            ]
          },
          "total_nodes": {
            "type": "integer",
            "title": "Total Nodes",
            "description": "Total target nodes detected",
            "examples": [
              12
            ]
          },
          "groups": {
            "items": {
              "$ref": "#/components/schemas/NodeGroup"
            },
            "type": "array",
            "title": "Groups",
            "description": "Grouped nodes with recommendations"
          },
          "estimated_duration": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Estimated Duration",
            "description": "Estimated execution time",
            "examples": [
              "2分钟"
            ]
          },
          "resource_warning": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Resource Warning",
            "description": "Resource warning if applicable",
            "examples": [
              "CPU使用率较高，建议减少并发数"
            ]
          },
          "subject": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Subject",
            "description": "Subject extracted from canvas_path using extract_subject_from_canvas_path()",
            "examples": [
              "数学"
            ]
          },
          "subject_group_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Subject Group Id",
            "description": "Subject isolation group_id, format: {subject}:{canvas_name}",
            "examples": [
              "数学:离散数学"
            ]
          },
          "silhouette_score": {
            "anyOf": [
              {
                "type": "number",
                "maximum": 1.0,
                "minimum": 0.0
              },
              {
                "type": "null"
              }
            ],
            "title": "Silhouette Score",
            "description": "Clustering quality (Silhouette Score). Recommend re-clustering if < 0.3",
            "examples": [
              0.72
            ]
          },
          "recommended_k": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Recommended K",
            "description": "Auto-determined optimal number of clusters",
            "examples": [
              4
            ]
          }
        },
        "type": "object",
        "required": [
          "canvas_path",
          "total_nodes",
          "groups"
        ],
        "title": "IntelligentParallelResponse",
        "description": "Response model for intelligent parallel grouping analysis.\n\n[Source: specs/api/parallel-api.openapi.yml#/components/schemas/ParallelAnalyzeResponse]\nStory 33.4: Added subject and subject_group_id for multi-subject isolation (AC-33.4.5)"
      },
      "LanceDBHealthResponse": {
        "properties": {
          "status": {
            "type": "string",
            "title": "Status",
            "description": "状态: ok=正常, error=不可用"
          },
          "table_count": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Table Count",
            "description": "向量表数量"
          },
          "total_vectors": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Total Vectors",
            "description": "向量总数"
          },
          "embedding_model": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Embedding Model",
            "description": "使用的Embedding模型名称"
          },
          "error": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Error",
            "description": "错误信息(仅error时存在)"
          }
        },
        "type": "object",
        "required": [
          "status"
        ],
        "title": "LanceDBHealthResponse",
        "description": "LanceDB健康检查响应.\n\n[Source: specs/data/lancedb-health-response.schema.json]\n[Source: docs/stories/30.3.memory-api-health-endpoints.story.md - AC-30.3.8]"
      },
      "LatencyInfo": {
        "properties": {
          "graphiti": {
            "anyOf": [
              {
                "type": "number"
              },
              {
                "type": "null"
              }
            ],
            "title": "Graphiti",
            "description": "Graphiti 检索延迟 (ms)"
          },
          "lancedb": {
            "anyOf": [
              {
                "type": "number"
              },
              {
                "type": "null"
              }
            ],
            "title": "Lancedb",
            "description": "LanceDB 检索延迟 (ms)"
          },
          "multimodal": {
            "anyOf": [
              {
                "type": "number"
              },
              {
                "type": "null"
              }
            ],
            "title": "Multimodal",
            "description": "多模态检索延迟 (ms)"
          },
          "fusion": {
            "anyOf": [
              {
                "type": "number"
              },
              {
                "type": "null"
              }
            ],
            "title": "Fusion",
            "description": "融合延迟 (ms)"
          },
          "reranking": {
            "anyOf": [
              {
                "type": "number"
              },
              {
                "type": "null"
              }
            ],
            "title": "Reranking",
            "description": "Reranking 延迟 (ms)"
          }
        },
        "type": "object",
        "title": "LatencyInfo",
        "description": "延迟信息"
      },
      "LatencyMetrics": {
        "properties": {
          "p95_ms": {
            "type": "number",
            "title": "P95 Ms",
            "description": "P95 latency in milliseconds"
          },
          "p50_ms": {
            "anyOf": [
              {
                "type": "number"
              },
              {
                "type": "null"
              }
            ],
            "title": "P50 Ms",
            "description": "P50 (median) latency in ms"
          },
          "sample_count": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Sample Count",
            "description": "Number of samples in window"
          },
          "window_seconds": {
            "type": "integer",
            "title": "Window Seconds",
            "description": "Statistics window in seconds"
          }
        },
        "type": "object",
        "required": [
          "p95_ms",
          "window_seconds"
        ],
        "title": "LatencyMetrics",
        "description": "Latency metrics for storage health checks."
      },
      "LayerHealthStatus": {
        "properties": {
          "status": {
            "$ref": "#/components/schemas/LayerStatus",
            "description": "层状态: ok/error"
          },
          "backend": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Backend",
            "description": "后端类型"
          },
          "node_count": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Node Count",
            "description": "节点数量(graphiti层)"
          },
          "vector_count": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Vector Count",
            "description": "向量数量(semantic层)"
          },
          "error": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Error",
            "description": "错误信息(仅error时)"
          }
        },
        "type": "object",
        "required": [
          "status"
        ],
        "title": "LayerHealthStatus",
        "description": "Health status for a single memory layer."
      },
      "LayerStatus": {
        "type": "string",
        "enum": [
          "ok",
          "error"
        ],
        "title": "LayerStatus",
        "description": "Layer status values."
      },
      "LearningEpisodeCreate": {
        "properties": {
          "user_id": {
            "type": "string",
            "title": "User Id",
            "description": "用户ID"
          },
          "canvas_path": {
            "type": "string",
            "title": "Canvas Path",
            "description": "Canvas文件路径"
          },
          "node_id": {
            "type": "string",
            "title": "Node Id",
            "description": "Canvas节点ID"
          },
          "concept": {
            "type": "string",
            "title": "Concept",
            "description": "学习概念"
          },
          "agent_type": {
            "type": "string",
            "title": "Agent Type",
            "description": "使用的Agent类型"
          },
          "score": {
            "anyOf": [
              {
                "type": "integer",
                "maximum": 100.0,
                "minimum": 0.0
              },
              {
                "type": "null"
              }
            ],
            "title": "Score",
            "description": "得分 (0-100)"
          },
          "duration_seconds": {
            "anyOf": [
              {
                "type": "integer",
                "minimum": 0.0
              },
              {
                "type": "null"
              }
            ],
            "title": "Duration Seconds",
            "description": "学习时长 (秒)"
          }
        },
        "type": "object",
        "required": [
          "user_id",
          "canvas_path",
          "node_id",
          "concept",
          "agent_type"
        ],
        "title": "LearningEpisodeCreate",
        "description": "Request model for creating a learning episode.\n\n✅ Verified from docs/stories/22.4.story.md#LearningEpisodeCreate:\n- user_id: 用户ID (required)\n- canvas_path: Canvas文件路径 (required)\n- node_id: Canvas节点ID (required)\n- concept: 学习概念 (required)\n- agent_type: 使用的Agent类型 (required)\n- score: 得分 (optional, 0-100)\n- duration_seconds: 学习时长 (optional)\n\n[Source: docs/stories/22.4.story.md#Pydantic模型]",
        "example": {
          "agent_type": "basic-decomposition",
          "canvas_path": "离散数学.canvas",
          "concept": "逆否命题",
          "duration_seconds": 300,
          "node_id": "node-abc123",
          "score": 85,
          "user_id": "user-123"
        }
      },
      "LearningEpisodeResponse": {
        "properties": {
          "episode_id": {
            "type": "string",
            "title": "Episode Id",
            "description": "Episode唯一标识"
          },
          "status": {
            "type": "string",
            "title": "Status",
            "description": "状态"
          }
        },
        "type": "object",
        "required": [
          "episode_id",
          "status"
        ],
        "title": "LearningEpisodeResponse",
        "description": "Response model for created learning episode.\n\n✅ Verified from docs/stories/22.4.story.md#LearningEpisodeResponse:\n- episode_id: 生成的Episode ID\n- status: 状态 (\"created\")\n\n[Source: docs/stories/22.4.story.md#Pydantic模型]",
        "example": {
          "episode_id": "episode-a1b2c3d4e5f67890",
          "status": "created"
        }
      },
      "LearningHistoryItem": {
        "properties": {
          "episode_id": {
            "type": "string",
            "title": "Episode Id",
            "description": "Episode ID"
          },
          "user_id": {
            "type": "string",
            "title": "User Id",
            "description": "用户ID"
          },
          "canvas_path": {
            "type": "string",
            "title": "Canvas Path",
            "description": "Canvas文件路径"
          },
          "node_id": {
            "type": "string",
            "title": "Node Id",
            "description": "Canvas节点ID"
          },
          "concept": {
            "type": "string",
            "title": "Concept",
            "description": "学习概念"
          },
          "agent_type": {
            "type": "string",
            "title": "Agent Type",
            "description": "使用的Agent类型"
          },
          "score": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Score",
            "description": "得分"
          },
          "duration_seconds": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Duration Seconds",
            "description": "学习时长"
          },
          "timestamp": {
            "type": "string",
            "title": "Timestamp",
            "description": "时间戳 (ISO format)"
          }
        },
        "type": "object",
        "required": [
          "episode_id",
          "user_id",
          "canvas_path",
          "node_id",
          "concept",
          "agent_type",
          "timestamp"
        ],
        "title": "LearningHistoryItem",
        "description": "Single item in learning history.\n\n[Source: docs/stories/22.4.story.md#API规范 - GET /episodes response]"
      },
      "LearningHistoryResponse": {
        "properties": {
          "items": {
            "items": {
              "$ref": "#/components/schemas/LearningHistoryItem"
            },
            "type": "array",
            "title": "Items",
            "description": "学习历史列表"
          },
          "total": {
            "type": "integer",
            "title": "Total",
            "description": "总记录数"
          },
          "page": {
            "type": "integer",
            "title": "Page",
            "description": "当前页码"
          },
          "page_size": {
            "type": "integer",
            "title": "Page Size",
            "description": "每页大小"
          },
          "pages": {
            "type": "integer",
            "title": "Pages",
            "description": "总页数"
          }
        },
        "type": "object",
        "required": [
          "items",
          "total",
          "page",
          "page_size",
          "pages"
        ],
        "title": "LearningHistoryResponse",
        "description": "Paginated response for learning history.\n\n✅ Verified from docs/stories/22.4.story.md#API规范:\n- items: 学习历史列表\n- total: 总数\n- page: 当前页\n- page_size: 每页大小\n- pages: 总页数\n\n[Source: docs/stories/22.4.story.md#API规范]",
        "example": {
          "items": [
            {
              "agent_type": "basic-decomposition",
              "canvas_path": "离散数学.canvas",
              "concept": "逆否命题",
              "duration_seconds": 300,
              "episode_id": "episode-a1b2c3d4e5f67890",
              "node_id": "node-abc123",
              "score": 85,
              "timestamp": "2025-12-12T10:30:00",
              "user_id": "user-123"
            }
          ],
          "page": 1,
          "page_size": 50,
          "pages": 2,
          "total": 100
        }
      },
      "ListMountedResponse": {
        "properties": {
          "canvas_path": {
            "type": "string",
            "title": "Canvas Path"
          },
          "associations": {
            "items": {
              "additionalProperties": true,
              "type": "object"
            },
            "type": "array",
            "title": "Associations"
          },
          "config_path": {
            "type": "string",
            "title": "Config Path"
          }
        },
        "type": "object",
        "required": [
          "canvas_path",
          "associations",
          "config_path"
        ],
        "title": "ListMountedResponse",
        "description": "Response listing mounted textbooks for a canvas."
      },
      "MasteryLevel": {
        "type": "string",
        "enum": [
          "not_understood",
          "learning",
          "mastered",
          "pending_verification"
        ],
        "title": "MasteryLevel",
        "description": "Mastery level values for color changes."
      },
      "MediaItemResponse": {
        "properties": {
          "id": {
            "type": "string",
            "title": "Id",
            "description": "Unique content identifier (UUID)"
          },
          "type": {
            "type": "string",
            "pattern": "^(image|pdf|audio|video)$",
            "title": "Type",
            "description": "Media type: 'image' | 'pdf' | 'audio' | 'video'"
          },
          "path": {
            "type": "string",
            "title": "Path",
            "description": "File path"
          },
          "title": {
            "anyOf": [
              {
                "type": "string",
                "maxLength": 50
              },
              {
                "type": "null"
              }
            ],
            "title": "Title",
            "description": "Title (truncated to 50 chars)"
          },
          "relevanceScore": {
            "type": "number",
            "maximum": 1.0,
            "minimum": 0.0,
            "title": "Relevancescore",
            "description": "Relevance score (0-1)"
          },
          "conceptId": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Conceptid",
            "description": "Related concept node ID"
          },
          "metadata": {
            "anyOf": [
              {
                "additionalProperties": true,
                "type": "object"
              },
              {
                "type": "null"
              }
            ],
            "title": "Metadata",
            "description": "Additional metadata (dimensions, duration, etc.)"
          },
          "thumbnail": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Thumbnail",
            "description": "Base64 encoded thumbnail image"
          }
        },
        "type": "object",
        "required": [
          "id",
          "type",
          "path",
          "relevanceScore"
        ],
        "title": "MediaItemResponse",
        "description": "Response model matching frontend MediaItem interface.\n\nThis is the core response model for all query endpoints,\nmatching the TypeScript MediaItem interface exactly.\n\n[Source: docs/stories/35.2.story.md#AC-35.2.4]\n[Source: canvas-progress-tracker/obsidian-plugin/src/components/MediaPanel.ts:30-45]"
      },
      "MemoryHealthResponse": {
        "properties": {
          "status": {
            "$ref": "#/components/schemas/OverallStatus",
            "description": "整体状态"
          },
          "layers": {
            "$ref": "#/components/schemas/MemoryLayersStatus",
            "description": "3层系统状态"
          },
          "timestamp": {
            "type": "string",
            "title": "Timestamp",
            "description": "检查时间戳"
          }
        },
        "type": "object",
        "required": [
          "status",
          "layers",
          "timestamp"
        ],
        "title": "MemoryHealthResponse",
        "description": "Response model for memory health check.\n\n✅ Verified from Story 30.3 AC-30.3.5:\n- 返回 Temporal (FSRS/SQLite) 层状态\n- 返回 Graphiti (Neo4j) 层状态\n- 返回 Semantic (LanceDB) 层状态\n- 整体状态: healthy/degraded/unhealthy\n\n[Source: docs/stories/30.3.memory-api-health-endpoints.story.md#AC-30.3.5]",
        "example": {
          "layers": {
            "graphiti": {
              "backend": "neo4j",
              "node_count": 1234,
              "status": "ok"
            },
            "semantic": {
              "backend": "lancedb",
              "status": "ok",
              "vector_count": 5678
            },
            "temporal": {
              "backend": "sqlite",
              "status": "ok"
            }
          },
          "status": "healthy",
          "timestamp": "2026-01-16T10:00:00Z"
        }
      },
      "MemoryLayerSummary": {
        "properties": {
          "queries_total": {
            "type": "integer",
            "title": "Queries Total"
          },
          "avg_latency_ms": {
            "type": "number",
            "title": "Avg Latency Ms"
          }
        },
        "type": "object",
        "required": [
          "queries_total",
          "avg_latency_ms"
        ],
        "title": "MemoryLayerSummary",
        "description": "Memory layer summary."
      },
      "MemoryLayersStatus": {
        "properties": {
          "temporal": {
            "$ref": "#/components/schemas/LayerHealthStatus",
            "description": "Temporal层状态"
          },
          "graphiti": {
            "$ref": "#/components/schemas/LayerHealthStatus",
            "description": "Graphiti层状态"
          },
          "semantic": {
            "$ref": "#/components/schemas/LayerHealthStatus",
            "description": "Semantic层状态"
          }
        },
        "type": "object",
        "required": [
          "temporal",
          "graphiti",
          "semantic"
        ],
        "title": "MemoryLayersStatus",
        "description": "Status of all 3 memory layers."
      },
      "MemoryLogsResponse": {
        "properties": {
          "log_file": {
            "type": "string",
            "title": "Log File",
            "description": "日志文件路径"
          },
          "total_lines": {
            "type": "integer",
            "title": "Total Lines",
            "description": "返回的日志行数"
          },
          "logs": {
            "items": {
              "type": "string"
            },
            "type": "array",
            "title": "Logs",
            "description": "日志内容列表"
          }
        },
        "type": "object",
        "required": [
          "log_file",
          "total_lines",
          "logs"
        ],
        "title": "MemoryLogsResponse",
        "description": "记忆系统日志响应模型"
      },
      "MemoryMetricsSummary": {
        "properties": {
          "queries_total": {
            "type": "integer",
            "title": "Queries Total",
            "description": "Total memory queries"
          },
          "avg_latency_s": {
            "type": "number",
            "title": "Avg Latency S",
            "description": "Average query latency in seconds"
          },
          "by_type": {
            "additionalProperties": {
              "$ref": "#/components/schemas/MemoryTypeStats"
            },
            "type": "object",
            "title": "By Type",
            "description": "Statistics by memory type (graphiti, lancedb, temporal, sqlite)"
          }
        },
        "type": "object",
        "required": [
          "queries_total",
          "avg_latency_s"
        ],
        "title": "MemoryMetricsSummary",
        "description": "Memory system metrics summary.\n\n[Source: specs/api/canvas-api.openapi.yml:987-1060]"
      },
      "MemorySystemSummary": {
        "properties": {
          "graphiti": {
            "$ref": "#/components/schemas/MemoryLayerSummary"
          },
          "temporal": {
            "$ref": "#/components/schemas/MemoryLayerSummary"
          },
          "semantic": {
            "$ref": "#/components/schemas/MemoryLayerSummary"
          }
        },
        "type": "object",
        "required": [
          "graphiti",
          "temporal",
          "semantic"
        ],
        "title": "MemorySystemSummary",
        "description": "Memory system metrics summary.\n\n[Source: specs/api/canvas-api.openapi.yml:1021-1040]"
      },
      "MemoryTypeStats": {
        "properties": {
          "query_count": {
            "type": "integer",
            "title": "Query Count",
            "description": "Total queries",
            "default": 0
          },
          "success_count": {
            "type": "integer",
            "title": "Success Count",
            "description": "Successful queries",
            "default": 0
          },
          "error_count": {
            "type": "integer",
            "title": "Error Count",
            "description": "Failed queries",
            "default": 0
          },
          "avg_latency_s": {
            "type": "number",
            "title": "Avg Latency S",
            "description": "Average latency in seconds",
            "default": 0.0
          },
          "by_operation": {
            "additionalProperties": {
              "type": "integer"
            },
            "type": "object",
            "title": "By Operation",
            "description": "Query counts by operation type"
          }
        },
        "type": "object",
        "title": "MemoryTypeStats",
        "description": "Statistics for a single memory system type."
      },
      "MetadataSource": {
        "type": "string",
        "enum": [
          "config",
          "inferred",
          "default",
          "manual"
        ],
        "title": "MetadataSource",
        "description": "Source of metadata resolution."
      },
      "MetricsSummary": {
        "properties": {
          "agents": {
            "$ref": "#/components/schemas/app__models__common__AgentMetricsSummary",
            "description": "Agent execution metrics"
          },
          "memory_system": {
            "$ref": "#/components/schemas/MemoryMetricsSummary",
            "description": "Memory system metrics"
          },
          "resources": {
            "$ref": "#/components/schemas/ResourceMetricsSummary",
            "description": "System resource metrics"
          },
          "timestamp": {
            "type": "string",
            "format": "date-time",
            "title": "Timestamp",
            "description": "Metrics collection timestamp"
          }
        },
        "type": "object",
        "required": [
          "agents",
          "memory_system",
          "resources",
          "timestamp"
        ],
        "title": "MetricsSummary",
        "description": "Complete metrics summary response for /metrics/summary endpoint.\n\n[Source: specs/api/canvas-api.openapi.yml:987-1060]\n[Source: Story 17.2 AC-6]",
        "examples": [
          {
            "agents": {
              "avg_execution_time_s": 2.5,
              "by_type": {
                "scoring-agent": {
                  "avg_time_s": 3.2,
                  "count": 50,
                  "error_count": 2,
                  "success_count": 48
                }
              },
              "invocations_total": 150
            },
            "memory_system": {
              "avg_latency_s": 0.15,
              "by_type": {
                "graphiti": {
                  "avg_latency_s": 0.2,
                  "by_operation": {
                    "search": 80,
                    "write": 20
                  },
                  "error_count": 1,
                  "query_count": 100,
                  "success_count": 99
                }
              },
              "queries_total": 300
            },
            "resources": {
              "cpu_usage_percent": 45.2,
              "disk_free_bytes": 107374182400,
              "disk_usage_percent": 55.0,
              "memory_available_bytes": 8589934592,
              "memory_total_bytes": 17179869184,
              "memory_usage_percent": 62.5
            },
            "timestamp": "2025-12-03T10:30:00Z"
          }
        ]
      },
      "MetricsSummaryResponse": {
        "properties": {
          "timestamp": {
            "type": "string",
            "format": "date-time",
            "title": "Timestamp",
            "description": "Summary timestamp"
          },
          "api": {
            "$ref": "#/components/schemas/APIMetricsSummary"
          },
          "agents": {
            "$ref": "#/components/schemas/app__api__v1__endpoints__monitoring__AgentMetricsSummary"
          },
          "memory_system": {
            "$ref": "#/components/schemas/MemorySystemSummary"
          },
          "resources": {
            "$ref": "#/components/schemas/ResourcesSummary"
          },
          "alerts": {
            "$ref": "#/components/schemas/AlertsSummary"
          }
        },
        "type": "object",
        "required": [
          "timestamp",
          "api",
          "agents",
          "memory_system",
          "resources",
          "alerts"
        ],
        "title": "MetricsSummaryResponse",
        "description": "Complete metrics summary for dashboard.\n\n[Source: specs/api/canvas-api.openapi.yml:987-1060]\n[Source: docs/stories/17.3.story.md - AC 6]",
        "example": {
          "agents": {
            "avg_execution_time_s": 2.5,
            "by_type": [
              {
                "agent_type": "scoring-agent",
                "avg_execution_time_s": 1.8,
                "invocations": 200
              }
            ],
            "invocations_total": 500
          },
          "alerts": {
            "active_count": 2,
            "critical_count": 0,
            "info_count": 0,
            "warning_count": 2
          },
          "api": {
            "avg_latency_ms": 150.0,
            "error_rate": 0.01,
            "p95_latency_ms": 350.0,
            "requests_per_second": 25.5,
            "requests_total": 10000
          },
          "memory_system": {
            "graphiti": {
              "avg_latency_ms": 50.0,
              "queries_total": 1000
            },
            "semantic": {
              "avg_latency_ms": 100.0,
              "queries_total": 500
            },
            "temporal": {
              "avg_latency_ms": 30.0,
              "queries_total": 800
            }
          },
          "resources": {
            "cpu_usage_percent": 45.0,
            "disk_usage_percent": 35.0,
            "memory_usage_percent": 60.0
          },
          "timestamp": "2025-12-03T20:15:00"
        }
      },
      "MountedTextbook": {
        "properties": {
          "id": {
            "type": "string",
            "title": "Id",
            "description": "Unique textbook ID"
          },
          "path": {
            "type": "string",
            "title": "Path",
            "description": "File path in vault"
          },
          "name": {
            "type": "string",
            "title": "Name",
            "description": "Display name"
          },
          "type": {
            "type": "string",
            "title": "Type",
            "description": "Textbook type: markdown, pdf, canvas"
          },
          "sections": {
            "items": {
              "$ref": "#/components/schemas/TextbookSection"
            },
            "type": "array",
            "title": "Sections"
          }
        },
        "type": "object",
        "required": [
          "id",
          "path",
          "name",
          "type"
        ],
        "title": "MountedTextbook",
        "description": "Mounted textbook information from frontend."
      },
      "MultiReviewProgressResponse": {
        "properties": {
          "original_canvas_path": {
            "type": "string",
            "title": "Original Canvas Path",
            "description": "Path to original canvas file",
            "example": "离散数学.canvas"
          },
          "review_count": {
            "type": "integer",
            "minimum": 0.0,
            "title": "Review Count",
            "description": "Total number of review sessions",
            "example": 3
          },
          "reviews": {
            "items": {
              "$ref": "#/components/schemas/ReviewEntry"
            },
            "type": "array",
            "title": "Reviews",
            "description": "List of all review sessions (newest first)"
          },
          "trends": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/TrendAnalysis"
              },
              {
                "type": "null"
              }
            ],
            "description": "Trend analysis data (null if <2 reviews)"
          }
        },
        "type": "object",
        "required": [
          "original_canvas_path",
          "review_count",
          "reviews"
        ],
        "title": "MultiReviewProgressResponse",
        "description": "Multi-review progress response with trend analysis.\n\n[Source: specs/api/review-api.openapi.yml#L725-805]"
      },
      "MultimodalByConceptResponse": {
        "properties": {
          "items": {
            "items": {
              "$ref": "#/components/schemas/MediaItemResponse"
            },
            "type": "array",
            "title": "Items",
            "description": "List of media items associated with the concept"
          },
          "total": {
            "type": "integer",
            "minimum": 0.0,
            "title": "Total",
            "description": "Total number of items"
          }
        },
        "type": "object",
        "required": [
          "total"
        ],
        "title": "MultimodalByConceptResponse",
        "description": "Response model for GET /api/v1/multimodal/by-concept/{concept_id}.\n\n[Source: docs/stories/35.2.story.md#AC-35.2.1]"
      },
      "MultimodalDeleteResponse": {
        "properties": {
          "deleted_id": {
            "type": "string",
            "title": "Deleted Id",
            "description": "ID of deleted content"
          },
          "message": {
            "type": "string",
            "title": "Message",
            "description": "Status message",
            "default": "Content deleted successfully"
          },
          "file_deleted": {
            "type": "boolean",
            "title": "File Deleted",
            "description": "Whether physical file was deleted",
            "default": true
          },
          "thumbnail_deleted": {
            "type": "boolean",
            "title": "Thumbnail Deleted",
            "description": "Whether thumbnail was also deleted",
            "default": false
          }
        },
        "type": "object",
        "required": [
          "deleted_id"
        ],
        "title": "MultimodalDeleteResponse",
        "description": "Response model for successful deletion.\n\n[Source: docs/stories/35.1.story.md#AC-35.1.3]"
      },
      "MultimodalHealthResponse": {
        "properties": {
          "status": {
            "type": "string",
            "title": "Status",
            "description": "Service status: healthy/degraded/unhealthy"
          },
          "lancedb_connected": {
            "type": "boolean",
            "title": "Lancedb Connected",
            "description": "LanceDB connection status"
          },
          "neo4j_connected": {
            "type": "boolean",
            "title": "Neo4J Connected",
            "description": "Neo4j connection status"
          },
          "storage_path_writable": {
            "type": "boolean",
            "title": "Storage Path Writable",
            "description": "Storage path write access"
          },
          "total_items": {
            "type": "integer",
            "minimum": 0.0,
            "title": "Total Items",
            "description": "Total stored items count",
            "default": 0
          }
        },
        "type": "object",
        "required": [
          "status",
          "lancedb_connected",
          "neo4j_connected",
          "storage_path_writable"
        ],
        "title": "MultimodalHealthResponse",
        "description": "Response model for multimodal service health check.\n\n[Source: Story 35.1 - Service health endpoint]"
      },
      "MultimodalListResponse": {
        "properties": {
          "items": {
            "items": {
              "$ref": "#/components/schemas/MultimodalResponse"
            },
            "type": "array",
            "title": "Items",
            "description": "List of multimodal content items"
          },
          "total": {
            "type": "integer",
            "minimum": 0.0,
            "title": "Total",
            "description": "Total item count"
          },
          "concept_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Concept Id",
            "description": "Filter concept ID if applied"
          },
          "media_type": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/MultimodalMediaType"
              },
              {
                "type": "null"
              }
            ],
            "description": "Filter media type if applied"
          }
        },
        "type": "object",
        "required": [
          "total"
        ],
        "title": "MultimodalListResponse",
        "description": "Response model for listing multimodal content.\n\n[Source: Story 35.1 - Additional utility endpoint]"
      },
      "MultimodalMediaType": {
        "type": "string",
        "enum": [
          "image",
          "pdf",
          "audio",
          "video"
        ],
        "title": "MultimodalMediaType",
        "description": "Supported media types for multimodal content.\n\n[Source: specs/data/multimodal-content.schema.json#media_type]\n[Source: src/agentic_rag/models/multimodal_content.py#MediaType]"
      },
      "MultimodalMetadataSchema": {
        "properties": {
          "file_size": {
            "anyOf": [
              {
                "type": "integer",
                "minimum": 0.0
              },
              {
                "type": "null"
              }
            ],
            "title": "File Size",
            "description": "File size in bytes"
          },
          "width": {
            "anyOf": [
              {
                "type": "integer",
                "minimum": 0.0
              },
              {
                "type": "null"
              }
            ],
            "title": "Width",
            "description": "Width in pixels (image/video)"
          },
          "height": {
            "anyOf": [
              {
                "type": "integer",
                "minimum": 0.0
              },
              {
                "type": "null"
              }
            ],
            "title": "Height",
            "description": "Height in pixels (image/video)"
          },
          "duration": {
            "anyOf": [
              {
                "type": "number",
                "minimum": 0.0
              },
              {
                "type": "null"
              }
            ],
            "title": "Duration",
            "description": "Duration in seconds (audio/video)"
          },
          "page_count": {
            "anyOf": [
              {
                "type": "integer",
                "minimum": 0.0
              },
              {
                "type": "null"
              }
            ],
            "title": "Page Count",
            "description": "Page count (PDF)"
          },
          "mime_type": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Mime Type",
            "description": "MIME type"
          },
          "author": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Author",
            "description": "Content author"
          },
          "title": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Title",
            "description": "Content title"
          },
          "language": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Language",
            "description": "Content language"
          }
        },
        "type": "object",
        "title": "MultimodalMetadataSchema",
        "description": "Metadata for multimodal content.\n\n[Source: src/agentic_rag/models/multimodal_content.py#MultimodalMetadata]"
      },
      "MultimodalPaginatedListResponse": {
        "properties": {
          "items": {
            "items": {
              "$ref": "#/components/schemas/MediaItemResponse"
            },
            "type": "array",
            "title": "Items",
            "description": "List of media items for current page"
          },
          "pagination": {
            "$ref": "#/components/schemas/PaginationMeta",
            "description": "Pagination metadata"
          }
        },
        "type": "object",
        "required": [
          "pagination"
        ],
        "title": "MultimodalPaginatedListResponse",
        "description": "Response model for GET /api/v1/multimodal/list with pagination.\n\n[Source: docs/stories/35.2.story.md#AC-35.2.3]"
      },
      "MultimodalResponse": {
        "properties": {
          "id": {
            "type": "string",
            "title": "Id",
            "description": "Unique content identifier (UUID)"
          },
          "media_type": {
            "$ref": "#/components/schemas/MultimodalMediaType",
            "description": "Type of media content"
          },
          "file_path": {
            "type": "string",
            "title": "File Path",
            "description": "Path to the media file"
          },
          "related_concept_id": {
            "type": "string",
            "title": "Related Concept Id",
            "description": "Associated Canvas concept node ID"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "title": "Created At",
            "description": "Creation timestamp"
          },
          "thumbnail_path": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Thumbnail Path",
            "description": "Path to thumbnail image"
          },
          "extracted_text": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Extracted Text",
            "description": "OCR-extracted text (images/PDFs)"
          },
          "description": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Description",
            "description": "AI-generated or user description"
          },
          "source_location": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Source Location",
            "description": "Page number or timestamp"
          },
          "updated_at": {
            "anyOf": [
              {
                "type": "string",
                "format": "date-time"
              },
              {
                "type": "null"
              }
            ],
            "title": "Updated At",
            "description": "Last update timestamp"
          },
          "metadata": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/MultimodalMetadataSchema"
              },
              {
                "type": "null"
              }
            ],
            "description": "Additional metadata (dimensions, duration, etc.)"
          }
        },
        "type": "object",
        "required": [
          "id",
          "media_type",
          "file_path",
          "related_concept_id",
          "created_at"
        ],
        "title": "MultimodalResponse",
        "description": "Response model for multimodal content.\n\nMatches frontend MediaItem interface for seamless integration.\n\n[Source: docs/stories/35.1.story.md#AC-35.1.1]\n[Source: specs/data/multimodal-content.schema.json]\n[Source: canvas-progress-tracker/obsidian-plugin/src/types/media.ts#MediaItem]"
      },
      "MultimodalResultItem": {
        "properties": {
          "id": {
            "type": "string",
            "title": "Id",
            "description": "内容ID"
          },
          "media_type": {
            "type": "string",
            "enum": [
              "image",
              "pdf",
              "audio",
              "video"
            ],
            "title": "Media Type",
            "description": "媒体类型"
          },
          "path": {
            "type": "string",
            "title": "Path",
            "description": "文件路径"
          },
          "thumbnail": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Thumbnail",
            "description": "缩略图Base64或URL"
          },
          "relevance_score": {
            "type": "number",
            "maximum": 1.0,
            "minimum": 0.0,
            "title": "Relevance Score",
            "description": "相关度分数 (0-1)"
          },
          "metadata": {
            "additionalProperties": true,
            "type": "object",
            "title": "Metadata",
            "description": "额外元数据"
          }
        },
        "type": "object",
        "required": [
          "id",
          "media_type",
          "path",
          "relevance_score"
        ],
        "title": "MultimodalResultItem",
        "description": "多模态检索结果项 (Story 35.8 AC-35.8.1)\n\n✅ Verified from OpenAPI: specs/api/fastapi-backend-api.openapi.yml#MultimodalResultItem"
      },
      "MultimodalSearchRequest": {
        "properties": {
          "query": {
            "type": "string",
            "maxLength": 1000,
            "minLength": 1,
            "title": "Query",
            "description": "Search query text for semantic search"
          },
          "media_types": {
            "anyOf": [
              {
                "items": {
                  "$ref": "#/components/schemas/MultimodalMediaType"
                },
                "type": "array"
              },
              {
                "type": "null"
              }
            ],
            "title": "Media Types",
            "description": "Optional filter by media types"
          },
          "top_k": {
            "type": "integer",
            "maximum": 100.0,
            "minimum": 1.0,
            "title": "Top K",
            "description": "Maximum number of results",
            "default": 10
          },
          "min_score": {
            "type": "number",
            "maximum": 1.0,
            "minimum": 0.0,
            "title": "Min Score",
            "description": "Minimum similarity score threshold",
            "default": 0.5
          }
        },
        "type": "object",
        "required": [
          "query"
        ],
        "title": "MultimodalSearchRequest",
        "description": "Request model for POST /api/v1/multimodal/search.\n\n[Source: docs/stories/35.2.story.md#AC-35.2.2]"
      },
      "MultimodalSearchResponse": {
        "properties": {
          "items": {
            "items": {
              "$ref": "#/components/schemas/MediaItemResponse"
            },
            "type": "array",
            "title": "Items",
            "description": "List of search results sorted by relevance"
          },
          "total": {
            "type": "integer",
            "minimum": 0.0,
            "title": "Total",
            "description": "Number of results returned"
          },
          "query_processed": {
            "type": "boolean",
            "title": "Query Processed",
            "description": "Whether the query was successfully processed",
            "default": true
          }
        },
        "type": "object",
        "required": [
          "total"
        ],
        "title": "MultimodalSearchResponse",
        "description": "Response model for POST /api/v1/multimodal/search.\n\n[Source: docs/stories/35.2.story.md#AC-35.2.2]"
      },
      "MultimodalUpdateRequest": {
        "properties": {
          "description": {
            "anyOf": [
              {
                "type": "string",
                "maxLength": 1000
              },
              {
                "type": "null"
              }
            ],
            "title": "Description",
            "description": "Updated description"
          },
          "related_concept_id": {
            "anyOf": [
              {
                "type": "string",
                "minLength": 1
              },
              {
                "type": "null"
              }
            ],
            "title": "Related Concept Id",
            "description": "New related concept ID"
          },
          "source_location": {
            "anyOf": [
              {
                "type": "string",
                "maxLength": 255
              },
              {
                "type": "null"
              }
            ],
            "title": "Source Location",
            "description": "Page number (PDF) or timestamp (audio/video)"
          }
        },
        "type": "object",
        "title": "MultimodalUpdateRequest",
        "description": "Request model for updating multimodal content metadata.\n\n[Source: docs/stories/35.1.story.md#AC-35.1.4]\n[Source: specs/api/multimodal-api.openapi.yml#MultimodalUpdateRequest]"
      },
      "MultimodalUploadResponse": {
        "properties": {
          "content": {
            "$ref": "#/components/schemas/MultimodalResponse",
            "description": "Uploaded content details"
          },
          "message": {
            "type": "string",
            "title": "Message",
            "description": "Status message",
            "default": "Content uploaded successfully"
          },
          "thumbnail_generated": {
            "type": "boolean",
            "title": "Thumbnail Generated",
            "description": "Whether thumbnail was generated",
            "default": false
          }
        },
        "type": "object",
        "required": [
          "content"
        ],
        "title": "MultimodalUploadResponse",
        "description": "Response model for successful upload.\n\n[Source: docs/stories/35.1.story.md#AC-35.1.1]"
      },
      "MultimodalUploadUrlRequest": {
        "properties": {
          "url": {
            "type": "string",
            "minLength": 1,
            "title": "Url",
            "description": "URL to fetch content from (must be accessible)"
          },
          "related_concept_id": {
            "type": "string",
            "minLength": 1,
            "title": "Related Concept Id",
            "description": "Canvas node ID to associate this content with"
          },
          "canvas_path": {
            "type": "string",
            "minLength": 1,
            "title": "Canvas Path",
            "description": "Canvas file path for context"
          },
          "description": {
            "anyOf": [
              {
                "type": "string",
                "maxLength": 1000
              },
              {
                "type": "null"
              }
            ],
            "title": "Description",
            "description": "Optional description for the content"
          }
        },
        "type": "object",
        "required": [
          "url",
          "related_concept_id",
          "canvas_path"
        ],
        "title": "MultimodalUploadUrlRequest",
        "description": "Request model for uploading content from URL.\n\n[Source: docs/stories/35.1.story.md#AC-35.1.2]\n[Source: specs/api/multimodal-api.openapi.yml#MultimodalUploadUrlRequest]"
      },
      "Neo4jConnectionPool": {
        "properties": {
          "active": {
            "type": "integer",
            "title": "Active",
            "description": "Active connections",
            "default": 0
          },
          "idle": {
            "type": "integer",
            "title": "Idle",
            "description": "Idle connections",
            "default": 0
          },
          "max_size": {
            "type": "integer",
            "title": "Max Size",
            "description": "Maximum pool size",
            "default": 50
          },
          "utilization_percent": {
            "type": "number",
            "title": "Utilization Percent",
            "description": "Pool utilization percentage",
            "default": 0.0
          }
        },
        "type": "object",
        "title": "Neo4jConnectionPool",
        "description": "Neo4j connection pool status."
      },
      "Neo4jHealthChecks": {
        "properties": {
          "neo4j_enabled": {
            "anyOf": [
              {
                "type": "boolean"
              },
              {
                "type": "null"
              }
            ],
            "title": "Neo4J Enabled",
            "description": "Neo4j是否在配置中启用"
          },
          "neo4j_connection": {
            "anyOf": [
              {
                "type": "boolean"
              },
              {
                "type": "null"
              }
            ],
            "title": "Neo4J Connection",
            "description": "Neo4j Bolt连接是否成功"
          },
          "driver_initialized": {
            "anyOf": [
              {
                "type": "boolean"
              },
              {
                "type": "null"
              }
            ],
            "title": "Driver Initialized",
            "description": "Neo4j AsyncGraphDatabase driver是否已初始化"
          },
          "database_accessible": {
            "anyOf": [
              {
                "type": "boolean"
              },
              {
                "type": "null"
              }
            ],
            "title": "Database Accessible",
            "description": "目标数据库是否可访问 (RETURN 1 测试通过)"
          },
          "uri": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Uri",
            "description": "Neo4j连接URI (仅在healthy时返回)"
          },
          "reason": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Reason",
            "description": "降级或不健康状态的原因说明"
          },
          "error": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Error",
            "description": "错误信息 (仅在unhealthy时返回)"
          }
        },
        "type": "object",
        "title": "Neo4jHealthChecks",
        "description": "Neo4j健康检查详情."
      },
      "Neo4jHealthResponse": {
        "properties": {
          "status": {
            "type": "string",
            "title": "Status",
            "description": "整体健康状态: healthy=Neo4j连接正常, degraded=Neo4j已禁用, unhealthy=连接失败"
          },
          "checks": {
            "$ref": "#/components/schemas/Neo4jHealthChecks",
            "description": "各项检查结果"
          },
          "cached": {
            "type": "boolean",
            "title": "Cached",
            "description": "是否为缓存结果 (缓存TTL: 30秒, 参考ADR-007)",
            "default": false
          },
          "timestamp": {
            "type": "string",
            "format": "date-time",
            "title": "Timestamp",
            "description": "检查时间戳 (ISO 8601格式)"
          }
        },
        "type": "object",
        "required": [
          "status",
          "checks",
          "timestamp"
        ],
        "title": "Neo4jHealthResponse",
        "description": "Neo4j健康检查响应.\n\n[Source: specs/data/neo4j-health-response.schema.json]\n[Source: docs/stories/30.1.story.md - AC 4]"
      },
      "NodeColor": {
        "type": "string",
        "enum": [
          "1",
          "2",
          "3",
          "4",
          "5",
          "6"
        ],
        "title": "NodeColor",
        "description": "Node color codes (Obsidian Canvas actual display).\n\nVerified from docs/issues/canvas-layout-lessons-learned.md:\n- \"1\" = gray (灰白色)\n- \"2\" = green (绿色) - 完全理解/已通过\n- \"3\" = purple (紫色) - 似懂非懂/待检验\n- \"4\" = red (红色) - 不理解/未通过\n- \"5\" = blue (蓝色) - AI解释\n- \"6\" = yellow (黄色) - 个人理解输出区\n\nPRD语义映射:\n- 红色(不理解) → \"4\"\n- 绿色(完全理解) → \"2\"\n- 紫色(似懂非懂) → \"3\"\n- 黄色(个人理解) → \"6\""
      },
      "NodeCreate": {
        "properties": {
          "type": {
            "$ref": "#/components/schemas/NodeType",
            "description": "Node type"
          },
          "text": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Text",
            "description": "Text content (required for type=text)"
          },
          "file": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "File",
            "description": "File path (required for type=file)"
          },
          "url": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Url",
            "description": "Link URL (required for type=link)"
          },
          "x": {
            "type": "integer",
            "title": "X",
            "description": "X position"
          },
          "y": {
            "type": "integer",
            "title": "Y",
            "description": "Y position"
          },
          "width": {
            "type": "integer",
            "title": "Width",
            "description": "Node width",
            "default": 250
          },
          "height": {
            "type": "integer",
            "title": "Height",
            "description": "Node height",
            "default": 60
          },
          "color": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/NodeColor"
              },
              {
                "type": "null"
              }
            ],
            "description": "Node color code"
          }
        },
        "type": "object",
        "required": [
          "type",
          "x",
          "y"
        ],
        "title": "NodeCreate",
        "description": "Request model for creating a new node.\n\n[Source: specs/api/fastapi-backend-api.openapi.yml#/components/schemas/NodeCreate]"
      },
      "NodeError": {
        "properties": {
          "node_id": {
            "type": "string",
            "title": "Node Id",
            "description": "Node ID"
          },
          "error_message": {
            "type": "string",
            "title": "Error Message",
            "description": "Error message"
          }
        },
        "type": "object",
        "required": [
          "node_id",
          "error_message"
        ],
        "title": "NodeError",
        "description": "Error information for a failed node.\n\n[Source: specs/api/parallel-api.openapi.yml#/components/schemas/ParallelTaskStatus/groups/errors]"
      },
      "NodeGroup": {
        "properties": {
          "group_id": {
            "type": "string",
            "title": "Group Id",
            "description": "Group ID",
            "examples": [
              "group-1"
            ]
          },
          "group_name": {
            "type": "string",
            "title": "Group Name",
            "description": "Auto-generated group name",
            "examples": [
              "对比类概念"
            ]
          },
          "group_emoji": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Group Emoji",
            "description": "Group icon",
            "examples": [
              "📊"
            ]
          },
          "nodes": {
            "items": {
              "$ref": "#/components/schemas/NodeInGroup"
            },
            "type": "array",
            "title": "Nodes",
            "description": "Nodes in this group"
          },
          "recommended_agent": {
            "type": "string",
            "title": "Recommended Agent",
            "description": "Recommended agent type",
            "examples": [
              "comparison-table"
            ]
          },
          "confidence": {
            "anyOf": [
              {
                "type": "number",
                "maximum": 1.0,
                "minimum": 0.0
              },
              {
                "type": "null"
              }
            ],
            "title": "Confidence",
            "description": "Recommendation confidence score",
            "examples": [
              0.85
            ]
          },
          "priority": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/GroupPriority"
              },
              {
                "type": "null"
              }
            ],
            "description": "Group priority"
          }
        },
        "type": "object",
        "required": [
          "group_id",
          "group_name",
          "nodes",
          "recommended_agent"
        ],
        "title": "NodeGroup",
        "description": "Node group with recommended agent.\n\n[Source: specs/api/parallel-api.openapi.yml#/components/schemas/NodeGroup]\n[Source: specs/data/parallel-task.schema.json#/definitions/NodeGroup]"
      },
      "NodeInGroup": {
        "properties": {
          "node_id": {
            "type": "string",
            "title": "Node Id",
            "description": "Node ID",
            "examples": [
              "node-001"
            ]
          },
          "text": {
            "type": "string",
            "title": "Text",
            "description": "Node text content",
            "examples": [
              "逆否命题 vs 否命题"
            ]
          }
        },
        "type": "object",
        "required": [
          "node_id",
          "text"
        ],
        "title": "NodeInGroup",
        "description": "Node information within a group.\n\n[Source: specs/api/parallel-api.openapi.yml#/components/schemas/NodeGroup/nodes]"
      },
      "NodeRead": {
        "properties": {
          "id": {
            "type": "string",
            "pattern": "^[a-zA-Z0-9][-a-zA-Z0-9]*$",
            "title": "Id",
            "description": "Node ID"
          },
          "type": {
            "$ref": "#/components/schemas/NodeType",
            "description": "Node type"
          },
          "text": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Text",
            "description": "Text content"
          },
          "file": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "File",
            "description": "File path"
          },
          "url": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Url",
            "description": "Link URL"
          },
          "x": {
            "type": "integer",
            "title": "X",
            "description": "X position"
          },
          "y": {
            "type": "integer",
            "title": "Y",
            "description": "Y position"
          },
          "width": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Width",
            "description": "Node width"
          },
          "height": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Height",
            "description": "Node height"
          },
          "color": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/NodeColor"
              },
              {
                "type": "null"
              }
            ],
            "description": "Node color code"
          }
        },
        "type": "object",
        "required": [
          "id",
          "type",
          "x",
          "y"
        ],
        "title": "NodeRead",
        "description": "Response model for a node.\n\n[Source: specs/api/fastapi-backend-api.openapi.yml#/components/schemas/NodeRead]"
      },
      "NodeResult": {
        "properties": {
          "node_id": {
            "type": "string",
            "title": "Node Id",
            "description": "Node ID",
            "examples": [
              "node-001"
            ]
          },
          "file_path": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "File Path",
            "description": "Generated file path",
            "examples": [
              "逆否命题 vs 否命题.md"
            ]
          },
          "file_size": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "File Size",
            "description": "File size",
            "examples": [
              "3.2KB"
            ]
          }
        },
        "type": "object",
        "required": [
          "node_id"
        ],
        "title": "NodeResult",
        "description": "Result for a processed node.\n\n[Source: specs/api/parallel-api.openapi.yml#/components/schemas/ParallelTaskStatus/groups/results]"
      },
      "NodeScore": {
        "properties": {
          "node_id": {
            "type": "string",
            "title": "Node Id",
            "description": "Node ID"
          },
          "accuracy": {
            "type": "number",
            "maximum": 25.0,
            "minimum": 0.0,
            "title": "Accuracy",
            "description": "Accuracy score (0-25)"
          },
          "imagery": {
            "type": "number",
            "maximum": 25.0,
            "minimum": 0.0,
            "title": "Imagery",
            "description": "Imagery score (0-25)"
          },
          "completeness": {
            "type": "number",
            "maximum": 25.0,
            "minimum": 0.0,
            "title": "Completeness",
            "description": "Completeness score (0-25)"
          },
          "originality": {
            "type": "number",
            "maximum": 25.0,
            "minimum": 0.0,
            "title": "Originality",
            "description": "Originality score (0-25)"
          },
          "total": {
            "type": "number",
            "maximum": 100.0,
            "minimum": 0.0,
            "title": "Total",
            "description": "Total score (0-100)"
          },
          "new_color": {
            "type": "string",
            "title": "New Color",
            "description": "New node color: 2=green(>=80), 3=purple(60-79), 4=red(<60)"
          },
          "feedback": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Feedback",
            "description": "Specific improvement suggestions (100-200 chars)"
          },
          "color_action": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Color Action",
            "description": "Color action: change_to_green/change_to_purple/keep_red"
          }
        },
        "type": "object",
        "required": [
          "node_id",
          "accuracy",
          "imagery",
          "completeness",
          "originality",
          "total",
          "new_color"
        ],
        "title": "NodeScore",
        "description": "Score result for a single node.\n\n[Source: specs/api/fastapi-backend-api.openapi.yml#/components/schemas/NodeScore]\n[Source: specs/data/node-score.schema.json]\n[Source: .claude/agents/scoring.md - Output Format]"
      },
      "NodeType": {
        "type": "string",
        "enum": [
          "text",
          "file",
          "group",
          "link"
        ],
        "title": "NodeType",
        "description": "Node type enum."
      },
      "NodeUpdate": {
        "properties": {
          "text": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Text",
            "description": "Text content"
          },
          "x": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "X",
            "description": "X position"
          },
          "y": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Y",
            "description": "Y position"
          },
          "width": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Width",
            "description": "Node width"
          },
          "height": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Height",
            "description": "Node height"
          },
          "color": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/NodeColor"
              },
              {
                "type": "null"
              }
            ],
            "description": "Node color code"
          }
        },
        "type": "object",
        "title": "NodeUpdate",
        "description": "Request model for updating a node.\n\n[Source: specs/api/fastapi-backend-api.openapi.yml#/components/schemas/NodeUpdate]"
      },
      "OperationDataResponse": {
        "properties": {
          "before": {
            "anyOf": [
              {},
              {
                "type": "null"
              }
            ],
            "title": "Before",
            "description": "操作前状态"
          },
          "after": {
            "anyOf": [
              {},
              {
                "type": "null"
              }
            ],
            "title": "After",
            "description": "操作后状态"
          },
          "node_ids": {
            "anyOf": [
              {
                "items": {
                  "type": "string"
                },
                "type": "array"
              },
              {
                "type": "null"
              }
            ],
            "title": "Node Ids",
            "description": "影响的节点ID列表"
          },
          "edge_ids": {
            "anyOf": [
              {
                "items": {
                  "type": "string"
                },
                "type": "array"
              },
              {
                "type": "null"
              }
            ],
            "title": "Edge Ids",
            "description": "影响的边ID列表"
          }
        },
        "type": "object",
        "title": "OperationDataResponse",
        "description": "操作数据响应模型\n\n[Source: docs/architecture/rollback-recovery-architecture.md:38-66]"
      },
      "OperationHistoryResponse": {
        "properties": {
          "canvas_path": {
            "type": "string",
            "title": "Canvas Path",
            "description": "Canvas文件路径"
          },
          "total": {
            "type": "integer",
            "title": "Total",
            "description": "总操作数"
          },
          "limit": {
            "type": "integer",
            "title": "Limit",
            "description": "返回的最大记录数"
          },
          "offset": {
            "type": "integer",
            "title": "Offset",
            "description": "跳过的记录数"
          },
          "operations": {
            "items": {
              "$ref": "#/components/schemas/OperationResponse"
            },
            "type": "array",
            "title": "Operations",
            "description": "操作历史列表 (按时间倒序)"
          }
        },
        "type": "object",
        "required": [
          "canvas_path",
          "total",
          "limit",
          "offset"
        ],
        "title": "OperationHistoryResponse",
        "description": "操作历史列表响应模型\n\n[Source: docs/architecture/rollback-recovery-architecture.md:296-310]",
        "example": {
          "canvas_path": "离散数学.canvas",
          "limit": 10,
          "offset": 0,
          "operations": [
            {
              "canvas_path": "离散数学.canvas",
              "data": {
                "after": {
                  "id": "node1",
                  "text": "逆否命题"
                },
                "node_ids": [
                  "node1"
                ]
              },
              "id": "550e8400-e29b-41d4-a716-446655440000",
              "metadata": {
                "agent_id": "basic-decomposition",
                "description": "Add node: 逆否命题"
              },
              "timestamp": "2025-12-04T01:30:00Z",
              "type": "node_add",
              "user_id": "system"
            }
          ],
          "total": 25
        }
      },
      "OperationMetadataResponse": {
        "properties": {
          "description": {
            "type": "string",
            "title": "Description",
            "description": "操作描述",
            "default": ""
          },
          "agent_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Agent Id",
            "description": "执行Agent ID"
          },
          "request_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Request Id",
            "description": "请求追踪ID"
          }
        },
        "type": "object",
        "title": "OperationMetadataResponse",
        "description": "操作元数据响应模型\n\n[Source: docs/architecture/rollback-recovery-architecture.md:38-66]"
      },
      "OperationResponse": {
        "properties": {
          "id": {
            "type": "string",
            "title": "Id",
            "description": "操作唯一标识符 (UUID)"
          },
          "type": {
            "$ref": "#/components/schemas/OperationTypeEnum",
            "description": "操作类型"
          },
          "canvas_path": {
            "type": "string",
            "title": "Canvas Path",
            "description": "Canvas文件路径"
          },
          "timestamp": {
            "type": "string",
            "format": "date-time",
            "title": "Timestamp",
            "description": "操作时间戳 (UTC)"
          },
          "user_id": {
            "type": "string",
            "title": "User Id",
            "description": "执行操作的用户ID"
          },
          "data": {
            "$ref": "#/components/schemas/OperationDataResponse",
            "description": "操作数据"
          },
          "metadata": {
            "$ref": "#/components/schemas/OperationMetadataResponse",
            "description": "操作元数据"
          }
        },
        "type": "object",
        "required": [
          "id",
          "type",
          "canvas_path",
          "timestamp",
          "user_id"
        ],
        "title": "OperationResponse",
        "description": "操作历史记录响应模型\n\n[Source: docs/architecture/rollback-recovery-architecture.md:296-310]",
        "example": {
          "canvas_path": "离散数学.canvas",
          "data": {
            "after": {
              "color": "1",
              "id": "node1",
              "text": "逆否命题"
            },
            "node_ids": [
              "node1"
            ]
          },
          "id": "550e8400-e29b-41d4-a716-446655440000",
          "metadata": {
            "agent_id": "basic-decomposition",
            "description": "Add node: 逆否命题",
            "request_id": "req-123"
          },
          "timestamp": "2025-12-04T01:30:00Z",
          "type": "node_add",
          "user_id": "system"
        }
      },
      "OperationTypeEnum": {
        "type": "string",
        "enum": [
          "node_add",
          "node_delete",
          "node_modify",
          "node_color_change",
          "edge_add",
          "edge_delete",
          "batch_operation"
        ],
        "title": "OperationTypeEnum",
        "description": "操作类型枚举\n\n[Source: docs/architecture/rollback-recovery-architecture.md:38-66]"
      },
      "OverallProgress": {
        "properties": {
          "progress_rate": {
            "type": "number",
            "title": "Progress Rate",
            "description": "Overall progress rate (-1 to 1 scale)",
            "example": 0.25
          },
          "trend_direction": {
            "$ref": "#/components/schemas/TrendDirection",
            "description": "Trend direction (up/stable/down)"
          }
        },
        "type": "object",
        "required": [
          "progress_rate",
          "trend_direction"
        ],
        "title": "OverallProgress",
        "description": "Overall learning progress metrics.\n\n[Source: specs/api/review-api.openapi.yml#L782-791]"
      },
      "OverallStatus": {
        "type": "string",
        "enum": [
          "healthy",
          "degraded",
          "unhealthy"
        ],
        "title": "OverallStatus",
        "description": "Overall system status values."
      },
      "PaginationInfo": {
        "properties": {
          "limit": {
            "type": "integer",
            "maximum": 100.0,
            "minimum": 1.0,
            "title": "Limit",
            "description": "Number of items per page",
            "example": 20
          },
          "offset": {
            "type": "integer",
            "minimum": 0.0,
            "title": "Offset",
            "description": "Offset from the start",
            "example": 0
          },
          "has_more": {
            "type": "boolean",
            "title": "Has More",
            "description": "Whether there are more items available",
            "example": false
          }
        },
        "type": "object",
        "required": [
          "limit",
          "offset",
          "has_more"
        ],
        "title": "PaginationInfo",
        "description": "Pagination metadata for list responses.\n\n[Source: specs/data/verification-history-response.schema.json#L26-44]"
      },
      "PaginationMeta": {
        "properties": {
          "total": {
            "type": "integer",
            "minimum": 0.0,
            "title": "Total",
            "description": "Total number of items"
          },
          "page": {
            "type": "integer",
            "minimum": 1.0,
            "title": "Page",
            "description": "Current page number (1-indexed)"
          },
          "page_size": {
            "type": "integer",
            "maximum": 100.0,
            "minimum": 1.0,
            "title": "Page Size",
            "description": "Items per page"
          },
          "total_pages": {
            "type": "integer",
            "minimum": 0.0,
            "title": "Total Pages",
            "description": "Total number of pages"
          },
          "has_next": {
            "type": "boolean",
            "title": "Has Next",
            "description": "Whether there is a next page"
          },
          "has_prev": {
            "type": "boolean",
            "title": "Has Prev",
            "description": "Whether there is a previous page"
          }
        },
        "type": "object",
        "required": [
          "total",
          "page",
          "page_size",
          "total_pages",
          "has_next",
          "has_prev"
        ],
        "title": "PaginationMeta",
        "description": "Pagination metadata matching frontend pagination standards.\n\n[Source: docs/stories/35.2.story.md#AC-35.2.3]\n[Source: specs/data/pagination-meta.schema.json]"
      },
      "ParallelErrorResponse": {
        "properties": {
          "error": {
            "type": "string",
            "title": "Error",
            "description": "Error type",
            "examples": [
              "CanvasNotFoundError"
            ]
          },
          "message": {
            "type": "string",
            "title": "Message",
            "description": "Error message",
            "examples": [
              "Canvas file '离散数学.canvas' not found"
            ]
          },
          "details": {
            "anyOf": [
              {
                "additionalProperties": true,
                "type": "object"
              },
              {
                "type": "null"
              }
            ],
            "title": "Details",
            "description": "Additional error details"
          }
        },
        "type": "object",
        "required": [
          "error",
          "message"
        ],
        "title": "ParallelErrorResponse",
        "description": "Error response model for parallel processing endpoints.\n\n[Source: specs/api/parallel-api.openapi.yml#/components/schemas/Error]"
      },
      "ParallelTaskStatus": {
        "type": "string",
        "enum": [
          "pending",
          "running",
          "completed",
          "partial_failure",
          "failed",
          "cancelled"
        ],
        "title": "ParallelTaskStatus",
        "description": "Parallel task status enum.\n\n[Source: specs/data/parallel-task.schema.json#/properties/status]"
      },
      "PassRateTrend": {
        "properties": {
          "date": {
            "type": "string",
            "title": "Date",
            "description": "ISO date string (YYYY-MM-DD)",
            "example": "2025-01-15"
          },
          "pass_rate": {
            "type": "number",
            "maximum": 1.0,
            "minimum": 0.0,
            "title": "Pass Rate",
            "description": "Pass rate at this date",
            "example": 0.75
          }
        },
        "type": "object",
        "required": [
          "date",
          "pass_rate"
        ],
        "title": "PassRateTrend",
        "description": "Single data point in pass rate trend chart.\n\n[Source: specs/api/review-api.openapi.yml#L765-769]"
      },
      "PerformanceMetrics": {
        "properties": {
          "total_duration_seconds": {
            "anyOf": [
              {
                "type": "number"
              },
              {
                "type": "null"
              }
            ],
            "title": "Total Duration Seconds",
            "description": "Total duration in seconds",
            "examples": [
              135
            ]
          },
          "average_duration_per_node": {
            "anyOf": [
              {
                "type": "number"
              },
              {
                "type": "null"
              }
            ],
            "title": "Average Duration Per Node",
            "description": "Average time per node in seconds",
            "examples": [
              11.25
            ]
          },
          "parallel_efficiency": {
            "anyOf": [
              {
                "type": "number"
              },
              {
                "type": "null"
              }
            ],
            "title": "Parallel Efficiency",
            "description": "Parallel efficiency (speedup ratio)",
            "examples": [
              7.2
            ]
          },
          "peak_concurrent": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Peak Concurrent",
            "description": "Peak concurrent executions",
            "examples": [
              8
            ]
          }
        },
        "type": "object",
        "title": "PerformanceMetrics",
        "description": "Performance metrics for completed session.\n\n[Source: specs/api/parallel-api.openapi.yml#/components/schemas/ParallelTaskStatus/performance_metrics]"
      },
      "ProgressResponse": {
        "properties": {
          "session_id": {
            "type": "string",
            "title": "Session Id",
            "description": "Session/Task ID",
            "examples": [
              "parallel-20250118-001"
            ]
          },
          "status": {
            "$ref": "#/components/schemas/ParallelTaskStatus",
            "description": "Current status"
          },
          "total_groups": {
            "type": "integer",
            "title": "Total Groups",
            "description": "Total groups",
            "examples": [
              4
            ]
          },
          "total_nodes": {
            "type": "integer",
            "title": "Total Nodes",
            "description": "Total nodes",
            "examples": [
              12
            ]
          },
          "completed_groups": {
            "type": "integer",
            "title": "Completed Groups",
            "description": "Completed groups",
            "default": 0
          },
          "completed_nodes": {
            "type": "integer",
            "title": "Completed Nodes",
            "description": "Completed nodes",
            "default": 0
          },
          "failed_nodes": {
            "type": "integer",
            "title": "Failed Nodes",
            "description": "Failed nodes",
            "default": 0
          },
          "progress_percent": {
            "type": "integer",
            "maximum": 100.0,
            "minimum": 0.0,
            "title": "Progress Percent",
            "description": "Progress percentage",
            "default": 0
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "title": "Created At",
            "description": "Creation timestamp"
          },
          "started_at": {
            "anyOf": [
              {
                "type": "string",
                "format": "date-time"
              },
              {
                "type": "null"
              }
            ],
            "title": "Started At",
            "description": "Start timestamp"
          },
          "completed_at": {
            "anyOf": [
              {
                "type": "string",
                "format": "date-time"
              },
              {
                "type": "null"
              }
            ],
            "title": "Completed At",
            "description": "Completion timestamp"
          },
          "groups": {
            "items": {
              "$ref": "#/components/schemas/GroupProgress"
            },
            "type": "array",
            "title": "Groups",
            "description": "Group progress details"
          },
          "performance_metrics": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/PerformanceMetrics"
              },
              {
                "type": "null"
              }
            ],
            "description": "Performance metrics (available after completion)"
          }
        },
        "type": "object",
        "required": [
          "session_id",
          "status",
          "total_groups",
          "total_nodes",
          "created_at"
        ],
        "title": "ProgressResponse",
        "description": "Response model for session progress status (GET /canvas/intelligent-parallel/{session_id}).\n\n[Source: specs/api/parallel-api.openapi.yml#/components/schemas/ParallelTaskStatus]"
      },
      "PromptTemplateCheck": {
        "properties": {
          "total": {
            "type": "integer",
            "minimum": 0.0,
            "title": "Total",
            "description": "Expected total number of templates"
          },
          "available": {
            "type": "integer",
            "minimum": 0.0,
            "title": "Available",
            "description": "Number of available templates"
          },
          "missing": {
            "items": {
              "type": "string"
            },
            "type": "array",
            "title": "Missing",
            "description": "List of missing template names"
          }
        },
        "type": "object",
        "required": [
          "total",
          "available"
        ],
        "title": "PromptTemplateCheck",
        "description": "Prompt template check result.\n\n[Source: specs/data/health-check-response.schema.json#L37-58]"
      },
      "QuestionDecomposeRequest": {
        "properties": {
          "canvas_name": {
            "type": "string",
            "title": "Canvas Name",
            "description": "Canvas file name"
          },
          "node_id": {
            "type": "string",
            "title": "Node Id",
            "description": "Target node ID"
          }
        },
        "type": "object",
        "required": [
          "canvas_name",
          "node_id"
        ],
        "title": "QuestionDecomposeRequest",
        "description": "Request model for question decomposition.\n\n[Source: docs/stories/story-12.A.6-complete-agents.md#AC2]\n[Source: .claude/agents/question-decomposition.md]"
      },
      "QuestionDecomposeResponse": {
        "properties": {
          "questions": {
            "items": {
              "$ref": "#/components/schemas/SubQuestion"
            },
            "type": "array",
            "title": "Questions",
            "description": "Decomposed verification questions (2-5)"
          },
          "created_nodes": {
            "items": {
              "$ref": "#/components/schemas/NodeRead"
            },
            "type": "array",
            "title": "Created Nodes",
            "description": "Created question nodes on Canvas"
          }
        },
        "type": "object",
        "required": [
          "questions"
        ],
        "title": "QuestionDecomposeResponse",
        "description": "Response model for question decomposition.\n\n[Source: docs/stories/story-12.A.6-complete-agents.md#AC2]\n[Source: .claude/agents/question-decomposition.md#Output-Format]"
      },
      "QuestionType": {
        "type": "string",
        "enum": [
          "standard",
          "application",
          "comparison",
          "counterexample",
          "synthesis"
        ],
        "title": "QuestionType",
        "description": "Verification question angle type.\n\nStory 31.4 AC-31.4.2: Different question angles for diverse coverage.\n\n[Source: specs/data/verification-history-response.schema.json#L61-64]\n[Source: docs/stories/31.4.story.md#Task-3]"
      },
      "RAGQueryMetadata": {
        "properties": {
          "query_rewritten": {
            "type": "boolean",
            "title": "Query Rewritten",
            "description": "Query 是否被重写",
            "default": false
          },
          "rewrite_count": {
            "type": "integer",
            "title": "Rewrite Count",
            "description": "重写次数",
            "default": 0
          },
          "fusion_strategy": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Fusion Strategy",
            "description": "使用的融合策略"
          },
          "reranking_strategy": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Reranking Strategy",
            "description": "使用的 Reranking 策略"
          }
        },
        "type": "object",
        "title": "RAGQueryMetadata",
        "description": "RAG 查询元数据"
      },
      "RAGQueryRequest": {
        "properties": {
          "query": {
            "type": "string",
            "maxLength": 2000,
            "minLength": 1,
            "title": "Query",
            "description": "查询字符串"
          },
          "canvas_file": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Canvas File",
            "description": "Canvas 文件路径 (用于上下文过滤)"
          },
          "is_review_canvas": {
            "type": "boolean",
            "title": "Is Review Canvas",
            "description": "是否为检验白板场景",
            "default": false
          },
          "fusion_strategy": {
            "anyOf": [
              {
                "type": "string",
                "enum": [
                  "rrf",
                  "weighted",
                  "cascade"
                ]
              },
              {
                "type": "null"
              }
            ],
            "title": "Fusion Strategy",
            "description": "融合策略 (默认: rrf, 检验白板: weighted)"
          },
          "reranking_strategy": {
            "anyOf": [
              {
                "type": "string",
                "enum": [
                  "local",
                  "cohere",
                  "hybrid_auto"
                ]
              },
              {
                "type": "null"
              }
            ],
            "title": "Reranking Strategy",
            "description": "Reranking 策略 (默认: hybrid_auto)"
          }
        },
        "type": "object",
        "required": [
          "query"
        ],
        "title": "RAGQueryRequest",
        "description": "RAG 查询请求",
        "example": {
          "canvas_file": "离散数学.canvas",
          "is_review_canvas": false,
          "query": "什么是逆否命题？"
        }
      },
      "RAGQueryResponse": {
        "properties": {
          "results": {
            "items": {
              "$ref": "#/components/schemas/SearchResultItem"
            },
            "type": "array",
            "title": "Results",
            "description": "检索结果列表"
          },
          "multimodal_results": {
            "items": {
              "$ref": "#/components/schemas/MultimodalResultItem"
            },
            "type": "array",
            "title": "Multimodal Results",
            "description": "多模态检索结果 (Story 35.8 AC-35.8.1)"
          },
          "quality_grade": {
            "type": "string",
            "title": "Quality Grade",
            "description": "质量评级 (high/medium/low)",
            "default": "low"
          },
          "result_count": {
            "type": "integer",
            "title": "Result Count",
            "description": "结果数量",
            "default": 0
          },
          "latency_ms": {
            "$ref": "#/components/schemas/LatencyInfo"
          },
          "total_latency_ms": {
            "type": "number",
            "title": "Total Latency Ms",
            "description": "总延迟 (ms)",
            "default": 0.0
          },
          "metadata": {
            "$ref": "#/components/schemas/RAGQueryMetadata",
            "description": "元数据"
          }
        },
        "type": "object",
        "title": "RAGQueryResponse",
        "description": "RAG 查询响应 (Story 35.8 - 含multimodal_results)\n\n✅ Verified from OpenAPI: specs/api/fastapi-backend-api.openapi.yml#RAGQueryResponse",
        "example": {
          "latency_ms": {
            "fusion": 5.3,
            "graphiti": 45.2,
            "lancedb": 32.1,
            "multimodal": 58.5,
            "reranking": 12.8
          },
          "metadata": {
            "fusion_strategy": "rrf",
            "query_rewritten": false,
            "reranking_strategy": "hybrid_auto",
            "rewrite_count": 0
          },
          "multimodal_results": [
            {
              "id": "mm-001",
              "media_type": "image",
              "metadata": {
                "height": 600,
                "width": 800
              },
              "path": "笔记库/images/逆否命题图解.png",
              "relevance_score": 0.87,
              "thumbnail": "data:image/png;base64,..."
            }
          ],
          "quality_grade": "high",
          "result_count": 1,
          "results": [
            {
              "content": "逆否命题是将原命题的条件和结论同时取否定...",
              "doc_id": "node-123",
              "metadata": {
                "canvas": "离散数学.canvas",
                "source": "graphiti"
              },
              "score": 0.95
            }
          ],
          "total_latency_ms": 153.9
        }
      },
      "RAGStatusResponse": {
        "properties": {
          "available": {
            "type": "boolean",
            "title": "Available",
            "description": "服务是否可用"
          },
          "initialized": {
            "type": "boolean",
            "title": "Initialized",
            "description": "是否已初始化"
          },
          "langgraph_available": {
            "type": "boolean",
            "title": "Langgraph Available",
            "description": "LangGraph 是否可用"
          },
          "import_error": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Import Error",
            "description": "导入错误信息"
          },
          "timestamp": {
            "type": "string",
            "format": "date-time",
            "title": "Timestamp"
          }
        },
        "type": "object",
        "required": [
          "available",
          "initialized",
          "langgraph_available"
        ],
        "title": "RAGStatusResponse",
        "description": "RAG 服务状态响应"
      },
      "RecommendActionRequest": {
        "properties": {
          "score": {
            "type": "integer",
            "maximum": 100.0,
            "minimum": 0.0,
            "title": "Score",
            "description": "Current total score (0-100 scale)"
          },
          "node_id": {
            "type": "string",
            "minLength": 1,
            "title": "Node Id",
            "description": "Canvas node ID being evaluated"
          },
          "canvas_name": {
            "type": "string",
            "minLength": 1,
            "title": "Canvas Name",
            "description": "Canvas file name"
          },
          "include_history": {
            "type": "boolean",
            "title": "Include History",
            "description": "Whether to include historical score analysis",
            "default": true
          },
          "concept": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Concept",
            "description": "Concept name (optional, used for history lookup)"
          }
        },
        "type": "object",
        "required": [
          "score",
          "node_id",
          "canvas_name"
        ],
        "title": "RecommendActionRequest",
        "description": "Request model for intelligent action recommendation.\n\n[Source: specs/data/recommend-action-request.schema.json]\n[Source: docs/stories/31.3.story.md#AC-31.3.1, AC-31.3.2]"
      },
      "RecommendActionResponse": {
        "properties": {
          "action": {
            "$ref": "#/components/schemas/ActionType",
            "description": "Recommended action type"
          },
          "agent": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Agent",
            "description": "Recommended agent endpoint path, null for 'next' action"
          },
          "reason": {
            "type": "string",
            "minLength": 1,
            "title": "Reason",
            "description": "Human-readable explanation for the recommendation"
          },
          "priority": {
            "type": "integer",
            "maximum": 5.0,
            "minimum": 1.0,
            "title": "Priority",
            "description": "Recommendation priority (1=highest, 5=lowest)",
            "default": 3
          },
          "review_suggested": {
            "type": "boolean",
            "title": "Review Suggested",
            "description": "Whether additional review is suggested based on declining trend",
            "default": false
          },
          "history_context": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/HistoryContext"
              },
              {
                "type": "null"
              }
            ],
            "description": "Historical score context (when include_history=true)"
          },
          "alternative_agents": {
            "items": {
              "$ref": "#/components/schemas/AlternativeAgent"
            },
            "type": "array",
            "maxItems": 3,
            "title": "Alternative Agents",
            "description": "Alternative agent recommendations"
          }
        },
        "type": "object",
        "required": [
          "action",
          "reason"
        ],
        "title": "RecommendActionResponse",
        "description": "Response model for intelligent action recommendation.\n\n[Source: specs/data/recommend-action-response.schema.json]\n[Source: docs/stories/31.3.story.md#AC-31.3.3, AC-31.3.4]\n\nRecommendation Logic (0-100 scale):\n- score < 60: decompose (basic-decomposition)\n- score 60-79: explain (oral-explanation)\n- score >= 80: next (mastered)"
      },
      "RecordReviewRequest": {
        "properties": {
          "canvas_name": {
            "type": "string",
            "title": "Canvas Name",
            "description": "Canvas file name"
          },
          "node_id": {
            "type": "string",
            "title": "Node Id",
            "description": "Node ID (maps to concept_id)"
          },
          "rating": {
            "anyOf": [
              {
                "type": "integer",
                "maximum": 4.0,
                "minimum": 1.0
              },
              {
                "type": "null"
              }
            ],
            "title": "Rating",
            "description": "FSRS rating: 1=Again (forgot), 2=Hard, 3=Good, 4=Easy"
          },
          "score": {
            "anyOf": [
              {
                "type": "number",
                "maximum": 100.0,
                "minimum": 0.0
              },
              {
                "type": "null"
              }
            ],
            "title": "Score",
            "description": "Legacy score (0-100). Auto-converted to rating: <40=Again, 40-59=Hard, 60-84=Good, >=85=Easy"
          },
          "card_state": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Card State",
            "description": "Serialized FSRS card JSON from previous review (for card state continuity)"
          },
          "review_duration": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Review Duration",
            "description": "Review time in seconds (for metrics)"
          }
        },
        "type": "object",
        "required": [
          "canvas_name",
          "node_id"
        ],
        "title": "RecordReviewRequest",
        "description": "Request model for recording review result.\n\nStory 32.2 AC-32.2.2: Accepts FSRS ratings (1-4) in addition to legacy score.\nStory 32.2 AC-32.2.4: Backward compatible - either rating OR score must be provided.\n\n[Source: specs/api/fastapi-backend-api.openapi.yml#/components/schemas/RecordReviewRequest]\n[Source: specs/api/review-api.openapi.yml#L542-L563]\n[Source: docs/stories/32.2.story.md]"
      },
      "RecordReviewResponse": {
        "properties": {
          "next_review_date": {
            "type": "string",
            "format": "date",
            "title": "Next Review Date",
            "description": "Next review date (FSRS calculated)"
          },
          "new_interval": {
            "type": "integer",
            "title": "New Interval",
            "description": "New review interval in days (dynamic)"
          },
          "fsrs_state": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/FSRSStateResponse"
              },
              {
                "type": "null"
              }
            ],
            "description": "FSRS algorithm state (stability, difficulty, etc.)"
          },
          "card_data": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Card Data",
            "description": "Serialized FSRS card JSON for next review"
          },
          "algorithm": {
            "type": "string",
            "title": "Algorithm",
            "description": "Algorithm used: 'fsrs-4.5' or 'ebbinghaus-fallback'",
            "default": "fsrs-4.5"
          }
        },
        "type": "object",
        "required": [
          "next_review_date",
          "new_interval"
        ],
        "title": "RecordReviewResponse",
        "description": "Response model for recorded review result.\n\nStory 32.2: Enhanced with FSRS state and dynamic interval.\n\n[Source: specs/api/fastapi-backend-api.openapi.yml#/components/schemas/RecordReviewResponse]\n[Source: specs/api/review-api.openapi.yml#L565-L594]\n[Source: docs/stories/32.2.story.md]"
      },
      "ResourceMetricsSummary": {
        "properties": {
          "cpu_usage_percent": {
            "type": "number",
            "title": "Cpu Usage Percent",
            "description": "CPU usage percentage"
          },
          "memory_usage_percent": {
            "type": "number",
            "title": "Memory Usage Percent",
            "description": "Memory usage percentage"
          },
          "memory_available_bytes": {
            "type": "integer",
            "title": "Memory Available Bytes",
            "description": "Available memory in bytes",
            "default": 0
          },
          "memory_total_bytes": {
            "type": "integer",
            "title": "Memory Total Bytes",
            "description": "Total memory in bytes",
            "default": 0
          },
          "disk_usage_percent": {
            "type": "number",
            "title": "Disk Usage Percent",
            "description": "Disk usage percentage"
          },
          "disk_free_bytes": {
            "type": "integer",
            "title": "Disk Free Bytes",
            "description": "Free disk space in bytes",
            "default": 0
          }
        },
        "type": "object",
        "required": [
          "cpu_usage_percent",
          "memory_usage_percent",
          "disk_usage_percent"
        ],
        "title": "ResourceMetricsSummary",
        "description": "System resource metrics summary.\n\n[Source: specs/api/canvas-api.openapi.yml:987-1060]"
      },
      "ResourcesSummary": {
        "properties": {
          "cpu_usage_percent": {
            "type": "number",
            "title": "Cpu Usage Percent",
            "description": "CPU usage percentage"
          },
          "memory_usage_percent": {
            "type": "number",
            "title": "Memory Usage Percent",
            "description": "Memory usage percentage"
          },
          "disk_usage_percent": {
            "type": "number",
            "title": "Disk Usage Percent",
            "description": "Disk usage percentage"
          }
        },
        "type": "object",
        "required": [
          "cpu_usage_percent",
          "memory_usage_percent",
          "disk_usage_percent"
        ],
        "title": "ResourcesSummary",
        "description": "System resources summary.\n\n[Source: specs/api/canvas-api.openapi.yml:1041-1055]"
      },
      "ReviewEntry": {
        "properties": {
          "review_canvas_path": {
            "type": "string",
            "title": "Review Canvas Path",
            "description": "Path to verification canvas file",
            "example": "离散数学-检验白板-20250115.canvas"
          },
          "date": {
            "type": "string",
            "format": "date-time",
            "title": "Date",
            "description": "Review session timestamp",
            "example": "2025-01-15T10:00:00Z"
          },
          "mode": {
            "$ref": "#/components/schemas/ReviewMode",
            "description": "Review mode (fresh or targeted)"
          },
          "pass_rate": {
            "type": "number",
            "maximum": 1.0,
            "minimum": 0.0,
            "title": "Pass Rate",
            "description": "Pass rate for this session (0-1 scale)",
            "example": 0.75
          },
          "total_concepts": {
            "type": "integer",
            "minimum": 0.0,
            "title": "Total Concepts",
            "description": "Total concepts reviewed",
            "example": 8
          },
          "passed_concepts": {
            "type": "integer",
            "minimum": 0.0,
            "title": "Passed Concepts",
            "description": "Concepts with passing score (>=60)",
            "example": 6
          }
        },
        "type": "object",
        "required": [
          "review_canvas_path",
          "date",
          "mode",
          "pass_rate",
          "total_concepts",
          "passed_concepts"
        ],
        "title": "ReviewEntry",
        "description": "Single review session entry.\n\n[Source: specs/api/review-api.openapi.yml#L737-762]"
      },
      "ReviewItem": {
        "properties": {
          "canvas_name": {
            "type": "string",
            "title": "Canvas Name",
            "description": "Canvas file name"
          },
          "node_id": {
            "type": "string",
            "title": "Node Id",
            "description": "Node ID"
          },
          "concept": {
            "type": "string",
            "title": "Concept",
            "description": "Concept name"
          },
          "due_date": {
            "type": "string",
            "format": "date",
            "title": "Due Date",
            "description": "Due date for review"
          },
          "interval_days": {
            "type": "integer",
            "title": "Interval Days",
            "description": "Current review interval (1/7/30 days)"
          }
        },
        "type": "object",
        "required": [
          "canvas_name",
          "node_id",
          "concept",
          "due_date",
          "interval_days"
        ],
        "title": "ReviewItem",
        "description": "Single review item in schedule.\n\n[Source: specs/api/fastapi-backend-api.openapi.yml#/components/schemas/ReviewItem]\n[Source: specs/data/review-item.schema.json]"
      },
      "ReviewMode": {
        "type": "string",
        "enum": [
          "fresh",
          "targeted"
        ],
        "title": "ReviewMode",
        "description": "Review mode enum.\n\n[Source: specs/api/review-api.openapi.yml#L346-378]"
      },
      "ReviewScheduleResponse": {
        "properties": {
          "items": {
            "items": {
              "$ref": "#/components/schemas/ReviewItem"
            },
            "type": "array",
            "title": "Items",
            "description": "Review items"
          },
          "total_count": {
            "type": "integer",
            "title": "Total Count",
            "description": "Total item count"
          }
        },
        "type": "object",
        "required": [
          "items",
          "total_count"
        ],
        "title": "ReviewScheduleResponse",
        "description": "Response model for review schedule.\n\n[Source: specs/api/fastapi-backend-api.openapi.yml#/components/schemas/ReviewScheduleResponse]"
      },
      "ReviewSuggestionResponse": {
        "properties": {
          "concept": {
            "type": "string",
            "title": "Concept",
            "description": "概念名称"
          },
          "concept_id": {
            "type": "string",
            "title": "Concept Id",
            "description": "概念ID"
          },
          "last_score": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Last Score",
            "description": "最近得分"
          },
          "review_count": {
            "type": "integer",
            "title": "Review Count",
            "description": "复习次数"
          },
          "due_date": {
            "type": "string",
            "title": "Due Date",
            "description": "到期日期 (ISO format)"
          },
          "priority": {
            "type": "string",
            "title": "Priority",
            "description": "优先级: high, medium, low"
          }
        },
        "type": "object",
        "required": [
          "concept",
          "concept_id",
          "review_count",
          "due_date",
          "priority"
        ],
        "title": "ReviewSuggestionResponse",
        "description": "Response model for review suggestion.\n\n✅ Verified from docs/stories/22.4.story.md#ReviewSuggestionResponse:\n- concept: 概念名称\n- concept_id: 概念ID\n- last_score: 最近得分\n- review_count: 复习次数\n- due_date: 到期日期\n- priority: 优先级 (high/medium/low)\n\n[Source: docs/stories/22.4.story.md#Pydantic模型]",
        "example": {
          "concept": "逆否命题",
          "concept_id": "concept-123",
          "due_date": "2025-12-12T00:00:00",
          "last_score": 75,
          "priority": "high",
          "review_count": 2
        }
      },
      "RollbackRequest": {
        "properties": {
          "canvas_path": {
            "type": "string",
            "title": "Canvas Path",
            "description": "Canvas文件路径"
          },
          "rollback_type": {
            "$ref": "#/components/schemas/RollbackTypeEnum",
            "description": "回滚类型"
          },
          "target_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Target Id",
            "description": "目标ID (operation_id 或 snapshot_id)"
          },
          "target_time": {
            "anyOf": [
              {
                "type": "string",
                "format": "date-time"
              },
              {
                "type": "null"
              }
            ],
            "title": "Target Time",
            "description": "目标时间点 (仅 timepoint 类型)"
          },
          "create_backup": {
            "type": "boolean",
            "title": "Create Backup",
            "description": "是否在回滚前创建备份快照",
            "default": true
          },
          "preserve_graph": {
            "type": "boolean",
            "title": "Preserve Graph",
            "description": "是否跳过知识图谱同步",
            "default": false
          }
        },
        "type": "object",
        "required": [
          "canvas_path",
          "rollback_type"
        ],
        "title": "RollbackRequest",
        "description": "回滚请求模型\n\n[Source: docs/architecture/rollback-recovery-architecture.md:344-380]"
      },
      "RollbackResult": {
        "properties": {
          "success": {
            "type": "boolean",
            "title": "Success",
            "description": "是否成功"
          },
          "rollback_type": {
            "$ref": "#/components/schemas/RollbackTypeEnum",
            "description": "回滚类型"
          },
          "canvas_path": {
            "type": "string",
            "title": "Canvas Path",
            "description": "Canvas文件路径"
          },
          "backup_snapshot_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Backup Snapshot Id",
            "description": "备份快照ID"
          },
          "restored_operation_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Restored Operation Id",
            "description": "恢复到的操作ID"
          },
          "restored_snapshot_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Restored Snapshot Id",
            "description": "恢复到的快照ID"
          },
          "graph_sync_status": {
            "$ref": "#/components/schemas/GraphSyncStatusEnum",
            "default": "skipped"
          },
          "message": {
            "type": "string",
            "title": "Message",
            "description": "结果消息",
            "default": ""
          },
          "error": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Error",
            "description": "错误信息"
          }
        },
        "type": "object",
        "required": [
          "success",
          "rollback_type",
          "canvas_path"
        ],
        "title": "RollbackResult",
        "description": "回滚结果响应模型\n\n[Source: docs/architecture/rollback-recovery-architecture.md:344-380]"
      },
      "RollbackTypeEnum": {
        "type": "string",
        "enum": [
          "operation",
          "snapshot",
          "timepoint"
        ],
        "title": "RollbackTypeEnum",
        "description": "回滚类型枚举"
      },
      "ScoreRequest": {
        "properties": {
          "canvas_name": {
            "type": "string",
            "title": "Canvas Name",
            "description": "Canvas file name"
          },
          "node_ids": {
            "items": {
              "type": "string"
            },
            "type": "array",
            "title": "Node Ids",
            "description": "Node IDs to score"
          },
          "node_content": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Node Content",
            "description": "Node content to score (passed from plugin)"
          }
        },
        "type": "object",
        "required": [
          "canvas_name",
          "node_ids"
        ],
        "title": "ScoreRequest",
        "description": "Request model for scoring understanding.\n\n[Source: specs/api/fastapi-backend-api.openapi.yml#/components/schemas/ScoreRequest]\n[Story 2.8: Added node_content for real-time content passing]"
      },
      "ScoreResponse": {
        "properties": {
          "scores": {
            "items": {
              "$ref": "#/components/schemas/NodeScore"
            },
            "type": "array",
            "title": "Scores",
            "description": "Score results"
          }
        },
        "type": "object",
        "required": [
          "scores"
        ],
        "title": "ScoreResponse",
        "description": "Response model for scoring.\n\n[Source: specs/api/fastapi-backend-api.openapi.yml#/components/schemas/ScoreResponse]"
      },
      "ScoreTrend": {
        "properties": {
          "first": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "First",
            "description": "首次得分"
          },
          "last": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Last",
            "description": "最近得分"
          },
          "average": {
            "anyOf": [
              {
                "type": "number"
              },
              {
                "type": "null"
              }
            ],
            "title": "Average",
            "description": "平均得分"
          },
          "improvement": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Improvement",
            "description": "分数提升"
          }
        },
        "type": "object",
        "title": "ScoreTrend",
        "description": "Score trend analysis for concept history.\n\n[Source: AC-22.4.3]"
      },
      "SearchResultItem": {
        "properties": {
          "doc_id": {
            "type": "string",
            "title": "Doc Id",
            "description": "文档ID"
          },
          "content": {
            "type": "string",
            "title": "Content",
            "description": "内容"
          },
          "score": {
            "type": "number",
            "title": "Score",
            "description": "相关度分数"
          },
          "metadata": {
            "additionalProperties": true,
            "type": "object",
            "title": "Metadata",
            "description": "元数据"
          }
        },
        "type": "object",
        "required": [
          "doc_id",
          "content",
          "score"
        ],
        "title": "SearchResultItem",
        "description": "单个检索结果"
      },
      "SessionPauseResumeResponse": {
        "properties": {
          "session_id": {
            "type": "string",
            "title": "Session Id",
            "description": "Session identifier",
            "example": "sess_abc123"
          },
          "status": {
            "$ref": "#/components/schemas/VerificationStatusEnum",
            "description": "New session status after operation"
          },
          "message": {
            "type": "string",
            "title": "Message",
            "description": "Operation result message",
            "example": "Session paused successfully"
          }
        },
        "type": "object",
        "required": [
          "session_id",
          "status",
          "message"
        ],
        "title": "SessionPauseResumeResponse",
        "description": "Response for session pause/resume operations.\n\nStory 31.6 AC-31.6.4: Support pause/resume session.\n\n[Source: docs/stories/31.6.story.md#Task-3]"
      },
      "SessionProgressResponse": {
        "properties": {
          "session_id": {
            "type": "string",
            "title": "Session Id",
            "description": "Unique session identifier",
            "example": "sess_abc123"
          },
          "canvas_name": {
            "type": "string",
            "title": "Canvas Name",
            "description": "Source canvas name",
            "example": "离散数学"
          },
          "total_concepts": {
            "type": "integer",
            "minimum": 0.0,
            "title": "Total Concepts",
            "description": "Total concepts to verify",
            "example": 10
          },
          "completed_concepts": {
            "type": "integer",
            "minimum": 0.0,
            "title": "Completed Concepts",
            "description": "Concepts completed so far",
            "example": 5
          },
          "current_concept": {
            "type": "string",
            "title": "Current Concept",
            "description": "Current concept being verified",
            "example": "逆否命题"
          },
          "current_concept_idx": {
            "type": "integer",
            "minimum": 0.0,
            "title": "Current Concept Idx",
            "description": "Index of current concept (0-based)",
            "example": 5
          },
          "green_count": {
            "type": "integer",
            "minimum": 0.0,
            "title": "Green Count",
            "description": "Concepts marked as mastered (green)",
            "default": 0
          },
          "yellow_count": {
            "type": "integer",
            "minimum": 0.0,
            "title": "Yellow Count",
            "description": "Concepts partially understood (yellow)",
            "default": 0
          },
          "purple_count": {
            "type": "integer",
            "minimum": 0.0,
            "title": "Purple Count",
            "description": "Concepts need decomposition (purple)",
            "default": 0
          },
          "red_count": {
            "type": "integer",
            "minimum": 0.0,
            "title": "Red Count",
            "description": "Concepts not understood (red)",
            "default": 0
          },
          "status": {
            "$ref": "#/components/schemas/VerificationStatusEnum",
            "description": "Current session status",
            "default": "pending"
          },
          "progress_percentage": {
            "type": "number",
            "maximum": 100.0,
            "minimum": 0.0,
            "title": "Progress Percentage",
            "description": "Completion percentage (completed/total * 100)",
            "example": 50.0
          },
          "mastery_percentage": {
            "type": "number",
            "maximum": 100.0,
            "minimum": 0.0,
            "title": "Mastery Percentage",
            "description": "Mastery rate (green/completed * 100)",
            "example": 60.0
          },
          "hints_given": {
            "type": "integer",
            "minimum": 0.0,
            "title": "Hints Given",
            "description": "Hints given for current concept",
            "default": 0
          },
          "max_hints": {
            "type": "integer",
            "minimum": 0.0,
            "title": "Max Hints",
            "description": "Maximum hints allowed per concept",
            "default": 3
          },
          "started_at": {
            "type": "string",
            "format": "date-time",
            "title": "Started At",
            "description": "Session start timestamp"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "title": "Updated At",
            "description": "Last update timestamp"
          }
        },
        "type": "object",
        "required": [
          "session_id",
          "canvas_name",
          "total_concepts",
          "completed_concepts",
          "current_concept",
          "current_concept_idx",
          "progress_percentage",
          "mastery_percentage",
          "started_at",
          "updated_at"
        ],
        "title": "SessionProgressResponse",
        "description": "Real-time verification session progress response.\n\nStory 31.6 AC-31.6.1: Frontend displays \"已验证 X/Y 个概念\" progress.\nStory 31.6 AC-31.6.2: Color distribution real-time updates.\nStory 31.6 AC-31.6.3: Mastery percentage = green / total * 100%.\n\n[Source: docs/stories/31.6.story.md#Task-2]\n[Source: backend/app/services/verification_service.py:VerificationProgress]"
      },
      "SessionResponse": {
        "properties": {
          "session_id": {
            "type": "string",
            "title": "Session Id",
            "description": "Session/Task ID",
            "examples": [
              "parallel-20250118-001"
            ]
          },
          "status": {
            "$ref": "#/components/schemas/ParallelTaskStatus",
            "description": "Initial status",
            "default": "pending"
          },
          "total_groups": {
            "type": "integer",
            "title": "Total Groups",
            "description": "Total number of groups",
            "examples": [
              4
            ]
          },
          "total_nodes": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Total Nodes",
            "description": "Total number of nodes",
            "examples": [
              12
            ]
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "title": "Created At",
            "description": "Creation timestamp"
          },
          "estimated_completion": {
            "anyOf": [
              {
                "type": "string",
                "format": "date-time"
              },
              {
                "type": "null"
              }
            ],
            "title": "Estimated Completion",
            "description": "Estimated completion time"
          },
          "websocket_url": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Websocket Url",
            "description": "WebSocket URL for progress subscription",
            "examples": [
              "ws://localhost:8000/ws/intelligent-parallel/parallel-20250118-001"
            ]
          }
        },
        "type": "object",
        "required": [
          "session_id",
          "total_groups",
          "created_at"
        ],
        "title": "SessionResponse",
        "description": "Response model for batch session creation (202 Accepted).\n\n[Source: specs/api/parallel-api.openapi.yml#/components/schemas/ParallelTaskCreated]"
      },
      "SingleAgentRequest": {
        "properties": {
          "node_id": {
            "type": "string",
            "title": "Node Id",
            "description": "Node ID to process",
            "examples": [
              "node-005"
            ]
          },
          "agent_type": {
            "type": "string",
            "title": "Agent Type",
            "description": "Agent type",
            "examples": [
              "oral-explanation"
            ]
          },
          "canvas_path": {
            "type": "string",
            "title": "Canvas Path",
            "description": "Canvas file path",
            "examples": [
              "离散数学.canvas"
            ]
          }
        },
        "type": "object",
        "required": [
          "node_id",
          "agent_type",
          "canvas_path"
        ],
        "title": "SingleAgentRequest",
        "description": "Request model for single node agent retry (POST /canvas/single-agent).\n\n[Source: specs/api/parallel-api.openapi.yml#/components/schemas/SingleAgentRequest]"
      },
      "SingleAgentResponse": {
        "properties": {
          "node_id": {
            "type": "string",
            "title": "Node Id",
            "description": "Processed node ID",
            "examples": [
              "node-005"
            ]
          },
          "file_path": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "File Path",
            "description": "Generated file path",
            "examples": [
              "离散数学/逻辑表达式-explanation.md"
            ]
          },
          "status": {
            "$ref": "#/components/schemas/SingleAgentStatus",
            "description": "Execution status"
          },
          "error_message": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Error Message",
            "description": "Error message if failed"
          }
        },
        "type": "object",
        "required": [
          "node_id",
          "status"
        ],
        "title": "SingleAgentResponse",
        "description": "Response model for single agent execution.\n\n[Source: specs/api/parallel-api.openapi.yml#/components/schemas/SingleAgentResponse]"
      },
      "SingleAgentStatus": {
        "type": "string",
        "enum": [
          "success",
          "failed"
        ],
        "title": "SingleAgentStatus",
        "description": "Single agent execution status.\n\n[Source: specs/api/parallel-api.openapi.yml#/components/schemas/SingleAgentResponse/status]"
      },
      "SnapshotListResponse": {
        "properties": {
          "canvas_path": {
            "type": "string",
            "title": "Canvas Path"
          },
          "total": {
            "type": "integer",
            "title": "Total"
          },
          "snapshots": {
            "items": {
              "$ref": "#/components/schemas/SnapshotResponse"
            },
            "type": "array",
            "title": "Snapshots",
            "default": []
          }
        },
        "type": "object",
        "required": [
          "canvas_path",
          "total"
        ],
        "title": "SnapshotListResponse",
        "description": "快照列表响应模型"
      },
      "SnapshotMetadataResponse": {
        "properties": {
          "description": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Description"
          },
          "created_by": {
            "type": "string",
            "title": "Created By",
            "default": "system"
          },
          "tags": {
            "anyOf": [
              {
                "items": {
                  "type": "string"
                },
                "type": "array"
              },
              {
                "type": "null"
              }
            ],
            "title": "Tags"
          },
          "size_bytes": {
            "type": "integer",
            "title": "Size Bytes",
            "default": 0
          }
        },
        "type": "object",
        "title": "SnapshotMetadataResponse",
        "description": "快照元数据响应模型"
      },
      "SnapshotResponse": {
        "properties": {
          "id": {
            "type": "string",
            "title": "Id",
            "description": "快照唯一标识符"
          },
          "canvas_path": {
            "type": "string",
            "title": "Canvas Path",
            "description": "Canvas文件路径"
          },
          "timestamp": {
            "type": "string",
            "format": "date-time",
            "title": "Timestamp",
            "description": "创建时间戳"
          },
          "type": {
            "$ref": "#/components/schemas/SnapshotTypeEnum",
            "description": "快照类型"
          },
          "last_operation_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Last Operation Id",
            "description": "关联的最后操作ID"
          },
          "metadata": {
            "$ref": "#/components/schemas/SnapshotMetadataResponse"
          }
        },
        "type": "object",
        "required": [
          "id",
          "canvas_path",
          "timestamp",
          "type"
        ],
        "title": "SnapshotResponse",
        "description": "快照响应模型\n\n[Source: docs/architecture/rollback-recovery-architecture.md:312-326]"
      },
      "SnapshotTypeEnum": {
        "type": "string",
        "enum": [
          "auto",
          "manual",
          "checkpoint"
        ],
        "title": "SnapshotTypeEnum",
        "description": "快照类型枚举\n\n[Source: docs/architecture/rollback-recovery-architecture.md:212-250]"
      },
      "StorageBackendStatus": {
        "properties": {
          "name": {
            "type": "string",
            "title": "Name",
            "description": "Storage backend name: neo4j, mcp, json"
          },
          "status": {
            "type": "string",
            "title": "Status",
            "description": "Status: ok or error"
          },
          "latency_ms": {
            "anyOf": [
              {
                "type": "number"
              },
              {
                "type": "null"
              }
            ],
            "title": "Latency Ms",
            "description": "Health check latency in ms"
          },
          "error": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Error",
            "description": "Error message if status=error"
          },
          "details": {
            "anyOf": [
              {
                "additionalProperties": true,
                "type": "object"
              },
              {
                "type": "null"
              }
            ],
            "title": "Details",
            "description": "Additional details"
          }
        },
        "type": "object",
        "required": [
          "name",
          "status"
        ],
        "title": "StorageBackendStatus",
        "description": "Storage backend health status."
      },
      "StorageHealthResponse": {
        "properties": {
          "status": {
            "type": "string",
            "title": "Status",
            "description": "Overall status: healthy=all backends ok, degraded=some error, unhealthy=critical (neo4j) error"
          },
          "storage_backends": {
            "items": {
              "$ref": "#/components/schemas/StorageBackendStatus"
            },
            "type": "array",
            "title": "Storage Backends",
            "description": "Status of each storage backend"
          },
          "connection_pool": {
            "additionalProperties": {
              "$ref": "#/components/schemas/Neo4jConnectionPool"
            },
            "type": "object",
            "title": "Connection Pool",
            "description": "Connection pool status"
          },
          "latency_metrics": {
            "$ref": "#/components/schemas/LatencyMetrics",
            "description": "Latency metrics from health checks"
          },
          "cached": {
            "type": "boolean",
            "title": "Cached",
            "description": "Whether this is a cached response"
          },
          "cache_ttl_remaining_seconds": {
            "type": "integer",
            "title": "Cache Ttl Remaining Seconds",
            "description": "Remaining cache TTL in seconds",
            "default": 0
          },
          "timestamp": {
            "type": "string",
            "format": "date-time",
            "title": "Timestamp",
            "description": "Health check timestamp"
          }
        },
        "type": "object",
        "required": [
          "status",
          "storage_backends",
          "latency_metrics",
          "cached",
          "timestamp"
        ],
        "title": "StorageHealthResponse",
        "description": "Unified Storage Health Response.\n\n[Source: specs/data/storage-health-response.schema.json]\n[Source: docs/stories/36.10.story.md]"
      },
      "SubQuestion": {
        "properties": {
          "text": {
            "type": "string",
            "title": "Text",
            "description": "The sub-question text"
          },
          "type": {
            "type": "string",
            "title": "Type",
            "description": "Question type: 检验型/应用型/对比型/推理型"
          },
          "guidance": {
            "type": "string",
            "title": "Guidance",
            "description": "Guidance hint starting with 💡 提示:"
          }
        },
        "type": "object",
        "required": [
          "text",
          "type",
          "guidance"
        ],
        "title": "SubQuestion",
        "description": "Single sub-question from decomposition.\n\n[Source: .claude/agents/question-decomposition.md#Output-Format]"
      },
      "SubjectMappingConfig": {
        "properties": {
          "mappings": {
            "items": {
              "$ref": "#/components/schemas/SubjectMappingRule"
            },
            "type": "array",
            "title": "Mappings",
            "description": "Explicit folder → subject/category mappings"
          },
          "category_rules": {
            "additionalProperties": {
              "items": {
                "type": "string"
              },
              "type": "array"
            },
            "type": "object",
            "title": "Category Rules",
            "description": "Category inference rules (category → patterns)"
          },
          "defaults": {
            "additionalProperties": {
              "type": "string"
            },
            "type": "object",
            "title": "Defaults",
            "description": "Default subject/category when no rule matches"
          }
        },
        "type": "object",
        "title": "SubjectMappingConfig",
        "description": "Complete subject mapping configuration.\n\nUsed for GET/PUT /api/v1/config/subject-mapping\n\n[Source: Design doc - Phase 2.1]",
        "example": {
          "category_rules": {
            "math": [
              "math*",
              "数学*"
            ],
            "physics": [
              "physics*",
              "物理*"
            ]
          },
          "defaults": {
            "category": "general",
            "subject": "general"
          },
          "mappings": [
            {
              "category": "math",
              "pattern": "Math 54/**",
              "subject": "math54"
            },
            {
              "category": "physics",
              "pattern": "Physics 7A/**",
              "subject": "physics7a"
            }
          ]
        }
      },
      "SubjectMappingRule": {
        "properties": {
          "pattern": {
            "type": "string",
            "title": "Pattern",
            "description": "Folder pattern (glob-style, e.g., 'Math 54/**')"
          },
          "subject": {
            "type": "string",
            "title": "Subject",
            "description": "Subject identifier"
          },
          "category": {
            "type": "string",
            "title": "Category",
            "description": "Category identifier"
          }
        },
        "type": "object",
        "required": [
          "pattern",
          "subject",
          "category"
        ],
        "title": "SubjectMappingRule",
        "description": "Single subject mapping rule.\n\nMaps a folder pattern to subject and category.",
        "example": {
          "category": "math",
          "pattern": "Math 54/**",
          "subject": "math54"
        }
      },
      "SyncEdgesSummaryResponse": {
        "properties": {
          "canvas_path": {
            "type": "string",
            "title": "Canvas Path"
          },
          "total_edges": {
            "type": "integer",
            "title": "Total Edges"
          },
          "synced_count": {
            "type": "integer",
            "title": "Synced Count"
          },
          "failed_count": {
            "type": "integer",
            "title": "Failed Count"
          },
          "skipped_count": {
            "type": "integer",
            "title": "Skipped Count"
          },
          "sync_time_ms": {
            "type": "number",
            "title": "Sync Time Ms"
          }
        },
        "type": "object",
        "required": [
          "canvas_path",
          "total_edges",
          "synced_count",
          "failed_count",
          "skipped_count",
          "sync_time_ms"
        ],
        "title": "SyncEdgesSummaryResponse",
        "description": "Edge sync summary response.\n\nStory 36.4: Canvas打开时全量Edge同步\n[Source: docs/stories/36.4.story.md#Task-2]"
      },
      "SyncMountRequest": {
        "properties": {
          "canvas_path": {
            "type": "string",
            "title": "Canvas Path",
            "description": "Current Canvas path that the textbook is mounted to"
          },
          "textbook": {
            "$ref": "#/components/schemas/MountedTextbook",
            "description": "Mounted textbook information"
          }
        },
        "type": "object",
        "required": [
          "canvas_path",
          "textbook"
        ],
        "title": "SyncMountRequest",
        "description": "Request to sync a mounted textbook to backend."
      },
      "SyncMountResponse": {
        "properties": {
          "success": {
            "type": "boolean",
            "title": "Success",
            "description": "Whether sync was successful"
          },
          "config_path": {
            "type": "string",
            "title": "Config Path",
            "description": "Path to .canvas-links.json file"
          },
          "message": {
            "type": "string",
            "title": "Message",
            "description": "Status message",
            "default": ""
          },
          "association_id": {
            "type": "string",
            "title": "Association Id",
            "description": "Created association ID",
            "default": ""
          }
        },
        "type": "object",
        "required": [
          "success",
          "config_path"
        ],
        "title": "SyncMountResponse",
        "description": "Response after syncing mounted textbook."
      },
      "TextbookSection": {
        "properties": {
          "id": {
            "type": "string",
            "title": "Id",
            "description": "Unique section ID"
          },
          "title": {
            "type": "string",
            "title": "Title",
            "description": "Section title"
          },
          "level": {
            "type": "integer",
            "title": "Level",
            "description": "Heading level (1-6)",
            "default": 1
          },
          "preview": {
            "type": "string",
            "title": "Preview",
            "description": "Content preview",
            "default": ""
          },
          "start_offset": {
            "type": "integer",
            "title": "Start Offset",
            "description": "Start offset in file",
            "default": 0
          },
          "end_offset": {
            "type": "integer",
            "title": "End Offset",
            "description": "End offset in file",
            "default": 0
          },
          "page_number": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Page Number",
            "description": "PDF page number"
          }
        },
        "type": "object",
        "required": [
          "id",
          "title"
        ],
        "title": "TextbookSection",
        "description": "Section extracted from a textbook."
      },
      "TrendAnalysis": {
        "properties": {
          "pass_rate_trend": {
            "items": {
              "$ref": "#/components/schemas/PassRateTrend"
            },
            "type": "array",
            "title": "Pass Rate Trend",
            "description": "Time-series data for pass rate visualization"
          },
          "weak_concepts_improvement": {
            "items": {
              "$ref": "#/components/schemas/WeakConceptImprovement"
            },
            "type": "array",
            "title": "Weak Concepts Improvement",
            "description": "Weak concept improvement tracking"
          },
          "overall_progress": {
            "$ref": "#/components/schemas/OverallProgress",
            "description": "Overall progress metrics"
          }
        },
        "type": "object",
        "required": [
          "pass_rate_trend",
          "overall_progress"
        ],
        "title": "TrendAnalysis",
        "description": "Trend analysis container.\n\n[Source: specs/api/review-api.openapi.yml#L763-805]"
      },
      "TrendDirection": {
        "type": "string",
        "enum": [
          "up",
          "stable",
          "down"
        ],
        "title": "TrendDirection",
        "description": "Overall progress trend direction.\n\n[Source: specs/api/review-api.openapi.yml#L785-789]"
      },
      "UnmountRequest": {
        "properties": {
          "canvas_path": {
            "type": "string",
            "title": "Canvas Path",
            "description": "Canvas path"
          },
          "textbook_id": {
            "type": "string",
            "title": "Textbook Id",
            "description": "Textbook ID to unmount"
          }
        },
        "type": "object",
        "required": [
          "canvas_path",
          "textbook_id"
        ],
        "title": "UnmountRequest",
        "description": "Request to unmount a textbook."
      },
      "UnmountResponse": {
        "properties": {
          "success": {
            "type": "boolean",
            "title": "Success"
          },
          "message": {
            "type": "string",
            "title": "Message"
          }
        },
        "type": "object",
        "required": [
          "success",
          "message"
        ],
        "title": "UnmountResponse",
        "description": "Response after unmounting textbook."
      },
      "ValidationError": {
        "properties": {
          "loc": {
            "items": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "integer"
                }
              ]
            },
            "type": "array",
            "title": "Location"
          },
          "msg": {
            "type": "string",
            "title": "Message"
          },
          "type": {
            "type": "string",
            "title": "Error Type"
          }
        },
        "type": "object",
        "required": [
          "loc",
          "msg",
          "type"
        ],
        "title": "ValidationError"
      },
      "VerificationHistoryItem": {
        "properties": {
          "question_id": {
            "type": "string",
            "title": "Question Id",
            "description": "Unique question identifier",
            "example": "vq_abc123"
          },
          "question_text": {
            "type": "string",
            "title": "Question Text",
            "description": "The verification question content",
            "example": "请解释什么是「逆否命题」？"
          },
          "question_type": {
            "$ref": "#/components/schemas/QuestionType",
            "description": "Question angle type (standard, application, comparison, etc.)",
            "default": "standard"
          },
          "user_answer": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "User Answer",
            "description": "User's answer to the question (if answered)"
          },
          "score": {
            "anyOf": [
              {
                "type": "integer",
                "maximum": 100.0,
                "minimum": 0.0
              },
              {
                "type": "null"
              }
            ],
            "title": "Score",
            "description": "Score for the answer (0-100, if evaluated)",
            "example": 75
          },
          "canvas_name": {
            "type": "string",
            "title": "Canvas Name",
            "description": "Source canvas name",
            "example": "离散数学"
          },
          "asked_at": {
            "type": "string",
            "format": "date-time",
            "title": "Asked At",
            "description": "Timestamp when the question was asked",
            "example": "2025-01-15T10:30:00Z"
          }
        },
        "type": "object",
        "required": [
          "question_id",
          "question_text",
          "canvas_name",
          "asked_at"
        ],
        "title": "VerificationHistoryItem",
        "description": "Single verification question history record.\n\nStory 31.4 AC-31.4.4: History data includes question, answer, score, timestamp.\n\n[Source: specs/data/verification-history-response.schema.json#L48-86]\n[Source: specs/api/review-api.openapi.yml#/verification/history/{concept}]"
      },
      "VerificationHistoryResponse": {
        "properties": {
          "concept": {
            "type": "string",
            "title": "Concept",
            "description": "The concept being queried",
            "example": "逆否命题"
          },
          "total_count": {
            "type": "integer",
            "minimum": 0.0,
            "title": "Total Count",
            "description": "Total number of history records",
            "example": 5
          },
          "items": {
            "items": {
              "$ref": "#/components/schemas/VerificationHistoryItem"
            },
            "type": "array",
            "title": "Items",
            "description": "List of verification history records"
          },
          "pagination": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/PaginationInfo"
              },
              {
                "type": "null"
              }
            ],
            "description": "Pagination metadata (included when paginated)"
          }
        },
        "type": "object",
        "required": [
          "concept",
          "total_count",
          "items"
        ],
        "title": "VerificationHistoryResponse",
        "description": "Verification question history response.\n\nStory 31.4 AC-31.4.3: New GET /verification/history/{concept} endpoint.\nStory 31.4 AC-31.4.4: Returns question, answer, score, timestamp for each record.\n\n[Source: specs/data/verification-history-response.schema.json]\n[Source: specs/api/review-api.openapi.yml#/verification/history/{concept}]\n[Source: docs/stories/31.4.story.md#Task-4]"
      },
      "VerificationQuestion": {
        "properties": {
          "source_node_id": {
            "type": "string",
            "title": "Source Node Id",
            "description": "Source node ID this question refers to"
          },
          "question_text": {
            "type": "string",
            "title": "Question Text",
            "description": "The verification question text"
          },
          "question_type": {
            "type": "string",
            "title": "Question Type",
            "description": "Question type: 突破型/检验型/应用型/综合型"
          },
          "difficulty": {
            "type": "string",
            "title": "Difficulty",
            "description": "Difficulty level: 基础/深度"
          },
          "guidance": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Guidance",
            "description": "Optional hint starting with 💡"
          },
          "rationale": {
            "type": "string",
            "title": "Rationale",
            "description": "Why this question was generated"
          }
        },
        "type": "object",
        "required": [
          "source_node_id",
          "question_text",
          "question_type",
          "difficulty",
          "rationale"
        ],
        "title": "VerificationQuestion",
        "description": "Single verification question item.\n\n[Source: .claude/agents/verification-question-agent.md#Output-Format]"
      },
      "VerificationQuestionRequest": {
        "properties": {
          "canvas_name": {
            "type": "string",
            "title": "Canvas Name",
            "description": "Canvas file name"
          },
          "node_id": {
            "type": "string",
            "title": "Node Id",
            "description": "Target node ID"
          }
        },
        "type": "object",
        "required": [
          "canvas_name",
          "node_id"
        ],
        "title": "VerificationQuestionRequest",
        "description": "Request model for generating verification questions.\n\n[Source: docs/stories/story-12.A.6-complete-agents.md#AC1]\n[Source: .claude/agents/verification-question-agent.md]"
      },
      "VerificationQuestionResponse": {
        "properties": {
          "questions": {
            "items": {
              "$ref": "#/components/schemas/VerificationQuestion"
            },
            "type": "array",
            "title": "Questions",
            "description": "Generated verification questions"
          },
          "concept": {
            "type": "string",
            "title": "Concept",
            "description": "The concept being verified"
          },
          "generated_at": {
            "type": "string",
            "format": "date-time",
            "title": "Generated At",
            "description": "Generation timestamp"
          },
          "created_nodes": {
            "items": {
              "$ref": "#/components/schemas/NodeRead"
            },
            "type": "array",
            "title": "Created Nodes",
            "description": "Created question nodes on Canvas"
          }
        },
        "type": "object",
        "required": [
          "questions",
          "concept",
          "generated_at"
        ],
        "title": "VerificationQuestionResponse",
        "description": "Response model for verification question generation.\n\n[Source: docs/stories/story-12.A.6-complete-agents.md#AC1]\n[Source: .claude/agents/verification-question-agent.md#Output-Format]"
      },
      "VerificationStatusEnum": {
        "type": "string",
        "enum": [
          "pending",
          "in_progress",
          "paused",
          "completed",
          "cancelled"
        ],
        "title": "VerificationStatusEnum",
        "description": "Verification session status.\n\nStory 31.6 AC-31.6.4: Support pause/resume session.\n\n[Source: backend/app/services/verification_service.py:VerificationStatus]"
      },
      "WeakConceptData": {
        "properties": {
          "concept_name": {
            "type": "string",
            "title": "Concept Name",
            "description": "Name of the weak concept"
          },
          "weakness_score": {
            "type": "number",
            "maximum": 1.0,
            "minimum": 0.0,
            "title": "Weakness Score",
            "description": "Calculated weakness score"
          },
          "failure_count": {
            "type": "integer",
            "minimum": 0.0,
            "title": "Failure Count",
            "description": "Historical failure count"
          },
          "avg_rating": {
            "type": "number",
            "maximum": 4.0,
            "minimum": 0.0,
            "title": "Avg Rating",
            "description": "Average review rating"
          }
        },
        "type": "object",
        "required": [
          "concept_name",
          "weakness_score",
          "failure_count",
          "avg_rating"
        ],
        "title": "WeakConceptData",
        "description": "Data for a weak concept in targeted review.\n\n[Source: Story 24.3 - Weight Algorithm Implementation]"
      },
      "WeakConceptImprovement": {
        "properties": {
          "concept_name": {
            "type": "string",
            "title": "Concept Name",
            "description": "Name of the concept",
            "example": "逆否命题"
          },
          "improvement_rate": {
            "type": "number",
            "maximum": 1.0,
            "minimum": 0.0,
            "title": "Improvement Rate",
            "description": "Improvement rate (0-1 scale)",
            "example": 0.4
          },
          "current_status": {
            "$ref": "#/components/schemas/ConceptStatus",
            "description": "Current mastery status"
          }
        },
        "type": "object",
        "required": [
          "concept_name",
          "improvement_rate",
          "current_status"
        ],
        "title": "WeakConceptImprovement",
        "description": "Improvement tracking for a weak concept.\n\n[Source: specs/api/review-api.openapi.yml#L771-780]"
      },
      "WeakConceptItem": {
        "properties": {
          "concept": {
            "type": "string",
            "title": "Concept",
            "description": "概念名称"
          },
          "stability": {
            "type": "number",
            "title": "Stability",
            "description": "稳定性分数 (0-1)"
          },
          "last_review": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Last Review",
            "description": "上次复习时间"
          },
          "review_count": {
            "type": "integer",
            "title": "Review Count",
            "description": "复习次数",
            "default": 0
          }
        },
        "type": "object",
        "required": [
          "concept",
          "stability"
        ],
        "title": "WeakConceptItem",
        "description": "薄弱概念项"
      },
      "WeakConceptsResponse": {
        "properties": {
          "concepts": {
            "items": {
              "$ref": "#/components/schemas/WeakConceptItem"
            },
            "type": "array",
            "title": "Concepts",
            "description": "薄弱概念列表"
          },
          "total_count": {
            "type": "integer",
            "title": "Total Count",
            "description": "总数量",
            "default": 0
          },
          "canvas_file": {
            "type": "string",
            "title": "Canvas File",
            "description": "Canvas 文件"
          }
        },
        "type": "object",
        "required": [
          "canvas_file"
        ],
        "title": "WeakConceptsResponse",
        "description": "薄弱概念响应"
      },
      "WeightConfig": {
        "properties": {
          "weak_weight": {
            "type": "number",
            "maximum": 1.0,
            "minimum": 0.0,
            "title": "Weak Weight",
            "description": "Weight for weak concepts"
          },
          "mastered_weight": {
            "type": "number",
            "maximum": 1.0,
            "minimum": 0.0,
            "title": "Mastered Weight",
            "description": "Weight for mastered concepts"
          },
          "applied": {
            "type": "boolean",
            "title": "Applied",
            "description": "Whether weights were applied"
          }
        },
        "type": "object",
        "required": [
          "weak_weight",
          "mastered_weight",
          "applied"
        ],
        "title": "WeightConfig",
        "description": "Weight configuration for targeted review.\n\n[Source: Story 24.3 - Weight Algorithm Implementation]"
      },
      "app__api__v1__endpoints__monitoring__AgentMetricsSummary": {
        "properties": {
          "invocations_total": {
            "type": "integer",
            "title": "Invocations Total",
            "description": "Total agent invocations"
          },
          "avg_execution_time_s": {
            "type": "number",
            "title": "Avg Execution Time S",
            "description": "Average execution time"
          },
          "by_type": {
            "items": {
              "$ref": "#/components/schemas/AgentTypeSummary"
            },
            "type": "array",
            "title": "By Type",
            "description": "Breakdown by agent type"
          }
        },
        "type": "object",
        "required": [
          "invocations_total",
          "avg_execution_time_s"
        ],
        "title": "AgentMetricsSummary",
        "description": "Agent metrics summary.\n\n[Source: specs/api/canvas-api.openapi.yml:1001-1020]"
      },
      "app__models__common__AgentMetricsSummary": {
        "properties": {
          "invocations_total": {
            "type": "integer",
            "title": "Invocations Total",
            "description": "Total agent invocations"
          },
          "avg_execution_time_s": {
            "type": "number",
            "title": "Avg Execution Time S",
            "description": "Average execution time in seconds"
          },
          "by_type": {
            "additionalProperties": {
              "$ref": "#/components/schemas/AgentTypeStats"
            },
            "type": "object",
            "title": "By Type",
            "description": "Statistics by agent type"
          }
        },
        "type": "object",
        "required": [
          "invocations_total",
          "avg_execution_time_s"
        ],
        "title": "AgentMetricsSummary",
        "description": "Agent metrics summary.\n\n[Source: specs/api/canvas-api.openapi.yml:987-1060]"
      }
    }
  }
}