{"bug_id":"BUG-8EB07F80","timestamp":"2025-12-14T10:35:20.661523Z","endpoint":"/test","error_type":"ValueError","error_message":"Test error","request_params":{"path":"/test"},"stack_trace":"NoneType: None\n","user_action":null}
{"bug_id":"BUG-2A44CB0C","timestamp":"2025-12-14T10:37:25.745206Z","endpoint":"/api/v1/canvas/u·~򇉢\u000e»-叭Ô'Îu/nodes/verification","error_type":"ValidationError","error_message":"1 validation error for NodeRead\nid\n  String should match pattern '^[a-f0-9]+$' [type=string_pattern_mismatch, input_value='verification', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/string_pattern_mismatch","request_params":{"path":"/api/v1/canvas/u·~򇉢\u000e»-叭Ô'Îu/nodes/verification","method":"PUT","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\canvas.py\", line 114, in update_node\n    return NodeRead(\n           ^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\pydantic\\main.py\", line 250, in __init__\n    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\npydantic_core._pydantic_core.ValidationError: 1 validation error for NodeRead\nid\n  String should match pattern '^[a-f0-9]+$' [type=string_pattern_mismatch, input_value='verification', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/string_pattern_mismatch\n","user_action":null}
{"bug_id":"BUG-E5B6A24D","timestamp":"2025-12-14T10:37:29.171089Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-3F175B47","timestamp":"2025-12-14T10:37:29.216512Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-60F294B7","timestamp":"2025-12-14T10:37:29.304142Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: purple_count' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: purple_count' not found\n","user_action":null}
{"bug_id":"BUG-32083D75","timestamp":"2025-12-14T10:37:29.354101Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: üòª? 򃺵D\u0012' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: üòª? 򃺵D\u0012' not found\n","user_action":null}
{"bug_id":"BUG-2CF71B05","timestamp":"2025-12-14T10:37:29.503837Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: 񉯪Ë\u001fÎ𽨚򃢻RWWXß򓞵#®뒫Ë×&8#ö®\u0018򭃰熆񠭹,\u00067\u0014à\u0005!冃!Ï􋅰' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: 񉯪Ë\u001fÎ𽨚򃢻RWWXß򓞵#®뒫Ë×&8#ö®\u0018򭃰熆񠭹,\u00067\u0014à\u0005!冃!Ï􋅰' not found\n","user_action":null}
{"bug_id":"BUG-FA692280","timestamp":"2025-12-14T10:37:29.565536Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: O-' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: O-' not found\n","user_action":null}
{"bug_id":"BUG-F31E3332","timestamp":"2025-12-14T10:37:29.641227Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: C¢' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: C¢' not found\n","user_action":null}
{"bug_id":"BUG-87B9931F","timestamp":"2025-12-14T10:37:30.494758Z","endpoint":"/api/v1/agents/decompose/deep","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/decompose/deep","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 198, in decompose_deep\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-94EDF2B0","timestamp":"2025-12-14T10:37:30.545934Z","endpoint":"/api/v1/agents/decompose/deep","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/decompose/deep","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 198, in decompose_deep\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-5148EE89","timestamp":"2025-12-14T10:37:30.711995Z","endpoint":"/api/v1/agents/decompose/deep","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: _Å\u0007Å£' not found","request_params":{"path":"/api/v1/agents/decompose/deep","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 198, in decompose_deep\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: _Å\u0007Å£' not found\n","user_action":null}
{"bug_id":"BUG-ADBDD319","timestamp":"2025-12-14T10:37:30.849423Z","endpoint":"/api/v1/agents/decompose/deep","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: \"\u0007' not found","request_params":{"path":"/api/v1/agents/decompose/deep","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 198, in decompose_deep\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: \"\u0007' not found\n","user_action":null}
{"bug_id":"BUG-6F6D5D61","timestamp":"2025-12-14T10:37:30.929115Z","endpoint":"/api/v1/agents/decompose/deep","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: èÍ' not found","request_params":{"path":"/api/v1/agents/decompose/deep","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 198, in decompose_deep\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: èÍ' not found\n","user_action":null}
{"bug_id":"BUG-55AA9646","timestamp":"2025-12-14T10:37:31.012006Z","endpoint":"/api/v1/agents/decompose/deep","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: y4¸' not found","request_params":{"path":"/api/v1/agents/decompose/deep","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 198, in decompose_deep\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: y4¸' not found\n","user_action":null}
{"bug_id":"BUG-2612F611","timestamp":"2025-12-14T10:37:32.250246Z","endpoint":"/api/v1/agents/explain/oral","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/oral","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 367, in explain_oral\n    return await _call_explanation(request, \"oral\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-03D916A5","timestamp":"2025-12-14T10:37:32.294729Z","endpoint":"/api/v1/agents/explain/oral","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/oral","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 367, in explain_oral\n    return await _call_explanation(request, \"oral\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-DDF351E6","timestamp":"2025-12-14T10:37:32.491056Z","endpoint":"/api/v1/agents/explain/oral","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ¥򱥺Ü' not found","request_params":{"path":"/api/v1/agents/explain/oral","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 367, in explain_oral\n    return await _call_explanation(request, \"oral\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ¥򱥺Ü' not found\n","user_action":null}
{"bug_id":"BUG-8D363173","timestamp":"2025-12-14T10:37:32.549356Z","endpoint":"/api/v1/agents/explain/oral","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: 󇾸񙸏î0ª񐇽»2' not found","request_params":{"path":"/api/v1/agents/explain/oral","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 367, in explain_oral\n    return await _call_explanation(request, \"oral\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: 󇾸񙸏î0ª񐇽»2' not found\n","user_action":null}
{"bug_id":"BUG-FDBA15F1","timestamp":"2025-12-14T10:37:32.583357Z","endpoint":"/api/v1/agents/explain/oral","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: Y' not found","request_params":{"path":"/api/v1/agents/explain/oral","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 367, in explain_oral\n    return await _call_explanation(request, \"oral\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: Y' not found\n","user_action":null}
{"bug_id":"BUG-5CDC2FF6","timestamp":"2025-12-14T10:37:33.240888Z","endpoint":"/api/v1/agents/explain/clarification","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/clarification","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 391, in explain_clarification\n    return await _call_explanation(request, \"clarification\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-7BCEA501","timestamp":"2025-12-14T10:37:33.283424Z","endpoint":"/api/v1/agents/explain/clarification","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/clarification","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 391, in explain_clarification\n    return await _call_explanation(request, \"clarification\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-0AB22FFE","timestamp":"2025-12-14T10:37:33.394762Z","endpoint":"/api/v1/agents/explain/clarification","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: Ø!*^󑑂' not found","request_params":{"path":"/api/v1/agents/explain/clarification","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 391, in explain_clarification\n    return await _call_explanation(request, \"clarification\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: Ø!*^󑑂' not found\n","user_action":null}
{"bug_id":"BUG-6747D6B3","timestamp":"2025-12-14T10:37:33.436746Z","endpoint":"/api/v1/agents/explain/clarification","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/clarification","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 391, in explain_clarification\n    return await _call_explanation(request, \"clarification\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-52421569","timestamp":"2025-12-14T10:37:33.509436Z","endpoint":"/api/v1/agents/explain/clarification","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/clarification","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 391, in explain_clarification\n    return await _call_explanation(request, \"clarification\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-D56EC3DC","timestamp":"2025-12-14T10:37:33.598943Z","endpoint":"/api/v1/agents/explain/clarification","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/clarification","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 391, in explain_clarification\n    return await _call_explanation(request, \"clarification\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-A26E6363","timestamp":"2025-12-14T10:37:33.656613Z","endpoint":"/api/v1/agents/explain/clarification","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ã\bæê' not found","request_params":{"path":"/api/v1/agents/explain/clarification","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 391, in explain_clarification\n    return await _call_explanation(request, \"clarification\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ã\bæê' not found\n","user_action":null}
{"bug_id":"BUG-033848D1","timestamp":"2025-12-14T10:37:34.316528Z","endpoint":"/api/v1/agents/explain/comparison","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/comparison","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 415, in explain_comparison\n    return await _call_explanation(request, \"comparison\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-D7FB832B","timestamp":"2025-12-14T10:37:34.362979Z","endpoint":"/api/v1/agents/explain/comparison","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/comparison","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 415, in explain_comparison\n    return await _call_explanation(request, \"comparison\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-D8131204","timestamp":"2025-12-14T10:37:34.506949Z","endpoint":"/api/v1/agents/explain/comparison","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/comparison","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 415, in explain_comparison\n    return await _call_explanation(request, \"comparison\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-D9535DFD","timestamp":"2025-12-14T10:37:34.624550Z","endpoint":"/api/v1/agents/explain/comparison","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ù' not found","request_params":{"path":"/api/v1/agents/explain/comparison","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 415, in explain_comparison\n    return await _call_explanation(request, \"comparison\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ù' not found\n","user_action":null}
{"bug_id":"BUG-56CD995B","timestamp":"2025-12-14T10:37:34.661858Z","endpoint":"/api/v1/agents/explain/comparison","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ·`f_Ü󿺪󡩷񝕉{9𔞿¡' not found","request_params":{"path":"/api/v1/agents/explain/comparison","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 415, in explain_comparison\n    return await _call_explanation(request, \"comparison\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ·`f_Ü󿺪󡩷񝕉{9𔞿¡' not found\n","user_action":null}
{"bug_id":"BUG-FD70D955","timestamp":"2025-12-14T10:37:34.769718Z","endpoint":"/api/v1/agents/explain/comparison","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ca' not found","request_params":{"path":"/api/v1/agents/explain/comparison","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 415, in explain_comparison\n    return await _call_explanation(request, \"comparison\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ca' not found\n","user_action":null}
{"bug_id":"BUG-554E0701","timestamp":"2025-12-14T10:37:35.387043Z","endpoint":"/api/v1/agents/explain/memory","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/memory","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 439, in explain_memory\n    return await _call_explanation(request, \"memory\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-7C98C5E8","timestamp":"2025-12-14T10:37:35.429107Z","endpoint":"/api/v1/agents/explain/memory","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/memory","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 439, in explain_memory\n    return await _call_explanation(request, \"memory\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-06EC4939","timestamp":"2025-12-14T10:37:35.600191Z","endpoint":"/api/v1/agents/explain/memory","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: 򜄯' not found","request_params":{"path":"/api/v1/agents/explain/memory","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 439, in explain_memory\n    return await _call_explanation(request, \"memory\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: 򜄯' not found\n","user_action":null}
{"bug_id":"BUG-D4B84A95","timestamp":"2025-12-14T10:37:35.653705Z","endpoint":"/api/v1/agents/explain/memory","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: 𮤥\u0005' not found","request_params":{"path":"/api/v1/agents/explain/memory","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 439, in explain_memory\n    return await _call_explanation(request, \"memory\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: 𮤥\u0005' not found\n","user_action":null}
{"bug_id":"BUG-26D57700","timestamp":"2025-12-14T10:37:35.837349Z","endpoint":"/api/v1/agents/explain/memory","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: R' not found","request_params":{"path":"/api/v1/agents/explain/memory","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 439, in explain_memory\n    return await _call_explanation(request, \"memory\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: R' not found\n","user_action":null}
{"bug_id":"BUG-A18D5898","timestamp":"2025-12-14T10:37:36.448310Z","endpoint":"/api/v1/agents/explain/four-level","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/four-level","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 463, in explain_four_level\n    return await _call_explanation(request, \"four-level\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-48132C93","timestamp":"2025-12-14T10:37:36.500250Z","endpoint":"/api/v1/agents/explain/four-level","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/four-level","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 463, in explain_four_level\n    return await _call_explanation(request, \"four-level\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-626AC058","timestamp":"2025-12-14T10:37:36.674931Z","endpoint":"/api/v1/agents/explain/four-level","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: Ü𑂞W' not found","request_params":{"path":"/api/v1/agents/explain/four-level","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 463, in explain_four_level\n    return await _call_explanation(request, \"four-level\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: Ü𑂞W' not found\n","user_action":null}
{"bug_id":"BUG-3BFC47A4","timestamp":"2025-12-14T10:37:36.761753Z","endpoint":"/api/v1/agents/explain/four-level","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: 쥏' not found","request_params":{"path":"/api/v1/agents/explain/four-level","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 463, in explain_four_level\n    return await _call_explanation(request, \"four-level\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: 쥏' not found\n","user_action":null}
{"bug_id":"BUG-2EB59063","timestamp":"2025-12-14T10:37:36.840853Z","endpoint":"/api/v1/agents/explain/four-level","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: \u0014򆐂§' not found","request_params":{"path":"/api/v1/agents/explain/four-level","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 463, in explain_four_level\n    return await _call_explanation(request, \"four-level\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: \u0014򆐂§' not found\n","user_action":null}
{"bug_id":"BUG-4F9F5C5E","timestamp":"2025-12-14T10:37:36.904201Z","endpoint":"/api/v1/agents/explain/four-level","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: 񖽴' not found","request_params":{"path":"/api/v1/agents/explain/four-level","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 463, in explain_four_level\n    return await _call_explanation(request, \"four-level\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: 񖽴' not found\n","user_action":null}
{"bug_id":"BUG-27EC41AF","timestamp":"2025-12-14T10:37:36.985023Z","endpoint":"/api/v1/agents/explain/four-level","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/four-level","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 463, in explain_four_level\n    return await _call_explanation(request, \"four-level\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-C178572C","timestamp":"2025-12-14T10:37:37.553126Z","endpoint":"/api/v1/agents/explain/example","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/example","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 487, in explain_example\n    return await _call_explanation(request, \"example\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-401BA313","timestamp":"2025-12-14T10:37:37.603146Z","endpoint":"/api/v1/agents/explain/example","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/example","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 487, in explain_example\n    return await _call_explanation(request, \"example\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-C097F2C1","timestamp":"2025-12-14T10:37:37.804213Z","endpoint":"/api/v1/agents/explain/example","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ´ 񖧶ém\u0018ãN:>򟺐Ç' not found","request_params":{"path":"/api/v1/agents/explain/example","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 487, in explain_example\n    return await _call_explanation(request, \"example\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ´ 񖧶ém\u0018ãN:>򟺐Ç' not found\n","user_action":null}
{"bug_id":"BUG-CE162462","timestamp":"2025-12-14T10:37:37.846242Z","endpoint":"/api/v1/agents/explain/example","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ¯' not found","request_params":{"path":"/api/v1/agents/explain/example","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 487, in explain_example\n    return await _call_explanation(request, \"example\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ¯' not found\n","user_action":null}
{"bug_id":"BUG-562DF06F","timestamp":"2025-12-14T10:37:38.000240Z","endpoint":"/api/v1/agents/explain/example","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: 򖏎󤼻' not found","request_params":{"path":"/api/v1/agents/explain/example","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 487, in explain_example\n    return await _call_explanation(request, \"example\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: 򖏎󤼻' not found\n","user_action":null}
{"bug_id":"BUG-CD5DF83E","timestamp":"2025-12-14T10:37:41.892381Z","endpoint":"/api/v1/review/progress/multi/0","error_type":"TypeError","error_message":"get_review_service() missing 2 required positional arguments: 'canvas_service' and 'task_manager'","request_params":{"path":"/api/v1/review/progress/multi/0","method":"GET","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 111, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 104, in receive_nowait\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\review.py\", line 511, in get_multi_review_progress\n    review_service = get_review_service()\n                     ^^^^^^^^^^^^^^^^^^^^\nTypeError: get_review_service() missing 2 required positional arguments: 'canvas_service' and 'task_manager'\n","user_action":null}
{"bug_id":"BUG-70CA1BB8","timestamp":"2025-12-14T10:37:45.876215Z","endpoint":"/api/v1/rollback/snapshot","error_type":"PermissionError","error_message":"[Errno 13] Permission denied: '.'","request_params":{"path":"/api/v1/rollback/snapshot","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\rollback.py\", line 350, in create_snapshot\n    snapshot = await manager.create_snapshot(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 143, in create_snapshot\n    canvas_data = await self._read_canvas(canvas_path)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 113, in _read_canvas\n    data = path.read_bytes()\n           ^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1019, in read_bytes\n    with self.open(mode='rb') as f:\n         ^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1013, in open\n    return io.open(self, mode, buffering, encoding, errors, newline)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nPermissionError: [Errno 13] Permission denied: '.'\n","user_action":null}
{"bug_id":"BUG-6985D15E","timestamp":"2025-12-14T10:37:45.915924Z","endpoint":"/api/v1/rollback/snapshot","error_type":"PermissionError","error_message":"[Errno 13] Permission denied: '.'","request_params":{"path":"/api/v1/rollback/snapshot","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\rollback.py\", line 350, in create_snapshot\n    snapshot = await manager.create_snapshot(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 143, in create_snapshot\n    canvas_data = await self._read_canvas(canvas_path)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 113, in _read_canvas\n    data = path.read_bytes()\n           ^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1019, in read_bytes\n    with self.open(mode='rb') as f:\n         ^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1013, in open\n    return io.open(self, mode, buffering, encoding, errors, newline)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nPermissionError: [Errno 13] Permission denied: '.'\n","user_action":null}
{"bug_id":"BUG-1CE642F5","timestamp":"2025-12-14T10:37:45.943119Z","endpoint":"/api/v1/rollback/snapshot","error_type":"PermissionError","error_message":"[Errno 13] Permission denied: '.'","request_params":{"path":"/api/v1/rollback/snapshot","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\rollback.py\", line 350, in create_snapshot\n    snapshot = await manager.create_snapshot(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 143, in create_snapshot\n    canvas_data = await self._read_canvas(canvas_path)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 113, in _read_canvas\n    data = path.read_bytes()\n           ^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1019, in read_bytes\n    with self.open(mode='rb') as f:\n         ^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1013, in open\n    return io.open(self, mode, buffering, encoding, errors, newline)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nPermissionError: [Errno 13] Permission denied: '.'\n","user_action":null}
{"bug_id":"BUG-29D5979B","timestamp":"2025-12-14T10:37:45.975757Z","endpoint":"/api/v1/rollback/snapshot","error_type":"PermissionError","error_message":"[Errno 13] Permission denied: '.'","request_params":{"path":"/api/v1/rollback/snapshot","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\rollback.py\", line 350, in create_snapshot\n    snapshot = await manager.create_snapshot(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 143, in create_snapshot\n    canvas_data = await self._read_canvas(canvas_path)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 113, in _read_canvas\n    data = path.read_bytes()\n           ^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1019, in read_bytes\n    with self.open(mode='rb') as f:\n         ^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1013, in open\n    return io.open(self, mode, buffering, encoding, errors, newline)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nPermissionError: [Errno 13] Permission denied: '.'\n","user_action":null}
{"bug_id":"BUG-608E15E9","timestamp":"2025-12-14T10:37:46.003911Z","endpoint":"/api/v1/rollback/snapshot","error_type":"PermissionError","error_message":"[Errno 13] Permission denied: '.'","request_params":{"path":"/api/v1/rollback/snapshot","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\rollback.py\", line 350, in create_snapshot\n    snapshot = await manager.create_snapshot(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 143, in create_snapshot\n    canvas_data = await self._read_canvas(canvas_path)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 113, in _read_canvas\n    data = path.read_bytes()\n           ^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1019, in read_bytes\n    with self.open(mode='rb') as f:\n         ^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1013, in open\n    return io.open(self, mode, buffering, encoding, errors, newline)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nPermissionError: [Errno 13] Permission denied: '.'\n","user_action":null}
{"bug_id":"BUG-3E957195","timestamp":"2025-12-14T10:37:46.029264Z","endpoint":"/api/v1/rollback/snapshot","error_type":"PermissionError","error_message":"[Errno 13] Permission denied: '.'","request_params":{"path":"/api/v1/rollback/snapshot","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\rollback.py\", line 350, in create_snapshot\n    snapshot = await manager.create_snapshot(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 143, in create_snapshot\n    canvas_data = await self._read_canvas(canvas_path)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 113, in _read_canvas\n    data = path.read_bytes()\n           ^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1019, in read_bytes\n    with self.open(mode='rb') as f:\n         ^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1013, in open\n    return io.open(self, mode, buffering, encoding, errors, newline)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nPermissionError: [Errno 13] Permission denied: '.'\n","user_action":null}
{"bug_id":"BUG-02916198","timestamp":"2025-12-14T10:37:46.061815Z","endpoint":"/api/v1/rollback/snapshot","error_type":"PermissionError","error_message":"[Errno 13] Permission denied: '.'","request_params":{"path":"/api/v1/rollback/snapshot","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\rollback.py\", line 350, in create_snapshot\n    snapshot = await manager.create_snapshot(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 143, in create_snapshot\n    canvas_data = await self._read_canvas(canvas_path)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 113, in _read_canvas\n    data = path.read_bytes()\n           ^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1019, in read_bytes\n    with self.open(mode='rb') as f:\n         ^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1013, in open\n    return io.open(self, mode, buffering, encoding, errors, newline)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nPermissionError: [Errno 13] Permission denied: '.'\n","user_action":null}
{"bug_id":"BUG-A1999B08","timestamp":"2025-12-14T10:37:46.097464Z","endpoint":"/api/v1/rollback/snapshot","error_type":"PermissionError","error_message":"[Errno 13] Permission denied: '.'","request_params":{"path":"/api/v1/rollback/snapshot","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\rollback.py\", line 350, in create_snapshot\n    snapshot = await manager.create_snapshot(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 143, in create_snapshot\n    canvas_data = await self._read_canvas(canvas_path)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 113, in _read_canvas\n    data = path.read_bytes()\n           ^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1019, in read_bytes\n    with self.open(mode='rb') as f:\n         ^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1013, in open\n    return io.open(self, mode, buffering, encoding, errors, newline)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nPermissionError: [Errno 13] Permission denied: '.'\n","user_action":null}
{"bug_id":"BUG-7F10F379","timestamp":"2025-12-14T10:39:37.553498Z","endpoint":"/api/v1/canvas/úO=f\u000f1¤`;/nodes/򽁩򻂷»Qe^\u0010\fY􆃣","error_type":"ValidationError","error_message":"1 validation error for NodeRead\nid\n  String should match pattern '^[a-f0-9]+$' [type=string_pattern_mismatch, input_value='\\U000bd069\\U000bb0b7»Qe^\\x10\\t\\x0cY\\U001060e3', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/string_pattern_mismatch","request_params":{"path":"/api/v1/canvas/úO=f\u000f1¤`;/nodes/򽁩򻂷»Qe^\u0010\fY􆃣","method":"PUT","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\canvas.py\", line 114, in update_node\n    return NodeRead(\n           ^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\pydantic\\main.py\", line 250, in __init__\n    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\npydantic_core._pydantic_core.ValidationError: 1 validation error for NodeRead\nid\n  String should match pattern '^[a-f0-9]+$' [type=string_pattern_mismatch, input_value='\\U000bd069\\U000bb0b7»Qe^\\x10\\t\\x0cY\\U001060e3', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/string_pattern_mismatch\n","user_action":null}
{"bug_id":"BUG-50BDBAF8","timestamp":"2025-12-14T10:39:40.770086Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-07646604","timestamp":"2025-12-14T10:39:40.821026Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-AD974AD3","timestamp":"2025-12-14T10:39:41.013069Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: 30ß򌲩' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: 30ß򌲩' not found\n","user_action":null}
{"bug_id":"BUG-DD151A8E","timestamp":"2025-12-14T10:39:41.049991Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: \u000bëÛhb󂁟>\u0017kZ}óÑ󻦡򝝼-qL򳲦𒁂𧈍q\u000f' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: \u000bëÛhb󂁟>\u0017kZ}óÑ󻦡򝝼-qL򳲦𒁂𧈍q\u000f' not found\n","user_action":null}
{"bug_id":"BUG-F4922745","timestamp":"2025-12-14T10:39:41.824237Z","endpoint":"/api/v1/agents/decompose/deep","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/decompose/deep","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 198, in decompose_deep\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-EBF90C05","timestamp":"2025-12-14T10:39:41.870957Z","endpoint":"/api/v1/agents/decompose/deep","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/decompose/deep","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 198, in decompose_deep\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-2C75381D","timestamp":"2025-12-14T10:39:41.989969Z","endpoint":"/api/v1/agents/decompose/deep","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: \u0003򕫣÷CEDäzÂ' not found","request_params":{"path":"/api/v1/agents/decompose/deep","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 198, in decompose_deep\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: \u0003򕫣÷CEDäzÂ' not found\n","user_action":null}
{"bug_id":"BUG-A284B498","timestamp":"2025-12-14T10:39:42.036326Z","endpoint":"/api/v1/agents/decompose/deep","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: level' not found","request_params":{"path":"/api/v1/agents/decompose/deep","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 198, in decompose_deep\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: level' not found\n","user_action":null}
{"bug_id":"BUG-C4BF4677","timestamp":"2025-12-14T10:39:42.127607Z","endpoint":"/api/v1/agents/decompose/deep","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/decompose/deep","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 198, in decompose_deep\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-D8D064EA","timestamp":"2025-12-14T10:39:42.204628Z","endpoint":"/api/v1/agents/decompose/deep","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: l򭃾' not found","request_params":{"path":"/api/v1/agents/decompose/deep","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 198, in decompose_deep\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: l򭃾' not found\n","user_action":null}
{"bug_id":"BUG-90290FA5","timestamp":"2025-12-14T10:39:42.326760Z","endpoint":"/api/v1/agents/decompose/deep","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: 9' not found","request_params":{"path":"/api/v1/agents/decompose/deep","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 198, in decompose_deep\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: 9' not found\n","user_action":null}
{"bug_id":"BUG-2EB6BF6A","timestamp":"2025-12-14T10:39:43.587070Z","endpoint":"/api/v1/agents/explain/oral","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/oral","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 367, in explain_oral\n    return await _call_explanation(request, \"oral\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-C4690876","timestamp":"2025-12-14T10:39:43.632721Z","endpoint":"/api/v1/agents/explain/oral","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/oral","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 367, in explain_oral\n    return await _call_explanation(request, \"oral\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-1AAA2DC3","timestamp":"2025-12-14T10:39:43.766390Z","endpoint":"/api/v1/agents/explain/oral","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ÷\u0012!𧔙' not found","request_params":{"path":"/api/v1/agents/explain/oral","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 367, in explain_oral\n    return await _call_explanation(request, \"oral\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ÷\u0012!𧔙' not found\n","user_action":null}
{"bug_id":"BUG-B3308BA2","timestamp":"2025-12-14T10:39:43.800045Z","endpoint":"/api/v1/agents/explain/oral","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ꌽ7𞚫PhÝ' not found","request_params":{"path":"/api/v1/agents/explain/oral","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 367, in explain_oral\n    return await _call_explanation(request, \"oral\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ꌽ7𞚫PhÝ' not found\n","user_action":null}
{"bug_id":"BUG-AD5B78BE","timestamp":"2025-12-14T10:39:43.850122Z","endpoint":"/api/v1/agents/explain/oral","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/oral","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 367, in explain_oral\n    return await _call_explanation(request, \"oral\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-15C0B329","timestamp":"2025-12-14T10:39:43.932615Z","endpoint":"/api/v1/agents/explain/oral","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ø􆓃RÔ\u0014zD' not found","request_params":{"path":"/api/v1/agents/explain/oral","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 367, in explain_oral\n    return await _call_explanation(request, \"oral\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ø􆓃RÔ\u0014zD' not found\n","user_action":null}
{"bug_id":"BUG-FF82810B","timestamp":"2025-12-14T10:39:44.277990Z","endpoint":"/api/v1/agents/explain/oral","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/oral","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 367, in explain_oral\n    return await _call_explanation(request, \"oral\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-777248F9","timestamp":"2025-12-14T10:39:44.858390Z","endpoint":"/api/v1/agents/explain/clarification","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/clarification","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 391, in explain_clarification\n    return await _call_explanation(request, \"clarification\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-A42B5DF3","timestamp":"2025-12-14T10:39:44.896294Z","endpoint":"/api/v1/agents/explain/clarification","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/clarification","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 391, in explain_clarification\n    return await _call_explanation(request, \"clarification\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-DA12F269","timestamp":"2025-12-14T10:39:44.994832Z","endpoint":"/api/v1/agents/explain/clarification","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: 2025-12-03T10:30:00Z' not found","request_params":{"path":"/api/v1/agents/explain/clarification","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 391, in explain_clarification\n    return await _call_explanation(request, \"clarification\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: 2025-12-03T10:30:00Z' not found\n","user_action":null}
{"bug_id":"BUG-48EE43F2","timestamp":"2025-12-14T10:39:45.040656Z","endpoint":"/api/v1/agents/explain/clarification","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: 2󘂫򗻋@' not found","request_params":{"path":"/api/v1/agents/explain/clarification","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 391, in explain_clarification\n    return await _call_explanation(request, \"clarification\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: 2󘂫򗻋@' not found\n","user_action":null}
{"bug_id":"BUG-B1EDFA3C","timestamp":"2025-12-14T10:39:45.180411Z","endpoint":"/api/v1/agents/explain/clarification","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: \u0006y' not found","request_params":{"path":"/api/v1/agents/explain/clarification","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 391, in explain_clarification\n    return await _call_explanation(request, \"clarification\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: \u0006y' not found\n","user_action":null}
{"bug_id":"BUG-E5FAAE3A","timestamp":"2025-12-14T10:39:45.349303Z","endpoint":"/api/v1/agents/explain/clarification","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ?' not found","request_params":{"path":"/api/v1/agents/explain/clarification","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 391, in explain_clarification\n    return await _call_explanation(request, \"clarification\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ?' not found\n","user_action":null}
{"bug_id":"BUG-B61DD5E5","timestamp":"2025-12-14T10:39:45.937427Z","endpoint":"/api/v1/agents/explain/comparison","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/comparison","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 415, in explain_comparison\n    return await _call_explanation(request, \"comparison\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-9B720EB1","timestamp":"2025-12-14T10:39:45.991044Z","endpoint":"/api/v1/agents/explain/comparison","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/comparison","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 415, in explain_comparison\n    return await _call_explanation(request, \"comparison\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-4CD072C5","timestamp":"2025-12-14T10:39:46.107183Z","endpoint":"/api/v1/agents/explain/comparison","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ª$\u0004񩖠:򽼜Az\u001e񀝈' not found","request_params":{"path":"/api/v1/agents/explain/comparison","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 415, in explain_comparison\n    return await _call_explanation(request, \"comparison\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ª$\u0004񩖠:򽼜Az\u001e񀝈' not found\n","user_action":null}
{"bug_id":"BUG-D6B6BFC5","timestamp":"2025-12-14T10:39:46.283793Z","endpoint":"/api/v1/agents/explain/comparison","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: õ.´' not found","request_params":{"path":"/api/v1/agents/explain/comparison","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 415, in explain_comparison\n    return await _call_explanation(request, \"comparison\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: õ.´' not found\n","user_action":null}
{"bug_id":"BUG-17AC7387","timestamp":"2025-12-14T10:39:46.329847Z","endpoint":"/api/v1/agents/explain/comparison","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/comparison","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 415, in explain_comparison\n    return await _call_explanation(request, \"comparison\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-6041426B","timestamp":"2025-12-14T10:39:46.391984Z","endpoint":"/api/v1/agents/explain/comparison","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: 񕙭V񛻆Øð\u00019' not found","request_params":{"path":"/api/v1/agents/explain/comparison","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 415, in explain_comparison\n    return await _call_explanation(request, \"comparison\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: 񕙭V񛻆Øð\u00019' not found\n","user_action":null}
{"bug_id":"BUG-76CB35A1","timestamp":"2025-12-14T10:39:46.545691Z","endpoint":"/api/v1/agents/explain/comparison","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: Ṱ̺̺̕o͞ ̷i̲̬͇̪͙n̝̗͕v̟̜̘̦͟o̶̙̰̠kè͚̮̺̪̹̱̤ ̖t̝͕̳̣̻̪͞h̼͓̲̦̳̘̲e͇̣̰̦̬͎ ̢̼̻̱̘h͚͎͙̜̣̲ͅi̦̲̣̰̤v̻͍e̺̭̳̪̰-m̢iͅn̖̺̞̲̯̰d̵̼̟͙̩̼̘̳ ̞̥̱̳̭r̛̗̘e͙p͠r̼̞̻̭̗e̺̠̣͟s̘͇̳͍̝͉e͉̥̯̞̲͚̬͜ǹ̬͎͎̟̖͇̤t͍̬̤͓̼̭͘ͅi̪̱n͠g̴͉ ͏͉ͅc̬̟h͡a̫̻̯͘o̫̟̖͍̙̝͉s̗̦̲.̨̹͈̣' not found","request_params":{"path":"/api/v1/agents/explain/comparison","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 415, in explain_comparison\n    return await _call_explanation(request, \"comparison\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: Ṱ̺̺̕o͞ ̷i̲̬͇̪͙n̝̗͕v̟̜̘̦͟o̶̙̰̠kè͚̮̺̪̹̱̤ ̖t̝͕̳̣̻̪͞h̼͓̲̦̳̘̲e͇̣̰̦̬͎ ̢̼̻̱̘h͚͎͙̜̣̲ͅi̦̲̣̰̤v̻͍e̺̭̳̪̰-m̢iͅn̖̺̞̲̯̰d̵̼̟͙̩̼̘̳ ̞̥̱̳̭r̛̗̘e͙p͠r̼̞̻̭̗e̺̠̣͟s̘͇̳͍̝͉e͉̥̯̞̲͚̬͜ǹ̬͎͎̟̖͇̤t͍̬̤͓̼̭͘ͅi̪̱n͠g̴͉ ͏͉ͅc̬̟h͡a̫̻̯͘o̫̟̖͍̙̝͉s̗̦̲.̨̹͈̣' not found\n","user_action":null}
{"bug_id":"BUG-C2E21425","timestamp":"2025-12-14T10:39:47.119993Z","endpoint":"/api/v1/agents/explain/memory","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/memory","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 439, in explain_memory\n    return await _call_explanation(request, \"memory\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-B0E1973A","timestamp":"2025-12-14T10:39:47.170343Z","endpoint":"/api/v1/agents/explain/memory","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/memory","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 439, in explain_memory\n    return await _call_explanation(request, \"memory\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-CF1658FD","timestamp":"2025-12-14T10:39:47.312361Z","endpoint":"/api/v1/agents/explain/memory","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: 򅞂\u000e񿕊Ð' not found","request_params":{"path":"/api/v1/agents/explain/memory","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 439, in explain_memory\n    return await _call_explanation(request, \"memory\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: 򅞂\u000e񿕊Ð' not found\n","user_action":null}
{"bug_id":"BUG-9156A086","timestamp":"2025-12-14T10:39:47.447659Z","endpoint":"/api/v1/agents/explain/memory","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: À' not found","request_params":{"path":"/api/v1/agents/explain/memory","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 439, in explain_memory\n    return await _call_explanation(request, \"memory\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: À' not found\n","user_action":null}
{"bug_id":"BUG-D5913302","timestamp":"2025-12-14T10:39:47.544810Z","endpoint":"/api/v1/agents/explain/memory","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: v򣆇Ñ򻔵򙒯' not found","request_params":{"path":"/api/v1/agents/explain/memory","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 439, in explain_memory\n    return await _call_explanation(request, \"memory\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: v򣆇Ñ򻔵򙒯' not found\n","user_action":null}
{"bug_id":"BUG-72BAA3B3","timestamp":"2025-12-14T10:39:47.662920Z","endpoint":"/api/v1/agents/explain/memory","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ç' not found","request_params":{"path":"/api/v1/agents/explain/memory","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 439, in explain_memory\n    return await _call_explanation(request, \"memory\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ç' not found\n","user_action":null}
{"bug_id":"BUG-26D3DFC1","timestamp":"2025-12-14T10:39:48.401564Z","endpoint":"/api/v1/agents/explain/four-level","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/four-level","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 463, in explain_four_level\n    return await _call_explanation(request, \"four-level\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-B8A06B8F","timestamp":"2025-12-14T10:39:48.457192Z","endpoint":"/api/v1/agents/explain/four-level","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/four-level","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 463, in explain_four_level\n    return await _call_explanation(request, \"four-level\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-A6DCD0E8","timestamp":"2025-12-14T10:39:48.591001Z","endpoint":"/api/v1/agents/explain/four-level","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: è' not found","request_params":{"path":"/api/v1/agents/explain/four-level","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 463, in explain_four_level\n    return await _call_explanation(request, \"four-level\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: è' not found\n","user_action":null}
{"bug_id":"BUG-ABBE778B","timestamp":"2025-12-14T10:39:48.646312Z","endpoint":"/api/v1/agents/explain/four-level","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ¦\u001cUç' not found","request_params":{"path":"/api/v1/agents/explain/four-level","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 463, in explain_four_level\n    return await _call_explanation(request, \"four-level\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ¦\u001cUç' not found\n","user_action":null}
{"bug_id":"BUG-AC87DE33","timestamp":"2025-12-14T10:39:48.690498Z","endpoint":"/api/v1/agents/explain/four-level","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: 󺴓󫫱' not found","request_params":{"path":"/api/v1/agents/explain/four-level","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 463, in explain_four_level\n    return await _call_explanation(request, \"four-level\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: 󺴓󫫱' not found\n","user_action":null}
{"bug_id":"BUG-80A5F4DE","timestamp":"2025-12-14T10:39:48.882482Z","endpoint":"/api/v1/agents/explain/four-level","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: Bug不存在' not found","request_params":{"path":"/api/v1/agents/explain/four-level","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 463, in explain_four_level\n    return await _call_explanation(request, \"four-level\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: Bug不存在' not found\n","user_action":null}
{"bug_id":"BUG-7B919848","timestamp":"2025-12-14T10:39:49.546238Z","endpoint":"/api/v1/agents/explain/example","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/example","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 487, in explain_example\n    return await _call_explanation(request, \"example\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-4AB9B838","timestamp":"2025-12-14T10:39:49.597382Z","endpoint":"/api/v1/agents/explain/example","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/example","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 487, in explain_example\n    return await _call_explanation(request, \"example\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-A89E44A3","timestamp":"2025-12-14T10:39:50.024179Z","endpoint":"/api/v1/agents/explain/example","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ä\f񵽷󉞁4@' not found","request_params":{"path":"/api/v1/agents/explain/example","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 487, in explain_example\n    return await _call_explanation(request, \"example\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ä\f񵽷󉞁4@' not found\n","user_action":null}
{"bug_id":"BUG-B5305E71","timestamp":"2025-12-14T10:39:54.362914Z","endpoint":"/api/v1/review/progress/multi/0","error_type":"TypeError","error_message":"get_review_service() missing 2 required positional arguments: 'canvas_service' and 'task_manager'","request_params":{"path":"/api/v1/review/progress/multi/0","method":"GET","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 111, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 104, in receive_nowait\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\review.py\", line 511, in get_multi_review_progress\n    review_service = get_review_service()\n                     ^^^^^^^^^^^^^^^^^^^^\nTypeError: get_review_service() missing 2 required positional arguments: 'canvas_service' and 'task_manager'\n","user_action":null}
{"bug_id":"BUG-AD6212C5","timestamp":"2025-12-14T10:39:58.528665Z","endpoint":"/api/v1/rollback/snapshot","error_type":"PermissionError","error_message":"[Errno 13] Permission denied: '.'","request_params":{"path":"/api/v1/rollback/snapshot","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\rollback.py\", line 350, in create_snapshot\n    snapshot = await manager.create_snapshot(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 143, in create_snapshot\n    canvas_data = await self._read_canvas(canvas_path)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 113, in _read_canvas\n    data = path.read_bytes()\n           ^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1019, in read_bytes\n    with self.open(mode='rb') as f:\n         ^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1013, in open\n    return io.open(self, mode, buffering, encoding, errors, newline)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nPermissionError: [Errno 13] Permission denied: '.'\n","user_action":null}
{"bug_id":"BUG-7336760F","timestamp":"2025-12-14T10:39:58.560580Z","endpoint":"/api/v1/rollback/snapshot","error_type":"PermissionError","error_message":"[Errno 13] Permission denied: '.'","request_params":{"path":"/api/v1/rollback/snapshot","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\rollback.py\", line 350, in create_snapshot\n    snapshot = await manager.create_snapshot(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 143, in create_snapshot\n    canvas_data = await self._read_canvas(canvas_path)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 113, in _read_canvas\n    data = path.read_bytes()\n           ^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1019, in read_bytes\n    with self.open(mode='rb') as f:\n         ^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1013, in open\n    return io.open(self, mode, buffering, encoding, errors, newline)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nPermissionError: [Errno 13] Permission denied: '.'\n","user_action":null}
{"bug_id":"BUG-6CF2400C","timestamp":"2025-12-14T10:39:58.586764Z","endpoint":"/api/v1/rollback/snapshot","error_type":"PermissionError","error_message":"[Errno 13] Permission denied: '.'","request_params":{"path":"/api/v1/rollback/snapshot","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\rollback.py\", line 350, in create_snapshot\n    snapshot = await manager.create_snapshot(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 143, in create_snapshot\n    canvas_data = await self._read_canvas(canvas_path)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 113, in _read_canvas\n    data = path.read_bytes()\n           ^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1019, in read_bytes\n    with self.open(mode='rb') as f:\n         ^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1013, in open\n    return io.open(self, mode, buffering, encoding, errors, newline)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nPermissionError: [Errno 13] Permission denied: '.'\n","user_action":null}
{"bug_id":"BUG-9BF5AE53","timestamp":"2025-12-14T10:39:58.615862Z","endpoint":"/api/v1/rollback/snapshot","error_type":"PermissionError","error_message":"[Errno 13] Permission denied: '.'","request_params":{"path":"/api/v1/rollback/snapshot","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\rollback.py\", line 350, in create_snapshot\n    snapshot = await manager.create_snapshot(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 143, in create_snapshot\n    canvas_data = await self._read_canvas(canvas_path)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 113, in _read_canvas\n    data = path.read_bytes()\n           ^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1019, in read_bytes\n    with self.open(mode='rb') as f:\n         ^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1013, in open\n    return io.open(self, mode, buffering, encoding, errors, newline)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nPermissionError: [Errno 13] Permission denied: '.'\n","user_action":null}
{"bug_id":"BUG-5BA60E2A","timestamp":"2025-12-14T10:39:58.642125Z","endpoint":"/api/v1/rollback/snapshot","error_type":"PermissionError","error_message":"[Errno 13] Permission denied: '.'","request_params":{"path":"/api/v1/rollback/snapshot","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\rollback.py\", line 350, in create_snapshot\n    snapshot = await manager.create_snapshot(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 143, in create_snapshot\n    canvas_data = await self._read_canvas(canvas_path)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 113, in _read_canvas\n    data = path.read_bytes()\n           ^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1019, in read_bytes\n    with self.open(mode='rb') as f:\n         ^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1013, in open\n    return io.open(self, mode, buffering, encoding, errors, newline)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nPermissionError: [Errno 13] Permission denied: '.'\n","user_action":null}
{"bug_id":"BUG-A5548B83","timestamp":"2025-12-14T10:39:58.669447Z","endpoint":"/api/v1/rollback/snapshot","error_type":"PermissionError","error_message":"[Errno 13] Permission denied: '.'","request_params":{"path":"/api/v1/rollback/snapshot","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\rollback.py\", line 350, in create_snapshot\n    snapshot = await manager.create_snapshot(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 143, in create_snapshot\n    canvas_data = await self._read_canvas(canvas_path)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 113, in _read_canvas\n    data = path.read_bytes()\n           ^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1019, in read_bytes\n    with self.open(mode='rb') as f:\n         ^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1013, in open\n    return io.open(self, mode, buffering, encoding, errors, newline)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nPermissionError: [Errno 13] Permission denied: '.'\n","user_action":null}
{"bug_id":"BUG-4EB9E0C5","timestamp":"2025-12-14T10:39:58.695317Z","endpoint":"/api/v1/rollback/snapshot","error_type":"PermissionError","error_message":"[Errno 13] Permission denied: '.'","request_params":{"path":"/api/v1/rollback/snapshot","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\rollback.py\", line 350, in create_snapshot\n    snapshot = await manager.create_snapshot(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 143, in create_snapshot\n    canvas_data = await self._read_canvas(canvas_path)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 113, in _read_canvas\n    data = path.read_bytes()\n           ^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1019, in read_bytes\n    with self.open(mode='rb') as f:\n         ^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1013, in open\n    return io.open(self, mode, buffering, encoding, errors, newline)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nPermissionError: [Errno 13] Permission denied: '.'\n","user_action":null}
{"bug_id":"BUG-1E59862C","timestamp":"2025-12-14T10:39:58.732661Z","endpoint":"/api/v1/rollback/snapshot","error_type":"PermissionError","error_message":"[Errno 13] Permission denied: '.'","request_params":{"path":"/api/v1/rollback/snapshot","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\rollback.py\", line 350, in create_snapshot\n    snapshot = await manager.create_snapshot(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 143, in create_snapshot\n    canvas_data = await self._read_canvas(canvas_path)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 113, in _read_canvas\n    data = path.read_bytes()\n           ^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1019, in read_bytes\n    with self.open(mode='rb') as f:\n         ^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1013, in open\n    return io.open(self, mode, buffering, encoding, errors, newline)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nPermissionError: [Errno 13] Permission denied: '.'\n","user_action":null}
{"bug_id":"BUG-813B66BF","timestamp":"2025-12-14T10:39:59.028332Z","endpoint":"/api/v1/rollback/snapshot","error_type":"PermissionError","error_message":"[Errno 13] Permission denied: '.'","request_params":{"path":"/api/v1/rollback/snapshot","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\rollback.py\", line 350, in create_snapshot\n    snapshot = await manager.create_snapshot(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 143, in create_snapshot\n    canvas_data = await self._read_canvas(canvas_path)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 113, in _read_canvas\n    data = path.read_bytes()\n           ^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1019, in read_bytes\n    with self.open(mode='rb') as f:\n         ^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1013, in open\n    return io.open(self, mode, buffering, encoding, errors, newline)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nPermissionError: [Errno 13] Permission denied: '.'\n","user_action":null}
{"bug_id":"BUG-BC93AC19","timestamp":"2025-12-14T10:39:59.169962Z","endpoint":"/api/v1/rollback/snapshot","error_type":"OSError","error_message":"[WinError 123] 文件名、目录名或卷标语法不正确。: '.canvas-learning\\\\snapshots\\\\z\\x0fÁ\\x1b)+o\\\\snapshots'","request_params":{"path":"/api/v1/rollback/snapshot","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\rollback.py\", line 350, in create_snapshot\n    snapshot = await manager.create_snapshot(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 163, in create_snapshot\n    await self._save_snapshot(snapshot)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 178, in _save_snapshot\n    snapshots_dir.mkdir(parents=True, exist_ok=True)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1311, in mkdir\n    os.mkdir(self, mode)\nOSError: [WinError 123] 文件名、目录名或卷标语法不正确。: '.canvas-learning\\\\snapshots\\\\z\\x0fÁ\\x1b)+o\\\\snapshots'\n","user_action":null}
{"bug_id":"BUG-E367C805","timestamp":"2025-12-14T10:39:59.204984Z","endpoint":"/api/v1/rollback/snapshot","error_type":"OSError","error_message":"[WinError 123] 文件名、目录名或卷标语法不正确。: '.canvas-learning\\\\snapshots\\\\ô¤?Ú\\\\snapshots'","request_params":{"path":"/api/v1/rollback/snapshot","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\rollback.py\", line 350, in create_snapshot\n    snapshot = await manager.create_snapshot(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 163, in create_snapshot\n    await self._save_snapshot(snapshot)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 178, in _save_snapshot\n    snapshots_dir.mkdir(parents=True, exist_ok=True)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1311, in mkdir\n    os.mkdir(self, mode)\nOSError: [WinError 123] 文件名、目录名或卷标语法不正确。: '.canvas-learning\\\\snapshots\\\\ô¤?Ú\\\\snapshots'\n","user_action":null}
{"bug_id":"BUG-5CED1D3D","timestamp":"2025-12-14T10:40:19.729145Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: test' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: test' not found\n","user_action":null}
{"bug_id":"BUG-3C10457D","timestamp":"2025-12-14T10:40:19.820747Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: test' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: test' not found\n","user_action":null}
{"bug_id":"BUG-1BCB8F3E","timestamp":"2025-12-14T10:40:25.108899Z","endpoint":"/api/v1/rollback/snapshot","error_type":"PermissionError","error_message":"[Errno 13] Permission denied: '.'","request_params":{"path":"/api/v1/rollback/snapshot","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\rollback.py\", line 350, in create_snapshot\n    snapshot = await manager.create_snapshot(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 143, in create_snapshot\n    canvas_data = await self._read_canvas(canvas_path)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 113, in _read_canvas\n    data = path.read_bytes()\n           ^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1019, in read_bytes\n    with self.open(mode='rb') as f:\n         ^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1013, in open\n    return io.open(self, mode, buffering, encoding, errors, newline)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nPermissionError: [Errno 13] Permission denied: '.'\n","user_action":null}
{"bug_id":"BUG-91416260","timestamp":"2025-12-14T10:40:25.465438Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: test-canvas' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: test-canvas' not found\n","user_action":null}
{"bug_id":"BUG-F344DF13","timestamp":"2025-12-14T10:40:25.491273Z","endpoint":"/api/v1/agents/decompose/deep","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: test-canvas' not found","request_params":{"path":"/api/v1/agents/decompose/deep","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 198, in decompose_deep\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: test-canvas' not found\n","user_action":null}
{"bug_id":"BUG-2C4DE043","timestamp":"2025-12-14T10:40:25.546526Z","endpoint":"/api/v1/agents/explain/oral","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: test-canvas' not found","request_params":{"path":"/api/v1/agents/explain/oral","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 367, in explain_oral\n    return await _call_explanation(request, \"oral\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: test-canvas' not found\n","user_action":null}
{"bug_id":"BUG-7A0C83B5","timestamp":"2025-12-14T10:40:25.576251Z","endpoint":"/api/v1/agents/explain/clarification","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: test-canvas' not found","request_params":{"path":"/api/v1/agents/explain/clarification","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 391, in explain_clarification\n    return await _call_explanation(request, \"clarification\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: test-canvas' not found\n","user_action":null}
{"bug_id":"BUG-AA59C5C8","timestamp":"2025-12-14T10:40:25.607474Z","endpoint":"/api/v1/agents/explain/comparison","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: test-canvas' not found","request_params":{"path":"/api/v1/agents/explain/comparison","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 415, in explain_comparison\n    return await _call_explanation(request, \"comparison\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: test-canvas' not found\n","user_action":null}
{"bug_id":"BUG-F9E0FA7E","timestamp":"2025-12-14T10:40:25.642170Z","endpoint":"/api/v1/agents/explain/memory","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: test-canvas' not found","request_params":{"path":"/api/v1/agents/explain/memory","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 439, in explain_memory\n    return await _call_explanation(request, \"memory\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: test-canvas' not found\n","user_action":null}
{"bug_id":"BUG-E6675149","timestamp":"2025-12-14T10:40:25.673812Z","endpoint":"/api/v1/agents/explain/four-level","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: test-canvas' not found","request_params":{"path":"/api/v1/agents/explain/four-level","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 463, in explain_four_level\n    return await _call_explanation(request, \"four-level\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: test-canvas' not found\n","user_action":null}
{"bug_id":"BUG-A40B1FDD","timestamp":"2025-12-14T10:40:25.706534Z","endpoint":"/api/v1/agents/explain/example","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: test-canvas' not found","request_params":{"path":"/api/v1/agents/explain/example","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 487, in explain_example\n    return await _call_explanation(request, \"example\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: test-canvas' not found\n","user_action":null}
{"bug_id":"BUG-CFBE5689","timestamp":"2025-12-14T12:04:34.567022Z","endpoint":"/api/v1/canvas/𰿇â/nodes/\u001f","error_type":"ValidationError","error_message":"1 validation error for NodeRead\nid\n  String should match pattern '^[a-f0-9]+$' [type=string_pattern_mismatch, input_value='\\x1f', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/string_pattern_mismatch","request_params":{"path":"/api/v1/canvas/𰿇â/nodes/\u001f","method":"PUT","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\canvas.py\", line 114, in update_node\n    return NodeRead(\n           ^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\pydantic\\main.py\", line 250, in __init__\n    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\npydantic_core._pydantic_core.ValidationError: 1 validation error for NodeRead\nid\n  String should match pattern '^[a-f0-9]+$' [type=string_pattern_mismatch, input_value='\\x1f', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/string_pattern_mismatch\n","user_action":null}
{"bug_id":"BUG-8201BCE1","timestamp":"2025-12-14T12:04:43.405759Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-26D2E74C","timestamp":"2025-12-14T12:04:43.759120Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-092D2DE4","timestamp":"2025-12-14T12:04:46.452987Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: 0' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: 0' not found\n","user_action":null}
{"bug_id":"BUG-3DF2CAE4","timestamp":"2025-12-14T12:04:52.689709Z","endpoint":"/api/v1/agents/decompose/deep","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/decompose/deep","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 198, in decompose_deep\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-46433F78","timestamp":"2025-12-14T12:04:53.071827Z","endpoint":"/api/v1/agents/decompose/deep","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/decompose/deep","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 198, in decompose_deep\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-25346396","timestamp":"2025-12-14T12:04:54.944144Z","endpoint":"/api/v1/agents/decompose/deep","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ³ïG' not found","request_params":{"path":"/api/v1/agents/decompose/deep","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 198, in decompose_deep\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ³ïG' not found\n","user_action":null}
{"bug_id":"BUG-04C930F6","timestamp":"2025-12-14T12:04:55.287486Z","endpoint":"/api/v1/agents/decompose/deep","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: 7' not found","request_params":{"path":"/api/v1/agents/decompose/deep","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 198, in decompose_deep\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: 7' not found\n","user_action":null}
{"bug_id":"BUG-FB45ED1C","timestamp":"2025-12-14T12:05:06.922097Z","endpoint":"/api/v1/agents/explain/oral","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/oral","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 367, in explain_oral\n    return await _call_explanation(request, \"oral\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-43C2C1AC","timestamp":"2025-12-14T12:05:07.202559Z","endpoint":"/api/v1/agents/explain/oral","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/oral","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 367, in explain_oral\n    return await _call_explanation(request, \"oral\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-BC9D77D8","timestamp":"2025-12-14T12:05:07.960563Z","endpoint":"/api/v1/agents/explain/oral","error_type":"ValidationError","error_message":"Path traversal detected in canvas name: \\","request_params":{"path":"/api/v1/agents/explain/oral","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 367, in explain_oral\n    return await _call_explanation(request, \"oral\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 85, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 66, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 62, in _validate_canvas_name\n    raise ValidationError(f\"Path traversal detected in canvas name: {canvas_name}\")\napp.core.exceptions.ValidationError: Path traversal detected in canvas name: \\\n","user_action":null}
{"bug_id":"BUG-734D3643","timestamp":"2025-12-14T12:05:08.401801Z","endpoint":"/api/v1/agents/explain/oral","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/oral","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 367, in explain_oral\n    return await _call_explanation(request, \"oral\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-ECBE8931","timestamp":"2025-12-14T12:05:09.077959Z","endpoint":"/api/v1/agents/explain/oral","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: Dy򂓔' not found","request_params":{"path":"/api/v1/agents/explain/oral","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 367, in explain_oral\n    return await _call_explanation(request, \"oral\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: Dy򂓔' not found\n","user_action":null}
{"bug_id":"BUG-D1B9729E","timestamp":"2025-12-14T12:05:14.679112Z","endpoint":"/api/v1/agents/explain/clarification","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/clarification","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 391, in explain_clarification\n    return await _call_explanation(request, \"clarification\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-47511787","timestamp":"2025-12-14T12:05:15.034408Z","endpoint":"/api/v1/agents/explain/clarification","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/clarification","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 391, in explain_clarification\n    return await _call_explanation(request, \"clarification\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-E1D9A2EF","timestamp":"2025-12-14T12:05:16.012757Z","endpoint":"/api/v1/agents/explain/clarification","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: B󵬢#°' not found","request_params":{"path":"/api/v1/agents/explain/clarification","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 391, in explain_clarification\n    return await _call_explanation(request, \"clarification\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: B󵬢#°' not found\n","user_action":null}
{"bug_id":"BUG-0F3C9407","timestamp":"2025-12-14T12:05:16.292049Z","endpoint":"/api/v1/agents/explain/clarification","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ×ë穴qC§' not found","request_params":{"path":"/api/v1/agents/explain/clarification","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 391, in explain_clarification\n    return await _call_explanation(request, \"clarification\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ×ë穴qC§' not found\n","user_action":null}
{"bug_id":"BUG-9B0348C1","timestamp":"2025-12-14T12:05:16.928644Z","endpoint":"/api/v1/agents/explain/clarification","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ßX򯘙k\n疰򟇼Óè4VO󇧣񩪹񝉢Jû½pS' not found","request_params":{"path":"/api/v1/agents/explain/clarification","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 391, in explain_clarification\n    return await _call_explanation(request, \"clarification\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ßX򯘙k\n疰򟇼Óè4VO󇧣񩪹񝉢Jû½pS' not found\n","user_action":null}
{"bug_id":"BUG-092C27F7","timestamp":"2025-12-14T12:05:17.651096Z","endpoint":"/api/v1/agents/explain/clarification","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ÒÈ' not found","request_params":{"path":"/api/v1/agents/explain/clarification","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 391, in explain_clarification\n    return await _call_explanation(request, \"clarification\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ÒÈ' not found\n","user_action":null}
{"bug_id":"BUG-7522B92E","timestamp":"2025-12-14T12:05:17.951985Z","endpoint":"/api/v1/agents/explain/clarification","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: Òº' not found","request_params":{"path":"/api/v1/agents/explain/clarification","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 391, in explain_clarification\n    return await _call_explanation(request, \"clarification\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: Òº' not found\n","user_action":null}
{"bug_id":"BUG-B2F8041B","timestamp":"2025-12-14T12:05:23.596903Z","endpoint":"/api/v1/agents/explain/comparison","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/comparison","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 415, in explain_comparison\n    return await _call_explanation(request, \"comparison\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-16C991B6","timestamp":"2025-12-14T12:05:23.952841Z","endpoint":"/api/v1/agents/explain/comparison","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/comparison","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 415, in explain_comparison\n    return await _call_explanation(request, \"comparison\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-71FE1957","timestamp":"2025-12-14T12:05:25.084400Z","endpoint":"/api/v1/agents/explain/comparison","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: Np򬒀' not found","request_params":{"path":"/api/v1/agents/explain/comparison","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 415, in explain_comparison\n    return await _call_explanation(request, \"comparison\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: Np򬒀' not found\n","user_action":null}
{"bug_id":"BUG-02115578","timestamp":"2025-12-14T12:05:27.002112Z","endpoint":"/api/v1/agents/explain/comparison","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: retrieval_batch_size' not found","request_params":{"path":"/api/v1/agents/explain/comparison","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 415, in explain_comparison\n    return await _call_explanation(request, \"comparison\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: retrieval_batch_size' not found\n","user_action":null}
{"bug_id":"BUG-A5EE9C1A","timestamp":"2025-12-14T12:05:33.030286Z","endpoint":"/api/v1/agents/explain/memory","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/memory","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 439, in explain_memory\n    return await _call_explanation(request, \"memory\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-8DEF6386","timestamp":"2025-12-14T12:05:33.382172Z","endpoint":"/api/v1/agents/explain/memory","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/memory","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 439, in explain_memory\n    return await _call_explanation(request, \"memory\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-611D1125","timestamp":"2025-12-14T12:05:34.567469Z","endpoint":"/api/v1/agents/explain/memory","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: 𝗄Èá4𢨣򯟅·Q\n¦RÃ' not found","request_params":{"path":"/api/v1/agents/explain/memory","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 439, in explain_memory\n    return await _call_explanation(request, \"memory\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: 𝗄Èá4𢨣򯟅·Q\n¦RÃ' not found\n","user_action":null}
{"bug_id":"BUG-4E7D1593","timestamp":"2025-12-14T12:05:34.864173Z","endpoint":"/api/v1/agents/explain/memory","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: 󻜹󺪭' not found","request_params":{"path":"/api/v1/agents/explain/memory","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 439, in explain_memory\n    return await _call_explanation(request, \"memory\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: 󻜹󺪭' not found\n","user_action":null}
{"bug_id":"BUG-7EC96355","timestamp":"2025-12-14T12:05:35.232196Z","endpoint":"/api/v1/agents/explain/memory","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: Ç8U\u0012' not found","request_params":{"path":"/api/v1/agents/explain/memory","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 439, in explain_memory\n    return await _call_explanation(request, \"memory\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: Ç8U\u0012' not found\n","user_action":null}
{"bug_id":"BUG-005A79DA","timestamp":"2025-12-14T12:05:35.647963Z","endpoint":"/api/v1/agents/explain/memory","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: n\u000b\u0019¡񘨖疸\u001cí' not found","request_params":{"path":"/api/v1/agents/explain/memory","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 439, in explain_memory\n    return await _call_explanation(request, \"memory\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: n\u000b\u0019¡񘨖疸\u001cí' not found\n","user_action":null}
{"bug_id":"BUG-EF4595EA","timestamp":"2025-12-14T12:05:35.966226Z","endpoint":"/api/v1/agents/explain/memory","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ²' not found","request_params":{"path":"/api/v1/agents/explain/memory","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 439, in explain_memory\n    return await _call_explanation(request, \"memory\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ²' not found\n","user_action":null}
{"bug_id":"BUG-70AB6762","timestamp":"2025-12-14T12:05:36.329527Z","endpoint":"/api/v1/agents/explain/memory","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: k^ûOQ񖯾_' not found","request_params":{"path":"/api/v1/agents/explain/memory","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 439, in explain_memory\n    return await _call_explanation(request, \"memory\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: k^ûOQ񖯾_' not found\n","user_action":null}
{"bug_id":"BUG-0759DB5D","timestamp":"2025-12-14T12:05:42.247399Z","endpoint":"/api/v1/agents/explain/four-level","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/four-level","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 463, in explain_four_level\n    return await _call_explanation(request, \"four-level\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-09E3B967","timestamp":"2025-12-14T12:05:42.623153Z","endpoint":"/api/v1/agents/explain/four-level","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/four-level","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 463, in explain_four_level\n    return await _call_explanation(request, \"four-level\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-046DB687","timestamp":"2025-12-14T12:05:45.484826Z","endpoint":"/api/v1/agents/explain/four-level","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: â×Tû¬Î񰰀' not found","request_params":{"path":"/api/v1/agents/explain/four-level","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 463, in explain_four_level\n    return await _call_explanation(request, \"four-level\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: â×Tû¬Î񰰀' not found\n","user_action":null}
{"bug_id":"BUG-0FD1C3CD","timestamp":"2025-12-14T12:05:45.932029Z","endpoint":"/api/v1/agents/explain/four-level","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/four-level","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 463, in explain_four_level\n    return await _call_explanation(request, \"four-level\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-E91EA724","timestamp":"2025-12-14T12:05:51.787100Z","endpoint":"/api/v1/agents/explain/example","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/example","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 487, in explain_example\n    return await _call_explanation(request, \"example\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-EEF1BF63","timestamp":"2025-12-14T12:05:52.161956Z","endpoint":"/api/v1/agents/explain/example","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/example","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 487, in explain_example\n    return await _call_explanation(request, \"example\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-C51D557D","timestamp":"2025-12-14T12:05:53.575390Z","endpoint":"/api/v1/agents/explain/example","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found:  Lï³' not found","request_params":{"path":"/api/v1/agents/explain/example","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 487, in explain_example\n    return await _call_explanation(request, \"example\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found:  Lï³' not found\n","user_action":null}
{"bug_id":"BUG-285B703E","timestamp":"2025-12-14T12:05:54.299140Z","endpoint":"/api/v1/agents/explain/example","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: 򽥾¯' not found","request_params":{"path":"/api/v1/agents/explain/example","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 487, in explain_example\n    return await _call_explanation(request, \"example\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: 򽥾¯' not found\n","user_action":null}
{"bug_id":"BUG-65BCA500","timestamp":"2025-12-14T12:05:54.709389Z","endpoint":"/api/v1/agents/explain/example","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/example","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 487, in explain_example\n    return await _call_explanation(request, \"example\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-2CAC666F","timestamp":"2025-12-14T12:05:55.449892Z","endpoint":"/api/v1/agents/explain/example","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: 򑐮򿣺􆄌\u0006𚫦񝻺󳍛𲟪M' not found","request_params":{"path":"/api/v1/agents/explain/example","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 487, in explain_example\n    return await _call_explanation(request, \"example\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: 򑐮򿣺􆄌\u0006𚫦񝻺󳍛𲟪M' not found\n","user_action":null}
{"bug_id":"BUG-386B41FF","timestamp":"2025-12-14T12:05:59.959998Z","endpoint":"/api/v1/review/progress/multi/0","error_type":"TypeError","error_message":"get_review_service() missing 2 required positional arguments: 'canvas_service' and 'task_manager'","request_params":{"path":"/api/v1/review/progress/multi/0","method":"GET","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 111, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 104, in receive_nowait\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\review.py\", line 511, in get_multi_review_progress\n    review_service = get_review_service()\n                     ^^^^^^^^^^^^^^^^^^^^\nTypeError: get_review_service() missing 2 required positional arguments: 'canvas_service' and 'task_manager'\n","user_action":null}
{"bug_id":"BUG-A752D9B5","timestamp":"2025-12-14T12:06:04.447566Z","endpoint":"/api/v1/rollback/snapshot","error_type":"PermissionError","error_message":"[Errno 13] Permission denied: '.'","request_params":{"path":"/api/v1/rollback/snapshot","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\rollback.py\", line 350, in create_snapshot\n    snapshot = await manager.create_snapshot(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 143, in create_snapshot\n    canvas_data = await self._read_canvas(canvas_path)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 113, in _read_canvas\n    data = path.read_bytes()\n           ^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1019, in read_bytes\n    with self.open(mode='rb') as f:\n         ^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1013, in open\n    return io.open(self, mode, buffering, encoding, errors, newline)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nPermissionError: [Errno 13] Permission denied: '.'\n","user_action":null}
{"bug_id":"BUG-70A60F7E","timestamp":"2025-12-14T12:06:04.479214Z","endpoint":"/api/v1/rollback/snapshot","error_type":"PermissionError","error_message":"[Errno 13] Permission denied: '.'","request_params":{"path":"/api/v1/rollback/snapshot","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\rollback.py\", line 350, in create_snapshot\n    snapshot = await manager.create_snapshot(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 143, in create_snapshot\n    canvas_data = await self._read_canvas(canvas_path)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 113, in _read_canvas\n    data = path.read_bytes()\n           ^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1019, in read_bytes\n    with self.open(mode='rb') as f:\n         ^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1013, in open\n    return io.open(self, mode, buffering, encoding, errors, newline)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nPermissionError: [Errno 13] Permission denied: '.'\n","user_action":null}
{"bug_id":"BUG-4713016C","timestamp":"2025-12-14T12:06:04.505194Z","endpoint":"/api/v1/rollback/snapshot","error_type":"PermissionError","error_message":"[Errno 13] Permission denied: '.'","request_params":{"path":"/api/v1/rollback/snapshot","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\rollback.py\", line 350, in create_snapshot\n    snapshot = await manager.create_snapshot(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 143, in create_snapshot\n    canvas_data = await self._read_canvas(canvas_path)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 113, in _read_canvas\n    data = path.read_bytes()\n           ^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1019, in read_bytes\n    with self.open(mode='rb') as f:\n         ^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1013, in open\n    return io.open(self, mode, buffering, encoding, errors, newline)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nPermissionError: [Errno 13] Permission denied: '.'\n","user_action":null}
{"bug_id":"BUG-541969B7","timestamp":"2025-12-14T12:06:04.535687Z","endpoint":"/api/v1/rollback/snapshot","error_type":"PermissionError","error_message":"[Errno 13] Permission denied: '.'","request_params":{"path":"/api/v1/rollback/snapshot","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\rollback.py\", line 350, in create_snapshot\n    snapshot = await manager.create_snapshot(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 143, in create_snapshot\n    canvas_data = await self._read_canvas(canvas_path)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 113, in _read_canvas\n    data = path.read_bytes()\n           ^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1019, in read_bytes\n    with self.open(mode='rb') as f:\n         ^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1013, in open\n    return io.open(self, mode, buffering, encoding, errors, newline)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nPermissionError: [Errno 13] Permission denied: '.'\n","user_action":null}
{"bug_id":"BUG-7F2F864C","timestamp":"2025-12-14T12:06:04.563819Z","endpoint":"/api/v1/rollback/snapshot","error_type":"PermissionError","error_message":"[Errno 13] Permission denied: '.'","request_params":{"path":"/api/v1/rollback/snapshot","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\rollback.py\", line 350, in create_snapshot\n    snapshot = await manager.create_snapshot(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 143, in create_snapshot\n    canvas_data = await self._read_canvas(canvas_path)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 113, in _read_canvas\n    data = path.read_bytes()\n           ^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1019, in read_bytes\n    with self.open(mode='rb') as f:\n         ^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1013, in open\n    return io.open(self, mode, buffering, encoding, errors, newline)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nPermissionError: [Errno 13] Permission denied: '.'\n","user_action":null}
{"bug_id":"BUG-8BE3F210","timestamp":"2025-12-14T12:06:04.588840Z","endpoint":"/api/v1/rollback/snapshot","error_type":"PermissionError","error_message":"[Errno 13] Permission denied: '.'","request_params":{"path":"/api/v1/rollback/snapshot","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\rollback.py\", line 350, in create_snapshot\n    snapshot = await manager.create_snapshot(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 143, in create_snapshot\n    canvas_data = await self._read_canvas(canvas_path)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 113, in _read_canvas\n    data = path.read_bytes()\n           ^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1019, in read_bytes\n    with self.open(mode='rb') as f:\n         ^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1013, in open\n    return io.open(self, mode, buffering, encoding, errors, newline)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nPermissionError: [Errno 13] Permission denied: '.'\n","user_action":null}
{"bug_id":"BUG-0F2CA71B","timestamp":"2025-12-14T12:06:04.622161Z","endpoint":"/api/v1/rollback/snapshot","error_type":"PermissionError","error_message":"[Errno 13] Permission denied: '.'","request_params":{"path":"/api/v1/rollback/snapshot","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\rollback.py\", line 350, in create_snapshot\n    snapshot = await manager.create_snapshot(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 143, in create_snapshot\n    canvas_data = await self._read_canvas(canvas_path)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 113, in _read_canvas\n    data = path.read_bytes()\n           ^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1019, in read_bytes\n    with self.open(mode='rb') as f:\n         ^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1013, in open\n    return io.open(self, mode, buffering, encoding, errors, newline)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nPermissionError: [Errno 13] Permission denied: '.'\n","user_action":null}
{"bug_id":"BUG-16929727","timestamp":"2025-12-14T12:06:04.658375Z","endpoint":"/api/v1/rollback/snapshot","error_type":"PermissionError","error_message":"[Errno 13] Permission denied: '.'","request_params":{"path":"/api/v1/rollback/snapshot","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\rollback.py\", line 350, in create_snapshot\n    snapshot = await manager.create_snapshot(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 143, in create_snapshot\n    canvas_data = await self._read_canvas(canvas_path)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 113, in _read_canvas\n    data = path.read_bytes()\n           ^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1019, in read_bytes\n    with self.open(mode='rb') as f:\n         ^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1013, in open\n    return io.open(self, mode, buffering, encoding, errors, newline)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nPermissionError: [Errno 13] Permission denied: '.'\n","user_action":null}
{"bug_id":"BUG-80862B29","timestamp":"2025-12-14T12:08:14.054894Z","endpoint":"/api/v1/canvas/󌭋/nodes/Í𖋯􀃓Ûccx򱪨QË𠞃򪐯","error_type":"ValidationError","error_message":"1 validation error for NodeRead\nid\n  String should match pattern '^[a-f0-9]+$' [type=string_pattern_mismatch, input_value='Í\\U000162ef\\U001000d3\\x...0b1aa8QË𠞃\\U000aa42f', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/string_pattern_mismatch","request_params":{"path":"/api/v1/canvas/󌭋/nodes/Í𖋯􀃓Ûccx򱪨QË𠞃򪐯","method":"PUT","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\canvas.py\", line 114, in update_node\n    return NodeRead(\n           ^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\pydantic\\main.py\", line 250, in __init__\n    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)\n                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\npydantic_core._pydantic_core.ValidationError: 1 validation error for NodeRead\nid\n  String should match pattern '^[a-f0-9]+$' [type=string_pattern_mismatch, input_value='Í\\U000162ef\\U001000d3\\x...0b1aa8QË𠞃\\U000aa42f', input_type=str]\n    For further information visit https://errors.pydantic.dev/2.12/v/string_pattern_mismatch\n","user_action":null}
{"bug_id":"BUG-AE21C78A","timestamp":"2025-12-14T12:08:23.130129Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-D33B5235","timestamp":"2025-12-14T12:08:23.476027Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-BBF4EB7C","timestamp":"2025-12-14T12:08:24.513163Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: E+' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: E+' not found\n","user_action":null}
{"bug_id":"BUG-F3FE8546","timestamp":"2025-12-14T12:08:25.216863Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: 󀺬å¢Hêa¨yJ}à' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: 󀺬å¢Hêa¨yJ}à' not found\n","user_action":null}
{"bug_id":"BUG-130B6C3E","timestamp":"2025-12-14T12:08:25.579843Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: Ð0󪉶í󂙇{_' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: Ð0󪉶í󂙇{_' not found\n","user_action":null}
{"bug_id":"BUG-70612F4E","timestamp":"2025-12-14T12:08:25.964184Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: \u0011BøÕ&𹻸󙬥' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: \u0011BøÕ&𹻸󙬥' not found\n","user_action":null}
{"bug_id":"BUG-BA7FE4E1","timestamp":"2025-12-14T12:08:26.352049Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-DB920832","timestamp":"2025-12-14T12:08:33.044816Z","endpoint":"/api/v1/agents/decompose/deep","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/decompose/deep","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 198, in decompose_deep\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-DF5E8748","timestamp":"2025-12-14T12:08:33.412059Z","endpoint":"/api/v1/agents/decompose/deep","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/decompose/deep","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 198, in decompose_deep\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-A1D83154","timestamp":"2025-12-14T12:08:34.463514Z","endpoint":"/api/v1/agents/decompose/deep","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: pyZ\u0002,󹦏󄍁0' not found","request_params":{"path":"/api/v1/agents/decompose/deep","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 198, in decompose_deep\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: pyZ\u0002,󹦏󄍁0' not found\n","user_action":null}
{"bug_id":"BUG-F9B76E71","timestamp":"2025-12-14T12:08:34.855931Z","endpoint":"/api/v1/agents/decompose/deep","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: \u0017' not found","request_params":{"path":"/api/v1/agents/decompose/deep","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 198, in decompose_deep\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: \u0017' not found\n","user_action":null}
{"bug_id":"BUG-30467B23","timestamp":"2025-12-14T12:08:35.212397Z","endpoint":"/api/v1/agents/decompose/deep","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: h' not found","request_params":{"path":"/api/v1/agents/decompose/deep","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 198, in decompose_deep\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: h' not found\n","user_action":null}
{"bug_id":"BUG-F1112BBE","timestamp":"2025-12-14T12:08:35.540370Z","endpoint":"/api/v1/agents/decompose/deep","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/decompose/deep","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 198, in decompose_deep\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-A13B81B2","timestamp":"2025-12-14T12:08:35.921975Z","endpoint":"/api/v1/agents/decompose/deep","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: 󅄩bxü󢼗񷶝cê' not found","request_params":{"path":"/api/v1/agents/decompose/deep","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 198, in decompose_deep\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: 󅄩bxü󢼗񷶝cê' not found\n","user_action":null}
{"bug_id":"BUG-A94CEB24","timestamp":"2025-12-14T12:08:36.271781Z","endpoint":"/api/v1/agents/decompose/deep","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ª:' not found","request_params":{"path":"/api/v1/agents/decompose/deep","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 198, in decompose_deep\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ª:' not found\n","user_action":null}
{"bug_id":"BUG-9085BF16","timestamp":"2025-12-14T12:08:36.609682Z","endpoint":"/api/v1/agents/decompose/deep","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: 򛻻a3ß°ö󏠞' not found","request_params":{"path":"/api/v1/agents/decompose/deep","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 198, in decompose_deep\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: 򛻻a3ß°ö󏠞' not found\n","user_action":null}
{"bug_id":"BUG-A4D3DD4E","timestamp":"2025-12-14T12:08:51.274819Z","endpoint":"/api/v1/agents/explain/oral","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/oral","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 367, in explain_oral\n    return await _call_explanation(request, \"oral\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-370DCCCE","timestamp":"2025-12-14T12:08:51.652397Z","endpoint":"/api/v1/agents/explain/oral","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/oral","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 367, in explain_oral\n    return await _call_explanation(request, \"oral\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-8518522A","timestamp":"2025-12-14T12:08:52.741922Z","endpoint":"/api/v1/agents/explain/oral","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ¾3ÿ±Q' not found","request_params":{"path":"/api/v1/agents/explain/oral","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 367, in explain_oral\n    return await _call_explanation(request, \"oral\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ¾3ÿ±Q' not found\n","user_action":null}
{"bug_id":"BUG-0F6F849E","timestamp":"2025-12-14T12:08:53.166937Z","endpoint":"/api/v1/agents/explain/oral","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: \r¹¢' not found","request_params":{"path":"/api/v1/agents/explain/oral","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 367, in explain_oral\n    return await _call_explanation(request, \"oral\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: \r¹¢' not found\n","user_action":null}
{"bug_id":"BUG-EFADC233","timestamp":"2025-12-14T12:08:53.546048Z","endpoint":"/api/v1/agents/explain/oral","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: 󑜦jV򽩴󫥪KLã|ð𥇃' not found","request_params":{"path":"/api/v1/agents/explain/oral","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 367, in explain_oral\n    return await _call_explanation(request, \"oral\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: 󑜦jV򽩴󫥪KLã|ð𥇃' not found\n","user_action":null}
{"bug_id":"BUG-09FB5C5E","timestamp":"2025-12-14T12:08:53.926556Z","endpoint":"/api/v1/agents/explain/oral","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: bã3Ö' not found","request_params":{"path":"/api/v1/agents/explain/oral","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 367, in explain_oral\n    return await _call_explanation(request, \"oral\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: bã3Ö' not found\n","user_action":null}
{"bug_id":"BUG-AF8FDD84","timestamp":"2025-12-14T12:08:54.295644Z","endpoint":"/api/v1/agents/explain/oral","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: §¢æ)=󦏬𩪶y扐m\"ÏWµ¬' not found","request_params":{"path":"/api/v1/agents/explain/oral","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 367, in explain_oral\n    return await _call_explanation(request, \"oral\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: §¢æ)=󦏬𩪶y扐m\"ÏWµ¬' not found\n","user_action":null}
{"bug_id":"BUG-E5E032C4","timestamp":"2025-12-14T12:08:54.720495Z","endpoint":"/api/v1/agents/explain/oral","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: 7w¦' not found","request_params":{"path":"/api/v1/agents/explain/oral","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 367, in explain_oral\n    return await _call_explanation(request, \"oral\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: 7w¦' not found\n","user_action":null}
{"bug_id":"BUG-E910DF52","timestamp":"2025-12-14T12:09:01.602146Z","endpoint":"/api/v1/agents/explain/clarification","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/clarification","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 391, in explain_clarification\n    return await _call_explanation(request, \"clarification\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-2CA6992D","timestamp":"2025-12-14T12:09:01.954381Z","endpoint":"/api/v1/agents/explain/clarification","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/clarification","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 391, in explain_clarification\n    return await _call_explanation(request, \"clarification\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-1852808C","timestamp":"2025-12-14T12:09:03.162389Z","endpoint":"/api/v1/agents/explain/clarification","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: [𽜲Y' not found","request_params":{"path":"/api/v1/agents/explain/clarification","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 391, in explain_clarification\n    return await _call_explanation(request, \"clarification\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: [𽜲Y' not found\n","user_action":null}
{"bug_id":"BUG-CB3A4C71","timestamp":"2025-12-14T12:09:04.549861Z","endpoint":"/api/v1/agents/explain/clarification","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/clarification","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 391, in explain_clarification\n    return await _call_explanation(request, \"clarification\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-62DE51F2","timestamp":"2025-12-14T12:09:05.326242Z","endpoint":"/api/v1/agents/explain/clarification","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: \u000e𣋜Ïô{' not found","request_params":{"path":"/api/v1/agents/explain/clarification","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 391, in explain_clarification\n    return await _call_explanation(request, \"clarification\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: \u000e𣋜Ïô{' not found\n","user_action":null}
{"bug_id":"BUG-161E3DDA","timestamp":"2025-12-14T12:09:12.103931Z","endpoint":"/api/v1/agents/explain/comparison","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/comparison","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 415, in explain_comparison\n    return await _call_explanation(request, \"comparison\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-B15EC483","timestamp":"2025-12-14T12:09:12.474833Z","endpoint":"/api/v1/agents/explain/comparison","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/comparison","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 415, in explain_comparison\n    return await _call_explanation(request, \"comparison\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-B38ADFC6","timestamp":"2025-12-14T12:09:13.596278Z","endpoint":"/api/v1/agents/explain/comparison","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found:  Zçä\tâ' not found","request_params":{"path":"/api/v1/agents/explain/comparison","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 415, in explain_comparison\n    return await _call_explanation(request, \"comparison\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found:  Zçä\tâ' not found\n","user_action":null}
{"bug_id":"BUG-934DB977","timestamp":"2025-12-14T12:09:14.358875Z","endpoint":"/api/v1/agents/explain/comparison","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: qù\u0016üg󹦤C' not found","request_params":{"path":"/api/v1/agents/explain/comparison","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 415, in explain_comparison\n    return await _call_explanation(request, \"comparison\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: qù\u0016üg󹦤C' not found\n","user_action":null}
{"bug_id":"BUG-0E0B3FB8","timestamp":"2025-12-14T12:09:14.700192Z","endpoint":"/api/v1/agents/explain/comparison","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: 𽏐򇀟ëE' not found","request_params":{"path":"/api/v1/agents/explain/comparison","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 415, in explain_comparison\n    return await _call_explanation(request, \"comparison\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: 𽏐򇀟ëE' not found\n","user_action":null}
{"bug_id":"BUG-E3769C5D","timestamp":"2025-12-14T12:09:15.419281Z","endpoint":"/api/v1/agents/explain/comparison","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/comparison","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 415, in explain_comparison\n    return await _call_explanation(request, \"comparison\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-99B7D0FD","timestamp":"2025-12-14T12:09:15.788944Z","endpoint":"/api/v1/agents/explain/comparison","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ®' not found","request_params":{"path":"/api/v1/agents/explain/comparison","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 415, in explain_comparison\n    return await _call_explanation(request, \"comparison\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ®' not found\n","user_action":null}
{"bug_id":"BUG-F269B6FE","timestamp":"2025-12-14T12:09:22.291979Z","endpoint":"/api/v1/agents/explain/memory","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/memory","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 439, in explain_memory\n    return await _call_explanation(request, \"memory\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-B185C4E8","timestamp":"2025-12-14T12:09:22.672979Z","endpoint":"/api/v1/agents/explain/memory","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/memory","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 439, in explain_memory\n    return await _call_explanation(request, \"memory\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-B17D0E64","timestamp":"2025-12-14T12:09:24.243023Z","endpoint":"/api/v1/agents/explain/memory","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ÄÏ×À' not found","request_params":{"path":"/api/v1/agents/explain/memory","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 439, in explain_memory\n    return await _call_explanation(request, \"memory\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ÄÏ×À' not found\n","user_action":null}
{"bug_id":"BUG-C171660A","timestamp":"2025-12-14T12:09:24.609182Z","endpoint":"/api/v1/agents/explain/memory","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: 򧁇,{Ë󺵎óÀ𲪾󉛕𽘗' not found","request_params":{"path":"/api/v1/agents/explain/memory","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 439, in explain_memory\n    return await _call_explanation(request, \"memory\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: 򧁇,{Ë󺵎óÀ𲪾󉛕𽘗' not found\n","user_action":null}
{"bug_id":"BUG-FF6D8AC2","timestamp":"2025-12-14T12:09:25.016913Z","endpoint":"/api/v1/agents/explain/memory","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: i1𛈻aCi' not found","request_params":{"path":"/api/v1/agents/explain/memory","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 439, in explain_memory\n    return await _call_explanation(request, \"memory\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: i1𛈻aCi' not found\n","user_action":null}
{"bug_id":"BUG-FF4A169F","timestamp":"2025-12-14T12:09:25.747015Z","endpoint":"/api/v1/agents/explain/memory","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: 􏡎EòÓ' not found","request_params":{"path":"/api/v1/agents/explain/memory","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 439, in explain_memory\n    return await _call_explanation(request, \"memory\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: 􏡎EòÓ' not found\n","user_action":null}
{"bug_id":"BUG-5D94ACDF","timestamp":"2025-12-14T12:09:26.137347Z","endpoint":"/api/v1/agents/explain/memory","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: KÛ􇾱' not found","request_params":{"path":"/api/v1/agents/explain/memory","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 439, in explain_memory\n    return await _call_explanation(request, \"memory\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: KÛ􇾱' not found\n","user_action":null}
{"bug_id":"BUG-46C1599D","timestamp":"2025-12-14T12:09:32.429033Z","endpoint":"/api/v1/agents/explain/four-level","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/four-level","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 463, in explain_four_level\n    return await _call_explanation(request, \"four-level\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-34F3C720","timestamp":"2025-12-14T12:09:32.822187Z","endpoint":"/api/v1/agents/explain/four-level","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/four-level","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 463, in explain_four_level\n    return await _call_explanation(request, \"four-level\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-BD5CD536","timestamp":"2025-12-14T12:09:35.358187Z","endpoint":"/api/v1/agents/explain/four-level","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ýðò$\u000e' not found","request_params":{"path":"/api/v1/agents/explain/four-level","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 463, in explain_four_level\n    return await _call_explanation(request, \"four-level\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ýðò$\u000e' not found\n","user_action":null}
{"bug_id":"BUG-9BE3836F","timestamp":"2025-12-14T12:09:36.082199Z","endpoint":"/api/v1/agents/explain/four-level","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: create_node' not found","request_params":{"path":"/api/v1/agents/explain/four-level","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 463, in explain_four_level\n    return await _call_explanation(request, \"four-level\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: create_node' not found\n","user_action":null}
{"bug_id":"BUG-29D64351","timestamp":"2025-12-14T12:09:42.289773Z","endpoint":"/api/v1/agents/explain/example","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/example","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 487, in explain_example\n    return await _call_explanation(request, \"example\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-C37F6FAC","timestamp":"2025-12-14T12:09:42.630112Z","endpoint":"/api/v1/agents/explain/example","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/example","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 487, in explain_example\n    return await _call_explanation(request, \"example\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-CD619612","timestamp":"2025-12-14T12:09:43.759783Z","endpoint":"/api/v1/agents/explain/example","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: él8' not found","request_params":{"path":"/api/v1/agents/explain/example","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 487, in explain_example\n    return await _call_explanation(request, \"example\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: él8' not found\n","user_action":null}
{"bug_id":"BUG-44D84C1F","timestamp":"2025-12-14T12:09:44.489869Z","endpoint":"/api/v1/agents/explain/example","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: 򸦠©' not found","request_params":{"path":"/api/v1/agents/explain/example","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 487, in explain_example\n    return await _call_explanation(request, \"example\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: 򸦠©' not found\n","user_action":null}
{"bug_id":"BUG-5F0203E4","timestamp":"2025-12-14T12:09:45.186990Z","endpoint":"/api/v1/agents/explain/example","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/explain/example","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 487, in explain_example\n    return await _call_explanation(request, \"example\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-844E0E85","timestamp":"2025-12-14T12:09:50.530111Z","endpoint":"/api/v1/review/progress/multi/0","error_type":"TypeError","error_message":"get_review_service() missing 2 required positional arguments: 'canvas_service' and 'task_manager'","request_params":{"path":"/api/v1/review/progress/multi/0","method":"GET","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 111, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 104, in receive_nowait\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\review.py\", line 511, in get_multi_review_progress\n    review_service = get_review_service()\n                     ^^^^^^^^^^^^^^^^^^^^\nTypeError: get_review_service() missing 2 required positional arguments: 'canvas_service' and 'task_manager'\n","user_action":null}
{"bug_id":"BUG-F80F1853","timestamp":"2025-12-14T12:09:54.884540Z","endpoint":"/api/v1/rollback/snapshot","error_type":"PermissionError","error_message":"[Errno 13] Permission denied: '.'","request_params":{"path":"/api/v1/rollback/snapshot","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\rollback.py\", line 350, in create_snapshot\n    snapshot = await manager.create_snapshot(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 143, in create_snapshot\n    canvas_data = await self._read_canvas(canvas_path)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 113, in _read_canvas\n    data = path.read_bytes()\n           ^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1019, in read_bytes\n    with self.open(mode='rb') as f:\n         ^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1013, in open\n    return io.open(self, mode, buffering, encoding, errors, newline)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nPermissionError: [Errno 13] Permission denied: '.'\n","user_action":null}
{"bug_id":"BUG-C161C551","timestamp":"2025-12-14T12:09:54.913551Z","endpoint":"/api/v1/rollback/snapshot","error_type":"PermissionError","error_message":"[Errno 13] Permission denied: '.'","request_params":{"path":"/api/v1/rollback/snapshot","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\rollback.py\", line 350, in create_snapshot\n    snapshot = await manager.create_snapshot(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 143, in create_snapshot\n    canvas_data = await self._read_canvas(canvas_path)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 113, in _read_canvas\n    data = path.read_bytes()\n           ^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1019, in read_bytes\n    with self.open(mode='rb') as f:\n         ^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1013, in open\n    return io.open(self, mode, buffering, encoding, errors, newline)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nPermissionError: [Errno 13] Permission denied: '.'\n","user_action":null}
{"bug_id":"BUG-F2EE6781","timestamp":"2025-12-14T12:09:54.942869Z","endpoint":"/api/v1/rollback/snapshot","error_type":"PermissionError","error_message":"[Errno 13] Permission denied: '.'","request_params":{"path":"/api/v1/rollback/snapshot","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\rollback.py\", line 350, in create_snapshot\n    snapshot = await manager.create_snapshot(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 143, in create_snapshot\n    canvas_data = await self._read_canvas(canvas_path)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 113, in _read_canvas\n    data = path.read_bytes()\n           ^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1019, in read_bytes\n    with self.open(mode='rb') as f:\n         ^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1013, in open\n    return io.open(self, mode, buffering, encoding, errors, newline)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nPermissionError: [Errno 13] Permission denied: '.'\n","user_action":null}
{"bug_id":"BUG-69532F60","timestamp":"2025-12-14T12:09:54.972058Z","endpoint":"/api/v1/rollback/snapshot","error_type":"PermissionError","error_message":"[Errno 13] Permission denied: '.'","request_params":{"path":"/api/v1/rollback/snapshot","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\rollback.py\", line 350, in create_snapshot\n    snapshot = await manager.create_snapshot(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 143, in create_snapshot\n    canvas_data = await self._read_canvas(canvas_path)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 113, in _read_canvas\n    data = path.read_bytes()\n           ^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1019, in read_bytes\n    with self.open(mode='rb') as f:\n         ^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1013, in open\n    return io.open(self, mode, buffering, encoding, errors, newline)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nPermissionError: [Errno 13] Permission denied: '.'\n","user_action":null}
{"bug_id":"BUG-2DC702F4","timestamp":"2025-12-14T12:09:55.004454Z","endpoint":"/api/v1/rollback/snapshot","error_type":"PermissionError","error_message":"[Errno 13] Permission denied: '.'","request_params":{"path":"/api/v1/rollback/snapshot","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\rollback.py\", line 350, in create_snapshot\n    snapshot = await manager.create_snapshot(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 143, in create_snapshot\n    canvas_data = await self._read_canvas(canvas_path)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 113, in _read_canvas\n    data = path.read_bytes()\n           ^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1019, in read_bytes\n    with self.open(mode='rb') as f:\n         ^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1013, in open\n    return io.open(self, mode, buffering, encoding, errors, newline)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nPermissionError: [Errno 13] Permission denied: '.'\n","user_action":null}
{"bug_id":"BUG-4437AE06","timestamp":"2025-12-14T12:09:55.031992Z","endpoint":"/api/v1/rollback/snapshot","error_type":"PermissionError","error_message":"[Errno 13] Permission denied: '.'","request_params":{"path":"/api/v1/rollback/snapshot","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\rollback.py\", line 350, in create_snapshot\n    snapshot = await manager.create_snapshot(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 143, in create_snapshot\n    canvas_data = await self._read_canvas(canvas_path)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 113, in _read_canvas\n    data = path.read_bytes()\n           ^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1019, in read_bytes\n    with self.open(mode='rb') as f:\n         ^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1013, in open\n    return io.open(self, mode, buffering, encoding, errors, newline)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nPermissionError: [Errno 13] Permission denied: '.'\n","user_action":null}
{"bug_id":"BUG-2C3A17D2","timestamp":"2025-12-14T12:09:55.061822Z","endpoint":"/api/v1/rollback/snapshot","error_type":"PermissionError","error_message":"[Errno 13] Permission denied: '.'","request_params":{"path":"/api/v1/rollback/snapshot","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\rollback.py\", line 350, in create_snapshot\n    snapshot = await manager.create_snapshot(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 143, in create_snapshot\n    canvas_data = await self._read_canvas(canvas_path)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 113, in _read_canvas\n    data = path.read_bytes()\n           ^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1019, in read_bytes\n    with self.open(mode='rb') as f:\n         ^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1013, in open\n    return io.open(self, mode, buffering, encoding, errors, newline)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nPermissionError: [Errno 13] Permission denied: '.'\n","user_action":null}
{"bug_id":"BUG-ACDC21CB","timestamp":"2025-12-14T12:09:55.105606Z","endpoint":"/api/v1/rollback/snapshot","error_type":"PermissionError","error_message":"[Errno 13] Permission denied: '.'","request_params":{"path":"/api/v1/rollback/snapshot","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\rollback.py\", line 350, in create_snapshot\n    snapshot = await manager.create_snapshot(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 143, in create_snapshot\n    canvas_data = await self._read_canvas(canvas_path)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 113, in _read_canvas\n    data = path.read_bytes()\n           ^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1019, in read_bytes\n    with self.open(mode='rb') as f:\n         ^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1013, in open\n    return io.open(self, mode, buffering, encoding, errors, newline)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nPermissionError: [Errno 13] Permission denied: '.'\n","user_action":null}
{"bug_id":"BUG-75C009D7","timestamp":"2025-12-14T12:09:55.216983Z","endpoint":"/api/v1/rollback/snapshot","error_type":"OSError","error_message":"[WinError 123] 文件名、目录名或卷标语法不正确。: '.canvas-learning\\\\snapshots\\\\ÝzB\\x13\\\\snapshots'","request_params":{"path":"/api/v1/rollback/snapshot","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\rollback.py\", line 350, in create_snapshot\n    snapshot = await manager.create_snapshot(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 163, in create_snapshot\n    await self._save_snapshot(snapshot)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 178, in _save_snapshot\n    snapshots_dir.mkdir(parents=True, exist_ok=True)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1311, in mkdir\n    os.mkdir(self, mode)\nOSError: [WinError 123] 文件名、目录名或卷标语法不正确。: '.canvas-learning\\\\snapshots\\\\ÝzB\\x13\\\\snapshots'\n","user_action":null}
{"bug_id":"BUG-ADD25CBA","timestamp":"2025-12-14T12:10:19.604218Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: test' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: test' not found\n","user_action":null}
{"bug_id":"BUG-E6D82DD0","timestamp":"2025-12-14T12:10:19.709586Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: test' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: test' not found\n","user_action":null}
{"bug_id":"BUG-9D279941","timestamp":"2025-12-14T12:10:39.455563Z","endpoint":"/api/v1/rollback/snapshot","error_type":"PermissionError","error_message":"[Errno 13] Permission denied: '.'","request_params":{"path":"/api/v1/rollback/snapshot","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\rollback.py\", line 350, in create_snapshot\n    snapshot = await manager.create_snapshot(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 143, in create_snapshot\n    canvas_data = await self._read_canvas(canvas_path)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\src\\rollback\\snapshot_manager.py\", line 113, in _read_canvas\n    data = path.read_bytes()\n           ^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1019, in read_bytes\n    with self.open(mode='rb') as f:\n         ^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\pathlib.py\", line 1013, in open\n    return io.open(self, mode, buffering, encoding, errors, newline)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nPermissionError: [Errno 13] Permission denied: '.'\n","user_action":null}
{"bug_id":"BUG-F8F18380","timestamp":"2025-12-14T12:10:40.162654Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: test-canvas' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: test-canvas' not found\n","user_action":null}
{"bug_id":"BUG-B7C4879A","timestamp":"2025-12-14T12:10:40.520571Z","endpoint":"/api/v1/agents/decompose/deep","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: test-canvas' not found","request_params":{"path":"/api/v1/agents/decompose/deep","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 198, in decompose_deep\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: test-canvas' not found\n","user_action":null}
{"bug_id":"BUG-DB6DD86D","timestamp":"2025-12-14T12:10:41.195966Z","endpoint":"/api/v1/agents/explain/oral","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: test-canvas' not found","request_params":{"path":"/api/v1/agents/explain/oral","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 367, in explain_oral\n    return await _call_explanation(request, \"oral\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: test-canvas' not found\n","user_action":null}
{"bug_id":"BUG-C275BF7E","timestamp":"2025-12-14T12:10:41.542161Z","endpoint":"/api/v1/agents/explain/clarification","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: test-canvas' not found","request_params":{"path":"/api/v1/agents/explain/clarification","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 391, in explain_clarification\n    return await _call_explanation(request, \"clarification\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: test-canvas' not found\n","user_action":null}
{"bug_id":"BUG-BB3CE30C","timestamp":"2025-12-14T12:10:41.916869Z","endpoint":"/api/v1/agents/explain/comparison","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: test-canvas' not found","request_params":{"path":"/api/v1/agents/explain/comparison","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 415, in explain_comparison\n    return await _call_explanation(request, \"comparison\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: test-canvas' not found\n","user_action":null}
{"bug_id":"BUG-C5A4A813","timestamp":"2025-12-14T12:10:42.266413Z","endpoint":"/api/v1/agents/explain/memory","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: test-canvas' not found","request_params":{"path":"/api/v1/agents/explain/memory","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 439, in explain_memory\n    return await _call_explanation(request, \"memory\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: test-canvas' not found\n","user_action":null}
{"bug_id":"BUG-B11AAE6C","timestamp":"2025-12-14T12:10:42.600127Z","endpoint":"/api/v1/agents/explain/four-level","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: test-canvas' not found","request_params":{"path":"/api/v1/agents/explain/four-level","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 463, in explain_four_level\n    return await _call_explanation(request, \"four-level\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: test-canvas' not found\n","user_action":null}
{"bug_id":"BUG-61A4EE92","timestamp":"2025-12-14T12:10:42.962230Z","endpoint":"/api/v1/agents/explain/example","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: test-canvas' not found","request_params":{"path":"/api/v1/agents/explain/example","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 487, in explain_example\n    return await _call_explanation(request, \"example\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: test-canvas' not found\n","user_action":null}
{"bug_id":"BUG-5E94F4F7","timestamp":"2025-12-14T12:11:48.897198Z","endpoint":"/api/v1/agents/explain/four-level","error_type":"ValidationError","error_message":"Path traversal detected in canvas name: 2025_lecture_53_05_corrected_hold.pdf-3820ad9e-e32b-4f96-87da-83918ade5c6c/2025_lecture_53_05_corrected_hold.md","request_params":{"path":"/api/v1/agents/explain/four-level","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 463, in explain_four_level\n    return await _call_explanation(request, \"four-level\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 85, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 66, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 62, in _validate_canvas_name\n    raise ValidationError(f\"Path traversal detected in canvas name: {canvas_name}\")\napp.core.exceptions.ValidationError: Path traversal detected in canvas name: 2025_lecture_53_05_corrected_hold.pdf-3820ad9e-e32b-4f96-87da-83918ade5c6c/2025_lecture_53_05_corrected_hold.md\n","user_action":null}
{"bug_id":"BUG-1AD025B9","timestamp":"2025-12-14T12:11:50.267011Z","endpoint":"/api/v1/agents/explain/four-level","error_type":"ValidationError","error_message":"Path traversal detected in canvas name: 2025_lecture_53_05_corrected_hold.pdf-3820ad9e-e32b-4f96-87da-83918ade5c6c/2025_lecture_53_05_corrected_hold.md","request_params":{"path":"/api/v1/agents/explain/four-level","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 463, in explain_four_level\n    return await _call_explanation(request, \"four-level\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 85, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 66, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 62, in _validate_canvas_name\n    raise ValidationError(f\"Path traversal detected in canvas name: {canvas_name}\")\napp.core.exceptions.ValidationError: Path traversal detected in canvas name: 2025_lecture_53_05_corrected_hold.pdf-3820ad9e-e32b-4f96-87da-83918ade5c6c/2025_lecture_53_05_corrected_hold.md\n","user_action":null}
{"bug_id":"BUG-0C6713B3","timestamp":"2025-12-14T12:11:52.588621Z","endpoint":"/api/v1/agents/explain/four-level","error_type":"ValidationError","error_message":"Path traversal detected in canvas name: 2025_lecture_53_05_corrected_hold.pdf-3820ad9e-e32b-4f96-87da-83918ade5c6c/2025_lecture_53_05_corrected_hold.md","request_params":{"path":"/api/v1/agents/explain/four-level","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 463, in explain_four_level\n    return await _call_explanation(request, \"four-level\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 85, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 66, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 62, in _validate_canvas_name\n    raise ValidationError(f\"Path traversal detected in canvas name: {canvas_name}\")\napp.core.exceptions.ValidationError: Path traversal detected in canvas name: 2025_lecture_53_05_corrected_hold.pdf-3820ad9e-e32b-4f96-87da-83918ade5c6c/2025_lecture_53_05_corrected_hold.md\n","user_action":null}
{"bug_id":"BUG-7DE7EED7","timestamp":"2025-12-14T12:11:57.788215Z","endpoint":"/api/v1/agents/explain/four-level","error_type":"ValidationError","error_message":"Path traversal detected in canvas name: 2025_lecture_53_05_corrected_hold.pdf-3820ad9e-e32b-4f96-87da-83918ade5c6c/2025_lecture_53_05_corrected_hold.md","request_params":{"path":"/api/v1/agents/explain/four-level","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 463, in explain_four_level\n    return await _call_explanation(request, \"four-level\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 85, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 66, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 62, in _validate_canvas_name\n    raise ValidationError(f\"Path traversal detected in canvas name: {canvas_name}\")\napp.core.exceptions.ValidationError: Path traversal detected in canvas name: 2025_lecture_53_05_corrected_hold.pdf-3820ad9e-e32b-4f96-87da-83918ade5c6c/2025_lecture_53_05_corrected_hold.md\n","user_action":null}
{"bug_id":"BUG-84A47FEE","timestamp":"2025-12-14T12:16:49.521565Z","endpoint":"/api/v1/agents/explain/four-level","error_type":"ValidationError","error_message":"Path traversal detected in canvas name: 2025_lecture_53_05_corrected_hold.pdf-3820ad9e-e32b-4f96-87da-83918ade5c6c/2025_lecture_53_05_corrected_hold.md","request_params":{"path":"/api/v1/agents/explain/four-level","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 463, in explain_four_level\n    return await _call_explanation(request, \"four-level\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 85, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 66, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 62, in _validate_canvas_name\n    raise ValidationError(f\"Path traversal detected in canvas name: {canvas_name}\")\napp.core.exceptions.ValidationError: Path traversal detected in canvas name: 2025_lecture_53_05_corrected_hold.pdf-3820ad9e-e32b-4f96-87da-83918ade5c6c/2025_lecture_53_05_corrected_hold.md\n","user_action":null}
{"bug_id":"BUG-E2AF1B86","timestamp":"2025-12-14T12:16:50.761876Z","endpoint":"/api/v1/agents/explain/four-level","error_type":"ValidationError","error_message":"Path traversal detected in canvas name: 2025_lecture_53_05_corrected_hold.pdf-3820ad9e-e32b-4f96-87da-83918ade5c6c/2025_lecture_53_05_corrected_hold.md","request_params":{"path":"/api/v1/agents/explain/four-level","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 463, in explain_four_level\n    return await _call_explanation(request, \"four-level\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 85, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 66, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 62, in _validate_canvas_name\n    raise ValidationError(f\"Path traversal detected in canvas name: {canvas_name}\")\napp.core.exceptions.ValidationError: Path traversal detected in canvas name: 2025_lecture_53_05_corrected_hold.pdf-3820ad9e-e32b-4f96-87da-83918ade5c6c/2025_lecture_53_05_corrected_hold.md\n","user_action":null}
{"bug_id":"BUG-8CFCC83B","timestamp":"2025-12-14T12:16:53.043243Z","endpoint":"/api/v1/agents/explain/four-level","error_type":"ValidationError","error_message":"Path traversal detected in canvas name: 2025_lecture_53_05_corrected_hold.pdf-3820ad9e-e32b-4f96-87da-83918ade5c6c/2025_lecture_53_05_corrected_hold.md","request_params":{"path":"/api/v1/agents/explain/four-level","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 463, in explain_four_level\n    return await _call_explanation(request, \"four-level\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 85, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 66, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 62, in _validate_canvas_name\n    raise ValidationError(f\"Path traversal detected in canvas name: {canvas_name}\")\napp.core.exceptions.ValidationError: Path traversal detected in canvas name: 2025_lecture_53_05_corrected_hold.pdf-3820ad9e-e32b-4f96-87da-83918ade5c6c/2025_lecture_53_05_corrected_hold.md\n","user_action":null}
{"bug_id":"BUG-4F1944E2","timestamp":"2025-12-14T12:16:57.316452Z","endpoint":"/api/v1/agents/explain/four-level","error_type":"ValidationError","error_message":"Path traversal detected in canvas name: 2025_lecture_53_05_corrected_hold.pdf-3820ad9e-e32b-4f96-87da-83918ade5c6c/2025_lecture_53_05_corrected_hold.md","request_params":{"path":"/api/v1/agents/explain/four-level","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 463, in explain_four_level\n    return await _call_explanation(request, \"four-level\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 85, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 66, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 62, in _validate_canvas_name\n    raise ValidationError(f\"Path traversal detected in canvas name: {canvas_name}\")\napp.core.exceptions.ValidationError: Path traversal detected in canvas name: 2025_lecture_53_05_corrected_hold.pdf-3820ad9e-e32b-4f96-87da-83918ade5c6c/2025_lecture_53_05_corrected_hold.md\n","user_action":null}
{"bug_id":"BUG-4BF74376","timestamp":"2025-12-15T03:07:43.608163Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: test.canvas' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: test.canvas' not found\n","user_action":null}
{"bug_id":"BUG-D8F10EA1","timestamp":"2025-12-15T03:07:43.938775Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: 笔记库/子目录/test.canvas' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: 笔记库/子目录/test.canvas' not found\n","user_action":null}
{"bug_id":"BUG-E7715AE9","timestamp":"2025-12-15T03:07:44.263793Z","endpoint":"/api/v1/agents/explain/oral","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: 学习/数学/离散数学.canvas' not found","request_params":{"path":"/api/v1/agents/explain/oral","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 367, in explain_oral\n    return await _call_explanation(request, \"oral\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: 学习/数学/离散数学.canvas' not found\n","user_action":null}
{"bug_id":"BUG-CBD51A9D","timestamp":"2025-12-15T03:07:44.586359Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"ValidationError","error_message":"Invalid canvas path: ../../../etc/passwd","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 91, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 72, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 68, in _validate_canvas_name\n    raise ValidationError(f\"Invalid canvas path: {canvas_name}\")\napp.core.exceptions.ValidationError: Invalid canvas path: ../../../etc/passwd\n","user_action":null}
{"bug_id":"BUG-4567F73A","timestamp":"2025-12-15T03:07:45.686505Z","endpoint":"/api/v1/agents/decompose/deep","error_type":"ValidationError","error_message":"Invalid canvas path: test/../secret","request_params":{"path":"/api/v1/agents/decompose/deep","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 198, in decompose_deep\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 91, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 72, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 68, in _validate_canvas_name\n    raise ValidationError(f\"Invalid canvas path: {canvas_name}\")\napp.core.exceptions.ValidationError: Invalid canvas path: test/../secret\n","user_action":null}
{"bug_id":"BUG-0F2FC948","timestamp":"2025-12-15T03:07:46.255448Z","endpoint":"/api/v1/agents/explain/clarification","error_type":"ValidationError","error_message":"Invalid canvas path: test\\file","request_params":{"path":"/api/v1/agents/explain/clarification","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 391, in explain_clarification\n    return await _call_explanation(request, \"clarification\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 91, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 72, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 68, in _validate_canvas_name\n    raise ValidationError(f\"Invalid canvas path: {canvas_name}\")\napp.core.exceptions.ValidationError: Invalid canvas path: test\\file\n","user_action":null}
{"bug_id":"BUG-C5F89866","timestamp":"2025-12-15T03:07:46.599427Z","endpoint":"/api/v1/agents/explain/comparison","error_type":"ValidationError","error_message":"Invalid canvas path: test//file","request_params":{"path":"/api/v1/agents/explain/comparison","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 415, in explain_comparison\n    return await _call_explanation(request, \"comparison\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 91, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 72, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 68, in _validate_canvas_name\n    raise ValidationError(f\"Invalid canvas path: {canvas_name}\")\napp.core.exceptions.ValidationError: Invalid canvas path: test//file\n","user_action":null}
{"bug_id":"BUG-5B9148F5","timestamp":"2025-12-15T03:07:46.935221Z","endpoint":"/api/v1/agents/explain/memory","error_type":"ValidationError","error_message":"Absolute path not allowed: /etc/passwd","request_params":{"path":"/api/v1/agents/explain/memory","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 439, in explain_memory\n    return await _call_explanation(request, \"memory\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 91, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 72, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 62, in _validate_canvas_name\n    raise ValidationError(f\"Absolute path not allowed: {canvas_name}\")\napp.core.exceptions.ValidationError: Absolute path not allowed: /etc/passwd\n","user_action":null}
{"bug_id":"BUG-D9B7A744","timestamp":"2025-12-15T03:07:47.281037Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: folder/subfolder/test.canvas' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: folder/subfolder/test.canvas' not found\n","user_action":null}
{"bug_id":"BUG-D05534CE","timestamp":"2025-12-15T03:07:47.582869Z","endpoint":"/api/v1/agents/decompose/deep","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: folder/subfolder/test.canvas' not found","request_params":{"path":"/api/v1/agents/decompose/deep","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 198, in decompose_deep\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: folder/subfolder/test.canvas' not found\n","user_action":null}
{"bug_id":"BUG-EC120EA3","timestamp":"2025-12-15T03:07:48.169121Z","endpoint":"/api/v1/agents/explain/oral","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: folder/subfolder/test.canvas' not found","request_params":{"path":"/api/v1/agents/explain/oral","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 367, in explain_oral\n    return await _call_explanation(request, \"oral\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: folder/subfolder/test.canvas' not found\n","user_action":null}
{"bug_id":"BUG-95BB25CE","timestamp":"2025-12-15T03:07:48.497156Z","endpoint":"/api/v1/agents/explain/clarification","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: folder/subfolder/test.canvas' not found","request_params":{"path":"/api/v1/agents/explain/clarification","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 391, in explain_clarification\n    return await _call_explanation(request, \"clarification\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: folder/subfolder/test.canvas' not found\n","user_action":null}
{"bug_id":"BUG-59E5CDF2","timestamp":"2025-12-15T03:07:48.790305Z","endpoint":"/api/v1/agents/explain/comparison","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: folder/subfolder/test.canvas' not found","request_params":{"path":"/api/v1/agents/explain/comparison","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 415, in explain_comparison\n    return await _call_explanation(request, \"comparison\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: folder/subfolder/test.canvas' not found\n","user_action":null}
{"bug_id":"BUG-011FEF3F","timestamp":"2025-12-15T03:07:49.105068Z","endpoint":"/api/v1/agents/explain/memory","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: folder/subfolder/test.canvas' not found","request_params":{"path":"/api/v1/agents/explain/memory","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 439, in explain_memory\n    return await _call_explanation(request, \"memory\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: folder/subfolder/test.canvas' not found\n","user_action":null}
{"bug_id":"BUG-0D3C7096","timestamp":"2025-12-15T03:07:49.442852Z","endpoint":"/api/v1/agents/explain/four-level","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: folder/subfolder/test.canvas' not found","request_params":{"path":"/api/v1/agents/explain/four-level","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 463, in explain_four_level\n    return await _call_explanation(request, \"four-level\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: folder/subfolder/test.canvas' not found\n","user_action":null}
{"bug_id":"BUG-8CF00D27","timestamp":"2025-12-15T03:07:49.782053Z","endpoint":"/api/v1/agents/explain/example","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: folder/subfolder/test.canvas' not found","request_params":{"path":"/api/v1/agents/explain/example","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 487, in explain_example\n    return await _call_explanation(request, \"example\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: folder/subfolder/test.canvas' not found\n","user_action":null}
{"bug_id":"BUG-78229F9E","timestamp":"2025-12-15T03:07:50.115178Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"ValidationError","error_message":"Invalid canvas path: ../../../etc/passwd","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 91, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 72, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 68, in _validate_canvas_name\n    raise ValidationError(f\"Invalid canvas path: {canvas_name}\")\napp.core.exceptions.ValidationError: Invalid canvas path: ../../../etc/passwd\n","user_action":null}
{"bug_id":"BUG-DF57DB67","timestamp":"2025-12-15T03:07:50.457259Z","endpoint":"/api/v1/agents/decompose/deep","error_type":"ValidationError","error_message":"Invalid canvas path: ../../../etc/passwd","request_params":{"path":"/api/v1/agents/decompose/deep","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 198, in decompose_deep\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 91, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 72, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 68, in _validate_canvas_name\n    raise ValidationError(f\"Invalid canvas path: {canvas_name}\")\napp.core.exceptions.ValidationError: Invalid canvas path: ../../../etc/passwd\n","user_action":null}
{"bug_id":"BUG-1AB440E1","timestamp":"2025-12-15T03:07:51.100314Z","endpoint":"/api/v1/agents/explain/oral","error_type":"ValidationError","error_message":"Invalid canvas path: ../../../etc/passwd","request_params":{"path":"/api/v1/agents/explain/oral","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 367, in explain_oral\n    return await _call_explanation(request, \"oral\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 91, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 72, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 68, in _validate_canvas_name\n    raise ValidationError(f\"Invalid canvas path: {canvas_name}\")\napp.core.exceptions.ValidationError: Invalid canvas path: ../../../etc/passwd\n","user_action":null}
{"bug_id":"BUG-111B3577","timestamp":"2025-12-15T03:07:51.407183Z","endpoint":"/api/v1/agents/explain/clarification","error_type":"ValidationError","error_message":"Invalid canvas path: ../../../etc/passwd","request_params":{"path":"/api/v1/agents/explain/clarification","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 391, in explain_clarification\n    return await _call_explanation(request, \"clarification\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 91, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 72, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 68, in _validate_canvas_name\n    raise ValidationError(f\"Invalid canvas path: {canvas_name}\")\napp.core.exceptions.ValidationError: Invalid canvas path: ../../../etc/passwd\n","user_action":null}
{"bug_id":"BUG-6D5E7078","timestamp":"2025-12-15T03:07:51.698129Z","endpoint":"/api/v1/agents/explain/comparison","error_type":"ValidationError","error_message":"Invalid canvas path: ../../../etc/passwd","request_params":{"path":"/api/v1/agents/explain/comparison","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 415, in explain_comparison\n    return await _call_explanation(request, \"comparison\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 91, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 72, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 68, in _validate_canvas_name\n    raise ValidationError(f\"Invalid canvas path: {canvas_name}\")\napp.core.exceptions.ValidationError: Invalid canvas path: ../../../etc/passwd\n","user_action":null}
{"bug_id":"BUG-47AD88D6","timestamp":"2025-12-15T03:07:51.947440Z","endpoint":"/api/v1/agents/explain/memory","error_type":"ValidationError","error_message":"Invalid canvas path: ../../../etc/passwd","request_params":{"path":"/api/v1/agents/explain/memory","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 439, in explain_memory\n    return await _call_explanation(request, \"memory\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 91, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 72, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 68, in _validate_canvas_name\n    raise ValidationError(f\"Invalid canvas path: {canvas_name}\")\napp.core.exceptions.ValidationError: Invalid canvas path: ../../../etc/passwd\n","user_action":null}
{"bug_id":"BUG-EDEC2D5F","timestamp":"2025-12-15T03:07:52.237274Z","endpoint":"/api/v1/agents/explain/four-level","error_type":"ValidationError","error_message":"Invalid canvas path: ../../../etc/passwd","request_params":{"path":"/api/v1/agents/explain/four-level","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 463, in explain_four_level\n    return await _call_explanation(request, \"four-level\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 91, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 72, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 68, in _validate_canvas_name\n    raise ValidationError(f\"Invalid canvas path: {canvas_name}\")\napp.core.exceptions.ValidationError: Invalid canvas path: ../../../etc/passwd\n","user_action":null}
{"bug_id":"BUG-3A1C9988","timestamp":"2025-12-15T03:07:52.488901Z","endpoint":"/api/v1/agents/explain/example","error_type":"ValidationError","error_message":"Invalid canvas path: ../../../etc/passwd","request_params":{"path":"/api/v1/agents/explain/example","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 487, in explain_example\n    return await _call_explanation(request, \"example\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 91, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 72, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 68, in _validate_canvas_name\n    raise ValidationError(f\"Invalid canvas path: {canvas_name}\")\napp.core.exceptions.ValidationError: Invalid canvas path: ../../../etc/passwd\n","user_action":null}
{"bug_id":"BUG-1A41214B","timestamp":"2025-12-15T03:07:52.767289Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-63990674","timestamp":"2025-12-15T03:07:53.035229Z","endpoint":"/api/v1/agents/explain/oral","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: 数学/微积分/导数定义.canvas' not found","request_params":{"path":"/api/v1/agents/explain/oral","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 367, in explain_oral\n    return await _call_explanation(request, \"oral\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: 数学/微积分/导数定义.canvas' not found\n","user_action":null}
{"bug_id":"BUG-4D3FF99F","timestamp":"2025-12-15T03:07:53.332542Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.canvas' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.canvas' not found\n","user_action":null}
{"bug_id":"BUG-FC2BE363","timestamp":"2025-12-15T03:07:53.647423Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: test-file_2024 (copy).canvas' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: test-file_2024 (copy).canvas' not found\n","user_action":null}
{"bug_id":"BUG-54298FB6","timestamp":"2025-12-15T03:08:46.359475Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: test.canvas' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: test.canvas' not found\n","user_action":null}
{"bug_id":"BUG-300CD0A6","timestamp":"2025-12-15T03:08:46.671312Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: 笔记库/子目录/test.canvas' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: 笔记库/子目录/test.canvas' not found\n","user_action":null}
{"bug_id":"BUG-FF29AA07","timestamp":"2025-12-15T03:08:46.997366Z","endpoint":"/api/v1/agents/explain/oral","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: 学习/数学/离散数学.canvas' not found","request_params":{"path":"/api/v1/agents/explain/oral","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 367, in explain_oral\n    return await _call_explanation(request, \"oral\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: 学习/数学/离散数学.canvas' not found\n","user_action":null}
{"bug_id":"BUG-92684C4A","timestamp":"2025-12-15T03:08:47.322010Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"ValidationError","error_message":"Invalid canvas path: ../../../etc/passwd","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 91, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 72, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 68, in _validate_canvas_name\n    raise ValidationError(f\"Invalid canvas path: {canvas_name}\")\napp.core.exceptions.ValidationError: Invalid canvas path: ../../../etc/passwd\n","user_action":null}
{"bug_id":"BUG-A8A770E6","timestamp":"2025-12-15T03:08:47.630349Z","endpoint":"/api/v1/agents/decompose/deep","error_type":"ValidationError","error_message":"Invalid canvas path: test/../secret","request_params":{"path":"/api/v1/agents/decompose/deep","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 198, in decompose_deep\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 91, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 72, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 68, in _validate_canvas_name\n    raise ValidationError(f\"Invalid canvas path: {canvas_name}\")\napp.core.exceptions.ValidationError: Invalid canvas path: test/../secret\n","user_action":null}
{"bug_id":"BUG-60E9174B","timestamp":"2025-12-15T03:08:48.260785Z","endpoint":"/api/v1/agents/explain/clarification","error_type":"ValidationError","error_message":"Invalid canvas path: test\\file","request_params":{"path":"/api/v1/agents/explain/clarification","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 391, in explain_clarification\n    return await _call_explanation(request, \"clarification\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 91, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 72, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 68, in _validate_canvas_name\n    raise ValidationError(f\"Invalid canvas path: {canvas_name}\")\napp.core.exceptions.ValidationError: Invalid canvas path: test\\file\n","user_action":null}
{"bug_id":"BUG-AB997441","timestamp":"2025-12-15T03:08:48.580632Z","endpoint":"/api/v1/agents/explain/comparison","error_type":"ValidationError","error_message":"Invalid canvas path: test//file","request_params":{"path":"/api/v1/agents/explain/comparison","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 415, in explain_comparison\n    return await _call_explanation(request, \"comparison\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 91, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 72, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 68, in _validate_canvas_name\n    raise ValidationError(f\"Invalid canvas path: {canvas_name}\")\napp.core.exceptions.ValidationError: Invalid canvas path: test//file\n","user_action":null}
{"bug_id":"BUG-28B34489","timestamp":"2025-12-15T03:08:48.880624Z","endpoint":"/api/v1/agents/explain/memory","error_type":"ValidationError","error_message":"Absolute path not allowed: /etc/passwd","request_params":{"path":"/api/v1/agents/explain/memory","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 439, in explain_memory\n    return await _call_explanation(request, \"memory\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 91, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 72, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 62, in _validate_canvas_name\n    raise ValidationError(f\"Absolute path not allowed: {canvas_name}\")\napp.core.exceptions.ValidationError: Absolute path not allowed: /etc/passwd\n","user_action":null}
{"bug_id":"BUG-14E1AA57","timestamp":"2025-12-15T03:08:49.194197Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: folder/subfolder/test.canvas' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: folder/subfolder/test.canvas' not found\n","user_action":null}
{"bug_id":"BUG-6002E620","timestamp":"2025-12-15T03:08:49.514315Z","endpoint":"/api/v1/agents/decompose/deep","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: folder/subfolder/test.canvas' not found","request_params":{"path":"/api/v1/agents/decompose/deep","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 198, in decompose_deep\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: folder/subfolder/test.canvas' not found\n","user_action":null}
{"bug_id":"BUG-DDC0A712","timestamp":"2025-12-15T03:08:50.134569Z","endpoint":"/api/v1/agents/explain/oral","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: folder/subfolder/test.canvas' not found","request_params":{"path":"/api/v1/agents/explain/oral","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 367, in explain_oral\n    return await _call_explanation(request, \"oral\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: folder/subfolder/test.canvas' not found\n","user_action":null}
{"bug_id":"BUG-5C617DA2","timestamp":"2025-12-15T03:08:50.460900Z","endpoint":"/api/v1/agents/explain/clarification","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: folder/subfolder/test.canvas' not found","request_params":{"path":"/api/v1/agents/explain/clarification","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 391, in explain_clarification\n    return await _call_explanation(request, \"clarification\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: folder/subfolder/test.canvas' not found\n","user_action":null}
{"bug_id":"BUG-A9DD3B2A","timestamp":"2025-12-15T03:08:50.792891Z","endpoint":"/api/v1/agents/explain/comparison","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: folder/subfolder/test.canvas' not found","request_params":{"path":"/api/v1/agents/explain/comparison","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 415, in explain_comparison\n    return await _call_explanation(request, \"comparison\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: folder/subfolder/test.canvas' not found\n","user_action":null}
{"bug_id":"BUG-EBC156B5","timestamp":"2025-12-15T03:08:51.118769Z","endpoint":"/api/v1/agents/explain/memory","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: folder/subfolder/test.canvas' not found","request_params":{"path":"/api/v1/agents/explain/memory","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 439, in explain_memory\n    return await _call_explanation(request, \"memory\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: folder/subfolder/test.canvas' not found\n","user_action":null}
{"bug_id":"BUG-9548E738","timestamp":"2025-12-15T03:08:51.456259Z","endpoint":"/api/v1/agents/explain/four-level","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: folder/subfolder/test.canvas' not found","request_params":{"path":"/api/v1/agents/explain/four-level","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 463, in explain_four_level\n    return await _call_explanation(request, \"four-level\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: folder/subfolder/test.canvas' not found\n","user_action":null}
{"bug_id":"BUG-A6FB5628","timestamp":"2025-12-15T03:08:51.793729Z","endpoint":"/api/v1/agents/explain/example","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: folder/subfolder/test.canvas' not found","request_params":{"path":"/api/v1/agents/explain/example","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 487, in explain_example\n    return await _call_explanation(request, \"example\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: folder/subfolder/test.canvas' not found\n","user_action":null}
{"bug_id":"BUG-C114D7C6","timestamp":"2025-12-15T03:08:52.136173Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"ValidationError","error_message":"Invalid canvas path: ../../../etc/passwd","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 91, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 72, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 68, in _validate_canvas_name\n    raise ValidationError(f\"Invalid canvas path: {canvas_name}\")\napp.core.exceptions.ValidationError: Invalid canvas path: ../../../etc/passwd\n","user_action":null}
{"bug_id":"BUG-4F360747","timestamp":"2025-12-15T03:08:52.467926Z","endpoint":"/api/v1/agents/decompose/deep","error_type":"ValidationError","error_message":"Invalid canvas path: ../../../etc/passwd","request_params":{"path":"/api/v1/agents/decompose/deep","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 198, in decompose_deep\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 91, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 72, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 68, in _validate_canvas_name\n    raise ValidationError(f\"Invalid canvas path: {canvas_name}\")\napp.core.exceptions.ValidationError: Invalid canvas path: ../../../etc/passwd\n","user_action":null}
{"bug_id":"BUG-EBB6BB79","timestamp":"2025-12-15T03:08:53.064685Z","endpoint":"/api/v1/agents/explain/oral","error_type":"ValidationError","error_message":"Invalid canvas path: ../../../etc/passwd","request_params":{"path":"/api/v1/agents/explain/oral","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 367, in explain_oral\n    return await _call_explanation(request, \"oral\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 91, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 72, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 68, in _validate_canvas_name\n    raise ValidationError(f\"Invalid canvas path: {canvas_name}\")\napp.core.exceptions.ValidationError: Invalid canvas path: ../../../etc/passwd\n","user_action":null}
{"bug_id":"BUG-E7A8443E","timestamp":"2025-12-15T03:08:53.398178Z","endpoint":"/api/v1/agents/explain/clarification","error_type":"ValidationError","error_message":"Invalid canvas path: ../../../etc/passwd","request_params":{"path":"/api/v1/agents/explain/clarification","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 391, in explain_clarification\n    return await _call_explanation(request, \"clarification\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 91, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 72, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 68, in _validate_canvas_name\n    raise ValidationError(f\"Invalid canvas path: {canvas_name}\")\napp.core.exceptions.ValidationError: Invalid canvas path: ../../../etc/passwd\n","user_action":null}
{"bug_id":"BUG-BF160C42","timestamp":"2025-12-15T03:08:53.728779Z","endpoint":"/api/v1/agents/explain/comparison","error_type":"ValidationError","error_message":"Invalid canvas path: ../../../etc/passwd","request_params":{"path":"/api/v1/agents/explain/comparison","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 415, in explain_comparison\n    return await _call_explanation(request, \"comparison\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 91, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 72, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 68, in _validate_canvas_name\n    raise ValidationError(f\"Invalid canvas path: {canvas_name}\")\napp.core.exceptions.ValidationError: Invalid canvas path: ../../../etc/passwd\n","user_action":null}
{"bug_id":"BUG-605EBCD0","timestamp":"2025-12-15T03:08:54.010506Z","endpoint":"/api/v1/agents/explain/memory","error_type":"ValidationError","error_message":"Invalid canvas path: ../../../etc/passwd","request_params":{"path":"/api/v1/agents/explain/memory","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 439, in explain_memory\n    return await _call_explanation(request, \"memory\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 91, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 72, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 68, in _validate_canvas_name\n    raise ValidationError(f\"Invalid canvas path: {canvas_name}\")\napp.core.exceptions.ValidationError: Invalid canvas path: ../../../etc/passwd\n","user_action":null}
{"bug_id":"BUG-269C006E","timestamp":"2025-12-15T03:08:54.314773Z","endpoint":"/api/v1/agents/explain/four-level","error_type":"ValidationError","error_message":"Invalid canvas path: ../../../etc/passwd","request_params":{"path":"/api/v1/agents/explain/four-level","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 463, in explain_four_level\n    return await _call_explanation(request, \"four-level\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 91, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 72, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 68, in _validate_canvas_name\n    raise ValidationError(f\"Invalid canvas path: {canvas_name}\")\napp.core.exceptions.ValidationError: Invalid canvas path: ../../../etc/passwd\n","user_action":null}
{"bug_id":"BUG-C76C05F0","timestamp":"2025-12-15T03:08:54.628905Z","endpoint":"/api/v1/agents/explain/example","error_type":"ValidationError","error_message":"Invalid canvas path: ../../../etc/passwd","request_params":{"path":"/api/v1/agents/explain/example","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 487, in explain_example\n    return await _call_explanation(request, \"example\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 91, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 72, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 68, in _validate_canvas_name\n    raise ValidationError(f\"Invalid canvas path: {canvas_name}\")\napp.core.exceptions.ValidationError: Invalid canvas path: ../../../etc/passwd\n","user_action":null}
{"bug_id":"BUG-2272BB59","timestamp":"2025-12-15T03:08:54.923434Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-9326FDDE","timestamp":"2025-12-15T03:08:55.229469Z","endpoint":"/api/v1/agents/explain/oral","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: 数学/微积分/导数定义.canvas' not found","request_params":{"path":"/api/v1/agents/explain/oral","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 367, in explain_oral\n    return await _call_explanation(request, \"oral\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: 数学/微积分/导数定义.canvas' not found\n","user_action":null}
{"bug_id":"BUG-988E4949","timestamp":"2025-12-15T03:08:55.554463Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.canvas' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.canvas' not found\n","user_action":null}
{"bug_id":"BUG-61D3E905","timestamp":"2025-12-15T03:08:55.848455Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: test-file_2024 (copy).canvas' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: test-file_2024 (copy).canvas' not found\n","user_action":null}
{"bug_id":"BUG-3CECBBAC","timestamp":"2025-12-15T03:10:01.343084Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: test.canvas' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: test.canvas' not found\n","user_action":null}
{"bug_id":"BUG-EF970D4B","timestamp":"2025-12-15T03:10:01.692942Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: 笔记库/子目录/test.canvas' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: 笔记库/子目录/test.canvas' not found\n","user_action":null}
{"bug_id":"BUG-7651F736","timestamp":"2025-12-15T03:10:02.031172Z","endpoint":"/api/v1/agents/explain/oral","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: 学习/数学/离散数学.canvas' not found","request_params":{"path":"/api/v1/agents/explain/oral","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 367, in explain_oral\n    return await _call_explanation(request, \"oral\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: 学习/数学/离散数学.canvas' not found\n","user_action":null}
{"bug_id":"BUG-4ACDE8F2","timestamp":"2025-12-15T03:10:02.398442Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"ValidationError","error_message":"Invalid canvas path: ../../../etc/passwd","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 91, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 72, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 68, in _validate_canvas_name\n    raise ValidationError(f\"Invalid canvas path: {canvas_name}\")\napp.core.exceptions.ValidationError: Invalid canvas path: ../../../etc/passwd\n","user_action":null}
{"bug_id":"BUG-41E3DC70","timestamp":"2025-12-15T03:10:02.731241Z","endpoint":"/api/v1/agents/decompose/deep","error_type":"ValidationError","error_message":"Invalid canvas path: test/../secret","request_params":{"path":"/api/v1/agents/decompose/deep","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 198, in decompose_deep\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 91, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 72, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 68, in _validate_canvas_name\n    raise ValidationError(f\"Invalid canvas path: {canvas_name}\")\napp.core.exceptions.ValidationError: Invalid canvas path: test/../secret\n","user_action":null}
{"bug_id":"BUG-046CFD9A","timestamp":"2025-12-15T03:10:03.380291Z","endpoint":"/api/v1/agents/explain/clarification","error_type":"ValidationError","error_message":"Invalid canvas path: test\\file","request_params":{"path":"/api/v1/agents/explain/clarification","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 391, in explain_clarification\n    return await _call_explanation(request, \"clarification\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 91, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 72, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 68, in _validate_canvas_name\n    raise ValidationError(f\"Invalid canvas path: {canvas_name}\")\napp.core.exceptions.ValidationError: Invalid canvas path: test\\file\n","user_action":null}
{"bug_id":"BUG-256AD075","timestamp":"2025-12-15T03:10:03.722455Z","endpoint":"/api/v1/agents/explain/comparison","error_type":"ValidationError","error_message":"Invalid canvas path: test//file","request_params":{"path":"/api/v1/agents/explain/comparison","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 415, in explain_comparison\n    return await _call_explanation(request, \"comparison\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 91, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 72, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 68, in _validate_canvas_name\n    raise ValidationError(f\"Invalid canvas path: {canvas_name}\")\napp.core.exceptions.ValidationError: Invalid canvas path: test//file\n","user_action":null}
{"bug_id":"BUG-69295BAD","timestamp":"2025-12-15T03:10:04.008202Z","endpoint":"/api/v1/agents/explain/memory","error_type":"ValidationError","error_message":"Absolute path not allowed: /etc/passwd","request_params":{"path":"/api/v1/agents/explain/memory","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 439, in explain_memory\n    return await _call_explanation(request, \"memory\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 91, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 72, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 62, in _validate_canvas_name\n    raise ValidationError(f\"Absolute path not allowed: {canvas_name}\")\napp.core.exceptions.ValidationError: Absolute path not allowed: /etc/passwd\n","user_action":null}
{"bug_id":"BUG-A4E256E6","timestamp":"2025-12-15T03:10:04.335709Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: folder/subfolder/test.canvas' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: folder/subfolder/test.canvas' not found\n","user_action":null}
{"bug_id":"BUG-B65ED2C9","timestamp":"2025-12-15T03:10:04.654399Z","endpoint":"/api/v1/agents/decompose/deep","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: folder/subfolder/test.canvas' not found","request_params":{"path":"/api/v1/agents/decompose/deep","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 198, in decompose_deep\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: folder/subfolder/test.canvas' not found\n","user_action":null}
{"bug_id":"BUG-CC9FF1AE","timestamp":"2025-12-15T03:10:05.227213Z","endpoint":"/api/v1/agents/explain/oral","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: folder/subfolder/test.canvas' not found","request_params":{"path":"/api/v1/agents/explain/oral","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 367, in explain_oral\n    return await _call_explanation(request, \"oral\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: folder/subfolder/test.canvas' not found\n","user_action":null}
{"bug_id":"BUG-28ECE3C5","timestamp":"2025-12-15T03:10:05.502676Z","endpoint":"/api/v1/agents/explain/clarification","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: folder/subfolder/test.canvas' not found","request_params":{"path":"/api/v1/agents/explain/clarification","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 391, in explain_clarification\n    return await _call_explanation(request, \"clarification\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: folder/subfolder/test.canvas' not found\n","user_action":null}
{"bug_id":"BUG-A962ADF9","timestamp":"2025-12-15T03:10:05.840603Z","endpoint":"/api/v1/agents/explain/comparison","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: folder/subfolder/test.canvas' not found","request_params":{"path":"/api/v1/agents/explain/comparison","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 415, in explain_comparison\n    return await _call_explanation(request, \"comparison\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: folder/subfolder/test.canvas' not found\n","user_action":null}
{"bug_id":"BUG-425161B2","timestamp":"2025-12-15T03:10:06.114879Z","endpoint":"/api/v1/agents/explain/memory","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: folder/subfolder/test.canvas' not found","request_params":{"path":"/api/v1/agents/explain/memory","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 439, in explain_memory\n    return await _call_explanation(request, \"memory\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: folder/subfolder/test.canvas' not found\n","user_action":null}
{"bug_id":"BUG-D4B46B8E","timestamp":"2025-12-15T03:10:06.453593Z","endpoint":"/api/v1/agents/explain/four-level","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: folder/subfolder/test.canvas' not found","request_params":{"path":"/api/v1/agents/explain/four-level","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 463, in explain_four_level\n    return await _call_explanation(request, \"four-level\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: folder/subfolder/test.canvas' not found\n","user_action":null}
{"bug_id":"BUG-32E3D9CA","timestamp":"2025-12-15T03:10:06.741488Z","endpoint":"/api/v1/agents/explain/example","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: folder/subfolder/test.canvas' not found","request_params":{"path":"/api/v1/agents/explain/example","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 487, in explain_example\n    return await _call_explanation(request, \"example\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: folder/subfolder/test.canvas' not found\n","user_action":null}
{"bug_id":"BUG-F5DE4E41","timestamp":"2025-12-15T03:10:07.042347Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"ValidationError","error_message":"Invalid canvas path: ../../../etc/passwd","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 91, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 72, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 68, in _validate_canvas_name\n    raise ValidationError(f\"Invalid canvas path: {canvas_name}\")\napp.core.exceptions.ValidationError: Invalid canvas path: ../../../etc/passwd\n","user_action":null}
{"bug_id":"BUG-4B93C77F","timestamp":"2025-12-15T03:10:07.302274Z","endpoint":"/api/v1/agents/decompose/deep","error_type":"ValidationError","error_message":"Invalid canvas path: ../../../etc/passwd","request_params":{"path":"/api/v1/agents/decompose/deep","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 198, in decompose_deep\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 91, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 72, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 68, in _validate_canvas_name\n    raise ValidationError(f\"Invalid canvas path: {canvas_name}\")\napp.core.exceptions.ValidationError: Invalid canvas path: ../../../etc/passwd\n","user_action":null}
{"bug_id":"BUG-1EA40B20","timestamp":"2025-12-15T03:10:07.873127Z","endpoint":"/api/v1/agents/explain/oral","error_type":"ValidationError","error_message":"Invalid canvas path: ../../../etc/passwd","request_params":{"path":"/api/v1/agents/explain/oral","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 367, in explain_oral\n    return await _call_explanation(request, \"oral\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 91, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 72, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 68, in _validate_canvas_name\n    raise ValidationError(f\"Invalid canvas path: {canvas_name}\")\napp.core.exceptions.ValidationError: Invalid canvas path: ../../../etc/passwd\n","user_action":null}
{"bug_id":"BUG-E7173B7B","timestamp":"2025-12-15T03:10:08.173064Z","endpoint":"/api/v1/agents/explain/clarification","error_type":"ValidationError","error_message":"Invalid canvas path: ../../../etc/passwd","request_params":{"path":"/api/v1/agents/explain/clarification","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 391, in explain_clarification\n    return await _call_explanation(request, \"clarification\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 91, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 72, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 68, in _validate_canvas_name\n    raise ValidationError(f\"Invalid canvas path: {canvas_name}\")\napp.core.exceptions.ValidationError: Invalid canvas path: ../../../etc/passwd\n","user_action":null}
{"bug_id":"BUG-DD716ACE","timestamp":"2025-12-15T03:10:08.454767Z","endpoint":"/api/v1/agents/explain/comparison","error_type":"ValidationError","error_message":"Invalid canvas path: ../../../etc/passwd","request_params":{"path":"/api/v1/agents/explain/comparison","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 415, in explain_comparison\n    return await _call_explanation(request, \"comparison\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 91, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 72, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 68, in _validate_canvas_name\n    raise ValidationError(f\"Invalid canvas path: {canvas_name}\")\napp.core.exceptions.ValidationError: Invalid canvas path: ../../../etc/passwd\n","user_action":null}
{"bug_id":"BUG-77AACEC0","timestamp":"2025-12-15T03:10:08.741089Z","endpoint":"/api/v1/agents/explain/memory","error_type":"ValidationError","error_message":"Invalid canvas path: ../../../etc/passwd","request_params":{"path":"/api/v1/agents/explain/memory","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 439, in explain_memory\n    return await _call_explanation(request, \"memory\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 91, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 72, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 68, in _validate_canvas_name\n    raise ValidationError(f\"Invalid canvas path: {canvas_name}\")\napp.core.exceptions.ValidationError: Invalid canvas path: ../../../etc/passwd\n","user_action":null}
{"bug_id":"BUG-D006E0FE","timestamp":"2025-12-15T03:10:09.055678Z","endpoint":"/api/v1/agents/explain/four-level","error_type":"ValidationError","error_message":"Invalid canvas path: ../../../etc/passwd","request_params":{"path":"/api/v1/agents/explain/four-level","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 463, in explain_four_level\n    return await _call_explanation(request, \"four-level\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 91, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 72, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 68, in _validate_canvas_name\n    raise ValidationError(f\"Invalid canvas path: {canvas_name}\")\napp.core.exceptions.ValidationError: Invalid canvas path: ../../../etc/passwd\n","user_action":null}
{"bug_id":"BUG-74D35B37","timestamp":"2025-12-15T03:10:09.393518Z","endpoint":"/api/v1/agents/explain/example","error_type":"ValidationError","error_message":"Invalid canvas path: ../../../etc/passwd","request_params":{"path":"/api/v1/agents/explain/example","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 487, in explain_example\n    return await _call_explanation(request, \"example\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 91, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 72, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 68, in _validate_canvas_name\n    raise ValidationError(f\"Invalid canvas path: {canvas_name}\")\napp.core.exceptions.ValidationError: Invalid canvas path: ../../../etc/passwd\n","user_action":null}
{"bug_id":"BUG-B348176A","timestamp":"2025-12-15T03:10:09.685641Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-07241053","timestamp":"2025-12-15T03:10:10.008868Z","endpoint":"/api/v1/agents/explain/oral","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: 数学/微积分/导数定义.canvas' not found","request_params":{"path":"/api/v1/agents/explain/oral","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 367, in explain_oral\n    return await _call_explanation(request, \"oral\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: 数学/微积分/导数定义.canvas' not found\n","user_action":null}
{"bug_id":"BUG-A1881409","timestamp":"2025-12-15T03:10:10.327334Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.canvas' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.canvas' not found\n","user_action":null}
{"bug_id":"BUG-788C2EC2","timestamp":"2025-12-15T03:10:10.658868Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: test-file_2024 (copy).canvas' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: test-file_2024 (copy).canvas' not found\n","user_action":null}
{"bug_id":"BUG-99CC4A60","timestamp":"2025-12-15T03:15:01.792217Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: test.canvas' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: test.canvas' not found\n","user_action":null}
{"bug_id":"BUG-F731AFDB","timestamp":"2025-12-15T03:15:02.131525Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: 笔记库/子目录/test.canvas' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: 笔记库/子目录/test.canvas' not found\n","user_action":null}
{"bug_id":"BUG-EBFB87B1","timestamp":"2025-12-15T03:15:02.408578Z","endpoint":"/api/v1/agents/explain/oral","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: 学习/数学/离散数学.canvas' not found","request_params":{"path":"/api/v1/agents/explain/oral","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 367, in explain_oral\n    return await _call_explanation(request, \"oral\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: 学习/数学/离散数学.canvas' not found\n","user_action":null}
{"bug_id":"BUG-407B1B2B","timestamp":"2025-12-15T03:15:02.710837Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"ValidationError","error_message":"Invalid canvas path: ../../../etc/passwd","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 91, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 72, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 68, in _validate_canvas_name\n    raise ValidationError(f\"Invalid canvas path: {canvas_name}\")\napp.core.exceptions.ValidationError: Invalid canvas path: ../../../etc/passwd\n","user_action":null}
{"bug_id":"BUG-94079833","timestamp":"2025-12-15T03:15:03.002436Z","endpoint":"/api/v1/agents/decompose/deep","error_type":"ValidationError","error_message":"Invalid canvas path: test/../secret","request_params":{"path":"/api/v1/agents/decompose/deep","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 198, in decompose_deep\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 91, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 72, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 68, in _validate_canvas_name\n    raise ValidationError(f\"Invalid canvas path: {canvas_name}\")\napp.core.exceptions.ValidationError: Invalid canvas path: test/../secret\n","user_action":null}
{"bug_id":"BUG-EE16AA65","timestamp":"2025-12-15T03:15:03.641750Z","endpoint":"/api/v1/agents/explain/clarification","error_type":"ValidationError","error_message":"Invalid canvas path: test\\file","request_params":{"path":"/api/v1/agents/explain/clarification","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 391, in explain_clarification\n    return await _call_explanation(request, \"clarification\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 91, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 72, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 68, in _validate_canvas_name\n    raise ValidationError(f\"Invalid canvas path: {canvas_name}\")\napp.core.exceptions.ValidationError: Invalid canvas path: test\\file\n","user_action":null}
{"bug_id":"BUG-13812643","timestamp":"2025-12-15T03:15:03.967687Z","endpoint":"/api/v1/agents/explain/comparison","error_type":"ValidationError","error_message":"Invalid canvas path: test//file","request_params":{"path":"/api/v1/agents/explain/comparison","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 415, in explain_comparison\n    return await _call_explanation(request, \"comparison\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 91, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 72, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 68, in _validate_canvas_name\n    raise ValidationError(f\"Invalid canvas path: {canvas_name}\")\napp.core.exceptions.ValidationError: Invalid canvas path: test//file\n","user_action":null}
{"bug_id":"BUG-269430A6","timestamp":"2025-12-15T03:15:04.280168Z","endpoint":"/api/v1/agents/explain/memory","error_type":"ValidationError","error_message":"Absolute path not allowed: /etc/passwd","request_params":{"path":"/api/v1/agents/explain/memory","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 439, in explain_memory\n    return await _call_explanation(request, \"memory\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 91, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 72, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 62, in _validate_canvas_name\n    raise ValidationError(f\"Absolute path not allowed: {canvas_name}\")\napp.core.exceptions.ValidationError: Absolute path not allowed: /etc/passwd\n","user_action":null}
{"bug_id":"BUG-34865C45","timestamp":"2025-12-15T03:15:04.588493Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: folder/subfolder/test.canvas' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: folder/subfolder/test.canvas' not found\n","user_action":null}
{"bug_id":"BUG-377C1C0B","timestamp":"2025-12-15T03:15:04.919592Z","endpoint":"/api/v1/agents/decompose/deep","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: folder/subfolder/test.canvas' not found","request_params":{"path":"/api/v1/agents/decompose/deep","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 198, in decompose_deep\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: folder/subfolder/test.canvas' not found\n","user_action":null}
{"bug_id":"BUG-1EFD0438","timestamp":"2025-12-15T03:15:05.504296Z","endpoint":"/api/v1/agents/explain/oral","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: folder/subfolder/test.canvas' not found","request_params":{"path":"/api/v1/agents/explain/oral","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 367, in explain_oral\n    return await _call_explanation(request, \"oral\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: folder/subfolder/test.canvas' not found\n","user_action":null}
{"bug_id":"BUG-80563AB2","timestamp":"2025-12-15T03:15:05.805749Z","endpoint":"/api/v1/agents/explain/clarification","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: folder/subfolder/test.canvas' not found","request_params":{"path":"/api/v1/agents/explain/clarification","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 391, in explain_clarification\n    return await _call_explanation(request, \"clarification\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: folder/subfolder/test.canvas' not found\n","user_action":null}
{"bug_id":"BUG-BBDA6771","timestamp":"2025-12-15T03:15:06.144537Z","endpoint":"/api/v1/agents/explain/comparison","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: folder/subfolder/test.canvas' not found","request_params":{"path":"/api/v1/agents/explain/comparison","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 415, in explain_comparison\n    return await _call_explanation(request, \"comparison\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: folder/subfolder/test.canvas' not found\n","user_action":null}
{"bug_id":"BUG-B40FCED0","timestamp":"2025-12-15T03:15:06.429337Z","endpoint":"/api/v1/agents/explain/memory","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: folder/subfolder/test.canvas' not found","request_params":{"path":"/api/v1/agents/explain/memory","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 439, in explain_memory\n    return await _call_explanation(request, \"memory\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: folder/subfolder/test.canvas' not found\n","user_action":null}
{"bug_id":"BUG-894BB913","timestamp":"2025-12-15T03:15:06.736628Z","endpoint":"/api/v1/agents/explain/four-level","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: folder/subfolder/test.canvas' not found","request_params":{"path":"/api/v1/agents/explain/four-level","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 463, in explain_four_level\n    return await _call_explanation(request, \"four-level\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: folder/subfolder/test.canvas' not found\n","user_action":null}
{"bug_id":"BUG-E888A0D1","timestamp":"2025-12-15T03:15:07.041482Z","endpoint":"/api/v1/agents/explain/example","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: folder/subfolder/test.canvas' not found","request_params":{"path":"/api/v1/agents/explain/example","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 487, in explain_example\n    return await _call_explanation(request, \"example\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: folder/subfolder/test.canvas' not found\n","user_action":null}
{"bug_id":"BUG-76072829","timestamp":"2025-12-15T03:15:07.360090Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"ValidationError","error_message":"Invalid canvas path: ../../../etc/passwd","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 91, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 72, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 68, in _validate_canvas_name\n    raise ValidationError(f\"Invalid canvas path: {canvas_name}\")\napp.core.exceptions.ValidationError: Invalid canvas path: ../../../etc/passwd\n","user_action":null}
{"bug_id":"BUG-B25FE224","timestamp":"2025-12-15T03:15:07.636302Z","endpoint":"/api/v1/agents/decompose/deep","error_type":"ValidationError","error_message":"Invalid canvas path: ../../../etc/passwd","request_params":{"path":"/api/v1/agents/decompose/deep","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 198, in decompose_deep\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 91, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 72, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 68, in _validate_canvas_name\n    raise ValidationError(f\"Invalid canvas path: {canvas_name}\")\napp.core.exceptions.ValidationError: Invalid canvas path: ../../../etc/passwd\n","user_action":null}
{"bug_id":"BUG-9C25D99D","timestamp":"2025-12-15T03:15:08.302514Z","endpoint":"/api/v1/agents/explain/oral","error_type":"ValidationError","error_message":"Invalid canvas path: ../../../etc/passwd","request_params":{"path":"/api/v1/agents/explain/oral","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 367, in explain_oral\n    return await _call_explanation(request, \"oral\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 91, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 72, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 68, in _validate_canvas_name\n    raise ValidationError(f\"Invalid canvas path: {canvas_name}\")\napp.core.exceptions.ValidationError: Invalid canvas path: ../../../etc/passwd\n","user_action":null}
{"bug_id":"BUG-82B54F60","timestamp":"2025-12-15T03:15:08.623577Z","endpoint":"/api/v1/agents/explain/clarification","error_type":"ValidationError","error_message":"Invalid canvas path: ../../../etc/passwd","request_params":{"path":"/api/v1/agents/explain/clarification","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 391, in explain_clarification\n    return await _call_explanation(request, \"clarification\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 91, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 72, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 68, in _validate_canvas_name\n    raise ValidationError(f\"Invalid canvas path: {canvas_name}\")\napp.core.exceptions.ValidationError: Invalid canvas path: ../../../etc/passwd\n","user_action":null}
{"bug_id":"BUG-672F7068","timestamp":"2025-12-15T03:15:08.947770Z","endpoint":"/api/v1/agents/explain/comparison","error_type":"ValidationError","error_message":"Invalid canvas path: ../../../etc/passwd","request_params":{"path":"/api/v1/agents/explain/comparison","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 415, in explain_comparison\n    return await _call_explanation(request, \"comparison\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 91, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 72, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 68, in _validate_canvas_name\n    raise ValidationError(f\"Invalid canvas path: {canvas_name}\")\napp.core.exceptions.ValidationError: Invalid canvas path: ../../../etc/passwd\n","user_action":null}
{"bug_id":"BUG-27438C7D","timestamp":"2025-12-15T03:15:09.260744Z","endpoint":"/api/v1/agents/explain/memory","error_type":"ValidationError","error_message":"Invalid canvas path: ../../../etc/passwd","request_params":{"path":"/api/v1/agents/explain/memory","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 439, in explain_memory\n    return await _call_explanation(request, \"memory\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 91, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 72, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 68, in _validate_canvas_name\n    raise ValidationError(f\"Invalid canvas path: {canvas_name}\")\napp.core.exceptions.ValidationError: Invalid canvas path: ../../../etc/passwd\n","user_action":null}
{"bug_id":"BUG-8DD7D521","timestamp":"2025-12-15T03:15:09.566121Z","endpoint":"/api/v1/agents/explain/four-level","error_type":"ValidationError","error_message":"Invalid canvas path: ../../../etc/passwd","request_params":{"path":"/api/v1/agents/explain/four-level","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 463, in explain_four_level\n    return await _call_explanation(request, \"four-level\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 91, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 72, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 68, in _validate_canvas_name\n    raise ValidationError(f\"Invalid canvas path: {canvas_name}\")\napp.core.exceptions.ValidationError: Invalid canvas path: ../../../etc/passwd\n","user_action":null}
{"bug_id":"BUG-FD56C02F","timestamp":"2025-12-15T03:15:09.857215Z","endpoint":"/api/v1/agents/explain/example","error_type":"ValidationError","error_message":"Invalid canvas path: ../../../etc/passwd","request_params":{"path":"/api/v1/agents/explain/example","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 487, in explain_example\n    return await _call_explanation(request, \"example\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 91, in read_canvas\n    canvas_path = self._get_canvas_path(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 72, in _get_canvas_path\n    self._validate_canvas_name(canvas_name)\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 68, in _validate_canvas_name\n    raise ValidationError(f\"Invalid canvas path: {canvas_name}\")\napp.core.exceptions.ValidationError: Invalid canvas path: ../../../etc/passwd\n","user_action":null}
{"bug_id":"BUG-11BDD368","timestamp":"2025-12-15T03:15:10.155378Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: ' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: ' not found\n","user_action":null}
{"bug_id":"BUG-D6B4A278","timestamp":"2025-12-15T03:15:10.430136Z","endpoint":"/api/v1/agents/explain/oral","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: 数学/微积分/导数定义.canvas' not found","request_params":{"path":"/api/v1/agents/explain/oral","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 367, in explain_oral\n    return await _call_explanation(request, \"oral\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: 数学/微积分/导数定义.canvas' not found\n","user_action":null}
{"bug_id":"BUG-1712BAB2","timestamp":"2025-12-15T03:15:10.751782Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.canvas' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.canvas' not found\n","user_action":null}
{"bug_id":"BUG-8DEF4336","timestamp":"2025-12-15T03:15:11.116561Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: test-file_2024 (copy).canvas' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: test-file_2024 (copy).canvas' not found\n","user_action":null}
{"bug_id":"BUG-89348C6B","timestamp":"2025-12-15T03:41:33.939426Z","endpoint":"/api/v1/agents/explain/four-level","error_type":"ValidationError","error_message":"Path traversal detected in canvas name: 2025_lecture_53_05_corrected_hold.pdf-3820ad9e-e32b-4f96-87da-83918ade5c6c/KP13-线性逼近与微分.md","request_params":{"path":"/api/v1/agents/explain/four-level","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 463, in explain_four_level\n    return await _call_explanation(request, \"four-level\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 85, in read_canvas\n    Raises:\n            \n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 66, in _get_canvas_path\n    for pattern in dangerous_patterns:\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 62, in _validate_canvas_name\n    raise ValidationError(f\"Absolute path not allowed: {canvas_name}\")\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\napp.core.exceptions.ValidationError: Path traversal detected in canvas name: 2025_lecture_53_05_corrected_hold.pdf-3820ad9e-e32b-4f96-87da-83918ade5c6c/KP13-线性逼近与微分.md\n","user_action":null}
{"bug_id":"BUG-3AD3F33B","timestamp":"2025-12-15T03:41:35.175247Z","endpoint":"/api/v1/agents/explain/four-level","error_type":"ValidationError","error_message":"Path traversal detected in canvas name: 2025_lecture_53_05_corrected_hold.pdf-3820ad9e-e32b-4f96-87da-83918ade5c6c/KP13-线性逼近与微分.md","request_params":{"path":"/api/v1/agents/explain/four-level","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 463, in explain_four_level\n    return await _call_explanation(request, \"four-level\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 85, in read_canvas\n    Raises:\n            \n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 66, in _get_canvas_path\n    for pattern in dangerous_patterns:\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 62, in _validate_canvas_name\n    raise ValidationError(f\"Absolute path not allowed: {canvas_name}\")\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\napp.core.exceptions.ValidationError: Path traversal detected in canvas name: 2025_lecture_53_05_corrected_hold.pdf-3820ad9e-e32b-4f96-87da-83918ade5c6c/KP13-线性逼近与微分.md\n","user_action":null}
{"bug_id":"BUG-F5F96912","timestamp":"2025-12-15T03:41:37.388458Z","endpoint":"/api/v1/agents/explain/four-level","error_type":"ValidationError","error_message":"Path traversal detected in canvas name: 2025_lecture_53_05_corrected_hold.pdf-3820ad9e-e32b-4f96-87da-83918ade5c6c/KP13-线性逼近与微分.md","request_params":{"path":"/api/v1/agents/explain/four-level","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 463, in explain_four_level\n    return await _call_explanation(request, \"four-level\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 85, in read_canvas\n    Raises:\n            \n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 66, in _get_canvas_path\n    for pattern in dangerous_patterns:\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 62, in _validate_canvas_name\n    raise ValidationError(f\"Absolute path not allowed: {canvas_name}\")\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\napp.core.exceptions.ValidationError: Path traversal detected in canvas name: 2025_lecture_53_05_corrected_hold.pdf-3820ad9e-e32b-4f96-87da-83918ade5c6c/KP13-线性逼近与微分.md\n","user_action":null}
{"bug_id":"BUG-A496C77E","timestamp":"2025-12-15T03:41:41.564884Z","endpoint":"/api/v1/agents/explain/four-level","error_type":"ValidationError","error_message":"Path traversal detected in canvas name: 2025_lecture_53_05_corrected_hold.pdf-3820ad9e-e32b-4f96-87da-83918ade5c6c/KP13-线性逼近与微分.md","request_params":{"path":"/api/v1/agents/explain/four-level","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 463, in explain_four_level\n    return await _call_explanation(request, \"four-level\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 85, in read_canvas\n    Raises:\n            \n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 66, in _get_canvas_path\n    for pattern in dangerous_patterns:\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 62, in _validate_canvas_name\n    raise ValidationError(f\"Absolute path not allowed: {canvas_name}\")\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\napp.core.exceptions.ValidationError: Path traversal detected in canvas name: 2025_lecture_53_05_corrected_hold.pdf-3820ad9e-e32b-4f96-87da-83918ade5c6c/KP13-线性逼近与微分.md\n","user_action":null}
{"bug_id":"BUG-2BC519F1","timestamp":"2025-12-15T03:42:22.549977Z","endpoint":"/api/v1/agents/decompose/deep","error_type":"ValidationError","error_message":"Path traversal detected in canvas name: 2025_lecture_53_05_corrected_hold.pdf-3820ad9e-e32b-4f96-87da-83918ade5c6c/KP13-线性逼近与微分.md","request_params":{"path":"/api/v1/agents/decompose/deep","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 198, in decompose_deep\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 85, in read_canvas\n    Raises:\n            \n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 66, in _get_canvas_path\n    for pattern in dangerous_patterns:\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 62, in _validate_canvas_name\n    raise ValidationError(f\"Absolute path not allowed: {canvas_name}\")\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\napp.core.exceptions.ValidationError: Path traversal detected in canvas name: 2025_lecture_53_05_corrected_hold.pdf-3820ad9e-e32b-4f96-87da-83918ade5c6c/KP13-线性逼近与微分.md\n","user_action":null}
{"bug_id":"BUG-A78DB8E7","timestamp":"2025-12-15T03:42:23.936543Z","endpoint":"/api/v1/agents/decompose/deep","error_type":"ValidationError","error_message":"Path traversal detected in canvas name: 2025_lecture_53_05_corrected_hold.pdf-3820ad9e-e32b-4f96-87da-83918ade5c6c/KP13-线性逼近与微分.md","request_params":{"path":"/api/v1/agents/decompose/deep","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 198, in decompose_deep\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 85, in read_canvas\n    Raises:\n            \n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 66, in _get_canvas_path\n    for pattern in dangerous_patterns:\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 62, in _validate_canvas_name\n    raise ValidationError(f\"Absolute path not allowed: {canvas_name}\")\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\napp.core.exceptions.ValidationError: Path traversal detected in canvas name: 2025_lecture_53_05_corrected_hold.pdf-3820ad9e-e32b-4f96-87da-83918ade5c6c/KP13-线性逼近与微分.md\n","user_action":null}
{"bug_id":"BUG-4780194D","timestamp":"2025-12-15T03:42:26.262798Z","endpoint":"/api/v1/agents/decompose/deep","error_type":"ValidationError","error_message":"Path traversal detected in canvas name: 2025_lecture_53_05_corrected_hold.pdf-3820ad9e-e32b-4f96-87da-83918ade5c6c/KP13-线性逼近与微分.md","request_params":{"path":"/api/v1/agents/decompose/deep","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 198, in decompose_deep\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 85, in read_canvas\n    Raises:\n            \n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 66, in _get_canvas_path\n    for pattern in dangerous_patterns:\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 62, in _validate_canvas_name\n    raise ValidationError(f\"Absolute path not allowed: {canvas_name}\")\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\napp.core.exceptions.ValidationError: Path traversal detected in canvas name: 2025_lecture_53_05_corrected_hold.pdf-3820ad9e-e32b-4f96-87da-83918ade5c6c/KP13-线性逼近与微分.md\n","user_action":null}
{"bug_id":"BUG-D90AA926","timestamp":"2025-12-15T03:42:30.499343Z","endpoint":"/api/v1/agents/decompose/deep","error_type":"ValidationError","error_message":"Path traversal detected in canvas name: 2025_lecture_53_05_corrected_hold.pdf-3820ad9e-e32b-4f96-87da-83918ade5c6c/KP13-线性逼近与微分.md","request_params":{"path":"/api/v1/agents/decompose/deep","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 198, in decompose_deep\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 85, in read_canvas\n    Raises:\n            \n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 66, in _get_canvas_path\n    for pattern in dangerous_patterns:\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 62, in _validate_canvas_name\n    raise ValidationError(f\"Absolute path not allowed: {canvas_name}\")\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\napp.core.exceptions.ValidationError: Path traversal detected in canvas name: 2025_lecture_53_05_corrected_hold.pdf-3820ad9e-e32b-4f96-87da-83918ade5c6c/KP13-线性逼近与微分.md\n","user_action":null}
{"bug_id":"BUG-FDF1A5F2","timestamp":"2025-12-15T03:58:24.384906Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: KP13-线性逼近与微分.md' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    def _read_file() -> Dict[str, Any]:\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    \"\"\"\n        \napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: KP13-线性逼近与微分.md' not found\n","user_action":null}
{"bug_id":"BUG-ECBC280E","timestamp":"2025-12-15T03:58:25.598871Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: KP13-线性逼近与微分.md' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    def _read_file() -> Dict[str, Any]:\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    \"\"\"\n        \napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: KP13-线性逼近与微分.md' not found\n","user_action":null}
{"bug_id":"BUG-FD2E028A","timestamp":"2025-12-15T03:58:27.779492Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: KP13-线性逼近与微分.md' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    def _read_file() -> Dict[str, Any]:\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    \"\"\"\n        \napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: KP13-线性逼近与微分.md' not found\n","user_action":null}
{"bug_id":"BUG-E5D2331C","timestamp":"2025-12-15T03:58:32.106404Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: KP13-线性逼近与微分.md' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    def _read_file() -> Dict[str, Any]:\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    \"\"\"\n        \napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: KP13-线性逼近与微分.md' not found\n","user_action":null}
{"bug_id":"BUG-F0DBC7EE","timestamp":"2025-12-15T03:58:43.157698Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: KP13-线性逼近与微分.md' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    def _read_file() -> Dict[str, Any]:\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    \"\"\"\n        \napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: KP13-线性逼近与微分.md' not found\n","user_action":null}
{"bug_id":"BUG-672E3E92","timestamp":"2025-12-15T03:58:44.332538Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: KP13-线性逼近与微分.md' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    def _read_file() -> Dict[str, Any]:\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    \"\"\"\n        \napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: KP13-线性逼近与微分.md' not found\n","user_action":null}
{"bug_id":"BUG-0D03A577","timestamp":"2025-12-15T03:58:46.595281Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: KP13-线性逼近与微分.md' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    def _read_file() -> Dict[str, Any]:\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    \"\"\"\n        \napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: KP13-线性逼近与微分.md' not found\n","user_action":null}
{"bug_id":"BUG-4A01AD72","timestamp":"2025-12-15T03:58:51.788916Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: KP13-线性逼近与微分.md' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    def _read_file() -> Dict[str, Any]:\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    \"\"\"\n        \napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: KP13-线性逼近与微分.md' not found\n","user_action":null}
{"bug_id":"BUG-F26998AA","timestamp":"2025-12-15T04:01:05.423198Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: KP13-线性逼近与微分.md' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    def _read_file() -> Dict[str, Any]:\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    \"\"\"\n        \napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: KP13-线性逼近与微分.md' not found\n","user_action":null}
{"bug_id":"BUG-8D96E6C5","timestamp":"2025-12-15T04:01:06.627186Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: KP13-线性逼近与微分.md' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    def _read_file() -> Dict[str, Any]:\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    \"\"\"\n        \napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: KP13-线性逼近与微分.md' not found\n","user_action":null}
{"bug_id":"BUG-B68FC715","timestamp":"2025-12-15T04:01:08.861450Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: KP13-线性逼近与微分.md' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    def _read_file() -> Dict[str, Any]:\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    \"\"\"\n        \napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: KP13-线性逼近与微分.md' not found\n","user_action":null}
{"bug_id":"BUG-9AD56A5A","timestamp":"2025-12-15T04:01:13.039422Z","endpoint":"/api/v1/agents/decompose/basic","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: KP13-线性逼近与微分.md' not found","request_params":{"path":"/api/v1/agents/decompose/basic","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 138, in decompose_basic\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 94, in read_canvas\n    def _read_file() -> Dict[str, Any]:\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 90, in _read_file\n    \"\"\"\n        \napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: KP13-线性逼近与微分.md' not found\n","user_action":null}
{"bug_id":"BUG-B8B25F58","timestamp":"2025-12-15T08:33:22.547222Z","endpoint":"/api/v1/agents/explain/four-level","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: Lecture5.canvas' not found","request_params":{"path":"/api/v1/agents/explain/four-level","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 463, in explain_four_level\n    return await _call_explanation(request, \"four-level\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: Lecture5.canvas' not found\n","user_action":null}
{"bug_id":"BUG-445098C4","timestamp":"2025-12-15T08:33:23.772042Z","endpoint":"/api/v1/agents/explain/four-level","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: Lecture5.canvas' not found","request_params":{"path":"/api/v1/agents/explain/four-level","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 463, in explain_four_level\n    return await _call_explanation(request, \"four-level\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: Lecture5.canvas' not found\n","user_action":null}
{"bug_id":"BUG-A9274511","timestamp":"2025-12-15T08:33:25.996818Z","endpoint":"/api/v1/agents/explain/four-level","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: Lecture5.canvas' not found","request_params":{"path":"/api/v1/agents/explain/four-level","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 463, in explain_four_level\n    return await _call_explanation(request, \"four-level\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: Lecture5.canvas' not found\n","user_action":null}
{"bug_id":"BUG-AACB9319","timestamp":"2025-12-15T08:33:30.211503Z","endpoint":"/api/v1/agents/explain/four-level","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: Lecture5.canvas' not found","request_params":{"path":"/api/v1/agents/explain/four-level","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 463, in explain_four_level\n    return await _call_explanation(request, \"four-level\", agent_service, context_service)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 306, in _call_explanation\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: Lecture5.canvas' not found\n","user_action":null}
{"bug_id":"BUG-26C19205","timestamp":"2025-12-15T08:36:29.270644Z","endpoint":"/api/v1/agents/decompose/deep","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: Lecture5.canvas' not found","request_params":{"path":"/api/v1/agents/decompose/deep","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 198, in decompose_deep\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: Lecture5.canvas' not found\n","user_action":null}
{"bug_id":"BUG-81C29D65","timestamp":"2025-12-15T08:36:30.496607Z","endpoint":"/api/v1/agents/decompose/deep","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: Lecture5.canvas' not found","request_params":{"path":"/api/v1/agents/decompose/deep","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 198, in decompose_deep\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: Lecture5.canvas' not found\n","user_action":null}
{"bug_id":"BUG-3464F428","timestamp":"2025-12-15T08:36:32.715143Z","endpoint":"/api/v1/agents/decompose/deep","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: Lecture5.canvas' not found","request_params":{"path":"/api/v1/agents/decompose/deep","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 198, in decompose_deep\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: Lecture5.canvas' not found\n","user_action":null}
{"bug_id":"BUG-FC1CC978","timestamp":"2025-12-15T08:36:36.925330Z","endpoint":"/api/v1/agents/decompose/deep","error_type":"CanvasNotFoundException","error_message":"Canvas 'Canvas not found: Lecture5.canvas' not found","request_params":{"path":"/api/v1/agents/decompose/deep","method":"POST","query_params":{}},"stack_trace":"Traceback (most recent call last):\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\main.py\", line 163, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 125, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 111, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 391, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\site-packages\\fastapi\\routing.py\", line 290, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\api\\v1\\endpoints\\agents.py\", line 198, in decompose_deep\n    enriched = await context_service.enrich_with_adjacent_nodes(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\context_enrichment_service.py\", line 171, in enrich_with_adjacent_nodes\n    canvas_data = await self._canvas_service.read_canvas(canvas_name)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 100, in read_canvas\n    data = await asyncio.to_thread(_read_file)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\asyncio\\threads.py\", line 25, in to_thread\n    return await loop.run_in_executor(None, func_call)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\anaconda3\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\ROG\\托福\\Canvas\\backend\\app\\services\\canvas_service.py\", line 96, in _read_file\n    raise CanvasNotFoundException(f\"Canvas not found: {canvas_name}\")\napp.core.exceptions.CanvasNotFoundException: Canvas 'Canvas not found: Lecture5.canvas' not found\n","user_action":null}
