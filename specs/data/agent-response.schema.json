{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://canvas-learning.com/schemas/agent-response.json",
  "title": "Agent Response Schema",
  "description": "通用Agent响应的JSON Schema，定义所有Agents返回结果的基础结构",
  "type": "object",
  "required": ["agent_name", "status", "timestamp"],
  "properties": {
    "agent_name": {
      "type": "string",
      "description": "执行的Agent名称",
      "enum": [
        "canvas-orchestrator",
        "basic-decomposition",
        "deep-decomposition",
        "question-decomposition",
        "oral-explanation",
        "clarification-path",
        "comparison-table",
        "memory-anchor",
        "four-level-explanation",
        "example-teaching",
        "scoring-agent",
        "verification-question-agent",
        "review-board-agent-selector",
        "graphiti-memory-agent"
      ],
      "examples": ["scoring-agent", "oral-explanation"]
    },
    "status": {
      "type": "string",
      "description": "Agent执行状态",
      "enum": ["success", "error", "timeout"],
      "examples": ["success"]
    },
    "timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "响应生成时间（ISO 8601格式）",
      "examples": ["2025-01-18T10:30:45Z"]
    },
    "duration_ms": {
      "type": "integer",
      "description": "Agent执行耗时（毫秒）",
      "minimum": 0,
      "examples": [2500]
    },
    "result": {
      "type": "object",
      "description": "Agent执行结果（具体结构取决于不同的Agent类型）",
      "additionalProperties": true,
      "examples": [
        {
          "questions": [
            "什么是命题？",
            "如何判断逆否命题？"
          ]
        }
      ]
    },
    "error": {
      "type": "object",
      "description": "错误信息（仅当status=error时存在）",
      "properties": {
        "type": {
          "type": "string",
          "description": "错误类型",
          "examples": ["ValidationError", "TimeoutError", "InternalError"]
        },
        "message": {
          "type": "string",
          "description": "错误详细信息",
          "examples": ["Missing required field: concept"]
        },
        "details": {
          "type": "object",
          "description": "额外的错误详情",
          "additionalProperties": true
        }
      },
      "required": ["type", "message"]
    },
    "metadata": {
      "type": "object",
      "description": "额外的元数据（可选）",
      "properties": {
        "input_hash": {
          "type": "string",
          "description": "输入数据的哈希值（用于缓存）",
          "examples": ["a3f5d8e9b2c1"]
        },
        "cached": {
          "type": "boolean",
          "description": "是否使用了缓存结果",
          "examples": [false]
        },
        "model_used": {
          "type": "string",
          "description": "使用的AI模型（如果适用）",
          "examples": ["claude-sonnet-4-5"]
        }
      }
    }
  },
  "examples": [
    {
      "agent_name": "scoring-agent",
      "status": "success",
      "timestamp": "2025-01-18T10:30:45Z",
      "duration_ms": 2500,
      "result": {
        "accuracy": 22,
        "imagery": 18,
        "completeness": 20,
        "originality": 15,
        "total_score": 75,
        "color": "3",
        "recommendations": [
          "clarification-path",
          "oral-explanation"
        ]
      },
      "metadata": {
        "input_hash": "a3f5d8e9b2c1",
        "cached": false,
        "model_used": "claude-sonnet-4-5"
      }
    },
    {
      "agent_name": "basic-decomposition",
      "status": "success",
      "timestamp": "2025-01-18T10:32:15Z",
      "duration_ms": 3200,
      "result": {
        "questions": [
          {
            "type": "定义型",
            "question": "什么是逆否命题？",
            "id": "q-def-001"
          },
          {
            "type": "实例型",
            "question": "能否举一个逆否命题的例子？",
            "id": "q-example-001"
          },
          {
            "type": "对比型",
            "question": "逆否命题和否命题有什么区别？",
            "id": "q-compare-001"
          }
        ],
        "total_questions": 3
      }
    },
    {
      "agent_name": "oral-explanation",
      "status": "error",
      "timestamp": "2025-01-18T10:35:00Z",
      "duration_ms": 1000,
      "error": {
        "type": "ValidationError",
        "message": "Missing required field: concept",
        "details": {
          "received_fields": ["user_understanding"],
          "missing_fields": ["concept"]
        }
      }
    }
  ]
}
