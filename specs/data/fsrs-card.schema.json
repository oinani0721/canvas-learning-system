{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://canvas-learning.com/schemas/fsrs-card.schema.json",
  "x-source-verification": {
    "verified_at": "2025-11-28T14:30:00Z",
    "sources": [
      {"type": "context7", "library_id": "/json-schema-org/json-schema-spec", "topic": "draft-07 schema validation"},
      {"type": "context7", "library_id": "/open-spaced-repetition/py-fsrs", "topic": "State enum verification"},
      {"type": "prd", "section": "FR3", "epic": "Epic 14"},
      {"type": "official_doc", "url": "https://github.com/open-spaced-repetition/py-fsrs"}
    ],
    "changelog": [
      {"date": "2025-11-28", "change": "state field updated from string enum to integer enum per py-fsrs Context7 verification", "reason": "SoT conflict resolution - Story 12.4 validation"}
    ]
  },
  "title": "FSRS复习卡片",
  "description": "基于Py-FSRS算法的复习卡片数据结构 (Epic 14). Context7 Verified: /json-schema-org/json-schema-spec (draft-07)",
  "type": "object",
  "properties": {
    "card_id": {
      "type": "string",
      "format": "uuid",
      "description": "卡片唯一标识"
    },
    "concept_id": {
      "type": "string",
      "description": "关联概念ID"
    },
    "canvas_path": {
      "type": "string",
      "description": "来源Canvas路径"
    },
    "node_id": {
      "type": "string",
      "description": "来源节点ID"
    },
    "due": {
      "type": "string",
      "format": "date-time",
      "description": "下次复习时间"
    },
    "stability": {
      "type": "number",
      "minimum": 0,
      "description": "记忆稳定性"
    },
    "difficulty": {
      "type": "number",
      "minimum": 1,
      "maximum": 10,
      "description": "难度 (1-10)"
    },
    "elapsed_days": {
      "type": "integer",
      "minimum": 0,
      "description": "距上次复习天数"
    },
    "scheduled_days": {
      "type": "integer",
      "minimum": 0,
      "description": "计划间隔天数"
    },
    "reps": {
      "type": "integer",
      "minimum": 0,
      "description": "复习次数"
    },
    "lapses": {
      "type": "integer",
      "minimum": 0,
      "description": "遗忘次数"
    },
    "state": {
      "type": "integer",
      "enum": [1, 2, 3],
      "description": "卡片状态 (py-fsrs State enum: 1=Learning, 2=Review, 3=Relearning). Context7 Verified: /open-spaced-repetition/py-fsrs"
    },
    "last_review": {
      "type": "string",
      "format": "date-time",
      "description": "上次复习时间"
    },
    "created_at": {
      "type": "string",
      "format": "date-time",
      "description": "创建时间"
    }
  },
  "required": ["card_id", "concept_id", "due", "stability", "difficulty", "state"]
}
