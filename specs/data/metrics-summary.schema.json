{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://canvas-learning.com/schemas/metrics-summary.schema.json",
  "title": "性能指标摘要",
  "description": "系统性能监控指标摘要 (Epic 17). Context7 Verified: /json-schema-org/json-schema-spec (draft-07)",
  "type": "object",
  "properties": {
    "timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "采集时间"
    },
    "api": {
      "type": "object",
      "description": "API性能指标",
      "properties": {
        "requests_total": {
          "type": "integer",
          "description": "总请求数"
        },
        "requests_per_second": {
          "type": "number",
          "description": "每秒请求数"
        },
        "avg_latency_ms": {
          "type": "number",
          "description": "平均延迟(ms)"
        },
        "p50_latency_ms": {
          "type": "number",
          "description": "P50延迟(ms)"
        },
        "p95_latency_ms": {
          "type": "number",
          "description": "P95延迟(ms)"
        },
        "p99_latency_ms": {
          "type": "number",
          "description": "P99延迟(ms)"
        },
        "error_rate": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "错误率"
        },
        "status_codes": {
          "type": "object",
          "additionalProperties": {
            "type": "integer"
          },
          "description": "状态码分布"
        }
      }
    },
    "agents": {
      "type": "object",
      "description": "Agent性能指标",
      "properties": {
        "invocations_total": {
          "type": "integer",
          "description": "总调用数"
        },
        "avg_execution_time_s": {
          "type": "number",
          "description": "平均执行时间(s)"
        },
        "by_type": {
          "type": "object",
          "additionalProperties": {
            "type": "object",
            "properties": {
              "count": {
                "type": "integer"
              },
              "avg_time_s": {
                "type": "number"
              },
              "error_count": {
                "type": "integer"
              }
            }
          },
          "description": "按Agent类型统计"
        }
      }
    },
    "memory_system": {
      "type": "object",
      "description": "记忆系统性能",
      "properties": {
        "graphiti": {
          "type": "object",
          "properties": {
            "queries_total": {
              "type": "integer"
            },
            "avg_latency_ms": {
              "type": "number"
            },
            "storage_size_mb": {
              "type": "number"
            }
          }
        },
        "temporal": {
          "type": "object",
          "properties": {
            "events_total": {
              "type": "integer"
            },
            "avg_latency_ms": {
              "type": "number"
            }
          }
        },
        "semantic": {
          "type": "object",
          "properties": {
            "searches_total": {
              "type": "integer"
            },
            "avg_latency_ms": {
              "type": "number"
            },
            "index_size_mb": {
              "type": "number"
            }
          }
        }
      }
    },
    "resources": {
      "type": "object",
      "description": "系统资源使用",
      "properties": {
        "cpu_usage_percent": {
          "type": "number",
          "minimum": 0,
          "maximum": 100
        },
        "memory_usage_mb": {
          "type": "number"
        },
        "memory_usage_percent": {
          "type": "number",
          "minimum": 0,
          "maximum": 100
        },
        "disk_usage_percent": {
          "type": "number",
          "minimum": 0,
          "maximum": 100
        },
        "active_connections": {
          "type": "integer"
        }
      }
    }
  },
  "required": ["timestamp"]
}
