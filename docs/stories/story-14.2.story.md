# Story 14.2: å¤ä¹ ä»ªè¡¨æ¿UI

## Status
âœ… Completed (2025-12-01)

## Story

**As a** Canvaså­¦ä¹ ç³»ç»Ÿç”¨æˆ·,
**I want** åœ¨Obsidianä¸­çœ‹åˆ°ä¸€ä¸ªç›´è§‚çš„å¤ä¹ ä»ªè¡¨æ¿,
**so that** æˆ‘èƒ½å¤Ÿå¿«é€Ÿäº†è§£ä»Šå¤©çš„å¤ä¹ ä»»åŠ¡ã€å­¦ä¹ è¿›åº¦å’Œå…³é”®ç»Ÿè®¡æ•°æ®ã€‚

## Acceptance Criteria

1. å®ç°ReviewDashboardä¸»ç»„ä»¶ï¼Œå±•ç¤ºä»Šæ—¥å¤ä¹ ä»»åŠ¡åˆ—è¡¨
2. æ˜¾ç¤ºå…³é”®å­¦ä¹ ç»Ÿè®¡ä¿¡æ¯ï¼ˆå¾…å¤ä¹ æ•°é‡ã€å®Œæˆè¿›åº¦ã€å¹³å‡åˆ†æ•°ç­‰ï¼‰
3. æä¾›å¿«é€Ÿæ“ä½œæŒ‰é’®ï¼ˆå¼€å§‹å¤ä¹ ã€ç”Ÿæˆè®¡åˆ’ã€æŸ¥çœ‹è¯¦æƒ…ç­‰ï¼‰
4. å®ç°ä»»åŠ¡çŠ¶æ€ç®¡ç†å’Œå®æ—¶æ›´æ–°æœºåˆ¶
5. æ”¯æŒå“åº”å¼å¸ƒå±€ï¼Œé€‚é…ä¸åŒå±å¹•å°ºå¯¸
6. é›†æˆObsidianåŸç”ŸUIé£æ ¼ï¼Œç¡®ä¿è§†è§‰ä¸€è‡´æ€§

## Tasks / Subtasks

- [x] Task 1: åˆ›å»ºReviewDashboardä¸»ç»„ä»¶ (AC: 1, 5, 6) âœ…
  - [x] è®¾è®¡ä»ªè¡¨æ¿æ•´ä½“å¸ƒå±€ç»“æ„ï¼ˆå¤´éƒ¨ç»Ÿè®¡ã€ä»»åŠ¡åˆ—è¡¨ã€æ“ä½œåŒºåŸŸï¼‰
  - [x] å®ç°Reactç»„ä»¶æ¡†æ¶å’ŒTypeScriptç±»å‹å®šä¹‰
  - [x] åˆ›å»ºå“åº”å¼CSSæ ·å¼ï¼Œä½¿ç”¨ObsidianåŸç”ŸCSSå˜é‡
  - [x] å®ç°ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†å’ŒçŠ¶æ€åˆå§‹åŒ–
  - [x] æ·»åŠ åŠ è½½çŠ¶æ€å’Œé”™è¯¯å¤„ç†UI

- [x] Task 2: å®ç°ä»»åŠ¡åˆ—è¡¨æ˜¾ç¤º (AC: 1) âœ…
  - [x] åˆ›å»ºTaskListç»„ä»¶ï¼Œå±•ç¤ºå¤ä¹ ä»»åŠ¡å¡ç‰‡
  - [x] å®ç°ä»»åŠ¡æ’åºå’Œè¿‡æ»¤åŠŸèƒ½ï¼ˆæŒ‰ä¼˜å…ˆçº§ã€æˆªæ­¢æ—¶é—´ç­‰ï¼‰
  - [x] æ·»åŠ ä»»åŠ¡åˆ†ç»„æ˜¾ç¤ºï¼ˆæŒ‰Canvasã€æŒ‰éš¾åº¦çº§åˆ«ï¼‰
  - [x] å®ç°ä»»åŠ¡åˆ—è¡¨çš„è™šæ‹Ÿæ»šåŠ¨ï¼Œä¼˜åŒ–æ€§èƒ½
  - [x] æ·»åŠ ç©ºçŠ¶æ€å’ŒåŠ è½½çŠ¶æ€çš„UIæ˜¾ç¤º

- [x] Task 3: å®ç°ç»Ÿè®¡ä¿¡æ¯é¢æ¿ (AC: 2) âœ…
  - [x] åˆ›å»ºStatisticsPanelç»„ä»¶ï¼Œæ˜¾ç¤ºå…³é”®æŒ‡æ ‡
  - [x] å®ç°ä»Šæ—¥ä»»åŠ¡ç»Ÿè®¡ï¼ˆå¾…å¤ä¹ ã€å·²å®Œæˆã€å·²æ¨è¿Ÿï¼‰
  - [x] æ·»åŠ å­¦ä¹ è¿›åº¦æ˜¾ç¤ºï¼ˆè¿›åº¦æ¡ã€ç™¾åˆ†æ¯”ã€è¶‹åŠ¿å›¾ï¼‰
  - [x] å®ç°å¹³å‡åˆ†æ•°å’Œè®°å¿†å¼ºåº¦æŒ‡æ ‡æ˜¾ç¤º
  - [x] åˆ›å»ºç»Ÿè®¡æ•°æ®çš„å¯è§†åŒ–å›¾è¡¨ç»„ä»¶

- [x] Task 4: å®ç°å¿«é€Ÿæ“ä½œåŒºåŸŸ (AC: 3) âœ…
  - [x] åˆ›å»ºQuickActionsç»„ä»¶ï¼Œæä¾›å¸¸ç”¨æ“ä½œæŒ‰é’®
  - [x] å®ç°"å¼€å§‹å¤ä¹ "æŒ‰é’®ï¼Œå¯åŠ¨å¤ä¹ ä¼šè¯
  - [x] å®ç°"ç”Ÿæˆå¤ä¹ è®¡åˆ’"æŒ‰é’®ï¼Œè°ƒç”¨ç›¸å…³å‘½ä»¤
  - [x] æ·»åŠ "æŸ¥çœ‹è¯¦æƒ…"å’Œ"è®¾ç½®"å¿«æ·å…¥å£
  - [x] å®ç°æŒ‰é’®çš„çŠ¶æ€ç®¡ç†å’Œé˜²é‡å¤ç‚¹å‡»

- [x] Task 5: å®ç°æ•°æ®é›†æˆå’ŒçŠ¶æ€ç®¡ç† (AC: 4) âœ…
  - [x] é›†æˆCommandWrapperï¼Œè·å–å¤ä¹ ä»»åŠ¡æ•°æ®
  - [x] é›†æˆDataManagerï¼ŒæŸ¥è¯¢å­¦ä¹ ç»Ÿè®¡æ•°æ®
  - [x] å®ç°React Contextæˆ–çŠ¶æ€ç®¡ç†å™¨
  - [x] æ·»åŠ æ•°æ®åˆ·æ–°å’Œè‡ªåŠ¨æ›´æ–°æœºåˆ¶
  - [x] å®ç°ç¦»çº¿çŠ¶æ€æ£€æµ‹å’Œç¼“å­˜ç­–ç•¥

- [x] Task 6: å®ç°ä¸»é¢˜å’Œæ ·å¼é€‚é… (AC: 6) âœ…
  - [x] ä½¿ç”¨Obsidian CSSå˜é‡ï¼Œé€‚é…äº®è‰²/æš—è‰²ä¸»é¢˜
  - [x] å®ç°å“åº”å¼å¸ƒå±€ï¼Œæ”¯æŒç§»åŠ¨ç«¯æ˜¾ç¤º
  - [x] æ·»åŠ è¿‡æ¸¡åŠ¨ç”»å’Œå¾®äº¤äº’æ•ˆæœ
  - [x] ç¡®ä¿ä¸ObsidianåŸç”ŸUIç»„ä»¶é£æ ¼ä¸€è‡´
  - [x] å®ç°è‡ªå®šä¹‰ä¸»é¢˜è‰²å½©å’Œå­—ä½“è®¾ç½®

- [x] Task 7: ç»„ä»¶é›†æˆå’Œæµ‹è¯• (ALL AC) âœ…
  - [x] åœ¨ä¸»æ’ä»¶ä¸­æ³¨å†Œä»ªè¡¨æ¿å‘½ä»¤
  - [x] å®ç°ä»ªè¡¨æ¿çš„æ˜¾ç¤ºå’Œéšè—é€»è¾‘
  - [x] æµ‹è¯•ç»„ä»¶åœ¨ä¸åŒObsidianä¸»é¢˜ä¸‹çš„æ˜¾ç¤ºæ•ˆæœ
  - [x] éªŒè¯æ•°æ®æ›´æ–°çš„å®æ—¶æ€§å’Œå‡†ç¡®æ€§
  - [x] è¿›è¡Œæ€§èƒ½æµ‹è¯•ï¼Œç¡®ä¿æµç•…çš„ç”¨æˆ·ä½“éªŒ

## Dev Notes

### æ¶æ„ä¸Šä¸‹æ–‡

**UIç»„ä»¶å±‚æ¶æ„** [Source: canvas-progress-tracker/docs/obsidian-plugin-architecture.md#UIç»„ä»¶å±‚]

æœ¬Storyå®ç°UIç»„ä»¶å±‚çš„æ ¸å¿ƒä»ªè¡¨æ¿ç»„ä»¶ï¼Œæä¾›ç”¨æˆ·ä¸æ’ä»¶çš„ä¸»è¦äº¤äº’ç•Œé¢ï¼š

```mermaid
graph TB
    subgraph "UIç»„ä»¶å±‚"
        DASH[ReviewDashboard] â­ æœ¬Storyå®ç°
        TASK[TaskList]
        STAT[StatisticsPanel]
        QA[QuickActions]
        CARD[TaskCard]
    end

    subgraph "ç®¡ç†å±‚"
        UI[UIManager]
        CMD[CommandWrapper]
        DATA[DataManager]
    end

    subgraph "Obsidian API"
        WORKSPACE[Workspace]
        MODAL[Modal]
        NOTICE[Notice]
    end

    DASH --> TASK
    DASH --> STAT
    DASH --> QA
    TASK --> CARD
    DASH --> UI
    UI --> CMD
    UI --> DATA
    UI --> WORKSPACE
    UI --> MODAL
    UI --> NOTICE
```

**è®¾è®¡åŸåˆ™** [Source: canvas-progress-tracker/docs/obsidian-plugin-prd.md#åŸºç¡€UIç»„ä»¶]
- **ä¸€è‡´æ€§**: éµå¾ªObsidianåŸç”ŸUIè®¾è®¡è§„èŒƒ
- **å“åº”å¼**: é€‚é…ä¸åŒå±å¹•å°ºå¯¸å’Œè®¾å¤‡
- **æ€§èƒ½**: ä¼˜åŒ–æ¸²æŸ“æ€§èƒ½ï¼Œé¿å…å¡é¡¿
- **å¯è®¿é—®æ€§**: æ”¯æŒé”®ç›˜å¯¼èˆªå’Œå±å¹•é˜…è¯»å™¨

### ç»„ä»¶è®¾è®¡è§„èŒƒ

**Reactç»„ä»¶ç»“æ„** [Source: canvas-progress-tracker/docs/obsidian-plugin-architecture.md#Reactç»„ä»¶é›†æˆ]
```typescript
// åŸºç¡€ç»„ä»¶æ¥å£
interface BaseComponentProps {
    className?: string;
    style?: React.CSSProperties;
    children?: React.ReactNode;
}

// å¤ä¹ ä»ªè¡¨æ¿å±æ€§
interface ReviewDashboardProps extends BaseComponentProps {
    plugin: CanvasReviewPlugin;
    onTaskComplete?: (taskId: string) => void;
    onTaskPostpone?: (taskId: string, days: number) => void;
    onRefresh?: () => void;
}

// ä»»åŠ¡åˆ—è¡¨å±æ€§
interface TaskListProps extends BaseComponentProps {
    tasks: ReviewTask[];
    loading?: boolean;
    onTaskClick?: (task: ReviewTask) => void;
    onTaskComplete?: (task: ReviewTask) => void;
    sortBy?: TaskSortOption;
    filterBy?: TaskFilterOption;
}

// ç»Ÿè®¡é¢æ¿å±æ€§
interface StatisticsPanelProps extends BaseComponentProps {
    statistics: LearningStatistics;
    dateRange: DateRange;
    loading?: boolean;
}
```

### ReviewDashboardä¸»ç»„ä»¶å®ç°

**ç»„ä»¶æ¡†æ¶** [Source: canvas-progress-tracker/docs/obsidian-plugin-architecture.md#Reactç»„ä»¶é›†æˆ]
```typescript
import React, { useState, useEffect, useCallback } from 'react';
import { useObsidianTheme } from '../hooks/useObsidianTheme';
import { useReviewData } from '../hooks/useReviewData';

export const ReviewDashboard: React.FC<ReviewDashboardProps> = ({
    plugin,
    className,
    onTaskComplete,
    onTaskPostpone,
    onRefresh
}) => {
    const theme = useObsidianTheme();
    const [loading, setLoading] = useState(true);
    const [error, setError] = useState<string | null>(null);

    // è·å–å¤ä¹ æ•°æ®
    const {
        tasks,
        statistics,
        refreshData,
        isLoading: dataLoading
    } = useReviewData(plugin);

    // ç»„ä»¶åˆå§‹åŒ–
    useEffect(() => {
        initializeDashboard();
    }, []);

    const initializeDashboard = async () => {
        try {
            setLoading(true);
            await refreshData();
        } catch (err) {
            setError(err instanceof Error ? err.message : 'åŠ è½½æ•°æ®å¤±è´¥');
        } finally {
            setLoading(false);
        }
    };

    // å¤„ç†ä»»åŠ¡å®Œæˆ
    const handleTaskComplete = useCallback(async (task: ReviewTask) => {
        try {
            await plugin.commandWrapper.completeReview(task.id);
            await refreshData();
            onTaskComplete?.(task.id);

            // æ˜¾ç¤ºæˆåŠŸé€šçŸ¥
            new Notice(`âœ… å·²å®Œæˆå¤ä¹ : ${task.conceptName}`);
        } catch (err) {
            new Notice(`âŒ å®Œæˆå¤ä¹ å¤±è´¥: ${err instanceof Error ? err.message : 'æœªçŸ¥é”™è¯¯'}`);
        }
    }, [plugin, refreshData, onTaskComplete]);

    // å¤„ç†ä»»åŠ¡æ¨è¿Ÿ
    const handleTaskPostpone = useCallback(async (task: ReviewTask, days: number) => {
        try {
            await plugin.commandWrapper.postponeReview(task.id, days);
            await refreshData();
            onTaskPostpone?.(task.id, days);

            new Notice(`â° å·²æ¨è¿Ÿå¤ä¹ : ${task.conceptName} (${days}å¤©)`);
        } catch (err) {
            new Notice(`âŒ æ¨è¿Ÿå¤ä¹ å¤±è´¥: ${err instanceof Error ? err.message : 'æœªçŸ¥é”™è¯¯'}`);
        }
    }, [plugin, refreshData, onTaskPostpone]);

    // å¤„ç†åˆ·æ–°
    const handleRefresh = useCallback(async () => {
        await refreshData();
        onRefresh?.();
    }, [refreshData, onRefresh]);

    if (loading) {
        return <DashboardLoadingState />;
    }

    if (error) {
        return <DashboardErrorState error={error} onRetry={initializeDashboard} />;
    }

    return (
        <div className={`review-dashboard ${theme.className} ${className || ''}`}>
            {/* é¡¶éƒ¨ç»Ÿè®¡åŒºåŸŸ */}
            <DashboardHeader
                statistics={statistics}
                onRefresh={handleRefresh}
                loading={dataLoading}
            />

            {/* ä¸»è¦å†…å®¹åŒºåŸŸ */}
            <div className="dashboard-content">
                {/* ä»»åŠ¡åˆ—è¡¨ */}
                <TaskList
                    tasks={tasks}
                    loading={dataLoading}
                    onTaskComplete={handleTaskComplete}
                    onTaskPostpone={handleTaskPostpone}
                />

                {/* ä¾§è¾¹æ ç»Ÿè®¡å’Œæ“ä½œ */}
                <DashboardSidebar
                    statistics={statistics}
                    plugin={plugin}
                    onRefresh={handleRefresh}
                />
            </div>
        </div>
    );
};
```

### TaskListç»„ä»¶å®ç°

**ä»»åŠ¡åˆ—è¡¨ç»„ä»¶** [Source: canvas-progress-tracker/docs/obsidian-plugin-prd.md#FR-007]
```typescript
import React, { useState, useMemo } from 'react';

interface TaskListProps {
    tasks: ReviewTask[];
    loading?: boolean;
    onTaskClick?: (task: ReviewTask) => void;
    onTaskComplete?: (task: ReviewTask) => void;
    onTaskPostpone?: (task: ReviewTask, days: number) => void;
    sortBy?: TaskSortOption;
    filterBy?: TaskFilterOption;
}

export const TaskList: React.FC<TaskListProps> = ({
    tasks,
    loading,
    onTaskClick,
    onTaskComplete,
    onTaskPostpone,
    sortBy = 'priority',
    filterBy = 'all'
}) => {
    const [expandedGroups, setExpandedGroups] = useState<Set<string>>(new Set());

    // è¿‡æ»¤å’Œæ’åºä»»åŠ¡
    const processedTasks = useMemo(() => {
        let filtered = tasks;

        // åº”ç”¨è¿‡æ»¤å™¨
        switch (filterBy) {
            case 'overdue':
                filtered = tasks.filter(task => task.overdueDays > 0);
                break;
            case 'today':
                filtered = tasks.filter(task =>
                    task.dueDate.toDateString() === new Date().toDateString()
                );
                break;
            case 'high-priority':
                filtered = tasks.filter(task =>
                    task.priority === 'critical' || task.priority === 'high'
                );
                break;
        }

        // åº”ç”¨æ’åº
        return filtered.sort((a, b) => {
            switch (sortBy) {
                case 'priority':
                    return getPriorityWeight(b.priority) - getPriorityWeight(a.priority);
                case 'dueDate':
                    return a.dueDate.getTime() - b.dueDate.getTime();
                case 'memoryStrength':
                    return a.memoryStrength - b.memoryStrength;
                case 'canvas':
                    return a.canvasTitle.localeCompare(b.canvasTitle);
                default:
                    return 0;
            }
        });
    }, [tasks, sortBy, filterBy]);

    // æŒ‰Canvasåˆ†ç»„ä»»åŠ¡
    const groupedTasks = useMemo(() => {
        const groups = new Map<string, ReviewTask[]>();

        processedTasks.forEach(task => {
            if (!groups.has(task.canvasTitle)) {
                groups.set(task.canvasTitle, []);
            }
            groups.get(task.canvasTitle)!.push(task);
        });

        return groups;
    }, [processedTasks]);

    const toggleGroup = (canvasTitle: string) => {
        const newExpanded = new Set(expandedGroups);
        if (newExpanded.has(canvasTitle)) {
            newExpanded.delete(canvasTitle);
        } else {
            newExpanded.add(canvasTitle);
        }
        setExpandedGroups(newExpanded);
    };

    if (loading) {
        return <TaskListSkeleton />;
    }

    if (processedTasks.length === 0) {
        return <EmptyTaskState filterBy={filterBy} />;
    }

    return (
        <div className="task-list">
            {/* æ’åºå’Œè¿‡æ»¤æ§åˆ¶ */}
            <TaskListControls
                sortBy={sortBy}
                filterBy={filterBy}
                onSortChange={setSortBy}
                onFilterChange={setFilterBy}
            />

            {/* ä»»åŠ¡ç»„åˆ—è¡¨ */}
            <div className="task-groups">
                {Array.from(groupedTasks.entries()).map(([canvasTitle, canvasTasks]) => (
                    <TaskGroup
                        key={canvasTitle}
                        canvasTitle={canvasTitle}
                        tasks={canvasTasks}
                        isExpanded={expandedGroups.has(canvasTitle)}
                        onToggle={() => toggleGroup(canvasTitle)}
                        onTaskClick={onTaskClick}
                        onTaskComplete={onTaskComplete}
                        onTaskPostpone={onTaskPostpone}
                    />
                ))}
            </div>
        </div>
    );
};
```

### StatisticsPanelç»„ä»¶å®ç°

**ç»Ÿè®¡é¢æ¿ç»„ä»¶** [Source: canvas-progress-tracker/docs/obsidian-plugin-prd.md#FR-007]
```typescript
import React from 'react';

interface StatisticsPanelProps {
    statistics: LearningStatistics;
    dateRange: DateRange;
    loading?: boolean;
}

export const StatisticsPanel: React.FC<StatisticsPanelProps> = ({
    statistics,
    dateRange,
    loading
}) => {
    if (loading) {
        return <StatisticsSkeleton />;
    }

    return (
        <div className="statistics-panel">
            {/* ä»Šæ—¥æ¦‚è§ˆ */}
            <div className="stat-card today-overview">
                <h3>ä»Šæ—¥å¤ä¹ </h3>
                <div className="stat-metrics">
                    <div className="metric">
                        <span className="value">{statistics.todayPending}</span>
                        <span className="label">å¾…å¤ä¹ </span>
                    </div>
                    <div className="metric">
                        <span className="value">{statistics.todayCompleted}</span>
                        <span className="label">å·²å®Œæˆ</span>
                    </div>
                    <div className="metric">
                        <span className="value">{Math.round(statistics.todayProgress * 100)}%</span>
                        <span className="label">è¿›åº¦</span>
                    </div>
                </div>

                {/* è¿›åº¦æ¡ */}
                <div className="progress-bar">
                    <div
                        className="progress-fill"
                        style={{ width: `${statistics.todayProgress * 100}%` }}
                    />
                </div>
            </div>

            {/* å­¦ä¹ ç»Ÿè®¡ */}
            <div className="stat-card learning-stats">
                <h3>å­¦ä¹ ç»Ÿè®¡</h3>
                <div className="stat-list">
                    <div className="stat-item">
                        <span className="label">å¹³å‡åˆ†æ•°</span>
                        <span className="value">{Math.round(statistics.averageScore)}</span>
                    </div>
                    <div className="stat-item">
                        <span className="label">è®°å¿†å¼ºåº¦</span>
                        <span className="value">{Math.round(statistics.averageMemoryStrength * 100)}%</span>
                    </div>
                    <div className="stat-item">
                        <span className="label">ä¿æŒç‡</span>
                        <span className="value">{Math.round(statistics.averageRetentionRate * 100)}%</span>
                    </div>
                    <div className="stat-item">
                        <span className="label">è¿ç»­å­¦ä¹ </span>
                        <span className="value">{statistics.streakDays}å¤©</span>
                    </div>
                </div>
            </div>

            {/* æŒæ¡åº¦åˆ†å¸ƒ */}
            <div className="stat-card mastery-distribution">
                <h3>æŒæ¡åº¦åˆ†å¸ƒ</h3>
                <div className="mastery-chart">
                    {statistics.masteryDistribution.map((item, index) => (
                        <div key={index} className="mastery-item">
                            <div
                                className="mastery-bar"
                                style={{
                                    height: `${item.percentage}%`,
                                    backgroundColor: item.color
                                }}
                            />
                            <span className="mastery-label">{item.label}</span>
                            <span className="mastery-count">{item.count}</span>
                        </div>
                    ))}
                </div>
            </div>

            {/* æœ€è¿‘æ´»åŠ¨ */}
            <div className="stat-card recent-activity">
                <h3>æœ€è¿‘æ´»åŠ¨</h3>
                <div className="activity-list">
                    {statistics.recentActivities.slice(0, 5).map((activity, index) => (
                        <div key={index} className="activity-item">
                            <div className="activity-icon">
                                {getActivityIcon(activity.type)}
                            </div>
                            <div className="activity-content">
                                <div className="activity-title">{activity.title}</div>
                                <div className="activity-time">{formatTime(activity.timestamp)}</div>
                            </div>
                        </div>
                    ))}
                </div>
            </div>
        </div>
    );
};
```

### QuickActionsç»„ä»¶å®ç°

**å¿«é€Ÿæ“ä½œç»„ä»¶** [Source: canvas-progress-tracker/docs/obsidian-plugin-prd.md#FR-007]
```typescript
import React, { useState } from 'react';

interface QuickActionsProps {
    plugin: CanvasReviewPlugin;
    onRefresh: () => void;
    loading?: boolean;
}

export const QuickActions: React.FC<QuickActionsProps> = ({
    plugin,
    onRefresh,
    loading
}) => {
    const [actionLoading, setActionLoading] = useState<string | null>(null);

    const handleStartReview = async () => {
        setActionLoading('start-review');
        try {
            // è·å–ç¬¬ä¸€ä¸ªå¾…å¤ä¹ ä»»åŠ¡
            const tasks = await plugin.commandWrapper.getReviewTasks({ limit: 1 });
            if (tasks.length > 0) {
                // æ‰“å¼€å¤ä¹ æ¨¡æ€æ¡†æˆ–å¯¼èˆªåˆ°å¤ä¹ é¡µé¢
                await plugin.uiManager.openReviewSession(tasks[0]);
            } else {
                new Notice('ğŸ‰ ä»Šæ—¥æ‰€æœ‰å¤ä¹ ä»»åŠ¡å·²å®Œæˆï¼');
            }
        } catch (error) {
            new Notice('âŒ å¼€å§‹å¤ä¹ å¤±è´¥');
        } finally {
            setActionLoading(null);
        }
    };

    const handleGeneratePlan = async () => {
        setActionLoading('generate-plan');
        try {
            // æ‰“å¼€ç”Ÿæˆå¤ä¹ è®¡åˆ’çš„å¯¹è¯æ¡†
            await plugin.uiManager.openGeneratePlanDialog();
        } catch (error) {
            new Notice('âŒ ç”Ÿæˆè®¡åˆ’å¤±è´¥');
        } finally {
            setActionLoading(null);
        }
    };

    const handleViewCalendar = async () => {
        setActionLoading('view-calendar');
        try {
            // æ‰“å¼€å¤ä¹ æ—¥å†è§†å›¾
            await plugin.uiManager.openCalendarView();
        } catch (error) {
            new Notice('âŒ æ‰“å¼€æ—¥å†å¤±è´¥');
        } finally {
            setActionLoading(null);
        }
    };

    return (
        <div className="quick-actions">
            <button
                className="action-button primary"
                onClick={handleStartReview}
                disabled={actionLoading !== null}
            >
                {actionLoading === 'start-review' ? (
                    <LoadingSpinner size="small" />
                ) : (
                    <Icon name="play" />
                )}
                å¼€å§‹å¤ä¹ 
            </button>

            <button
                className="action-button secondary"
                onClick={handleGeneratePlan}
                disabled={actionLoading !== null}
            >
                {actionLoading === 'generate-plan' ? (
                    <LoadingSpinner size="small" />
                ) : (
                    <Icon name="calendar-plus" />
                )}
                ç”Ÿæˆè®¡åˆ’
            </button>

            <button
                className="action-button secondary"
                onClick={handleViewCalendar}
                disabled={actionLoading !== null}
            >
                {actionLoading === 'view-calendar' ? (
                    <LoadingSpinner size="small" />
                ) : (
                    <Icon name="calendar" />
                )}
                å¤ä¹ æ—¥å†
            </button>

            <button
                className="action-button ghost"
                onClick={onRefresh}
                disabled={loading || actionLoading !== null}
            >
                <Icon name="refresh-cw" className={loading ? 'animate-spin' : ''} />
                åˆ·æ–°
            </button>
        </div>
    );
};
```

### æ ·å¼å’Œä¸»é¢˜é€‚é…

**å“åº”å¼CSSæ ·å¼** [Source: canvas-progress-tracker/docs/obsidian-plugin-architecture.md#æ ·å¼é›†æˆ]
```css
/* styles/review-dashboard.css */

.review-dashboard {
    display: flex;
    flex-direction: column;
    height: 100%;
    background-color: var(--background-primary);
    color: var(--text-normal);
    font-family: var(--font-text);
}

/* ä»ªè¡¨æ¿å¤´éƒ¨ */
.dashboard-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1rem 1.5rem;
    border-bottom: 1px solid var(--background-modifier-border);
    background-color: var(--background-secondary);
}

.dashboard-title {
    font-size: 1.5rem;
    font-weight: 600;
    color: var(--text-normal);
    margin: 0;
}

.dashboard-header-actions {
    display: flex;
    gap: 0.5rem;
}

/* ä¸»è¦å†…å®¹åŒºåŸŸ */
.dashboard-content {
    display: flex;
    flex: 1;
    overflow: hidden;
}

/* ä»»åŠ¡åˆ—è¡¨åŒºåŸŸ */
.task-list-container {
    flex: 1;
    padding: 1rem;
    overflow-y: auto;
}

/* ä¾§è¾¹æ  */
.dashboard-sidebar {
    width: 320px;
    padding: 1rem;
    border-left: 1px solid var(--background-modifier-border);
    background-color: var(--background-secondary-alt);
    overflow-y: auto;
}

/* ç»Ÿè®¡å¡ç‰‡ */
.stat-card {
    background-color: var(--background-primary);
    border: 1px solid var(--background-modifier-border);
    border-radius: 8px;
    padding: 1rem;
    margin-bottom: 1rem;
}

.stat-card h3 {
    margin: 0 0 0.75rem 0;
    font-size: 0.875rem;
    font-weight: 600;
    color: var(--text-muted);
    text-transform: uppercase;
    letter-spacing: 0.05em;
}

/* ç»Ÿè®¡æŒ‡æ ‡ */
.stat-metrics {
    display: flex;
    justify-content: space-around;
    margin-bottom: 1rem;
}

.metric {
    text-align: center;
}

.metric .value {
    display: block;
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--text-normal);
    line-height: 1;
}

.metric .label {
    display: block;
    font-size: 0.75rem;
    color: var(--text-muted);
    margin-top: 0.25rem;
}

/* è¿›åº¦æ¡ */
.progress-bar {
    height: 6px;
    background-color: var(--background-modifier-border);
    border-radius: 3px;
    overflow: hidden;
}

.progress-fill {
    height: 100%;
    background-color: var(--interactive-accent);
    transition: width 0.3s ease;
}

/* å¿«é€Ÿæ“ä½œæŒ‰é’® */
.quick-actions {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 0.5rem;
}

.action-button {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    padding: 0.75rem 1rem;
    border: 1px solid var(--background-modifier-border);
    border-radius: 6px;
    background-color: var(--background-primary);
    color: var(--text-normal);
    font-size: 0.875rem;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s ease;
}

.action-button:hover:not(:disabled) {
    background-color: var(--background-modifier-hover);
    border-color: var(--interactive-accent);
}

.action-button.primary {
    background-color: var(--interactive-accent);
    color: var(--text-on-accent);
    border-color: var(--interactive-accent);
    grid-column: span 2;
}

.action-button.primary:hover:not(:disabled) {
    background-color: var(--interactive-accent-hover);
}

.action-button.secondary {
    background-color: var(--interactive-normal);
    color: var(--text-normal);
    border-color: var(--interactive-normal);
}

.action-button.ghost {
    background-color: transparent;
    border-color: var(--background-modifier-border);
}

.action-button:disabled {
    opacity: 0.6;
    cursor: not-allowed;
}

/* å“åº”å¼è®¾è®¡ */
@media (max-width: 768px) {
    .dashboard-content {
        flex-direction: column;
    }

    .dashboard-sidebar {
        width: 100%;
        border-left: none;
        border-top: 1px solid var(--background-modifier-border);
    }

    .quick-actions {
        grid-template-columns: 1fr;
    }

    .action-button.primary {
        grid-column: span 1;
    }

    .stat-metrics {
        flex-direction: column;
        gap: 0.5rem;
    }

    .metric {
        display: flex;
        justify-content: space-between;
        text-align: left;
    }
}

/* æš—è‰²ä¸»é¢˜é€‚é… */
.theme-dark .review-dashboard {
    /* æš—è‰²ä¸»é¢˜ç‰¹å®šæ ·å¼ */
}

/* åŠ è½½å’Œé”™è¯¯çŠ¶æ€ */
.loading-state,
.error-state {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 200px;
    gap: 1rem;
}

.error-state {
    color: var(--text-error);
}

/* åŠ¨ç”»æ•ˆæœ */
@keyframes spin {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
}

.animate-spin {
    animation: spin 1s linear infinite;
}

/* å¾®äº¤äº’ */
.task-card {
    transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.task-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}
```

### React Hookså®ç°

**è‡ªå®šä¹‰Hook** [Source: canvas-progress-tracker/docs/obsidian-plugin-architecture.md#Reactç»„ä»¶é›†æˆ]
```typescript
// hooks/useReviewData.ts
import { useState, useEffect, useCallback } from 'react';
import { CanvasReviewPlugin } from '../main';

export interface ReviewData {
    tasks: ReviewTask[];
    statistics: LearningStatistics;
    lastUpdated: Date;
}

export const useReviewData = (plugin: CanvasReviewPlugin) => {
    const [data, setData] = useState<ReviewData>({
        tasks: [],
        statistics: {} as LearningStatistics,
        lastUpdated: new Date()
    });
    const [isLoading, setIsLoading] = useState(false);
    const [error, setError] = useState<string | null>(null);

    const refreshData = useCallback(async () => {
        setIsLoading(true);
        setError(null);

        try {
            // å¹¶è¡Œè·å–ä»»åŠ¡å’Œç»Ÿè®¡æ•°æ®
            const [tasks, statistics] = await Promise.all([
                plugin.commandWrapper.getReviewTasks(),
                plugin.dataManager.getLearningStatistics({
                    startDate: new Date(Date.now() - 30 * 24 * 60 * 60 * 1000), // 30å¤©å‰
                    endDate: new Date()
                })
            ]);

            setData({
                tasks,
                statistics,
                lastUpdated: new Date()
            });
        } catch (err) {
            setError(err instanceof Error ? err.message : 'è·å–æ•°æ®å¤±è´¥');
        } finally {
            setIsLoading(false);
        }
    }, [plugin]);

    useEffect(() => {
        refreshData();

        // è®¾ç½®è‡ªåŠ¨åˆ·æ–°
        const interval = setInterval(refreshData, 5 * 60 * 1000); // 5åˆ†é’Ÿåˆ·æ–°ä¸€æ¬¡

        return () => clearInterval(interval);
    }, [refreshData]);

    return {
        ...data,
        isLoading,
        error,
        refreshData
    };
};

// hooks/useObsidianTheme.ts
export const useObsidianTheme = () => {
    const [theme, setTheme] = useState<'light' | 'dark'>('light');

    useEffect(() => {
        // æ£€æµ‹å½“å‰ä¸»é¢˜
        const isDark = document.body.classList.contains('theme-dark');
        setTheme(isDark ? 'dark' : 'light');

        // ç›‘å¬ä¸»é¢˜å˜åŒ–
        const observer = new MutationObserver(() => {
            const isDark = document.body.classList.contains('theme-dark');
            setTheme(isDark ? 'dark' : 'light');
        });

        observer.observe(document.body, {
            attributes: true,
            attributeFilter: ['class']
        });

        return () => observer.disconnect();
    }, []);

    return {
        theme,
        className: `theme-${theme}`,
        isDark: theme === 'dark'
    };
};
```

### æµ‹è¯•è¦æ±‚

**å•å…ƒæµ‹è¯•**:
- æµ‹è¯•æ‰€æœ‰ç»„ä»¶çš„æ¸²æŸ“å’Œäº¤äº’
- æµ‹è¯•æ•°æ®æµå’ŒçŠ¶æ€ç®¡ç†
- æµ‹è¯•äº‹ä»¶å¤„ç†å’Œå›è°ƒå‡½æ•°
- æµ‹è¯•åŠ è½½çŠ¶æ€å’Œé”™è¯¯å¤„ç†

**é›†æˆæµ‹è¯•**:
- æµ‹è¯•ç»„ä»¶ä¸æ’ä»¶ç³»ç»Ÿçš„é›†æˆ
- æµ‹è¯•æ•°æ®è·å–å’Œæ›´æ–°æµç¨‹
- æµ‹è¯•ç”¨æˆ·äº¤äº’çš„å®Œæ•´æµç¨‹

**è§†è§‰æµ‹è¯•**:
- æµ‹è¯•ä¸åŒä¸»é¢˜ä¸‹çš„æ˜¾ç¤ºæ•ˆæœ
- æµ‹è¯•å“åº”å¼å¸ƒå±€çš„æ­£ç¡®æ€§
- æµ‹è¯•åŠ¨ç”»å’Œè¿‡æ¸¡æ•ˆæœ

## SDDè§„èŒƒå¼•ç”¨

- **OpenAPI Spec**: `specs/api/canvas-api.openapi.yml#/paths/~1api~1v1~1review~1dashboard`
- **UI Types**: `canvas-progress-tracker/obsidian-plugin/src/types/UITypes.ts`
- **CSS Spec**: `canvas-progress-tracker/obsidian-plugin/src/styles/review-dashboard.css`

## ADRå…³è”

- **ADR-0007**: DOM-based UI rendering for Obsidian plugins (no React support)

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-01-27 | 1.0 | åˆå§‹Storyåˆ›å»º | PM Agent (Sarah) |
| 2025-12-01 | 1.1 | Storyå®Œæˆï¼Œå¡«å……Dev/QAè®°å½• | Dev Agent (Claude) |

## Dev Agent Record

### Agent Model Used
Claude Opus 4.5 (claude-opus-4-5-20250514)

### Debug Log References
- ä½¿ç”¨DOM APIè€ŒéReactï¼ˆObsidianæ’ä»¶ä¸æ”¯æŒReactæ¸²æŸ“ï¼‰
- ItemViewä½œä¸ºä¸»è§†å›¾å®¹å™¨
- ä½¿ç”¨Obsidian CSSå˜é‡å®ç°ä¸»é¢˜é€‚é…

### Completion Notes
- å®ç°äº†ReviewDashboardViewä½œä¸ºObsidian ItemView
- ä½¿ç”¨åŸç”ŸDOMæ“ä½œæ¸²æŸ“UIï¼ˆrenderHeader, renderTaskList, renderSidebarï¼‰
- é›†æˆDataManagerè·å–ç»Ÿè®¡æ•°æ®å’Œå¤ä¹ ä»»åŠ¡
- ä½¿ç”¨CSSå˜é‡å®ç°äº®/æš—ä¸»é¢˜è‡ªåŠ¨é€‚é…
- å“åº”å¼å¸ƒå±€æ”¯æŒ768pxæ–­ç‚¹

### File List
**åˆ›å»ºçš„æ–‡ä»¶ï¼š**
- `canvas-progress-tracker/obsidian-plugin/src/views/ReviewDashboardView.ts` - ä¸»ä»ªè¡¨æ¿è§†å›¾ (287è¡Œ)
- `canvas-progress-tracker/obsidian-plugin/src/types/UITypes.ts` - UIç»„ä»¶ç±»å‹å®šä¹‰ (112è¡Œ)
- `canvas-progress-tracker/obsidian-plugin/src/styles/review-dashboard.css` - ä»ªè¡¨æ¿æ ·å¼ (245è¡Œ)
- `canvas-progress-tracker/obsidian-plugin/tests/views/ReviewDashboardView.test.ts` - è§†å›¾æµ‹è¯•

**ä¿®æ”¹çš„æ–‡ä»¶ï¼š**
- `canvas-progress-tracker/obsidian-plugin/main.ts` - æ³¨å†Œä»ªè¡¨æ¿å‘½ä»¤å’Œè§†å›¾
- `canvas-progress-tracker/obsidian-plugin/styles.css` - å¯¼å…¥ä»ªè¡¨æ¿æ ·å¼

## QA Results

### Review Date: 2025-12-01

### Reviewed By: QA Agent (Claude Opus 4.5)

### Code Quality Assessment
âœ… **PASS** - TypeScriptç±»å‹å®Œæ•´ï¼ŒDOMæ“ä½œå°è£…è‰¯å¥½ï¼Œç¬¦åˆObsidianæ’ä»¶æ¨¡å¼

### Compliance Check
âœ… **PASS** - ä½¿ç”¨Obsidian ItemView APIï¼ŒCSSå˜é‡éµå¾ªObsidianè§„èŒƒ

### Security Review
âœ… **PASS** - æ— XSSé£é™©ï¼ŒDOMåˆ›å»ºä½¿ç”¨createElè€ŒéinnerHTML

### Performance Considerations
âœ… **PASS** - è™šæ‹Ÿæ»šåŠ¨ä¼˜åŒ–å¤§åˆ—è¡¨ï¼Œæ•°æ®åˆ·æ–°èŠ‚æµå¤„ç†

### Architecture & Design Review
âœ… **PASS** - MVCåˆ†ç¦»ï¼Œè§†å›¾ä¸æ•°æ®å±‚è§£è€¦ï¼Œä¾¿äºæµ‹è¯•

### Test Quality Review
âœ… **PASS** - è§†å›¾æ¸²æŸ“æµ‹è¯•ï¼Œäº¤äº’å›è°ƒæµ‹è¯•ï¼Œä¸»é¢˜åˆ‡æ¢æµ‹è¯•

### Final Status
âœ… **PASS** - ç¬¦åˆObsidianæ’ä»¶UIè§„èŒƒï¼Œå“åº”å¼å¸ƒå±€å®Œæ•´

---

**æœ¬Storyå®Œæˆåï¼Œå°†ä¸ºç”¨æˆ·æä¾›ä¸€ä¸ªåŠŸèƒ½å®Œæ•´ã€è§†è§‰ç¾è§‚çš„å¤ä¹ ä»ªè¡¨æ¿ï¼Œå®ç°ä»Šæ—¥ä»»åŠ¡ç®¡ç†ã€å­¦ä¹ ç»Ÿè®¡å±•ç¤ºå’Œå¿«é€Ÿæ“ä½œçš„æ ¸å¿ƒåŠŸèƒ½ï¼Œæ˜¾è‘—æå‡ç”¨æˆ·çš„å­¦ä¹ ç®¡ç†ä½“éªŒã€‚**
