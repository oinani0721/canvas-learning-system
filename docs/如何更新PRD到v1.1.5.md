# 如何更新PRD到v1.1.5 - 简易指南

**当前状态**: 原PRD文件遇到写入锁定，无法自动更新
**解决方案**: 手动应用3个关键更新

---

## ⚡ 快速更新步骤（只需3步！）

### Step 1: 更新版本号和日期 ⏱️ 1分钟

**打开文件**: `docs/prd/CANVAS-LEARNING-SYSTEM-OBSIDIAN-NATIVE-MIGRATION-PRD.md`

**找到第3-5行**（文件开头）:
```markdown
**文档版本**: v1.1.4 (艾宾浩斯复习系统设计补全版)
**创建日期**: 2025-01-15
**最后更新**: 2025-11-11 (**NEW**: 艾宾浩斯复习系统设计补全 - FR3扩展+Epic 14调整)
```

**替换为**:
```markdown
**文档版本**: v1.1.5 (智能并行处理UI需求补全版)
**创建日期**: 2025-01-15
**最后更新**: 2025-11-12 (**NEW**: 智能并行处理UI需求补全 - FR2.1新增+Epic 11/13扩展)
```

---

### Step 2: 添加v1.1.5变更说明 ⏱️ 2分钟

**在第8行之前**（"## ⚠️ v1.1.4"之前）插入以下内容:

```markdown

## ⚠️ v1.1.5 智能并行处理UI需求补全 (2025-11-12) **必读**

**核心变更**: 新增FR2.1（智能并行处理UI），扩展Epic 13（Story 13.8）和Epic 11（Story 11.6），暴露Epic 10后端实现

**新增内容**:
1. **FR2.1 智能并行处理UI**: Canvas工具栏"智能批量处理"按钮，4步交互流程（分组预览→执行→进度监控→结果展示）
2. **Story 13.8 UI实现**: 7天工作量，5个Task（工具栏按钮、分组预览模态框、实时进度、结果预览、错误处理）
3. **Story 11.6 API端点**: 4个REST API + 1个WebSocket，集成AsyncExecutionEngine和智能调度器
4. **Epic影响**: Epic 13 (7→8 Stories), Epic 11 (5→6 Stories), 总时间+1周

**技术基础**: Epic 10的完整后端实现（1400+行代码）已验证，8倍性能提升，TF-IDF+K-Means智能分组

**优先级**: Must Have - P0（后端已实现，只需UI暴露）

**相关文档**: `docs/SPRINT_CHANGE_PROPOSAL_SCP-001_智能并行处理UI需求补全.md`

---
```

---

### Step 3: 插入FR2.1完整需求 ⏱️ 5分钟

**找到这一行**（大约第264行）:
```markdown
#### FR3: 艾宾浩斯复习提醒系统 (Must Have - P0)
```

**在这一行之前**插入以下完整内容:

```markdown
#### FR2.1: 智能并行处理UI (Must Have - P0)

**背景**: Epic 10智能并行处理系统的完整后端实现已完成（IntelligentParallelCommandHandler + AsyncExecutionEngine + IntelligentParallelScheduler），但缺少Obsidian Plugin的UI暴露。当前仅能通过CLI命令`/intelligent-parallel`使用。

**描述**: 在Obsidian Canvas工具栏添加"智能批量处理"按钮，用户可一键触发对当前Canvas的所有黄色节点进行智能分组和Agent批量调用。

**核心能力**:
- ✅ **智能分组**: TF-IDF向量化 + K-Means聚类，自动将语义相近的黄色节点分组
- ✅ **Agent推荐**: 基于节点内容关键词，自动推荐最合适的6个解释Agent
- ✅ **异步并发**: AsyncExecutionEngine支持最多12个Agent并发执行（Epic 10.2的8倍性能提升）
- ✅ **实时进度**: WebSocket推送任务进度、完成状态和错误信息
- ✅ **3层Canvas结构**: 黄色节点 → 蓝色TEXT节点（说明） → File节点（.md文档）

**UI交互流程**:

**Step 1: 工具栏按钮**
```
┌─────────────────────────────────────────┐
│ Canvas工具栏                             │
│ [🎯 拆解] [📊 评分] [📝 解释] [⚡ 智能批量处理] │
└─────────────────────────────────────────┘
```

**Step 2: 智能分组预览模态框**
```
┌────────────────────────────────────────────┐
│ 智能并行处理 - 分组预览                       │
├────────────────────────────────────────────┤
│ 检测到 12 个黄色节点，智能分组为 4 组:        │
│                                            │
│ 📊 Group 1: 对比类概念 (3节点)              │
│   推荐Agent: comparison-table              │
│   • 逆否命题 vs 否命题                      │
│   • 充分条件 vs 必要条件                    │
│   优先级: High                             │
│                                            │
│ 🔍 Group 2: 复杂概念澄清 (4节点)            │
│   推荐Agent: clarification-path            │
│   优先级: High                             │
│                                            │
│ [ 修改分组 ] [ 取消 ] [ 开始处理 (预计2分钟) ] │
└────────────────────────────────────────────┘
```

**Step 3: 实时进度显示**
```
┌────────────────────────────────────────────┐
│ 智能并行处理 - 执行中                        │
├────────────────────────────────────────────┤
│ 总进度: ████████░░░░░░░░ 8/12 (67%)        │
│                                            │
│ ✅ Group 1 (comparison-table): 已完成       │
│    ├─ 逆否命题 vs 否命题.md (3.2KB)         │
│    └─ 充分条件 vs 必要条件.md (2.8KB)       │
│                                            │
│ ⏳ Group 2 (clarification-path): 进行中 (2/4)│
│                                            │
│ [ 暂停 ] [ 取消 ] [ 最小化 ]                │
└────────────────────────────────────────────┘
```

**Step 4: 完成结果预览**
```
┌────────────────────────────────────────────┐
│ 智能并行处理 - 完成                          │
├────────────────────────────────────────────┤
│ ✅ 成功处理 11/12 个节点                     │
│ ❌ 1个节点失败                               │
│ ⏱️ 总耗时: 2分15秒                          │
│                                            │
│ 生成文档:                                   │
│ • 3个对比表 (📊)                            │
│ • 4个澄清路径 (🔍)                          │
│                                            │
│ [ 查看错误日志 ] [ 关闭 ]                   │
└────────────────────────────────────────────┘
```

**验收标准**:
- ✅ Canvas工具栏显示"智能批量处理"按钮（图标：⚡）
- ✅ 点击按钮触发智能分组分析（<3秒完成）
- ✅ 分组预览模态框正确显示分组结果
- ✅ 实时进度显示（WebSocket推送，延迟<500ms）
- ✅ 完成结果预览（成功/失败统计）
- ✅ Canvas自动更新（3层结构正确）
- ✅ 错误处理完善（无黄色节点提示、Agent失败不中断其他）

**关联Epic/Story**:
- Epic 11: Story 11.6（4个REST API + 1个WebSocket）
- Epic 13: Story 13.8（UI实现，7天）

**优先级**: Must Have - P0（已有完整后端实现，只缺UI暴露）

**时间估算**: +1周（UI开发 + API集成 + E2E测试）

---
```

---

## ✅ 完成验证

更新完成后，验证以下内容：

- [ ] 文件开头显示版本号 `v1.1.5`
- [ ] 最后更新日期为 `2025-11-12`
- [ ] 第8行附近有 `v1.1.5 智能并行处理UI需求补全` 章节
- [ ] FR2.1内容在FR3之前（约第264-415行）
- [ ] FR2.1包含4个UI Mockup（工具栏、分组预览、进度显示、结果预览）
- [ ] 所有markdown格式正确（代码块闭合、列表对齐）

---

## 📁 备份说明

**备份文件已创建**: `CANVAS-LEARNING-SYSTEM-OBSIDIAN-NATIVE-MIGRATION-PRD.md.backup-v1.1.4`

如果更新过程中出现问题，可以从备份恢复：
1. 删除当前PRD文件
2. 将备份文件重命名为原文件名

---

## 💡 为什么需要手动更新？

**技术原因**: PRD文件被其他进程占用（可能是：编辑器、OneDrive、杀毒软件）

**建议**:
1. 关闭所有编辑器
2. 暂停OneDrive同步（如果启用）
3. 使用VS Code或Notepad++进行更新
4. 保存后验证格式正确

---

## 🆘 遇到问题？

**如果内容太长难以复制**:
- 打开 `docs/SPRINT_CHANGE_PROPOSAL_SCP-001_智能并行处理UI需求补全.md`
- 查看第5.1节，那里有FR2.1的完整内容
- 直接复制粘贴

**如果格式混乱**:
- 使用VS Code的"Format Document"功能（快捷键：Shift+Alt+F）
- 或使用在线Markdown格式化工具

**如果还是无法更新**:
- 告诉我，我会创建一个完整的v1.1.5新文件给您

---

**预计总耗时**: 8-10分钟
**更新完成标志**: PRD文件版本号显示v1.1.5，且包含FR2.1完整内容
