# æ£€éªŒç™½æ¿è¿›åº¦ - ç¦»æ•£æ•°å­¦

ğŸ“Š çŸ¥è¯†è¿˜åŸè¿›åº¦: 12/15 (80%)

ğŸ”´ çº¢è‰²èŠ‚ç‚¹ (åŸºç¡€æ¦‚å¿µ):
  âœ… é€†å¦å‘½é¢˜å®šä¹‰ (åŸç™½æ¿ node-123)
  âœ… å……è¦æ¡ä»¶ (åŸç™½æ¿ node-456)
  âŒ å¾·æ‘©æ ¹å¾‹ (åŸç™½æ¿ node-789) - æœªé€šè¿‡

ğŸŸ£ ç´«è‰²èŠ‚ç‚¹ (è¿›é˜¶é—®é¢˜):
  âœ… é€†å¦å‘½é¢˜åº”ç”¨ (åŸç™½æ¿ node-234)
  âŒ å‘½é¢˜ç­‰ä»·è¯æ˜ (åŸç™½æ¿ node-567) - æœªé€šè¿‡
```

**éªŒæ”¶æ ‡å‡†**:
- âœ… å®æ—¶æ˜¾ç¤ºå·²è¿˜åŸèŠ‚ç‚¹æ•°é‡
- âœ… çº¢è‰²/ç´«è‰²/ç»¿è‰²èŠ‚ç‚¹ç»Ÿè®¡å‡†ç¡®
- âœ… å¯ç‚¹å‡»è·³è½¬åˆ°åŸç™½æ¿å¯¹åº”èŠ‚ç‚¹
- âœ… è¿›åº¦ç™¾åˆ†æ¯”è®¡ç®—æ­£ç¡®

---

#### FR4æ‰©å±•: å¤šæ¬¡æ£€éªŒå¯¹æ¯”åˆ†æ (v1.1.8æ–°å¢)

**æ ¸å¿ƒç›®æ ‡**: åœ¨å•æ¬¡è¿›åº¦è¿½è¸ªåŸºç¡€ä¸Šï¼Œæ–°å¢è·¨å¤šæ¬¡æ£€éªŒç™½æ¿çš„è¿›åº¦å¯¹æ¯”å’Œå­¦ä¹ è¶‹åŠ¿åˆ†æ

**æ‰©å±•ç”¨æˆ·æ•…äº‹**:
```
ä½œä¸ºå­¦ä¹ è€…
å½“æˆ‘å®Œæˆç¬¬3æ¬¡å¤ä¹ "ç¦»æ•£æ•°å­¦.canvas"æ—¶
æˆ‘å¸Œæœ›åœ¨æ£€éªŒç™½æ¿è¿›åº¦è¿½è¸ªUIä¸­çœ‹åˆ°:
  "è¿™æ˜¯ç¬¬3æ¬¡å¤ä¹ ï¼Œè¿›åº¦ä»60% â†’ 75% â†’ 85%æå‡"
  "é€†å¦å‘½é¢˜ï¼šç¬¬1æ¬¡å¤±è´¥ â†’ ç¬¬2æ¬¡å¤±è´¥ â†’ ç¬¬3æ¬¡é€šè¿‡ âœ…"
è¿™æ ·æˆ‘å¯ä»¥ç›´è§‚çœ‹åˆ°å­¦ä¹ è¿›æ­¥è¶‹åŠ¿
```

**æŠ€æœ¯æ–¹æ¡ˆæ‰©å±•**:

**1. è·¨æ£€éªŒç™½æ¿è¿›åº¦èšåˆç®—æ³•**

```python
def analyze_multi_review_progress(original_canvas_path: str) -> Dict:
    """
    åˆ†æåŒä¸€åŸç™½æ¿çš„å¤šæ¬¡æ£€éªŒè¿›åº¦è¶‹åŠ¿

    Returns:
        {
            "review_history": [
                {
                    "review_canvas": "ç¦»æ•£æ•°å­¦-æ£€éªŒç™½æ¿-20250115.canvas",
                    "timestamp": "2025-01-15T10:00:00Z",
                    "progress_rate": 0.60,  // 60%é€šè¿‡ç‡
                    "passed_count": 9,
                    "total_count": 15
                },
                {
                    "review_canvas": "ç¦»æ•£æ•°å­¦-æ£€éªŒç™½æ¿-20250122.canvas",
                    "timestamp": "2025-01-22T14:00:00Z",
                    "progress_rate": 0.85,  // 85%é€šè¿‡ç‡
                    "passed_count": 13,
                    "total_count": 15
                }
            ],
            "concept_trends": {
                "é€†å¦å‘½é¢˜": {
                    "attempts": 3,
                    "history": ["å¤±è´¥", "å¤±è´¥", "é€šè¿‡"],
                    "first_pass_review": 3  // ç¬¬3æ¬¡æ‰é€šè¿‡
                },
                "å……è¦æ¡ä»¶": {
                    "attempts": 3,
                    "history": ["é€šè¿‡", "é€šè¿‡", "é€šè¿‡"],
                    "first_pass_review": 1  // ç¬¬1æ¬¡å°±é€šè¿‡
                }
            },
            "overall_trend": "improving",  // "improving" | "stable" | "declining"
            "improvement_rate": 0.25  // ä»60%æå‡åˆ°85%ï¼Œæå‡ç‡25%
        }
    """

    # 1. ä»GraphitiæŸ¥è¯¢å†å²æ£€éªŒè®°å½•
    history = query_review_history_from_graphiti(original_canvas_path)

    # 2. è®¡ç®—æ¯æ¬¡æ£€éªŒçš„è¿›åº¦ç‡
    review_progress = []
    for review in history['reviews']:
        results = review['results']
        progress_rate = results['passed_nodes'] / results['total_nodes']
        review_progress.append({
            "review_canvas": review['review_canvas'],
            "timestamp": review['timestamp'],
            "progress_rate": progress_rate,
            "passed_count": results['passed_nodes'],
            "total_count": results['total_nodes']
        })

    # 3. åˆ†ææ¦‚å¿µçº§åˆ«çš„å­¦ä¹ è¶‹åŠ¿
    concept_trends = {}
    for review in history['reviews']:
        for concept in review['results']['weak_concepts']:
            if concept not in concept_trends:
                concept_trends[concept] = {"attempts": 0, "history": []}
            concept_trends[concept]["attempts"] += 1
            concept_trends[concept]["history"].append("å¤±è´¥")

        for concept in review['results']['mastered_concepts']:
            if concept not in concept_trends:
                concept_trends[concept] = {"attempts": 0, "history": []}
            concept_trends[concept]["attempts"] += 1
            concept_trends[concept]["history"].append("é€šè¿‡")

    # 4. è®¡ç®—é¦–æ¬¡é€šè¿‡çš„å¤ä¹ æ¬¡æ•°
    for concept, data in concept_trends.items():
        try:
            first_pass_index = data["history"].index("é€šè¿‡")
            data["first_pass_review"] = first_pass_index + 1
        except ValueError:
            data["first_pass_review"] = None  # ä»æœªé€šè¿‡

    # 5. åˆ¤æ–­æ•´ä½“è¶‹åŠ¿
    if len(review_progress) >= 2:
        first_rate = review_progress[0]['progress_rate']
        latest_rate = review_progress[-1]['progress_rate']
        improvement_rate = latest_rate - first_rate

        if improvement_rate > 0.1:
            overall_trend = "improving"
        elif improvement_rate < -0.1:
            overall_trend = "declining"
        else:
            overall_trend = "stable"
    else:
        overall_trend = "insufficient_data"
        improvement_rate = 0.0

    return {
        "review_history": review_progress,
        "concept_trends": concept_trends,
        "overall_trend": overall_trend,
        "improvement_rate": round(improvement_rate, 2)
    }
```

**2. UIæ‰©å±• - å†å²æ£€éªŒå¯¹æ¯”Tab**

```
æ£€éªŒç™½æ¿è¿›åº¦è¿½è¸ªUI (æ‰©å±•ç‰ˆ)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“Š æ£€éªŒç™½æ¿è¿›åº¦ - ç¦»æ•£æ•°å­¦                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [å½“å‰è¿›åº¦] [å†å²å¯¹æ¯”] [æ¦‚å¿µè¶‹åŠ¿]  â† æ–°å¢Tab   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ã€å†å²å¯¹æ¯”ã€‘Tab                              â”‚
â”‚                                             â”‚
â”‚ å¤ä¹ å†å²: å…±3æ¬¡                              â”‚
â”‚ æ•´ä½“è¶‹åŠ¿: â¬†ï¸ æŒç»­è¿›æ­¥ (æå‡25%)               â”‚
â”‚                                             â”‚
â”‚ ğŸ“ˆ è¿›åº¦å˜åŒ–æ›²çº¿                              â”‚
â”‚ 100% â”¤                              â—      â”‚
â”‚  85% â”¤                         â—            â”‚
â”‚  60% â”¤               â—                      â”‚
â”‚   0% â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€>   â”‚
â”‚           1/15     1/22     1/29            â”‚
â”‚                                             â”‚
â”‚ ğŸ“‹ è¯¦ç»†å¯¹æ¯”                                  â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚ â”‚ æ—¥æœŸâ”‚ æ¨¡å¼ â”‚ é€šè¿‡ç‡ â”‚ è–„å¼±æ¦‚å¿µ  â”‚         â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”‚
â”‚ â”‚1/15 â”‚å…¨æ–°  â”‚ 60% â–¼  â”‚ 6ä¸ª      â”‚         â”‚
â”‚ â”‚1/22 â”‚é’ˆå¯¹  â”‚ 85% â–²  â”‚ 3ä¸ª â¬‡ï¸   â”‚         â”‚
â”‚ â”‚1/29 â”‚é’ˆå¯¹  â”‚ 92% â–²  â”‚ 1ä¸ª â¬‡ï¸   â”‚         â”‚
â”‚ â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                             â”‚
â”‚ ğŸ¯ æ¦‚å¿µæŒæ¡è¿›å±•                              â”‚
â”‚ â€¢ é€†å¦å‘½é¢˜: âŒâŒâœ… (ç¬¬3æ¬¡é€šè¿‡)                â”‚
â”‚ â€¢ å¾·æ‘©æ ¹å¾‹: âŒâœ…âœ… (ç¬¬2æ¬¡é€šè¿‡)                â”‚
â”‚ â€¢ å……è¦æ¡ä»¶: âœ…âœ…âœ… (ç¬¬1æ¬¡é€šè¿‡)                â”‚
â”‚                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**3. è¿›åº¦è¿½è¸ªUIç»„ä»¶æ•°æ®æ¥å£**

```typescript
// Obsidianæ’ä»¶ - è¿›åº¦è¿½è¸ªç»„ä»¶è°ƒç”¨çš„API
interface MultiReviewProgressData {
  review_history: ReviewProgress[];
  concept_trends: Record<string, ConceptTrend>;
  overall_trend: 'improving' | 'stable' | 'declining' | 'insufficient_data';
  improvement_rate: number;
}

interface ReviewProgress {
  review_canvas: string;
  timestamp: string;
  progress_rate: number;
  passed_count: number;
  total_count: number;
}

interface ConceptTrend {
  attempts: number;
  history: ('é€šè¿‡' | 'å¤±è´¥')[];
  first_pass_review: number | null;
}

// APIç«¯ç‚¹
GET /api/review-progress/multi/{original_canvas_path}
```

**æ‰©å±•éªŒæ”¶æ ‡å‡†** (v1.1.8æ–°å¢):
- âœ… "å†å²å¯¹æ¯”"Tabæ­£å¸¸æ˜¾ç¤ºï¼ŒåŒ…å«è¿›åº¦æ›²çº¿å›¾å’Œè¯¦ç»†å¯¹æ¯”è¡¨
- âœ… è¿›åº¦æ›²çº¿å›¾æ­£ç¡®å±•ç¤ºå¤šæ¬¡æ£€éªŒçš„é€šè¿‡ç‡è¶‹åŠ¿
- âœ… æ¦‚å¿µçº§åˆ«è¶‹åŠ¿å‡†ç¡®æ˜¾ç¤ºæ¯ä¸ªæ¦‚å¿µçš„å†æ¬¡æ£€éªŒç»“æœï¼ˆâŒ/âœ…ï¼‰
- âœ… æ•´ä½“è¶‹åŠ¿åˆ¤æ–­å‡†ç¡®ï¼ˆimproving/stable/decliningï¼‰
- âœ… æå‡ç‡è®¡ç®—æ­£ç¡®ï¼ˆæœ€æ–°é€šè¿‡ç‡ - é¦–æ¬¡é€šè¿‡ç‡ï¼‰
- âœ… æ•°æ®æ¥æºäºGraphitiå†å²æ£€éªŒè®°å½•ï¼Œ100%çœŸå®æ•°æ®

**æ€§èƒ½æŒ‡æ ‡** (v1.1.8æ–°å¢):
- æŸ¥è¯¢Graphitiå†å²æ£€éªŒè®°å½•: <200ms
- èšåˆå¤šæ¬¡æ£€éªŒæ•°æ®: <100ms
- æ¸²æŸ“å†å²å¯¹æ¯”UI: <500ms

---

#### FR5: è·¨Canvaså…³è”å­¦ä¹ ç³»ç»Ÿ (Should Have - P1)

**æè¿°**: ç”¨æˆ·æ‰‹åŠ¨é…ç½®ä¹ é¢˜Canvaså…³è”åˆ°æ•™æCanvas,Agentè‡ªåŠ¨å¼•ç”¨æ•™æå†…å®¹

**ç”¨æˆ·æ•…äº‹**:
```
ä½œä¸ºå­¦ä¹ è€…
æˆ‘å¸Œæœ›åœ¨"çº¿æ€§ä»£æ•°ä¹ é¢˜é›†3.canvas"ä¸­è®¾ç½®å…³è”åˆ°"ç¬¬3ç« -å‘é‡ç©ºé—´.canvas"
è¿™æ ·Agentç”Ÿæˆè§£é‡Šæ—¶ä¼šè‡ªåŠ¨å¼•ç”¨æ•™æå®šä¹‰å’Œæ–‡æ¡£
```

**UIè®¾è®¡ - Canvaså·¥å…·æ æŒ‰é’® + æ¨¡æ€æ¡†**:

```
Canvaså·¥å…·æ :
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [ğŸ”] [â•] [ğŸ—‘ï¸] [âš™ï¸]  ...  [ğŸ”—å…³è”]      â”‚  â† æ–°å¢æŒ‰é’®
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç‚¹å‡» [ğŸ”—å…³è”] åå¼¹å‡ºæ¨¡æ€æ¡†:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ”— è®¾ç½®Canvaså…³è”                        â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
â”‚                                           â”‚
â”‚  å½“å‰Canvas:                              â”‚
â”‚  ğŸ“„ çº¿æ€§ä»£æ•°ä¹ é¢˜é›†3.canvas                â”‚
â”‚                                           â”‚
â”‚  â˜‘ï¸ å¯ç”¨å…³è”å­¦ä¹ æ¨¡å¼                      â”‚
â”‚                                           â”‚
â”‚  é€‰æ‹©å…³è”çš„æ•™æCanvas:                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ğŸ” æœç´¢Canvas...                    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                           â”‚
â”‚  æœ€è¿‘ä½¿ç”¨:                                â”‚
â”‚  â€¢ ç¬¬3ç« -å‘é‡ç©ºé—´.canvas                  â”‚
â”‚  â€¢ ç¬¬2ç« -çŸ©é˜µ.canvas                      â”‚
â”‚                                           â”‚
â”‚  æˆ–ä»æ‰€æœ‰Canvasä¸­é€‰æ‹©:                    â”‚
â”‚  â€¢ ç¬¬1ç« -è¡Œåˆ—å¼.canvas                    â”‚
â”‚  â€¢ ç¬¬3ç« -å‘é‡ç©ºé—´.canvas âœ“ å·²é€‰æ‹©         â”‚
â”‚  â€¢ ç¬¬4ç« -çº¿æ€§æ–¹ç¨‹ç»„.canvas                â”‚
â”‚                                           â”‚
â”‚  [ å–æ¶ˆ ]              [ ä¿å­˜å¹¶å¯ç”¨ ]     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ•°æ®å­˜å‚¨**:
```json
// .canvas-links.json (Vaultæ ¹ç›®å½•)
{
  "version": "1.0",
  "links": {
    "çº¿æ€§ä»£æ•°ä¹ é¢˜é›†3.canvas": {
      "linked_canvas": "ç¬¬3ç« -å‘é‡ç©ºé—´.canvas",
      "enabled": true,
      "created_at": "2025-01-15T14:30:00Z",
      "settings": {
        "citation_depth": 2,
        "auto_reference": true,
        "priority": "high"
      }
    }
  }
}
```

**GraphitiçŸ¥è¯†å›¾è°±åŒæ­¥**:
```cypher
// æ¯æ¬¡ä¿å­˜å…³è”æ—¶,åŒæ­¥å†™å…¥Graphiti
CREATE (exercise:Canvas {path: "çº¿æ€§ä»£æ•°ä¹ é¢˜é›†3.canvas"})
CREATE (textbook:Canvas {path: "ç¬¬3ç« -å‘é‡ç©ºé—´.canvas"})
CREATE (exercise)-[:LINKED_TO {enabled: true, depth: 2}]->(textbook)
```

**Agentå¼•ç”¨æœºåˆ¶**:
```python