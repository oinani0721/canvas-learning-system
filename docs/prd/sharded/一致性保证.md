# 一致性保证

**强一致性**:
- Canvas文件写入 ↔ LangGraph Checkpointer State
  - 机制: 在事务内完成，write_to_canvas失败则LangGraph自动回滚State

**最终一致性**:
- Canvas文件 ↔ Graphiti/Temporal/Semantic
  - 机制: 异步存储 + 重试机制 + 定期对账任务

**冲突解决**:
- 如果Graphiti/Temporal/Semantic存储失败，系统行为：
  1. 记录错误日志（包含session_id, operation_type, error_message）
  2. 不阻塞Canvas操作和用户体验
  3. 后台异步重试（指数退避策略）
  4. 管理员可查看失败队列，手动触发重试

---
