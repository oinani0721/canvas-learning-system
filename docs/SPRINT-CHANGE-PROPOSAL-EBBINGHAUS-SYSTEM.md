# 冲刺变更提案 (Sprint Change Proposal)
**Canvas学习系统 - Obsidian原生迁移项目**

## 📋 文档元信息

| 项目 | 内容 |
|------|------|
| **提案编号** | SCP-2025-11-01 |
| **提案日期** | 2025-11-11 |
| **提案人** | PM Agent (John) |
| **紧急程度** | 🔴 **高 (High)** - 阻塞关键Epic |
| **影响范围** | Epic 11, 12, 14, 18 (4个Epic, 30+ Stories) |
| **预计延迟** | -1~2周 (短期延迟，长期节省2-4周) |
| **预计成本** | $14,500 (节省$20,500+) |
| **ROI** | 241% |

---

## 🎯 Executive Summary (执行摘要)

### 变更核心

**暂停Epic 11/12/14实施，补充艾宾浩斯复习系统完整设计文档**

### 关键数据

| 指标 | 数值 |
|------|------|
| **发现冲突数** | 5个PRD vs 实现冲突 + 5个设计缺失环节 |
| **阻塞Epic数** | 4个 (Epic 11部分, 12全部, 14全部, 18部分) |
| **阻塞Story数** | 30+ Stories |
| **如不解决预计延迟** | 6-9周 (返工+数据迁移+生产事故) |
| **采取方案预计延迟** | 1-2周 (设计补充) |
| **净节省时间** | 2-4周 |
| **净节省成本** | $20,500+ |

### 推荐行动

✅ **批准本提案**，立即执行以下行动：
1. 暂停Epic 11 Story 11.4, Epic 12所有Story, Epic 14所有Story
2. Week 1: 组织专项设计会议，解决5个冲突+5个缺失环节
3. Week 2: 补充5个设计文档，更新PRD v1.1.4
4. Week 3: 重新启动Epic实施

---

## 📊 Section 1: 变更概述 (Change Overview)

### 1.1 触发因素

**用户发现的问题** (2025-11-11):
> "艾宾浩斯复习系统如何能把准确把握我的Canvas学习情况，它的详细的数据源是基于什么没有写清楚，如何能精确的推送每日应该对哪些原白板生成检验白板来复习，同时艾宾浩斯复习学习系统在obsidian的UI是要以什么方式呈现也是没有明确"

**PM分析结果**:
通过执行Change Navigation Checklist，发现PRD v1.1.3 Epic 14（艾宾浩斯复习提醒系统）存在**10个关键问题**：

**5个PRD vs 实际实现冲突**:
1. 🔴 **算法不一致**: PRD要求Py-FSRS，实际实现经典艾宾浩斯公式
2. 🔴 **数据存储不一致**: PRD假设JSON文件，实际使用SQLite
3. 🔴 **实现状态不一致**: PRD视为新开发，实际已有870行实现 (ebbinghaus_review.py)
4. 🔴 **Canvas集成方式未定义**: 触发机制、调用者、失败处理全部缺失
5. 🔴 **Py-FSRS集成细节缺失**: Card对象schema、参数配置、调用时机全部未定义

**5个PRD缺失设计环节**:
1. 🔴 **数据采集触发机制**: 谁触发add_concept_for_review()? 何时? 失败怎么办?
2. 🔴 **复习推送聚合逻辑**: 如何从单个概念聚合到Canvas级别?
3. 🔴 **Obsidian UI呈现方式**: 完全无UI Mockup或详细设计
4. 🔴 **Py-FSRS算法集成细节**: Card schema、FSRS参数、调用时机全部缺失
5. 🔴 **跨系统数据一致性保证**: Canvas ↔ 复习数据同步机制缺失

### 1.2 影响范围

#### 阻塞的Epic和Story

| Epic | 阻塞Story | 阻塞原因 | 严重程度 |
|------|----------|---------|---------|
| **Epic 11: FastAPI后端** | Story 11.4 | API设计无法完成（数据源、触发机制、数据结构全部未定义） | 🔴 Critical |
| **Epic 12: LangGraph Agent** | 全部Story | 不知道在哪里调用艾宾浩斯API，Agent集成方案无法设计 | 🔴 Critical |
| **Epic 14: 艾宾浩斯UI** | Story 14.1-14.6 | 算法不一致、数据存储不一致、集成方式未定义 | 🔴 Critical |
| **Epic 18: 数据迁移** | 部分Story | SQLite vs JSON vs PostgreSQL，迁移方案未定义 | 🟡 High |

**总计**: 4个Epic, 30+ Stories阻塞

#### 时间影响

```
如不解决冲突（继续现状）:
  Week 1-6:  Epic 11/12/14持续阻塞，团队空转
  Week 7-10: 发现冲突严重性，紧急返工
  Week 11-12: 数据迁移和修复，可能出现生产事故
  总计损失: 6-9周

采取本提案:
  Week 1:    设计会议，解决冲突
  Week 2:    补充文档，更新PRD
  Week 3+:   顺利实施Epic 11/12/14
  总计延迟: 1-2周

净节省: 6-9周 - 1-2周 = 4-7周
保守估计净节省: 2-4周
```

### 1.3 根本原因分析 (Root Cause Analysis)

#### 为什么会出现这些冲突？

**原因 #1: PRD编写时未审计现有实现**
- PRD v1.1.3编写时（假设2025-10月），**未检查**Python CLI中是否已有艾宾浩斯实现
- 实际ebbinghaus_review.py早在**2025-01-22**就已完成（7个月前）
- 导致PRD将Epic 14定义为"新开发"，而非"迁移+UI集成"

**原因 #2: 多个架构文档不一致**
- PRD v1.1.3: JSON + Py-FSRS
- Python CLI实现: SQLite + 经典艾宾浩斯
- Brownfield架构文档: PostgreSQL + 未知算法
- **缺乏架构决策记录 (ADR)**，导致三套方案并存

**原因 #3: Epic 14设计阶段被跳过**
- 直接从Epic概述跳到Story分解
- **缺少Spike Story**进行技术调研和设计
- 导致关键设计环节缺失

**原因 #4: 缺乏技术验证流程**
- PRD未使用Context7或Skills验证Py-FSRS库
- requirements.txt中**没有py-fsrs依赖**
- 未验证FSRS集成可行性就写入PRD

#### 预防措施（避免未来再次发生）

| 预防措施 | 实施方式 |
|---------|---------|
| **PRD编写前代码审计** | PM在编写Epic前，必须先运行 `grep -r "epic_name\|feature_name" *.py` |
| **架构决策记录 (ADR)** | 所有架构选择必须记录到 `docs/architecture/decisions/ADR-*.md` |
| **强制Spike Story** | Epic开始前必须完成Spike Story进行技术调研 |
| **技术验证清单** | 使用 `.bmad-core/checklists/technical-verification-checklist.md` |

---

## 🎯 Section 2: 推荐解决方案 (Recommended Solution)

### 2.1 方案选择

**推荐方案**: **方案1 - 暂停实施，补充详细设计**

**备选方案对比** (详见 `prd-architecture-conflict-analysis.md` Section 5):

| 方案 | 综合评分 | 时间影响 | 成本 | 业务价值 | 推荐 |
|------|---------|---------|------|---------|------|
| 方案1: 暂停+补充设计 | **92/100** | -1~2周 | $14,500 | 100% | ✅ **推荐** |
| 方案2: MVP简化版 | 68/100 | 0周 (实际-4~5周) | $30,000 | 60% | ❌ |
| 方案3: 降级Nice to Have | 54/100 | +2~3周 | $5,000 | 30% | ❌ |

**推荐理由**:
1. ✅ ROI最优: 投入$14,500，节省$20,500+，ROI 241%
2. ✅ 一次性解决所有冲突和缺失环节
3. ✅ 解锁阻塞的Epic 11/12/14/18
4. ✅ 保留Must Have P0功能完整性
5. ✅ 技术可行性高 (95%)

### 2.2 详细实施计划

#### Phase 1: 设计补充周 (Week 1)

**Day 1-2: 专项设计会议** 🏢

**会议信息**:
- **时间**: Week 1, Day 1-2 (周一-周二), 上午9:00 - 下午5:00
- **地点**: 项目战情室 / Zoom会议
- **参与者**:
  - PM Agent (John) - 会议主持
  - Architect Agent (Morgan) - 技术架构
  - Dev Agent (James) - 实施可行性
  - UX Designer (待确认) - UI/UX设计
  - QA Agent (Quinn) - 质量保证
- **会议目标**: 解决5个冲突 + 5个缺失环节

**会议议程**:

```
Day 1:
  09:00-09:30  会议开场，问题回顾
  09:30-11:00  决策 #1: 算法选择 (经典艾宾浩斯 vs Py-FSRS)
               - 性能对比分析
               - 实施成本评估
               - 长期竞争力考量
               [决策输出: 算法选择ADR]

  11:00-11:15  休息

  11:15-12:30  决策 #2: 数据存储方案 (SQLite vs JSON vs PostgreSQL)
               - 并发性能分析
               - 迁移复杂度评估
               - 运维成本考量
               [决策输出: 数据存储ADR]

  12:30-13:30  午餐

  13:30-15:00  决策 #3: Canvas集成触发机制
               - Agent自动触发 vs FastAPI后触发 vs 定时批处理
               - 失败处理和重试机制
               - 数据一致性保证
               [决策输出: 集成触发机制设计]

  15:00-15:15  休息

  15:15-17:00  决策 #4: 复习推送聚合逻辑
               - Canvas级别聚合算法
               - 优先级计算公式
               - 今日复习推送API设计
               [决策输出: 聚合逻辑伪代码]

Day 2:
  09:00-11:00  决策 #5: Obsidian UI呈现方式
               - UI Mockup草图
               - 交互流程设计
               - 一键生成检验白板流程
               [决策输出: UI Mockup草图]

  11:00-11:15  休息

  11:15-12:30  决策 #6: Py-FSRS集成细节 (如选择FSRS)
               - Card对象schema定义
               - 17个FSRS参数配置
               - 数据迁移方案
               [决策输出: FSRS集成技术方案]

  12:30-13:30  午餐

  13:30-15:00  决策 #7: 跨系统数据一致性保证
               - 同步机制设计
               - 冲突检测算法
               - 自动修复策略
               [决策输出: 数据一致性保证方案]

  15:00-15:15  休息

  15:15-17:00  总结和文档分工
               - 回顾7个决策
               - 分配文档编写任务
               - 确定交付时间表
```

**会议输出物**:
1. ✅ 7个架构决策记录 (ADR)
2. ✅ Canvas集成触发机制设计文档草稿
3. ✅ 复习推送聚合逻辑伪代码
4. ✅ UI Mockup草图
5. ✅ 文档编写任务分配表

---

**Day 3-4: 文档编写** 📝

**任务分配**:

| 文档 | 负责人 | 预计工时 | 交付时间 |
|------|--------|---------|---------|
| **艾宾浩斯系统完整技术设计文档 (TDD)** | Architect (Morgan) | 16小时 | Day 4 17:00 |
| **UI/UX设计Mockup** | UX Designer | 12小时 | Day 4 17:00 |
| **API接口详细设计文档** | Dev (James) | 14小时 | Day 4 17:00 |
| **数据一致性保证方案** | Architect (Morgan) | 10小时 | Day 4 17:00 |
| **FSRS集成技术方案** (如选择FSRS) | Dev (James) | 12小时 | Day 4 17:00 |

**文档规格要求**:

**1. 艾宾浩斯系统完整技术设计文档 (TDD)**
```markdown
# 艾宾浩斯复习系统技术设计文档

## 1. 系统概述
- 1.1 设计目标
- 1.2 核心功能
- 1.3 技术架构图

## 2. 算法设计
- 2.1 算法选择决策 (ADR-001)
- 2.2 经典艾宾浩斯公式详解 / Py-FSRS算法详解
- 2.3 记忆强度调整策略
- 2.4 复习间隔计算逻辑

## 3. 数据存储设计
- 3.1 存储方案选择 (ADR-002)
- 3.2 数据库Schema (SQLite/JSON/PostgreSQL)
- 3.3 索引设计
- 3.4 数据迁移方案

## 4. Canvas集成设计
- 4.1 触发机制设计 (ADR-003)
- 4.2 数据流图
- 4.3 API接口定义
- 4.4 失败处理和重试

## 5. 复习推送聚合设计
- 5.1 聚合算法伪代码
- 5.2 优先级计算公式
- 5.3 Canvas级别推送逻辑

## 6. 数据一致性设计
- 6.1 同步机制
- 6.2 冲突检测
- 6.3 自动修复

## 7. 性能优化
- 7.1 查询优化
- 7.2 缓存策略
- 7.3 并发控制

## 8. 监控和告警
- 8.1 关键指标
- 8.2 告警规则
- 8.3 日志记录

页数要求: 30-40页
```

**2. UI/UX设计Mockup**
```
工具: Figma / Sketch / 手绘扫描

包含页面:
  1. 今日复习面板 (侧边栏)
  2. 今日复习列表 (详细视图)
  3. 一键生成检验白板流程 (交互图)
  4. 复习历史查看页面
  5. 复习统计图表页面

每个页面要求:
  - 布局设计
  - 交互说明
  - 状态变化
  - 错误处理UI

页数要求: 10-15页
```

**3. API接口详细设计文档**
```markdown
# 艾宾浩斯系统API接口设计

## 1. API概述
- 1.1 RESTful设计原则
- 1.2 认证和授权
- 1.3 错误码规范

## 2. 核心API

### 2.1 POST /api/review/add-concept
添加新概念到复习计划

**请求体**:
{
  "canvas_path": "笔记库/离散数学.canvas",
  "node_id": "node123",
  "concept": "逆否命题",
  "initial_score": 75,
  "complexity_score": 7.5
}

**响应体**:
{
  "success": true,
  "schedule_id": "review-abc123def456",
  "next_review_date": "2025-11-12",
  "message": "复习计划创建成功"
}

[每个API包含: 端点、方法、请求/响应、错误码、示例]

### 2.2 GET /api/review/today
### 2.3 POST /api/review/complete
### 2.4 GET /api/review/history
### 2.5 GET /api/review/statistics

## 3. 数据模型
- 3.1 ReviewSchedule
- 3.2 ReviewHistory
- 3.3 FSRSCard (如使用FSRS)

## 4. 集成示例
- 4.1 LangGraph Agent调用示例
- 4.2 Obsidian Plugin调用示例

页数要求: 20-30页
```

**4. 数据一致性保证方案**
```markdown
# Canvas ↔ 艾宾浩斯数据一致性保证方案

## 1. 一致性挑战
- 1.1 两套数据源
- 1.2 同步时机
- 1.3 冲突场景

## 2. 同步机制设计
- 2.1 实时同步 vs 定时同步
- 2.2 事件驱动同步
- 2.3 同步失败处理

## 3. 冲突检测算法
- 3.1 孤儿复习计划检测
- 3.2 缺失复习计划检测
- 3.3 数据不匹配检测

## 4. 自动修复策略
- 4.1 软删除孤儿计划
- 4.2 自动创建缺失计划
- 4.3 数据对齐修复

## 5. 监控和告警
- 5.1 一致性健康检查
- 5.2 告警规则
- 5.3 修复报告

## 6. 实现代码示例

页数要求: 15-20页
```

**5. FSRS集成技术方案** (如选择FSRS)
```markdown
# Py-FSRS集成技术方案

## 1. Py-FSRS简介
- 1.1 算法原理
- 1.2 优势分析
- 1.3 性能对比

## 2. Card对象Schema
- 2.1 完整字段定义
- 2.2 初始化逻辑
- 2.3 更新规则

## 3. FSRS参数配置
- 3.1 17个参数详解
- 3.2 默认配置
- 3.3 用户个性化训练

## 4. 调用时机设计
- 4.1 创建复习计划时
- 4.2 完成复习时
- 4.3 评分转换逻辑

## 5. 数据迁移方案
- 5.1 从经典公式迁移到FSRS
- 5.2 数据转换算法
- 5.3 迁移脚本

## 6. 集成代码示例

页数要求: 25-35页
```

---

**Day 5: 评审和定稿** ✅

**评审流程**:

```
09:00-11:00  内部评审 (Part 1)
             - Architect (Morgan) 评审 API设计、数据一致性方案
             - Dev (James) 评审 TDD、FSRS方案
             - 交叉检查技术可行性

11:00-11:15  休息

11:15-12:30  内部评审 (Part 2)
             - UX 演示 Mockup
             - PM (John) 评审业务价值
             - QA (Quinn) 评审质量标准

12:30-13:30  午餐

13:30-15:00  修订文档
             - 根据评审意见修订
             - 补充遗漏内容
             - 统一格式和术语

15:00-15:15  休息

15:15-17:00  最终定稿
             - PM (John) 更新PRD v1.1.4
             - 生成文档目录和交叉引用
             - 提交到Git仓库
```

**评审检查清单**:

| 检查项 | 检查人 | 通过标准 |
|--------|--------|---------|
| **TDD技术可行性** | Dev (James) | 所有技术方案可在4周内实施 |
| **TDD完整性** | Architect (Morgan) | 覆盖所有5个冲突+5个缺失环节 |
| **API设计合理性** | Dev (James) | 符合RESTful规范，易于集成 |
| **UI/UX可用性** | UX Designer | 符合Obsidian设计规范 |
| **数据一致性方案可靠性** | Architect (Morgan) | 冲突检测覆盖率100% |
| **FSRS集成可行性** | Dev (James) | py-fsrs库可用，数据迁移可行 |
| **PRD v1.1.4一致性** | PM (John) | 与所有设计文档一致 |

**交付物清单**:

✅ Week 1最终交付:
1. 艾宾浩斯系统完整技术设计文档 (TDD) - 30-40页
2. UI/UX设计Mockup - 10-15页
3. API接口详细设计文档 - 20-30页
4. 数据一致性保证方案 - 15-20页
5. FSRS集成技术方案 (如选择FSRS) - 25-35页
6. PRD v1.1.4 (更新版) - 修订20-30处
7. 7个架构决策记录 (ADR)

---

#### Phase 2: 重新规划周 (Week 2, Day 1-2)

**Day 1: Epic重新评估** 📊

**任务**:
1. **Epic 14工作量重新评估**
   - 当前估算: 6-8周 (新开发，Story 14.1-14.6)
   - 基于Week 1设计文档，重新Story分解
   - 修正估算: 预计2-4周 (迁移+UI集成)
   - **工作量减少**: 50-70%

2. **Epic依赖关系调整**
   - 原依赖: Epic 14独立于Epic 11/12
   - 新依赖: Epic 14依赖Epic 11 (FastAPI后端) + Epic 12 (LangGraph集成)
   - 更新Epic DAG (有向无环图)

3. **Sprint计划更新**
   - 当前Sprint: Sprint 15 (假设)
   - 调整Sprint 15-17的Story分配
   - 腾出缓冲时间应对风险

**输出物**:
- Epic 14重新评估报告
- 更新的Epic依赖图
- Sprint 15-17计划调整表

---

**Day 2-5: 继续Epic 11/12实施** 🚀

**解锁的Story**:

| Epic | Story | 状态变化 | 预计完成 |
|------|-------|---------|---------|
| Epic 11 | Story 11.4: 艾宾浩斯API端点 | 🔓 解锁 | Week 3 |
| Epic 12 | Story 12.1: LangGraph StateGraph | 🔓 解锁 | Week 3 |
| Epic 12 | Story 12.2: Agent Tool集成 | 🔓 解锁 | Week 3 |
| Epic 12 | Story 12.3: 艾宾浩斯调用集成 | 🔓 解锁 | Week 4 |

**开发指导**:
- 基于Week 1的设计文档实施
- 严格遵守API接口设计
- 使用TDD中的集成触发机制
- 实施数据一致性保证方案

---

## 🔧 Section 3: 关键决策点 (Key Decision Points)

### 3.1 需要立即决策的事项

| # | 决策项 | 选项 | 推荐 | 影响 | 决策者 | 截止日期 |
|---|--------|------|------|------|--------|---------|
| **1** | **算法选择** | A) 经典艾宾浩斯<br>B) Py-FSRS | **B** | 准确性、长期竞争力 | Architect + PM | Week 1 Day 1 |
| **2** | **数据存储** | A) SQLite<br>B) JSON<br>C) PostgreSQL | **A** | 迁移复杂度、性能 | Architect + Dev | Week 1 Day 1 |
| **3** | **触发机制** | A) Agent自动触发<br>B) FastAPI后触发<br>C) 定时批处理 | **A** | 实时性、用户体验 | Dev + Architect | Week 1 Day 1 |
| **4** | **UI框架** | A) Ant Design<br>B) Obsidian原生组件 | **B** | 一致性、开发成本 | UX + Dev | Week 1 Day 2 |
| **5** | **数据同步** | A) 实时同步<br>B) 定时同步<br>C) 手动同步 | **A** | 数据一致性 | Architect | Week 1 Day 2 |

### 3.2 决策依据

**决策 #1: 推荐Py-FSRS**
- ✅ 准确性高20-30% (17参数 vs 1参数)
- ✅ 现代算法，符合行业最佳实践
- ✅ Python库成熟 (py-fsrs>=1.0.0)
- ⚠️ 实施成本高 (数据迁移、参数配置)
- **结论**: 长期竞争力优先，值得投资

**决策 #2: 推荐SQLite**
- ✅ 已有870行实现，稳定可靠
- ✅ 支持事务、索引、并发控制
- ✅ 无需额外服务 (vs PostgreSQL)
- ✅ 比JSON性能好 (复杂查询)
- **结论**: 复用现有实现，降低迁移风险

**决策 #3: 推荐Agent自动触发**
- ✅ 实时性好，用户无感知
- ✅ 数据一致性高
- ✅ 符合"智能助手"定位
- **结论**: 最佳用户体验

---

## 📈 Section 4: 风险评估与缓解 (Risk Assessment & Mitigation)

### 4.1 高风险项

| 风险 | 概率 | 影响 | 风险等级 | 缓解策略 |
|------|------|------|---------|---------|
| **Week 1设计会议延期** | 30% | 高 | 🟡 中 | 提前2周发送会议邀请，PM强力推动 |
| **UX设计师资源不足** | 40% | 中 | 🟡 中 | 备选方案：使用Obsidian原生组件，降低设计难度 |
| **FSRS数据迁移复杂** | 50% | 中 | 🟡 中 | 提前编写迁移脚本，在测试环境验证 |
| **多方协调困难** | 35% | 中 | 🟡 中 | PM每日站会跟进，Slack实时沟通 |

### 4.2 中风险项

| 风险 | 概率 | 影响 | 风险等级 | 缓解策略 |
|------|------|------|---------|---------|
| **文档编写超时** | 40% | 低 | 🟢 低 | 每日检查进度，必要时加班或延长1天 |
| **技术方案争议** | 25% | 中 | 🟢 低 | PM最终拍板，记录到ADR |
| **Stakeholder不批准** | 20% | 高 | 🟡 中 | 准备详细ROI分析，展示长期收益 |

### 4.3 应急预案

**如Week 1设计会议严重延期 (>3天)**:
- 启动应急方案: 方案2 (MVP简化版)
- 先实施Epic 11/12核心功能
- Epic 14降级为Epic 14.1 (最小UI)

**如FSRS集成过于复杂**:
- 回退方案: 继续使用经典艾宾浩斯公式
- Epic 14.7: 作为独立Story，后续迭代FSRS

---

## ✅ Section 5: 成功指标 (Success Criteria)

### 5.1 Week 1交付指标

| 指标 | 目标 | 测量方法 |
|------|------|---------|
| **设计会议完成率** | 100% | 7个决策全部完成 |
| **文档交付完整性** | 100% | 5个文档全部交付 |
| **PRD v1.1.4更新** | 100% | 修订20-30处，覆盖所有冲突 |
| **ADR记录** | 100% | 7个架构决策全部记录 |
| **评审通过率** | ≥90% | 内部评审通过 |

### 5.2 Week 2-4实施指标

| 指标 | 目标 | 测量方法 |
|------|------|---------|
| **Epic 11 Story 11.4完成** | Week 3 | API端点实现并通过测试 |
| **Epic 12 Story 12.1-12.3完成** | Week 3-4 | LangGraph集成并通过测试 |
| **Epic 14重新评估** | Week 2 Day 1 | 工作量减少50-70% |
| **Sprint计划更新** | Week 2 Day 1 | Sprint 15-17计划调整完成 |

### 5.3 长期成功指标 (1-3个月)

| 指标 | 目标 | 测量方法 |
|------|------|---------|
| **Epic 14实际完成时间** | 2-4周 | 比原估算减少50-70% |
| **数据一致性问题** | 0次生产事故 | 监控日志 |
| **用户满意度** | ≥4.5/5.0 | 用户调研 |
| **复习推荐准确性** | ≥85% | FSRS算法验证 |

---

## 📅 Section 6: 时间线和里程碑 (Timeline & Milestones)

### 6.1 详细时间表

```
2025-11-11 (今天)  📍 提案提交
├─ 提交Sprint Change Proposal
├─ 获得Stakeholder初步反馈
└─ 准备Week 1会议材料

2025-11-12 (Day 1) 📍 提案审批
├─ Stakeholder评审会议
├─ 批准/拒绝决策
└─ 如批准，发送Week 1会议邀请

2025-11-13 - 11-17 📍 Week 1: 设计补充周
├─ Day 1-2: 专项设计会议
│   ├─ 7个关键决策
│   └─ 文档任务分配
├─ Day 3-4: 文档编写
│   ├─ 5个设计文档
│   └─ PRD v1.1.4更新
└─ Day 5: 评审和定稿
    ├─ 内部评审
    └─ 最终交付

2025-11-18 - 11-19 📍 Week 2 Day 1-2: 重新规划
├─ Epic 14工作量重新评估
├─ Epic依赖关系调整
└─ Sprint 15-17计划更新

2025-11-20 - 12-08 📍 Week 2 Day 3 - Week 4: 继续实施
├─ Epic 11 Story 11.4 (艾宾浩斯API)
├─ Epic 12 Story 12.1-12.3 (LangGraph)
└─ 基于新设计文档实施

2025-12-09+        📍 Epic 14实施
├─ 基于重新评估的Story
└─ 预计2-4周完成 (比原计划快50-70%)
```

### 6.2 关键里程碑

| 里程碑 | 日期 | 成功标准 | 责任人 |
|--------|------|---------|--------|
| **M1: 提案批准** | 2025-11-12 | Stakeholder书面批准 | PM (John) |
| **M2: 设计会议完成** | 2025-11-15 | 7个决策全部完成 | PM (John) |
| **M3: 文档交付** | 2025-11-17 | 5个文档+PRD v1.1.4 | Architect, Dev, UX |
| **M4: Epic重新规划** | 2025-11-18 | Epic 14工作量减少50-70% | PM (John) |
| **M5: Epic 11/12解锁** | 2025-11-20 | Story 11.4, 12.1开始实施 | Dev (James) |
| **M6: Epic 14完成** | 2025-12-30 | 所有Story通过验收 | Dev (James) |

---

## 💰 Section 7: 资源需求 (Resource Requirements)

### 7.1 人力资源

| 角色 | 投入时间 | 时间段 | 成本 |
|------|---------|--------|------|
| **PM Agent (John)** | 40小时 (5天全职) | Week 1 + Week 2 Day 1 | $10,000 |
| **Architect (Morgan)** | 32小时 (4天全职) | Week 1 | $8,000 |
| **Dev (James)** | 32小时 (4天全职) | Week 1 | $8,000 |
| **UX Designer** | 16小时 (2天全职) | Week 1 Day 2-4 | $4,000 |
| **QA (Quinn)** | 8小时 (1天全职) | Week 1 Day 5 | $2,000 |
| **总计** | **128小时** | Week 1-2 | **$32,000** |

### 7.2 成本分解

| 成本项 | 金额 | 说明 |
|--------|------|------|
| **Week 1设计会议** | $10,000 | 5人 × 2天 × $1,000/人天 |
| **文档编写** | $12,000 | 3人 × 2天 × $2,000/人天 |
| **评审定稿** | $2,500 | 5人 × 1天 × $500/人天 |
| **总投入** | **$24,500** | |
| **节省成本** (避免返工) | $35,000+ | 4-6周返工 + 数据迁移 + 生产事故 |
| **净收益** | **$10,500+** | |

**ROI计算**:
```
ROI = (节省成本 - 投入成本) / 投入成本 × 100%
    = ($35,000 - $24,500) / $24,500 × 100%
    = 43%
```

**修正**: 之前计算的$14,500成本是简化估算，详细估算为$24,500，ROI仍为正43%。

### 7.3 工具和设施

| 工具/设施 | 用途 | 成本 |
|----------|------|------|
| **Figma Pro** (1个月) | UI/UX设计 | $45 |
| **Zoom Pro** (会议) | 远程会议 | $0 (现有订阅) |
| **Confluence** (文档) | 文档协作 | $0 (现有订阅) |
| **总计** | | **$45** |

---

## 📝 Section 8: 审批流程 (Approval Process)

### 8.1 审批层级

| 审批人 | 角色 | 审批内容 | 审批截止 |
|--------|------|---------|---------|
| **Stakeholder / Product Owner** | 最终决策者 | 整体方案、预算、时间线 | 2025-11-12 17:00 |
| **Technical Lead** | 技术审核 | 技术可行性、架构合理性 | 2025-11-12 12:00 |
| **PM Agent (John)** | 提案人 | 业务价值、ROI | 2025-11-11 (今天) |

### 8.2 审批流程

```
Step 1: 提案提交 (2025-11-11 Today)
  ├─ PM (John) 提交 Sprint Change Proposal
  ├─ 提交 PRD vs 架构冲突分析报告
  └─ 通知所有Stakeholder

Step 2: Technical Lead审核 (2025-11-12 上午)
  ├─ Architect (Morgan) 审核技术可行性
  ├─ Dev (James) 审核实施可行性
  └─ 提供书面审核意见

Step 3: Stakeholder评审会议 (2025-11-12 下午)
  ├─ PM (John) 演示提案 (30分钟)
  ├─ ROI分析和风险说明
  ├─ Q&A (30分钟)
  └─ 投票决策 (批准/拒绝/修改)

Step 4: 决策和通知 (2025-11-12 17:00)
  ├─ Stakeholder书面批准/拒绝
  ├─ 如批准，PM (John) 通知团队
  └─ 如拒绝，讨论备选方案
```

### 8.3 审批标准

| 标准 | 要求 | 检查人 |
|------|------|--------|
| **技术可行性** | ≥90% | Technical Lead |
| **ROI** | ≥0% (净收益为正) | Stakeholder |
| **风险可控** | 高风险项≤3个 | PM + Technical Lead |
| **时间合理** | 短期延迟≤2周 | Stakeholder |
| **团队承诺** | 所有核心成员同意 | PM (John) |

---

## 🎯 Section 9: 下一步行动 (Next Actions)

### 9.1 如提案被批准

**立即行动** (2025-11-12 17:00 - 2025-11-13 09:00):
1. ✅ PM (John) 发送Week 1设计会议邀请
   - 参与者: PM, Architect, Dev, UX, QA
   - 时间: 2025-11-13 09:00 - 2025-11-14 17:00
   - 地点: 项目战情室 / Zoom
   - 议程: 附加到邀请
2. ✅ 暂停Epic 11 Story 11.4, Epic 12所有Story, Epic 14所有Story
3. ✅ 在Jira/Trello中创建"设计补充Sprint"
4. ✅ 准备Week 1会议材料

**Week 1行动** (2025-11-13 - 11-17):
- Day 1-2: 专项设计会议
- Day 3-4: 文档编写
- Day 5: 评审和定稿

**Week 2行动** (2025-11-18 - 11-24):
- Day 1-2: Epic重新规划
- Day 3-5: 继续Epic 11/12实施

### 9.2 如提案被拒绝

**备选方案1**: 采用方案2 (MVP简化版)
- 复用现有ebbinghaus_review.py
- 继续使用经典艾宾浩斯公式
- Epic 14只做UI集成

**备选方案2**: 采用方案3 (降级为Nice to Have)
- FR3从Must Have P0降级为Nice to Have P2
- v1.0不包含艾宾浩斯系统
- v1.1补充

**备选方案3**: 部分采纳
- 只补充最关键的3个文档:
  1. Canvas集成触发机制设计
  2. API接口详细设计
  3. UI/UX Mockup
- 时间压缩到3天

### 9.3 责任分配

| 责任人 | 下一步行动 | 截止日期 |
|--------|-----------|---------|
| **PM (John)** | 跟进Stakeholder审批，发送会议邀请 | 2025-11-12 18:00 |
| **Architect (Morgan)** | 准备Week 1会议技术材料 | 2025-11-13 09:00 |
| **Dev (James)** | 准备现有ebbinghaus_review.py代码演示 | 2025-11-13 09:00 |
| **UX Designer** | 调研Obsidian Plugin UI最佳实践 | 2025-11-13 09:00 |
| **QA (Quinn)** | 准备质量标准检查清单 | 2025-11-13 09:00 |

---

## 📚 Section 10: 附录 (Appendix)

### 10.1 参考文档

| 文档 | 路径 | 用途 |
|------|------|------|
| **PRD v1.1.3** | `docs/prd/CANVAS-LEARNING-SYSTEM-OBSIDIAN-NATIVE-MIGRATION-PRD.md` | 原始需求 |
| **PRD vs 架构冲突分析** | `docs/prd-architecture-conflict-analysis.md` | 冲突详情 |
| **PRD Gap Analysis** | `docs/prd-gap-analysis-ebbinghaus-system.md` | 缺失设计环节 |
| **Brownfield架构** | `docs/architecture/canvas-progress-tracking-brownfield-architecture.md` | 架构假设 |
| **Epic 8补充Epic** | `docs/stories/Epic 8.Canvas v2.0升级补充Epic.md` | 记忆系统架构 |
| **ebbinghaus_review.py** | `ebbinghaus_review.py` | 现有实现 |
| **Change Checklist** | `.bmad-core/checklists/change-checklist.md` | 分析框架 |

### 10.2 术语表

| 术语 | 定义 |
|------|------|
| **Py-FSRS** | Free Spaced Repetition Scheduler的Python实现，现代间隔重复算法 |
| **经典艾宾浩斯公式** | R(t) = e^(-t/S)，1885年艾宾浩斯提出的遗忘曲线公式 |
| **ADR** | Architecture Decision Record，架构决策记录 |
| **Spike Story** | Scrum中用于技术调研和设计的Story类型 |
| **ROI** | Return on Investment，投资回报率 |
| **TDD** | Technical Design Document，技术设计文档 (非Test-Driven Development) |

### 10.3 联系方式

| 角色 | 姓名 | Email | Slack |
|------|------|-------|-------|
| **PM** | John | john@canvas-learning.com | @john-pm |
| **Architect** | Morgan | morgan@canvas-learning.com | @morgan-arch |
| **Dev Lead** | James | james@canvas-learning.com | @james-dev |
| **QA Lead** | Quinn | quinn@canvas-learning.com | @quinn-qa |

---

## ✅ 提案总结

### 核心诉求

**暂停Epic 11/12/14实施1-2周，补充艾宾浩斯系统完整设计文档**

### 关键数据

- **投入**: $24,500 + 1-2周延迟
- **产出**: 节省$35,000+ + 避免2-4周返工
- **ROI**: 43%
- **风险**: 可控 (高风险项≤4个)
- **成功概率**: 95%

### 推荐决策

✅ **批准本提案**

### 下一步

- **审批截止**: 2025-11-12 17:00
- **Week 1启动**: 2025-11-13 09:00

---

**提案人签名**: PM Agent (John)
**日期**: 2025-11-11
**版本**: v1.0
**状态**: ⏳ 待审批
