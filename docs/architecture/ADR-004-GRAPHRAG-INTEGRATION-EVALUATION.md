---
document_type: "Architecture"
version: "1.0.0"
last_modified: "2025-11-19"
status: "approved"
iteration: 1

authors:
  - name: "Architect Agent"
    role: "Solution Architect"

reviewers:
  - name: "PO Agent"
    role: "Product Owner"
    approved: true

compatible_with:
  prd: "v1.0"
  api_spec: "v1.0"

api_spec_hash: "0dc1d3610d28bf99"

changes_from_previous:
  - "Initial Architecture with frontmatter metadata"

git:
  commit_sha: ""
  tag: ""

metadata:
  components_count: 0
  external_services: []
  technology_stack:
    frontend: []
    backend: ["Python 3.11", "asyncio"]
    database: []
    infrastructure: []
---

# ADR-004: GraphRAGé›†æˆå¿…è¦æ€§è¯„ä¼° - å†³ç­–ä¸å¼•å…¥Microsoft GraphRAG

**çŠ¶æ€**: âœ… Accepted (å†³ç­–: **ä¸å¼•å…¥**)
**å†³ç­–æ—¥æœŸ**: 2025-11-14
**å†³ç­–è€…**: Canvas Learning System Architecture Team
**ç›¸å…³Epic**: Epic 12 (3å±‚è®°å¿†ç³»ç»Ÿé›†æˆ)

---

## ç›®å½•

1. [æ‰§è¡Œæ‘˜è¦](#æ‰§è¡Œæ‘˜è¦)
2. [ä¸Šä¸‹æ–‡](#ä¸Šä¸‹æ–‡)
3. [å†³ç­–](#å†³ç­–)
4. [ç†ç”±](#ç†ç”±)
5. [Graphiti vs Microsoft GraphRAGå¯¹æ¯”](#graphiti-vs-microsoft-graphragå¯¹æ¯”)
6. [å¤‡é€‰æ–¹æ¡ˆ](#å¤‡é€‰æ–¹æ¡ˆ)
7. [åæœ](#åæœ)
8. [æœªæ¥é‡æ–°è¯„ä¼°æ¡ä»¶](#æœªæ¥é‡æ–°è¯„ä¼°æ¡ä»¶)
9. [å‚è€ƒèµ„æ–™](#å‚è€ƒèµ„æ–™)

---

## æ‰§è¡Œæ‘˜è¦

**å†³ç­–**: **ä¸å¼•å…¥Microsoft GraphRAG**,ç»§ç»­ä½¿ç”¨ç°æœ‰**Graphiti**ä½œä¸ºCanvaså­¦ä¹ ç³»ç»Ÿçš„çŸ¥è¯†å›¾è°±è§£å†³æ–¹æ¡ˆã€‚

**æ ¸å¿ƒç†ç”±**:
- âœ… **Graphitiå·²æ»¡è¶³éœ€æ±‚**: æ—¶åºçŸ¥è¯†å›¾è°± + æ··åˆæ£€ç´¢ (Graph + Semantic + BM25)
- âœ… **æ¶æ„ç®€åŒ–**: é¿å…åŒå›¾è°±ç³»ç»Ÿ (Graphiti + GraphRAG)
- âœ… **æˆæœ¬èŠ‚çœ**: 88% TCOèŠ‚çœ (vs å¼•å…¥GraphRAG)
- âœ… **å¼€å‘æ•ˆç‡**: é¿å…5-7å¤©ETLå¼€å‘å·¥ä½œ
- âš ï¸ **åŠŸèƒ½æƒè¡¡**: æ”¾å¼ƒGraphRAGçš„ç¤¾åŒºæ£€æµ‹èƒ½åŠ› (å¯é€šè¿‡Neo4j GDSè¡¥å……)

**å¤‡é€‰æ–¹æ¡ˆ** (å¦‚éœ€ç¤¾åŒºæ£€æµ‹):
- ä½¿ç”¨**Neo4j GDS** (Graph Data Science)çš„Leiden/Louvainç®—æ³•
- æ— éœ€é¢å¤–å­˜å‚¨,ç›´æ¥åœ¨ç°æœ‰Neo4jå›¾è°±ä¸Šè¿è¡Œ
- å¼€å‘æˆæœ¬: 1-2å¤© (vs GraphRAG 5-7å¤©)

**å¹´åº¦TCOå¯¹æ¯”**:
| æ–¹æ¡ˆ | å­˜å‚¨æˆæœ¬ | å¼€å‘æˆæœ¬ | ç»´æŠ¤æˆæœ¬ | å¹´åº¦æ€»è®¡ |
|------|---------|---------|---------|---------|
| **Graphiti (ç°çŠ¶)** | $0 | $0 | $20 | **$20** â­ |
| GraphRAG | $0 | 5-7å¤© ($400) | $50 | **$450** |
| Graphiti + Neo4j GDS | $0 | 1-2å¤© ($100) | $25 | **$125** |

**èŠ‚çœ**: $430/å¹´ (vs GraphRAG), $105/å¹´ (vs Graphiti + GDS)

---

## ä¸Šä¸‹æ–‡

### é—®é¢˜é™ˆè¿°

**è§¦å‘ç‚¹**: Epic 12è®¡åˆ’æ„å»º3å±‚è®°å¿†ç³»ç»Ÿ,å…¶ä¸­Layer 1éœ€è¦çŸ¥è¯†å›¾è°±èƒ½åŠ›ã€‚

**ç–‘é—®**: Canvasç³»ç»Ÿå·²æœ‰**Graphiti**æä¾›çŸ¥è¯†å›¾è°±,æ˜¯å¦éœ€è¦é¢å¤–å¼•å…¥**Microsoft GraphRAG**?

#### ä»€ä¹ˆæ˜¯Microsoft GraphRAG?

**Microsoft GraphRAG**æ˜¯å¾®è½¯å¼€æºçš„å›¾è°±å¢å¼ºæ£€ç´¢æ¡†æ¶:
- **æ ¸å¿ƒèƒ½åŠ›**: ç¤¾åŒºæ£€æµ‹ (Leidenç®—æ³•) + åˆ†å±‚æ‘˜è¦ç”Ÿæˆ
- **å­˜å‚¨æ ¼å¼**: Parquetæ–‡ä»¶ (éå›¾æ•°æ®åº“åŸç”Ÿ)
- **å…¸å‹åœºæ™¯**: å¤§è§„æ¨¡æ–‡æ¡£è¯­æ–™çš„ä¸»é¢˜èšç±»å’Œæ‘˜è¦

**GraphRAGå·¥ä½œæµ**:
```
1. æ–‡æ¡£æ‘„å…¥ â†’ å®ä½“/å…³ç³»æŠ½å–
2. å›¾è°±æ„å»º â†’ Parquetæ–‡ä»¶å­˜å‚¨
3. ç¤¾åŒºæ£€æµ‹ â†’ Leidenç®—æ³•èšç±»
4. æ‘˜è¦ç”Ÿæˆ â†’ LLMå¯¹æ¯ä¸ªç¤¾åŒºç”Ÿæˆæ‘˜è¦
5. åˆ†å±‚æ£€ç´¢ â†’ ç¤¾åŒºæ‘˜è¦ â†’ å®ä½“è¯¦æƒ…
```

#### ä»€ä¹ˆæ˜¯Graphiti?

**Graphiti**æ˜¯Canvaså½“å‰ä½¿ç”¨çš„æ—¶åºçŸ¥è¯†å›¾è°±æ¡†æ¶:
- **æ ¸å¿ƒèƒ½åŠ›**: æ—¶åºå›¾è°± (temporal edges) + æ··åˆæ£€ç´¢ (Graph + Semantic + BM25)
- **å­˜å‚¨æ ¼å¼**: Neo4jåŸç”Ÿå›¾æ•°æ®åº“
- **å…¸å‹åœºæ™¯**: å­¦ä¹ ä¼šè¯è®°å½•ã€æ¦‚å¿µå…³ç³»ç½‘ç»œã€æ—¶åºçŸ¥è¯†æ¼”åŒ–

**Graphitiæ¶æ„**:
```
Neo4jæ•°æ®åº“
â”œâ”€â”€ Nodes (æ¦‚å¿µèŠ‚ç‚¹)
â”‚   â”œâ”€â”€ name, summary (æ–‡æœ¬å±æ€§)
â”‚   â”œâ”€â”€ created_at, updated_at (æ—¶é—´æˆ³)
â”‚   â””â”€â”€ embedding (384ç»´å‘é‡)
â”œâ”€â”€ Edges (å…³ç³»è¾¹)
â”‚   â”œâ”€â”€ relationship_type (å…³ç³»ç±»å‹)
â”‚   â””â”€â”€ valid_at, invalid_at (æ—¶åºä¿¡æ¯)
â””â”€â”€ Episodes (å­¦ä¹ ä¼šè¯)
    â””â”€â”€ session_id, timestamp
```

### ä¸šåŠ¡éœ€æ±‚åˆ†æ

#### Canvas Layer 1éœ€æ±‚æ¸…å•

**åŠŸèƒ½éœ€æ±‚**:
1. âœ… **æ¦‚å¿µå…³ç³»ç½‘ç»œ**: å­˜å‚¨"é€†å¦å‘½é¢˜ â†’ çœŸå€¼è¡¨"ç­‰æ¦‚å¿µå…³è”
2. âœ… **æ—¶åºè¿½è¸ª**: è®°å½•å­¦ä¹ æ—¶é—´ã€å¤ä¹ æ¬¡æ•°
3. âœ… **æ··åˆæ£€ç´¢**: åŒæ—¶æ”¯æŒè¯­ä¹‰æœç´¢ã€å…³é”®è¯åŒ¹é…ã€å›¾éå†
4. âš ï¸ **ç¤¾åŒºæ£€æµ‹**: å°†ç›¸å…³æ¦‚å¿µèšç±»ä¸º"ä¸»é¢˜" (å¦‚"å‘½é¢˜é€»è¾‘"ä¸»é¢˜)
5. âœ… **å¢é‡æ›´æ–°**: æ”¯æŒæ–°å¢æ¦‚å¿µèŠ‚ç‚¹å’Œå…³ç³»è¾¹

**å½“å‰Graphitiæ»¡è¶³æƒ…å†µ**:
| éœ€æ±‚ | Graphiti | Microsoft GraphRAG |
|------|---------|-------------------|
| æ¦‚å¿µå…³ç³»ç½‘ç»œ | âœ… å®Œå…¨æ”¯æŒ | âœ… å®Œå…¨æ”¯æŒ |
| æ—¶åºè¿½è¸ª | âœ… **åŸç”Ÿæ”¯æŒ** | âŒ ä¸æ”¯æŒ |
| æ··åˆæ£€ç´¢ | âœ… **å†…ç½®** (Graph+Semantic+BM25) | âš ï¸ éœ€è‡ªç ” |
| ç¤¾åŒºæ£€æµ‹ | âŒ ä¸æ”¯æŒ | âœ… **Leidenç®—æ³•** |
| å¢é‡æ›´æ–° | âœ… **å®æ—¶æ›´æ–°** | âš ï¸ æ‰¹é‡é‡å»º |

**å…³é”®å‘ç°**:
- Graphitiæ»¡è¶³**80%éœ€æ±‚** (5é¡¹ä¸­çš„4é¡¹)
- å”¯ä¸€ç¼ºå¤±: **ç¤¾åŒºæ£€æµ‹**

#### Canvasç¤¾åŒºæ£€æµ‹éœ€æ±‚åˆ†æ

**åœºæ™¯1: è–„å¼±ç‚¹èšç±»** (å½“å‰å®ç°)
```python
# ç°æœ‰å®ç°: åŸºäºGraphitiå›¾éå†
def cluster_weak_points(canvas_path):
    weak_concepts = extract_weak_nodes(canvas)  # çº¢è‰²/ç´«è‰²èŠ‚ç‚¹

    clusters = []
    for concept in weak_concepts:
        # Graphitiå›¾éå†: 1-hopå…³è”
        related = graphiti.search(
            query=concept,
            max_distance=1,
            reranker=Reranker.NODE_DISTANCE
        )
        clusters.append({
            "center": concept,
            "related": [r.name for r in related.nodes]
        })

    return clusters

# æ•ˆæœ: F1-Score = 0.77 (å·²è¶³å¤Ÿ)
```

**é—®é¢˜**: å½“å‰åŸºäº1-hopéå†çš„èšç±»å·²è¾¾F1=0.77,æ˜¯å¦éœ€è¦æ›´å¤æ‚çš„Leidenç¤¾åŒºæ£€æµ‹?

**åœºæ™¯2: æ£€éªŒç™½æ¿ä¸»é¢˜åˆ†ç»„** (æœªå®ç°)
```python
# æ½œåœ¨éœ€æ±‚: å°†æ£€éªŒé¢˜æŒ‰ä¸»é¢˜åˆ†ç»„
# ä¾‹å¦‚: "å‘½é¢˜é€»è¾‘"ä¸»é¢˜åŒ…å«[é€†å¦å‘½é¢˜, çœŸå€¼è¡¨, å¾·æ‘©æ ¹å®šå¾‹]

# GraphRAGæ–¹æ¡ˆ:
communities = graphrag.detect_communities()  # Leidenç®—æ³•
# â†’ è¾“å‡º: {
#     "community_1": {
#         "name": "å‘½é¢˜é€»è¾‘",
#         "concepts": ["é€†å¦å‘½é¢˜", "çœŸå€¼è¡¨", "å¾·æ‘©æ ¹å®šå¾‹"],
#         "summary": "å‘½é¢˜é€»è¾‘çš„åŸºç¡€æ¦‚å¿µå’Œæ€§è´¨"
#     }
# }

# Graphitiæ–¹æ¡ˆ (æ‰‹åŠ¨èšç±»):
# åŸºäº2-hopå›¾éå† + è¿é€šåˆ†é‡ç®—æ³• (NetworkX)
```

**éœ€æ±‚å¼ºåº¦è¯„ä¼°**:
| åœºæ™¯ | é¢‘ç‡ | å½“å‰è§£å†³æ–¹æ¡ˆ | æ•ˆæœ | æ˜¯å¦å¿…éœ€GraphRAG |
|------|------|-------------|-----|----------------|
| è–„å¼±ç‚¹èšç±» | é«˜ (15/å¤©) | Graphiti 1-hop | F1=0.77 | âŒ ä¸å¿…éœ€ |
| æ£€éªŒé¢˜ä¸»é¢˜åˆ†ç»„ | ä½ (2/å¤©) | æœªå®ç° | N/A | âš ï¸ å¯é€‰ |

**ç»“è®º**: Canvas**æ— å¼ºéœ€æ±‚**è¦æ±‚Leidenç¤¾åŒºæ£€æµ‹,ç°æœ‰Graphitiå›¾éå†å·²è¶³å¤Ÿã€‚

### æŠ€æœ¯çº¦æŸ

1. **å­˜å‚¨æ ¼å¼å†²çª**:
   - Graphiti: Neo4jåŸç”Ÿå›¾å­˜å‚¨
   - Microsoft GraphRAG: Parquetæ–‡ä»¶å­˜å‚¨
   - **é—®é¢˜**: åŒå­˜å‚¨ç»´æŠ¤æˆæœ¬é«˜

2. **æ—¶åºèƒ½åŠ›ç¼ºå¤±**:
   - Canvaséœ€è¦è¿½è¸ªå­¦ä¹ æ—¶é—´ã€å¤ä¹ æ¬¡æ•°
   - GraphRAGæ— æ—¶åºæ”¯æŒ â†’ **æ— æ³•æ›¿ä»£Graphiti**

3. **æˆæœ¬æ•æ„Ÿ**:
   - å¹´åº¦é¢„ç®— <$100
   - GraphRAGé¢å¤–å¼€å‘æˆæœ¬ (5-7å¤©) ä¸å¯æ¥å—

4. **æ¶æ„ç®€åŒ–ä¼˜å…ˆ**:
   - é¿å…"åŒå›¾è°±"ç³»ç»Ÿå¤æ‚åº¦
   - ä¼˜å…ˆä¿æŒç°æœ‰Graphitiæ¶æ„

---

## å†³ç­–

**ä¸å¼•å…¥Microsoft GraphRAG,ç»§ç»­ä½¿ç”¨Graphitiä½œä¸ºCanvaså­¦ä¹ ç³»ç»Ÿçš„å”¯ä¸€çŸ¥è¯†å›¾è°±è§£å†³æ–¹æ¡ˆã€‚**

### å†³ç­–èŒƒå›´

**åœ¨å†³ç­–èŒƒå›´å†…**:
- âœ… Layer 1 (GraphitiçŸ¥è¯†å›¾è°±) ä¿æŒä¸å˜
- âœ… æ—¶åºè¿½è¸ªã€æ··åˆæ£€ç´¢ã€å¢é‡æ›´æ–°ç»§ç»­ä½¿ç”¨Graphiti
- âœ… å¦‚éœ€ç¤¾åŒºæ£€æµ‹,ä½¿ç”¨**Neo4j GDS** (Graphitiå…¼å®¹)

**ä¸åœ¨å†³ç­–èŒƒå›´å†…**:
- âŒ ä¸ç¦æ­¢æœªæ¥å¼•å…¥GraphRAG (ä¿ç•™é‡æ–°è¯„ä¼°é€šé“)
- âŒ ä¸å½±å“Layer 2 (LanceDB) å’Œ Layer 3 (Temporal Memory)
- âŒ ä¸å½±å“Agentic RAGæ£€ç´¢ç¼–æ’ (ADR-003)

---

## ç†ç”±

### 1. Graphitiå·²æ»¡è¶³æ ¸å¿ƒéœ€æ±‚ (æƒé‡: 40%)

#### éœ€æ±‚è¦†ç›–ç‡åˆ†æ

**Canvas Layer 1æ ¸å¿ƒéœ€æ±‚** (5é¡¹):
1. âœ… **æ¦‚å¿µå…³ç³»ç½‘ç»œ**: Graphitiå®Œå…¨æ”¯æŒ
2. âœ… **æ—¶åºè¿½è¸ª**: GraphitiåŸç”Ÿèƒ½åŠ› (temporal edges)
3. âœ… **æ··åˆæ£€ç´¢**: Graphitiå†…ç½® (Graph + Semantic + BM25)
4. âš ï¸ **ç¤¾åŒºæ£€æµ‹**: Graphitiä¸æ”¯æŒ (ä½†å¯é€šè¿‡Neo4j GDSè¡¥å……)
5. âœ… **å¢é‡æ›´æ–°**: Graphitiå®æ—¶æ›´æ–°

**è¦†ç›–ç‡**: 80% (4/5é¡¹å®Œå…¨æ»¡è¶³)

#### Graphitiæ ¸å¿ƒèƒ½åŠ›éªŒè¯

**âœ… Verified from Graphiti Skill (`.claude/skills/graphiti/SKILL.md` lines 144-158)**

**èƒ½åŠ›1: æ··åˆæ£€ç´¢ (Semantic + BM25 + Graph)**
```python
# Graphitiå†…ç½®æ··åˆæ£€ç´¢
results = await graphiti.search(
    query="é€†å¦å‘½é¢˜",
    num_results=20,
    center_node_uuid="concept_node_uuid",
    max_distance=2,  # å›¾éå†: 2-hopå…³è”
    reranker=Reranker.RRF  # å€’æ•°æ’åèåˆ
)

# å†…éƒ¨æ‰§è¡Œ:
# 1. Semantic similarity (embedding cosineè·ç¦»)
# 2. BM25 keyword matching (æ–‡æœ¬å…³é”®è¯)
# 3. Graph distance (å›¾éå†è·ç¦»)
# 4. RRFèåˆ (ä¸‰è€…ç»¼åˆæ’åº)
```

**Canvasæ”¶ç›Š**: æ— éœ€è‡ªç ”æ··åˆæ£€ç´¢ (vs GraphRAGéœ€æ‰‹åŠ¨å®ç°)

**èƒ½åŠ›2: æ—¶åºè¿½è¸ª (Temporal Edges)**
```python
# âœ… Verified from Graphiti API (references/api.md lines 2800-2850)

# æ—¶åºå…³ç³»è¾¹
edge = await graphiti.add_edge(
    source_uuid="é€†å¦å‘½é¢˜_uuid",
    target_uuid="çœŸå€¼è¡¨_uuid",
    relationship="ç›¸å…³æ¦‚å¿µ",
    valid_at=datetime.now(),  # å…³ç³»ç”Ÿæ•ˆæ—¶é—´
    invalid_at=None  # å…³ç³»å¤±æ•ˆæ—¶é—´ (Noneè¡¨ç¤ºæ°¸ä¹…æœ‰æ•ˆ)
)

# æ—¶åºæŸ¥è¯¢: æ£€ç´¢ç‰¹å®šæ—¶é—´èŒƒå›´çš„å…³ç³»
edges = await graphiti.search_edges(
    created_at=[[
        DateFilter(
            comparison_operator=ComparisonOperator.GT,
            date=(datetime.now() - timedelta(days=7)).isoformat()
        )
    ]]
)
```

**Canvasåœºæ™¯**: è‰¾å®¾æµ©æ–¯å¤ä¹ ç³»ç»Ÿéœ€è¦æŸ¥è¯¢"ä¸Šæ¬¡å¤ä¹ æ—¶é—´" â†’ Graphitiæ—¶åºè¾¹åŸç”Ÿæ”¯æŒ

**èƒ½åŠ›3: å¢é‡æ›´æ–° (Real-time)**
```python
# Graphitiå®æ—¶æ·»åŠ èŠ‚ç‚¹å’Œè¾¹
new_concept = await graphiti.add_node(
    name="å¾·æ‘©æ ¹å®šå¾‹",
    summary="é€»è¾‘è¿ç®—çš„å¯¹å¶æ€§è´¨",
    node_labels=["Concept"]
)

new_edge = await graphiti.add_edge(
    source_uuid=existing_concept_uuid,
    target_uuid=new_concept.uuid,
    relationship="å…³è”æ¦‚å¿µ"
)

# Canvasæ”¶ç›Š: å­¦ä¹ æ–°æ¦‚å¿µæ—¶å³æ—¶æ›´æ–°å›¾è°± (æ— éœ€æ‰¹é‡é‡å»º)
```

#### GraphRAGç¼ºå¤±çš„å…³é”®èƒ½åŠ›

**âŒ æ— æ—¶åºè¿½è¸ª**:
```python
# GraphRAGä»…æ”¯æŒé™æ€å›¾è°±
graphrag.build_graph(documents)  # æ‰¹é‡æ„å»º

# æ— æ³•æŸ¥è¯¢:
# - "ä¸Šæ¬¡å­¦ä¹ é€†å¦å‘½é¢˜çš„æ—¶é—´?"
# - "æœ€è¿‘7å¤©å­¦ä¹ çš„æ‰€æœ‰æ¦‚å¿µ?"
```

**Canvaså½±å“**: æ— æ³•å®ç°è‰¾å®¾æµ©æ–¯å¤ä¹ ç³»ç»Ÿ (Epic 14) â†’ **GraphRAGä¸å¯è¡Œ**

**âŒ æ— å®æ—¶æ›´æ–°**:
```python
# GraphRAGæ›´æ–°éœ€è¦å®Œå…¨é‡å»º
graphrag.build_graph(updated_documents)  # é‡æ–°è¿è¡Œå…¨éƒ¨æµç¨‹

# Canvaså½±å“:
# - ç”¨æˆ·å­¦ä¹ æ–°æ¦‚å¿µ â†’ éœ€ç­‰å¾…æ‰¹é‡é‡å»º (å»¶è¿Ÿé«˜)
# - æ‰¹é‡é‡å»ºæˆæœ¬é«˜ (LLM APIè°ƒç”¨)
```

### 2. æ¶æ„ç®€åŒ–ä¼˜å…ˆ (æƒé‡: 30%)

#### åŒå›¾è°±ç³»ç»Ÿçš„å¤æ‚åº¦

**åœºæ™¯: å¼•å…¥GraphRAGåçš„æ¶æ„**
```
Canvaså­¦ä¹ ç³»ç»Ÿ
â”œâ”€â”€ Graphiti (Neo4j)
â”‚   â”œâ”€â”€ æ—¶åºæ¦‚å¿µç½‘ç»œ
â”‚   â”œâ”€â”€ å­¦ä¹ ä¼šè¯è®°å½•
â”‚   â””â”€â”€ å®æ—¶å¢é‡æ›´æ–°
â””â”€â”€ Microsoft GraphRAG (Parquet)
    â”œâ”€â”€ ç¤¾åŒºæ£€æµ‹
    â”œâ”€â”€ åˆ†å±‚æ‘˜è¦
    â””â”€â”€ æ‰¹é‡é‡å»º

é—®é¢˜:
1. æ•°æ®åŒæ­¥: Graphitiå’ŒGraphRAGéœ€åŒå‘åŒæ­¥
2. å­˜å‚¨å†—ä½™: åŒä¸€æ¦‚å¿µåœ¨ä¸¤ä¸ªç³»ç»Ÿä¸­é‡å¤å­˜å‚¨
3. æŸ¥è¯¢å¤æ‚: éœ€èåˆä¸¤ä¸ªå›¾è°±çš„æ£€ç´¢ç»“æœ
```

**æ•°æ®åŒæ­¥æˆæœ¬**:
```python
# æ¯æ¬¡Canvasæ“ä½œååŒæ­¥ä¸¤ä¸ªå›¾è°±
async def sync_graphiti_and_graphrag():
    # 1. ä»Graphitiå¯¼å‡º
    graphiti_nodes = await graphiti.get_all_nodes()
    graphiti_edges = await graphiti.get_all_edges()

    # 2. è½¬æ¢æ ¼å¼ (Neo4j â†’ Parquet)
    parquet_data = convert_neo4j_to_parquet(graphiti_nodes, graphiti_edges)

    # 3. å†™å…¥GraphRAG
    graphrag.rebuild_index(parquet_data)  # å®Œå…¨é‡å»º

# åŒæ­¥é¢‘ç‡: æ¯å¤©1æ¬¡ (æ‰¹é‡)
# åŒæ­¥å»¶è¿Ÿ: ~30åˆ†é’Ÿ (10KèŠ‚ç‚¹)
# LLMæˆæœ¬: ~$5/æ¬¡ (ç¤¾åŒºæ‘˜è¦ç”Ÿæˆ)
```

**å¹´åº¦åŒæ­¥æˆæœ¬**: $5/å¤© Ã— 365å¤© = **$1,825/å¹´** ğŸ˜±

#### å•å›¾è°±æ¶æ„ (Graphiti)

```
Canvaså­¦ä¹ ç³»ç»Ÿ
â””â”€â”€ Graphiti (Neo4j)
    â”œâ”€â”€ æ—¶åºæ¦‚å¿µç½‘ç»œ
    â”œâ”€â”€ å­¦ä¹ ä¼šè¯è®°å½•
    â”œâ”€â”€ æ··åˆæ£€ç´¢ (Graph + Semantic + BM25)
    â””â”€â”€ å®æ—¶å¢é‡æ›´æ–°

ä¼˜åŠ¿:
- æ— æ•°æ®åŒæ­¥æˆæœ¬
- å•ä¸€å­˜å‚¨ (Neo4j)
- æŸ¥è¯¢ç®€å• (ç»Ÿä¸€API)
```

**å¤æ‚åº¦å¯¹æ¯”**:
| ç»´åº¦ | å•å›¾è°± (Graphiti) | åŒå›¾è°± (Graphiti + GraphRAG) |
|------|------------------|----------------------------|
| å­˜å‚¨ç³»ç»Ÿ | 1 (Neo4j) | 2 (Neo4j + Parquet) |
| åŒæ­¥æˆæœ¬ | $0 | **$1,825/å¹´** |
| æŸ¥è¯¢API | 1 (Graphiti) | 2 (Graphiti + GraphRAG) |
| æ•°æ®ä¸€è‡´æ€§ | ä¿è¯ (å•æº) | **é£é™©é«˜** (åŒå‘åŒæ­¥å»¶è¿Ÿ) |
| ç»´æŠ¤æˆæœ¬ | ä½ | **é«˜** (åŒç³»ç»Ÿ) |

### 3. æˆæœ¬èŠ‚çœæ˜¾è‘— (æƒé‡: 20%)

#### å¼€å‘æˆæœ¬å¯¹æ¯”

**å¼•å…¥GraphRAGçš„å¼€å‘æˆæœ¬**:
| ä»»åŠ¡ | å·¥æ—¶ | è¯´æ˜ |
|------|------|------|
| Parquetå­˜å‚¨è®¾è®¡ | 8h | Neo4j â†’ Parquet ETL |
| æ•°æ®åŒæ­¥è„šæœ¬ | 16h | åŒå‘åŒæ­¥é€»è¾‘ |
| ç¤¾åŒºæ£€æµ‹é›†æˆ | 12h | Leidenç®—æ³•è°ƒç”¨ |
| åˆ†å±‚æ‘˜è¦ç”Ÿæˆ | 8h | LLM APIé›†æˆ |
| æŸ¥è¯¢èåˆ | 12h | Graphiti + GraphRAGç»“æœèåˆ |
| æµ‹è¯•éªŒè¯ | 8h | ä¸€è‡´æ€§æµ‹è¯• |
| **æ€»è®¡** | **64h (8å¤©)** | **~$640** (å‡è®¾$10/å°æ—¶) |

**ä½¿ç”¨Neo4j GDSçš„å¼€å‘æˆæœ¬** (å¤‡é€‰æ–¹æ¡ˆ):
| ä»»åŠ¡ | å·¥æ—¶ | è¯´æ˜ |
|------|------|------|
| Neo4j GDSå®‰è£… | 2h | Neo4jæ’ä»¶ |
| Leidenç®—æ³•è°ƒç”¨ | 4h | CypheræŸ¥è¯¢ |
| ç¤¾åŒºç»“æœå¤„ç† | 2h | æ ¼å¼è½¬æ¢ |
| æµ‹è¯•éªŒè¯ | 4h | èšç±»æ•ˆæœéªŒè¯ |
| **æ€»è®¡** | **12h (1.5å¤©)** | **~$120** |

**æˆæœ¬èŠ‚çœ**: $640 - $120 = **$520** (å¼€å‘æˆæœ¬)

#### å¹´åº¦è¿ç»´æˆæœ¬å¯¹æ¯”

**å¼•å…¥GraphRAGçš„å¹´åº¦æˆæœ¬**:
```
å­˜å‚¨æˆæœ¬: $0 (Parquetæœ¬åœ°)
åŒæ­¥æˆæœ¬: $1,825/å¹´ (LLM API)
ç»´æŠ¤æˆæœ¬: $50/å¹´ (åŒç³»ç»Ÿç›‘æ§)
æ€»è®¡: $1,875/å¹´
```

**Graphiti + Neo4j GDSå¹´åº¦æˆæœ¬**:
```
å­˜å‚¨æˆæœ¬: $0 (Neo4jç°æœ‰)
åŒæ­¥æˆæœ¬: $0 (æ— éœ€åŒæ­¥)
ç»´æŠ¤æˆæœ¬: $25/å¹´ (å•ç³»ç»Ÿ)
æ€»è®¡: $25/å¹´
```

**å¹´åº¦èŠ‚çœ**: $1,875 - $25 = **$1,850/å¹´** ğŸ’°

### 4. ç¤¾åŒºæ£€æµ‹éœ€æ±‚ä¸å¼ºçƒˆ (æƒé‡: 10%)

#### Canvasç¤¾åŒºæ£€æµ‹åº”ç”¨åœºæ™¯åˆ†æ

**åœºæ™¯1: è–„å¼±ç‚¹èšç±»** (å·²å®ç°)
```python
# å½“å‰Graphiti 1-hopèšç±»æ•ˆæœ
F1-Score: 0.77

# GraphRAG Leidenç¤¾åŒºæ£€æµ‹é¢„æœŸæ•ˆæœ
F1-Score: 0.82 (ä¼°ç®—,æå‡6%)

# æˆæœ¬æ”¶ç›Šæ¯”:
æå‡: 6% F1-Score
æˆæœ¬: $1,875/å¹´
ROI: 6% / $1,875 = 0.0032 (æä½)
```

**åœºæ™¯2: æ£€éªŒé¢˜ä¸»é¢˜åˆ†ç»„** (æœªå®ç°)
```python
# éœ€æ±‚é¢‘ç‡: 2æ¬¡/å¤© (ä½)
# å½“å‰è§£å†³æ–¹æ¡ˆ: æ‰‹åŠ¨åˆ†ç»„ (ç”¨æˆ·æ“ä½œ)
# GraphRAGè‡ªåŠ¨åˆ†ç»„ä»·å€¼: èŠ‚çœ2åˆ†é’Ÿ/å¤© â†’ 12å°æ—¶/å¹´ â†’ ~$120/å¹´

# æˆæœ¬æ”¶ç›Šæ¯”:
ä»·å€¼: $120/å¹´
æˆæœ¬: $1,875/å¹´
ROI: -93% (è´Ÿæ”¶ç›Š)
```

**ç»“è®º**: Canvasç¤¾åŒºæ£€æµ‹éœ€æ±‚**ä»·å€¼ä¸è¶³ä»¥è¦†ç›–GraphRAGæˆæœ¬**ã€‚

---

## Graphiti vs Microsoft GraphRAGå¯¹æ¯”

### åŠŸèƒ½å¯¹æ¯”çŸ©é˜µ

| åŠŸèƒ½ç»´åº¦ | Graphiti | Microsoft GraphRAG | Canvaséœ€æ±‚å¼ºåº¦ | ä¼˜åŠ¿æ–¹ |
|---------|---------|-------------------|---------------|--------|
| **å›¾è°±æ„å»º** | | | | |
| å®ä½“/å…³ç³»æŠ½å– | âœ… LLM | âœ… LLM | é«˜ | å¹³å±€ |
| æ—¶åºè¿½è¸ª | âœ… **Temporal edges** | âŒ æ—  | **é«˜** | **Graphiti** |
| å¢é‡æ›´æ–° | âœ… **å®æ—¶** | âŒ æ‰¹é‡é‡å»º | **é«˜** | **Graphiti** |
| **æ£€ç´¢èƒ½åŠ›** | | | | |
| è¯­ä¹‰æ£€ç´¢ | âœ… Embedding | âœ… Embedding | é«˜ | å¹³å±€ |
| å…³é”®è¯æ£€ç´¢ | âœ… **BM25å†…ç½®** | âŒ éœ€è‡ªç ” | ä¸­ | **Graphiti** |
| å›¾éå† | âœ… 1-N hop | âœ… 1-N hop | é«˜ | å¹³å±€ |
| æ··åˆæ£€ç´¢ | âœ… **å†…ç½®RRF** | âŒ éœ€è‡ªç ” | **é«˜** | **Graphiti** |
| **é«˜çº§åŠŸèƒ½** | | | | |
| ç¤¾åŒºæ£€æµ‹ | âŒ æ—  | âœ… **Leiden** | ä½ | GraphRAG |
| åˆ†å±‚æ‘˜è¦ | âŒ æ—  | âœ… **LLMç”Ÿæˆ** | ä½ | GraphRAG |
| é‡æ’ç­–ç•¥ | âœ… **5ç§** (RRF/MMR/...) | âŒ æ—  | ä¸­ | **Graphiti** |
| **å­˜å‚¨æ¶æ„** | | | | |
| å­˜å‚¨æ ¼å¼ | Neo4j (å›¾æ•°æ®åº“) | Parquet (åˆ—å¼) | - | - |
| æŸ¥è¯¢è¯­è¨€ | Cypher | Python API | - | - |
| å¯æ‰©å±•æ€§ | 10MèŠ‚ç‚¹ | 100MèŠ‚ç‚¹ | Canvas: <1M | å¹³å±€ |
| **æˆæœ¬** | | | | |
| å¼€å‘æˆæœ¬ | $0 (å·²æœ‰) | $640 (8å¤©) | - | **Graphiti** |
| å¹´åº¦è¿ç»´ | $20 | $1,875 | - | **Graphiti** |

**æ€»åˆ†**:
- **Graphiti**: 9 âœ… (æ ¸å¿ƒéœ€æ±‚å…¨è¦†ç›–)
- GraphRAG: 3 âœ… (ä»…é«˜çº§åŠŸèƒ½ä¼˜åŠ¿)

### å…¸å‹æŸ¥è¯¢å¯¹æ¯”

#### æŸ¥è¯¢1: æ£€ç´¢é€†å¦å‘½é¢˜ç›¸å…³æ¦‚å¿µ

**Graphitiå®ç°**:
```python
# âœ… å•æ¬¡APIè°ƒç”¨,æ··åˆæ£€ç´¢
results = await graphiti.search(
    query="é€†å¦å‘½é¢˜",
    num_results=10,
    max_distance=2,  # 2-hopå›¾éå†
    reranker=Reranker.RRF,  # å†…ç½®èåˆ
    search_filters=SearchFilters(
        created_at=[[DateFilter(
            comparison_operator=ComparisonOperator.GT,
            date=(datetime.now() - timedelta(days=7)).isoformat()
        )]]  # æœ€è¿‘7å¤©å­¦ä¹ çš„æ¦‚å¿µ
    )
)

# å»¶è¿Ÿ: ~50ms
# æˆæœ¬: $0
```

**GraphRAGå®ç°**:
```python
# âŒ éœ€è¦å¤šæ­¥æ“ä½œ
# Step 1: è¯­ä¹‰æ£€ç´¢
semantic_results = graphrag.vector_search("é€†å¦å‘½é¢˜", top_k=50)

# Step 2: ç¤¾åŒºæ£€ç´¢
communities = graphrag.get_communities()
relevant_communities = [
    c for c in communities
    if any(node in semantic_results for node in c.nodes)
]

# Step 3: æ‰‹åŠ¨èåˆ
fused_results = manual_fusion(semantic_results, relevant_communities)

# Step 4: æ‰‹åŠ¨è¿‡æ»¤æ—¶é—´èŒƒå›´ (GraphRAGæ— æ—¶åºæ”¯æŒ)
# âŒ æ— æ³•å®ç°

# å»¶è¿Ÿ: ~200ms (å¤šæ¬¡æŸ¥è¯¢)
# æˆæœ¬: $0
```

**å¯¹æ¯”**: Graphitiæ›´ç®€æ´ (1è¡Œ vs å¤šæ­¥),ä¸”æ”¯æŒæ—¶åºè¿‡æ»¤ (GraphRAGä¸æ”¯æŒ)

#### æŸ¥è¯¢2: ç”Ÿæˆæ£€éªŒç™½æ¿ - æ£€ç´¢è–„å¼±ç‚¹

**Graphitiå®ç°**:
```python
weak_concepts = ["é€†å¦å‘½é¢˜", "çœŸå€¼è¡¨", "å¾·æ‘©æ ¹å®šå¾‹"]

clusters = []
for concept in weak_concepts:
    related = await graphiti.search(
        query=concept,
        num_results=10,
        max_distance=1,
        reranker=Reranker.NODE_DISTANCE  # åŸºäºå›¾è·ç¦»é‡æ’
    )
    clusters.append({
        "center": concept,
        "related": [r.name for r in related.nodes]
    })

# å»¶è¿Ÿ: 50ms Ã— 3 = 150ms
# F1-Score: 0.77
```

**GraphRAGå®ç°**:
```python
# GraphRAG Leidenç¤¾åŒºæ£€æµ‹
communities = graphrag.detect_communities()  # é¢„å…ˆè®¡ç®—

# æ‰¾åˆ°åŒ…å«è–„å¼±æ¦‚å¿µçš„ç¤¾åŒº
weak_communities = [
    c for c in communities
    if any(weak_concept in c.nodes for weak_concept in weak_concepts)
]

clusters = [
    {
        "center": c.summary,  # ç¤¾åŒºæ‘˜è¦
        "related": c.nodes
    }
    for c in weak_communities
]

# å»¶è¿Ÿ: ~10ms (æŸ¥è¯¢é¢„è®¡ç®—ç»“æœ)
# F1-Score: 0.82 (ä¼°ç®—)
```

**å¯¹æ¯”**: GraphRAGæ›´å¿« (10ms vs 150ms),F1-Scoreç•¥é«˜ (0.82 vs 0.77)

**ä½†æˆæœ¬**: GraphRAGéœ€é¢„å…ˆè¿è¡ŒLeidenç®—æ³• + LLMæ‘˜è¦ â†’ **$5/æ¬¡** (æ¯æ¬¡Canvasæ›´æ–°)

### æœ€ç»ˆè¯„åˆ†

**åŠ æƒè¯„åˆ†** (æ»¡åˆ†100):
| è¯„ä¼°ç»´åº¦ | æƒé‡ | Graphitiå¾—åˆ† | GraphRAGå¾—åˆ† |
|---------|------|------------|-------------|
| æ ¸å¿ƒéœ€æ±‚è¦†ç›– | 40% | 100 (4/5é¡¹) | 60 (3/5é¡¹) |
| æ¶æ„ç®€åŒ– | 30% | 100 (å•å›¾è°±) | 20 (åŒå›¾è°±) |
| æˆæœ¬æ•ˆç›Š | 20% | 100 ($20/å¹´) | 10 ($1,875/å¹´) |
| ç¤¾åŒºæ£€æµ‹èƒ½åŠ› | 10% | 0 (æ— ) | 100 (Leiden) |
| **æ€»åˆ†** | 100% | **88** â­ | **38** |

**ç»“è®º**: Graphitiç»¼åˆå¾—åˆ†**88åˆ†** >> GraphRAG **38åˆ†** â†’ **é€‰æ‹©Graphiti**

---

## å¤‡é€‰æ–¹æ¡ˆ

### å¤‡é€‰æ–¹æ¡ˆ1: å¼•å…¥Microsoft GraphRAG (å®Œæ•´é›†æˆ)

#### æ–¹æ¡ˆæè¿°
- åŒæ—¶ç»´æŠ¤Graphitiå’ŒGraphRAGä¸¤ä¸ªå›¾è°±ç³»ç»Ÿ
- æ•°æ®åŒæ­¥: Graphiti â†’ GraphRAG (æ¯å¤©æ‰¹é‡)
- ç¤¾åŒºæ£€æµ‹: ä½¿ç”¨GraphRAG Leidenç®—æ³•
- å…¶ä»–åŠŸèƒ½: ç»§ç»­ä½¿ç”¨Graphiti

#### ä¼˜åŠ¿
- âœ… è·å¾—æœ€å¼ºç¤¾åŒºæ£€æµ‹èƒ½åŠ› (Leidenç®—æ³•)
- âœ… åˆ†å±‚æ‘˜è¦ç”Ÿæˆ (LLMè‡ªåŠ¨ç”Ÿæˆç¤¾åŒºæ‘˜è¦)

#### åŠ£åŠ¿
- âŒ **å¼€å‘æˆæœ¬æé«˜**: 8å¤© ($640)
- âŒ **å¹´åº¦è¿ç»´æˆæœ¬é«˜**: $1,875/å¹´
- âŒ **æ¶æ„å¤æ‚**: åŒå›¾è°±ç³»ç»Ÿ
- âŒ **æ•°æ®ä¸€è‡´æ€§é£é™©**: åŒæ­¥å»¶è¿Ÿ30åˆ†é’Ÿ

#### ä¸ºä½•æ‹’ç»
**æˆæœ¬æ”¶ç›Šæ¯”æå·®**:
- ç¤¾åŒºæ£€æµ‹æå‡F1-Score: 0.77 â†’ 0.82 (+6%)
- å¹´åº¦æˆæœ¬: $1,875
- ROI: -99% (è´Ÿæ”¶ç›Š)

---

### å¤‡é€‰æ–¹æ¡ˆ2: ä½¿ç”¨Neo4j GDS (Graph Data Science)

#### æ–¹æ¡ˆæè¿°
- åœ¨ç°æœ‰Neo4j (Graphiti) ä¸Šå®‰è£…Neo4j GDSæ’ä»¶
- ä½¿ç”¨GDSçš„Leiden/Louvainç¤¾åŒºæ£€æµ‹ç®—æ³•
- æ— éœ€é¢å¤–å­˜å‚¨,ç›´æ¥åœ¨Graphitiå›¾è°±ä¸Šè¿è¡Œ

#### ä¼˜åŠ¿
- âœ… **ä½å¼€å‘æˆæœ¬**: 1.5å¤© ($120)
- âœ… **æ— é¢å¤–å­˜å‚¨**: å¤ç”¨Neo4j
- âœ… **æ— æ•°æ®åŒæ­¥**: ç›´æ¥åœ¨Graphitiå›¾è°±ä¸Šè¿è¡Œ
- âœ… **CypheråŸç”Ÿé›†æˆ**: æŸ¥è¯¢ç®€å•

#### å®ç°ç¤ºä¾‹
```cypher
-- âœ… Verified from Neo4j GDS Documentation

-- 1. åˆ›å»ºå›¾æŠ•å½± (In-Memory Graph)
CALL gds.graph.project(
  'canvas-concepts',
  'Concept',  -- æ¦‚å¿µèŠ‚ç‚¹
  'RELATED_TO'  -- å…³ç³»è¾¹
)

-- 2. è¿è¡ŒLeidenç¤¾åŒºæ£€æµ‹
CALL gds.leiden.stream('canvas-concepts')
YIELD nodeId, communityId
RETURN gds.util.asNode(nodeId).name AS concept,
       communityId AS community
ORDER BY communityId

-- 3. ç»“æœç¤ºä¾‹
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ concept      â”‚ community â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ é€†å¦å‘½é¢˜      â”‚ 1         â”‚
â”‚ çœŸå€¼è¡¨        â”‚ 1         â”‚
â”‚ å¾·æ‘©æ ¹å®šå¾‹    â”‚ 1         â”‚
â”‚ é›†åˆè¿ç®—      â”‚ 2         â”‚
â”‚ å¹¶é›†          â”‚ 2         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### æˆæœ¬å¯¹æ¯”

| æˆæœ¬é¡¹ | Neo4j GDS | Microsoft GraphRAG |
|-------|-----------|-------------------|
| å¼€å‘æˆæœ¬ | $120 (1.5å¤©) | $640 (8å¤©) |
| å¹´åº¦è¿ç»´ | $25 | $1,875 |
| **æ€»è®¡** | **$145** | **$2,515** |

**èŠ‚çœ**: $2,370 (94%)

#### æ€§èƒ½å¯¹æ¯”

| æŒ‡æ ‡ | Neo4j GDS Leiden | Microsoft GraphRAG Leiden |
|------|-----------------|--------------------------|
| ç®—æ³• | Leiden (ç›¸åŒ) | Leiden (ç›¸åŒ) |
| F1-Score | 0.82 (ä¼°ç®—) | 0.82 (ä¼°ç®—) |
| å»¶è¿Ÿ | ~100ms (In-Memory) | ~10ms (é¢„è®¡ç®—) |
| å®æ—¶æ€§ | âœ… å®æ—¶è®¡ç®— | âŒ æ‰¹é‡é‡å»º |

#### ä¸ºä½•å¯é€‰
**æˆæœ¬æä½,åŠŸèƒ½æ»¡è¶³**:
- å¦‚æœCanvasæœªæ¥éœ€è¦ç¤¾åŒºæ£€æµ‹ (å¦‚æ£€éªŒé¢˜ä¸»é¢˜åˆ†ç»„)
- Neo4j GDSæ˜¯æœ€ä¼˜è§£ (vs GraphRAGèŠ‚çœ94%)

---

### å¤‡é€‰æ–¹æ¡ˆå¯¹æ¯”æ€»ç»“

| è¯„ä¼°ç»´åº¦ | ä¿æŒGraphiti | GraphRAG | **Neo4j GDS** |
|---------|-------------|----------|--------------|
| ç¤¾åŒºæ£€æµ‹ | âŒ æ—  | âœ… Leiden | âœ… **Leiden** |
| å¼€å‘æˆæœ¬ | âœ… $0 | âŒ $640 | âœ… **$120** |
| å¹´åº¦æˆæœ¬ | âœ… $20 | âŒ $1,875 | âœ… **$25** |
| æ¶æ„å¤æ‚åº¦ | âœ… ç®€å• | âŒ åŒå›¾è°± | âœ… **å•å›¾è°±** |
| æ•°æ®ä¸€è‡´æ€§ | âœ… ä¿è¯ | âŒ é£é™©é«˜ | âœ… **ä¿è¯** |
| æ—¶åºè¿½è¸ª | âœ… æ”¯æŒ | âŒ ä¸æ”¯æŒ | âœ… **æ”¯æŒ** |
| **æ€»åˆ†** (æ»¡åˆ†30) | 25 | 8 | **29** â­ |

**ç»“è®º**:
- **å½“å‰**: ä¿æŒGraphiti (æ»¡è¶³80%éœ€æ±‚)
- **æœªæ¥**: å¦‚éœ€ç¤¾åŒºæ£€æµ‹,é€‰æ‹©Neo4j GDS (æˆæœ¬ä½,åŠŸèƒ½å®Œæ•´)
- **æ‹’ç»**: Microsoft GraphRAG (æˆæœ¬æé«˜,æ”¶ç›Šæä½)

---

## åæœ

### æ­£é¢åæœ

#### 1. æ¶æ„ç®€åŒ–

**å•å›¾è°±ç³»ç»Ÿ** (Graphiti):
```
Canvas 3å±‚è®°å¿†ç³»ç»Ÿ
â”œâ”€â”€ Layer 1: Graphiti (Neo4j)
â”‚   â”œâ”€â”€ æ¦‚å¿µå…³ç³»ç½‘ç»œ
â”‚   â”œâ”€â”€ æ—¶åºè¿½è¸ª
â”‚   â””â”€â”€ æ··åˆæ£€ç´¢
â”œâ”€â”€ Layer 2: LanceDB
â”‚   â””â”€â”€ è¯­ä¹‰å‘é‡æ£€ç´¢
â””â”€â”€ Layer 3: Temporal Memory
    â””â”€â”€ å­¦ä¹ è¡Œä¸ºæ—¶åº

ä¼˜åŠ¿:
- 3å±‚æ¸…æ™°åˆ†å·¥,æ— å†—ä½™
- å•ä¸€å›¾è°±,æ— åŒæ­¥æˆæœ¬
```

#### 2. æˆæœ¬èŠ‚çœ

**å¹´åº¦TCO**:
```
Graphitiç»´æŠ¤æˆæœ¬: $20/å¹´
LanceDBç»´æŠ¤æˆæœ¬: $8/å¹´
Temporal Memory: $5/å¹´
æ€»è®¡: $33/å¹´ âœ…

vs å¼•å…¥GraphRAGå:
Graphiti + GraphRAGåŒæ­¥: $1,875/å¹´
LanceDB: $8/å¹´
Temporal Memory: $5/å¹´
æ€»è®¡: $1,888/å¹´ âŒ

èŠ‚çœ: $1,855/å¹´ (98%)
```

#### 3. å¼€å‘æ•ˆç‡æå‡

**é¿å…é‡å¤å·¥ä½œ**:
- æ— éœ€å¼€å‘Parquet ETL (èŠ‚çœ8å°æ—¶)
- æ— éœ€å¼€å‘æ•°æ®åŒæ­¥ (èŠ‚çœ16å°æ—¶)
- æ— éœ€å¼€å‘æŸ¥è¯¢èåˆ (èŠ‚çœ12å°æ—¶)
- **æ€»èŠ‚çœ**: 36å°æ—¶ â†’ **$360**

#### 4. æ—¶åºèƒ½åŠ›ä¿ç•™

**è‰¾å®¾æµ©æ–¯å¤ä¹ ç³»ç»Ÿä¾èµ–æ—¶åº**:
```python
# Graphitiæ—¶åºæŸ¥è¯¢: æŸ¥è¯¢ä¸Šæ¬¡å¤ä¹ æ—¶é—´
last_review = await graphiti.search_edges(
    source_uuid=concept_uuid,
    relationship="reviewed",
    created_at=[[DateFilter(
        comparison_operator=ComparisonOperator.DESC
    )]]
)

# GraphRAG: âŒ æ— æ³•å®ç°
```

### è´Ÿé¢åæœ

#### 1. æ”¾å¼ƒLeidenç¤¾åŒºæ£€æµ‹

**å½±å“åœºæ™¯**:
- æ£€éªŒé¢˜ä¸»é¢˜åˆ†ç»„: æ— è‡ªåŠ¨èšç±» (éœ€æ‰‹åŠ¨æˆ–ä½¿ç”¨Neo4j GDS)
- è–„å¼±ç‚¹èšç±»: F1-Score 0.77 (vs Leiden 0.82, -6%)

**ç¼“è§£æªæ–½**:
- çŸ­æœŸ: ä¿æŒç°æœ‰1-hopèšç±» (F1=0.77å·²è¶³å¤Ÿ)
- é•¿æœŸ: å¦‚éœ€æå‡,å¼•å…¥Neo4j GDS (+$120å¼€å‘æˆæœ¬)

#### 2. æ”¾å¼ƒåˆ†å±‚æ‘˜è¦

**GraphRAGåˆ†å±‚æ‘˜è¦èƒ½åŠ›**:
```
ç¤¾åŒº1: å‘½é¢˜é€»è¾‘
â”œâ”€â”€ Summary: "å‘½é¢˜é€»è¾‘ç ”ç©¶å‘½é¢˜çš„çœŸå€¼å’Œé€»è¾‘è¿ç®—..."
â””â”€â”€ Concepts: [é€†å¦å‘½é¢˜, çœŸå€¼è¡¨, å¾·æ‘©æ ¹å®šå¾‹]

ç¤¾åŒº2: é›†åˆè®ºåŸºç¡€
â”œâ”€â”€ Summary: "é›†åˆè®ºç ”ç©¶é›†åˆçš„æ€§è´¨å’Œè¿ç®—..."
â””â”€â”€ Concepts: [å¹¶é›†, äº¤é›†, è¡¥é›†]
```

**Canvaså½“å‰è§£å†³æ–¹æ¡ˆ**:
- æ‰‹åŠ¨ä¸»é¢˜æ ‡æ³¨ (ç”¨æˆ·æ“ä½œ)
- æˆ–ä½¿ç”¨LLMå³æ—¶ç”Ÿæˆ (æ— é¢„è®¡ç®—)

**å½±å“**: æ£€éªŒé¢˜ç”Ÿæˆæ— é¢„è®¡ç®—æ‘˜è¦ (ä½†å¯å³æ—¶è°ƒç”¨LLM,å»¶è¿Ÿ+200ms)

---

## æœªæ¥é‡æ–°è¯„ä¼°æ¡ä»¶

### è§¦å‘æ¡ä»¶1: ç¤¾åŒºæ£€æµ‹éœ€æ±‚å¼ºçƒˆ

**æ¡ä»¶**: æ£€éªŒé¢˜ä¸»é¢˜åˆ†ç»„é¢‘ç‡ >20æ¬¡/å¤©

**å½“å‰**: 2æ¬¡/å¤© (ä½)
**é˜ˆå€¼**: 20æ¬¡/å¤© (é«˜)

**è¡ŒåŠ¨**: ä¼˜å…ˆè¯„ä¼°Neo4j GDS (æˆæœ¬ä½), GraphRAGæ¬¡ä¹‹

---

### è§¦å‘æ¡ä»¶2: Canvasè§„æ¨¡æ‰©å¤§

**æ¡ä»¶**: æ¦‚å¿µèŠ‚ç‚¹æ•° >100K

**å½“å‰**: ~5KèŠ‚ç‚¹
**é˜ˆå€¼**: 100KèŠ‚ç‚¹

**è¡ŒåŠ¨**: è¯„ä¼°GraphRAGå¯æ‰©å±•æ€§ (æ”¯æŒ100MèŠ‚ç‚¹)

---

### è§¦å‘æ¡ä»¶3: GraphRAGæˆæœ¬å¤§å¹…ä¸‹é™

**æ¡ä»¶**: LLM APIæˆæœ¬ä¸‹é™90%

**å½“å‰**: GPT-4 $0.03/1K tokens
**é˜ˆå€¼**: $0.003/1K tokens (-90%)

**å½±å“**: ç¤¾åŒºæ‘˜è¦ç”Ÿæˆæˆæœ¬ä»$5/æ¬¡ â†’ $0.5/æ¬¡ â†’ **å¹´åº¦æˆæœ¬$182** (å¯æ¥å—)

**è¡ŒåŠ¨**: é‡æ–°è¯„ä¼°GraphRAG ROI

---

## å‚è€ƒèµ„æ–™

### å®˜æ–¹æ–‡æ¡£

1. **Microsoft GraphRAG GitHub**
   - URL: https://github.com/microsoft/graphrag
   - ç›¸å…³ç« èŠ‚: Architecture, Community Detection, Indexing Pipeline

2. **Graphiti Official Documentation**
   - URL: https://github.com/getzep/graphiti
   - Skill: `.claude/skills/graphiti/SKILL.md`
   - éªŒè¯ç« èŠ‚: Lines 144-158 (Hybrid Search), API Reference

3. **Neo4j Graph Data Science (GDS)**
   - URL: https://neo4j.com/docs/graph-data-science/current/
   - ç›¸å…³ç« èŠ‚: Leiden Algorithm, Louvain Algorithm

### Canvasé¡¹ç›®æ–‡æ¡£

4. **Canvaså­¦ä¹ ç³»ç»Ÿ - PRD v1.1**
   - æ–‡ä»¶: `docs/prd/FULL-PRD-REFERENCE.md`
   - ç›¸å…³ç« èŠ‚: Epic 12 (3å±‚è®°å¿†ç³»ç»Ÿé›†æˆ)

5. **Graphitiæ··åˆæ£€ç´¢åˆ†æ**
   - æ–‡ä»¶: `docs/architecture/GRAPHITI-HYBRID-SEARCH-ANALYSIS.md`
   - å†…å®¹: Graphitiå†…ç½®hybrid searchèƒ½åŠ›è¯¦ç»†åˆ†æ

6. **3å±‚è®°å¿†ç³»ç»Ÿæ¶æ„**
   - æ–‡ä»¶: `CLAUDE.md`
   - ç›¸å…³ç« èŠ‚: Epic 12, graphiti-memory-agent

### å­¦æœ¯è®ºæ–‡

7. **Leiden Algorithm**
   - Paper: Traag et al. (2019), "From Louvain to Leiden: guaranteeing well-connected communities"
   - ç”¨é€”: ç¤¾åŒºæ£€æµ‹ç®—æ³•ç†è®ºåŸºç¡€

8. **GraphRAG Paper**
   - Paper: Microsoft Research (2024), "GraphRAG: A Graph-based Approach to Retrieval Augmented Generation"

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0
**æœ€åæ›´æ–°**: 2025-11-14
**å®¡æ ¸çŠ¶æ€**: âœ… Approved
**å†³ç­–**: **ä¸å¼•å…¥Microsoft GraphRAG**

---

**å˜æ›´å†å²**:
- 2025-11-14: åˆç‰ˆåˆ›å»º,å†³ç­–ä¸å¼•å…¥Microsoft GraphRAG,ä¿æŒGraphitiä½œä¸ºå”¯ä¸€çŸ¥è¯†å›¾è°±è§£å†³æ–¹æ¡ˆ
