# 执行摘要

### 项目目标

构建**3层记忆系统 + LangGraph Agentic RAG**,实现Canvas学习系统的智能检索升级,将检索准确率从**60%提升至85%**,为艾宾浩斯复习系统(Epic 14)提供基础设施。

### 核心决策 (基于3个ADR)

| ADR | 决策 | 核心理由 | 预期收益 |
|-----|------|---------|---------|
| **ADR-002** | 选择**LanceDB**替换ChromaDB | 多模态支持 + 10x性能提升 | +50K向量规模, 10ms延迟 |
| **ADR-003** | 采用**LangGraph** Agentic RAG | 并行检索 + 自适应融合 + 质量控制 | 准确率+25%, 成本-77% |
| **ADR-004** | **不引入**Microsoft GraphRAG | Graphiti已满足需求 + 架构简化 | 节省$1,855/年 |

### 系统架构概览

```
┌─────────────────────────────────────────────────────────────┐
│             Canvas Agentic RAG Orchestration                │
│                   (LangGraph StateGraph)                    │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌───────────────┐    ┌───────────────┐    ┌────────────┐ │
│  │  Parallel     │    │  Fusion       │    │  Rerank    │ │
│  │  Retrieval    │───▶│  (RRF/Wgt/    │───▶│  (Hybrid)  │ │
│  │  (Send)       │    │   Cascade)    │    │  Local+API │ │
│  └───────┬───────┘    └───────────────┘    └────────────┘ │
│          │                                                  │
└──────────┼──────────────────────────────────────────────────┘
           │
           ├─────────┬──────────────┬────────────────────────┐
           │         │              │                        │
┌──────────▼─────┐ ┌─▼──────────┐ ┌─▼────────────────────┐  │
│  Layer 1:      │ │ Layer 2:   │ │  Layer 3:            │  │
│  Graphiti      │ │ LanceDB    │ │  Temporal Memory     │  │
│  (Neo4j)       │ │ (Columnar) │ │  (FSRS + Behavior)   │  │
├────────────────┤ ├────────────┤ ├──────────────────────┤  │
│ • 概念关系图谱  │ │ • 解释文档  │ │ • 学习行为时序      │  │
│ • 时序追踪      │ │ • 多模态向量│ │ • 遗忘曲线预测      │  │
│ • Graph+Sem+BM25│ │ • 10M向量   │ │ • 复习调度          │  │
└────────────────┘ └────────────┘ └──────────────────────┘  │
                                                             │
           Neo4j                LanceDB          SQLite/JSON │
        (DirectNeo4j         (~/.lancedb)      (./fsrs.db)  │
         Storage)                                            │
```

### 关键指标预期

| 指标 | 当前 (Simple RAG) | 目标 (Agentic RAG) | 提升 |
|------|------------------|-------------------|------|
| **检索准确率** (MRR@10) | 0.280 | **0.380** | **+36%** |
| **检验白板准确率** | 60% | **85%** | **+25%** |
| **薄弱点聚类** (F1-Score) | 0.55 | **0.77** | **+40%** |
| **P95延迟** | 180ms | **<400ms** | 2.2x |
| **向量规模支持** | 100K | **10M+** | 100x |
| **年度TCO** | $4 | **$49** | +$45 |

**ROI**: 准确率提升价值 ~$500/年 >> 增量成本$45 → **ROI = 1,011%** 📈

---
