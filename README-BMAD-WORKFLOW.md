# BMad 4.0 å¼€å‘å·¥ä½œæµæŒ‡å—

Canvas Learning System ä½¿ç”¨ **BMad 4.0 æ–¹æ³•è®º** è¿›è¡Œå¼€å‘ç®¡ç†ï¼Œå¹¶æ·»åŠ äº† **Canvas è‡ªå®šä¹‰æ‰©å±•** ä»¥å¢å¼ºè¿­ä»£ç®¡ç†å’Œå¹¶è¡Œå¼€å‘èƒ½åŠ›ã€‚

---

## ç›®å½•

1. [å·¥ä½œæµæ¦‚è¿°](#å·¥ä½œæµæ¦‚è¿°)
2. [Phase 1: Analysis (åˆ†æ)](#phase-1-analysis-åˆ†æ)
3. [Phase 2: Planning (è§„åˆ’)](#phase-2-planning-è§„åˆ’)
4. [Phase 3: Solutioning (æ¶æ„)](#phase-3-solutioning-æ¶æ„)
5. [Phase 4: Implementation (å®ç°)](#phase-4-implementation-å®ç°)
6. [å®Œæ•´å·¥ä½œæµç¤ºä¾‹](#å®Œæ•´å·¥ä½œæµç¤ºä¾‹)
7. [å¿«é€Ÿå‚è€ƒè¡¨](#å¿«é€Ÿå‚è€ƒè¡¨)
8. [å¸¸è§åœºæ™¯æŒ‡å—](#å¸¸è§åœºæ™¯æŒ‡å—)

---

## å·¥ä½œæµæ¦‚è¿°

### BMad 4é˜¶æ®µæµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Phase 1         â”‚     â”‚ Phase 2         â”‚     â”‚ Phase 3         â”‚     â”‚ Phase 4         â”‚
â”‚ ANALYSIS        â”‚ â”€â”€â–º â”‚ PLANNING        â”‚ â”€â”€â–º â”‚ SOLUTIONING     â”‚ â”€â”€â–º â”‚ IMPLEMENTATION  â”‚
â”‚ (å¯é€‰)          â”‚     â”‚ (å¿…éœ€)          â”‚     â”‚ (æ¶æ„)          â”‚     â”‚ (å¼€å‘)          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ /analyst        â”‚     â”‚ /pm             â”‚     â”‚ /architect      â”‚     â”‚ /sm             â”‚
â”‚                 â”‚     â”‚ /planning âš¡     â”‚     â”‚ /po             â”‚     â”‚ /dev            â”‚
â”‚                 â”‚     â”‚                 â”‚     â”‚                 â”‚     â”‚ /qa             â”‚
â”‚                 â”‚     â”‚                 â”‚     â”‚                 â”‚     â”‚ /parallel âš¡     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**âš¡ = Canvas è‡ªå®šä¹‰æ‰©å±•**

### æ ¸å¿ƒåŸåˆ™

- **å¯¹è¯é©±åŠ¨**: ä½¿ç”¨è‡ªç„¶è¯­è¨€ + `/å‘½ä»¤` + `*å‘½ä»¤`
- **Agentåä½œ**: æ¯ä¸ªAgentæœ‰ç‰¹å®šèŒè´£å’Œå‘½ä»¤é›†
- **è¿­ä»£ç®¡ç†**: Phase 2ä½¿ç”¨Planning Orchestratorè·Ÿè¸ªå˜æ›´
- **è´¨é‡é—¨ç¦**: QA Agentåœ¨Phase 4æŠŠå…³è´¨é‡

---

## Phase 1: Analysis (åˆ†æ)

**ç›®çš„**: æ¢ç´¢æƒ³æ³•ã€å¸‚åœºè°ƒç ”ã€åˆ›å»ºé¡¹ç›®ç®€æŠ¥

**ä½•æ—¶ä½¿ç”¨**: æ–°é¡¹ç›®å¯åŠ¨æ—¶ï¼ˆå¯é€‰ï¼Œå·²æœ‰æ˜ç¡®éœ€æ±‚å¯è·³è¿‡ï¼‰

### Agent: Business Analyst (Mary ğŸ“Š)

**æ¿€æ´»**: `/analyst`

| å‘½ä»¤ | æè¿° | ç¤ºä¾‹ |
|------|------|------|
| `*help` | æ˜¾ç¤ºæ‰€æœ‰å‘½ä»¤ | `*help` |
| `*create-project-brief` | åˆ›å»ºé¡¹ç›®ç®€æŠ¥ | `*create-project-brief` |
| `*perform-market-research` | å¸‚åœºè°ƒç ”æŠ¥å‘Š | `*perform-market-research` |
| `*brainstorm {topic}` | å¤´è„‘é£æš´ | `*brainstorm "å­¦ä¹ ç³»ç»ŸåŠŸèƒ½"` |
| `*elicit` | éœ€æ±‚è·å– | `*elicit` |
| `*exit` | é€€å‡ºAgent | `*exit` |

### ç¤ºä¾‹æµç¨‹

```bash
# æ¿€æ´»Business Analyst
/analyst

Mary (Business Analyst):
ğŸ“Š ä½ å¥½ï¼æˆ‘æ˜¯Maryï¼Œä½ çš„ä¸šåŠ¡åˆ†æå¸ˆã€‚
å¯ç”¨å‘½ä»¤: *create-project-brief, *perform-market-research, *brainstorm...

# åˆ›å»ºé¡¹ç›®ç®€æŠ¥
*create-project-brief

Mary:
ğŸ“‹ è¯·å›ç­”ä»¥ä¸‹é—®é¢˜æ¥åˆ›å»ºé¡¹ç›®ç®€æŠ¥:
1. é¡¹ç›®ç›®æ ‡æ˜¯ä»€ä¹ˆï¼Ÿ
2. ç›®æ ‡ç”¨æˆ·æ˜¯è°ï¼Ÿ
...

# å®Œæˆåè¾“å‡º
*doc-out

Mary:
âœ… å·²ä¿å­˜: docs/project-brief.md
```

### é˜¶æ®µäº§å‡º

- `docs/project-brief.md` - é¡¹ç›®ç®€æŠ¥

### è¿›å…¥ä¸‹ä¸€é˜¶æ®µä¿¡å·

- é¡¹ç›®ç®€æŠ¥å®Œæˆ
- éœ€æ±‚åŸºæœ¬æ˜ç¡®

---

## Phase 2: Planning (è§„åˆ’)

**ç›®çš„**: åˆ›å»ºPRDã€å®šä¹‰Epicå’ŒStoryã€ç®¡ç†è§„åˆ’è¿­ä»£

**ä½•æ—¶ä½¿ç”¨**: å¿…éœ€é˜¶æ®µï¼Œæ‰€æœ‰é¡¹ç›®éƒ½è¦ç»è¿‡

### Agent 1: PM Agent (John ğŸ“‹)

**æ¿€æ´»**: `/pm`

| å‘½ä»¤ | æè¿° | ç¤ºä¾‹ |
|------|------|------|
| `*help` | æ˜¾ç¤ºæ‰€æœ‰å‘½ä»¤ | `*help` |
| `*create-prd` | ä»é¡¹ç›®ç®€æŠ¥ç”ŸæˆPRD | `*create-prd` |
| `*create-epic` | åˆ›å»ºæ–°Epic | `*create-epic` |
| `*create-story` | åˆ›å»ºç”¨æˆ·æ•…äº‹ | `*create-story` |
| `*correct-course` | å˜æ›´åˆ†æ | `*correct-course "æ·»åŠ æ–°åŠŸèƒ½"` |
| `*shard-prd` | æ‹†åˆ†å¤§å‹PRD | `*shard-prd` |
| `*doc-out` | è¾“å‡ºæ–‡æ¡£ | `*doc-out` |
| `*exit` | é€€å‡ºAgent | `*exit` |

### Agent 2: Planning Orchestrator (Marcus ğŸ¯) âš¡ Canvasæ‰©å±•

**æ¿€æ´»**: `/planning`

**ç›®çš„**: ç®¡ç†Phase 2è¿­ä»£ï¼Œè·Ÿè¸ªPRD/Architectureå˜æ›´ï¼Œæ£€æµ‹Breaking Changes

| å‘½ä»¤ | æè¿° | ç¤ºä¾‹ |
|------|------|------|
| `*help` | æ˜¾ç¤ºæ‰€æœ‰å‘½ä»¤ | `*help` |
| `*init` | åˆå§‹åŒ–æ–°è¿­ä»£ | `*init "Epic 13 - Ebbinghaus"` |
| `*validate` | éªŒè¯å˜æ›´ï¼ˆå«SDDæ£€æŸ¥ï¼‰ | `*validate` |
| `*finalize` | å®Œæˆè¿­ä»£ï¼Œåˆ›å»ºGit tag | `*finalize` |
| `*status` | æ˜¾ç¤ºå½“å‰è¿­ä»£çŠ¶æ€ | `*status` |
| `*rollback` | å›æ»šåˆ°ä¹‹å‰è¿­ä»£ | `*rollback 3` |
| `*compare` | å¯¹æ¯”è¿­ä»£å·®å¼‚ | `*compare 3 4` |
| `*exit` | é€€å‡ºAgent | `*exit` |

### æ ‡å‡†PRDåˆ›å»ºæµç¨‹

```bash
# Step 1: æ¿€æ´»PM
/pm

John (PM):
ğŸ“‹ ä½ å¥½ï¼æˆ‘æ˜¯Johnï¼Œä½ çš„äº§å“ç»ç†ã€‚

# Step 2: åˆ›å»ºPRD
*create-prd

John:
ğŸ“ æ­£åœ¨åˆ†æé¡¹ç›®ç®€æŠ¥...
âœ… PRDè‰ç¨¿å·²ç”Ÿæˆ

# å›ç­”PMçš„æ¾„æ¸…é—®é¢˜...

# Step 3: è¾“å‡ºPRD
*doc-out

John:
âœ… å·²ä¿å­˜: docs/prd.md
```

### è¿­ä»£ç®¡ç†æµç¨‹ (ä¿®æ”¹å·²æœ‰PRD)

```bash
# Step 1: æ¿€æ´»Planning Orchestrator
/planning

Marcus (Planning Orchestrator):
ğŸ¯ ä½ å¥½ï¼æˆ‘æ˜¯Marcusï¼Œä½ çš„è§„åˆ’åè°ƒå‘˜ã€‚

# Step 2: åˆå§‹åŒ–è¿­ä»£
*init "æ·»åŠ Epic 13 - Ebbinghauså¤ä¹ ç³»ç»Ÿ"

Marcus:
âœ… Pre-flight checks passed
â³ Initializing Iteration 4...
   â””â”€ Snapshot: iterations/iteration-004.json
   â””â”€ Branch: planning-iteration-4

# Step 3: ä½¿ç”¨PMè¿›è¡Œå˜æ›´
/pm
*correct-course "æ·»åŠ Epic 13 - Ebbinghaus Review"

PM:
âœ… Generated: sprint-change-proposal-20251120.md

# Step 4: éªŒè¯å˜æ›´
/planning
*validate

Marcus:
â³ Running validation...
   â””â”€ PRD: Validated
   â””â”€ OpenAPI: No breaking changes
   â””â”€ Schemas: Compatible
âœ… Validation Passed!

# Step 5: å®Œæˆè¿­ä»£
*finalize

Marcus:
âœ… Git tag: planning-v4
ğŸ‰ Iteration 4 Complete!
```

### é˜¶æ®µäº§å‡º

- `docs/prd.md` æˆ– `docs/prd/*.md` (åˆ†ç‰‡PRD)
- `iterations/iteration-{N}.json` (è¿­ä»£å¿«ç…§)

### è¿›å…¥ä¸‹ä¸€é˜¶æ®µä¿¡å·

- PRDç»POéªŒè¯
- æ‰€æœ‰Epicå’ŒStoryå®šä¹‰å®Œæˆ

---

## Phase 3: Solutioning (æ¶æ„)

**ç›®çš„**: åˆ›å»ºæŠ€æœ¯æ¶æ„ã€è®°å½•æ¶æ„å†³ç­–

**ä½•æ—¶ä½¿ç”¨**: PRDå®Œæˆå

### Agent 1: Architect Agent (Winston ğŸ—ï¸)

**æ¿€æ´»**: `/architect`

| å‘½ä»¤ | æè¿° | ç¤ºä¾‹ |
|------|------|------|
| `*help` | æ˜¾ç¤ºæ‰€æœ‰å‘½ä»¤ | `*help` |
| `*create-adr {title}` | åˆ›å»ºæ¶æ„å†³ç­–è®°å½•(ADR) | `*create-adr "Vector Database Selection"` |
| `*create-backend-architecture` | åç«¯æ¶æ„è®¾è®¡ | `*create-backend-architecture` |
| `*create-front-end-architecture` | å‰ç«¯æ¶æ„ | `*create-front-end-architecture` |
| `*create-full-stack-architecture` | å…¨æ ˆæ¶æ„ | `*create-full-stack-architecture` |
| `*research {topic}` | æ·±åº¦ç ”ç©¶ | `*research "LangGraph vs LangChain"` |
| `*doc-out` | è¾“å‡ºæ–‡æ¡£ | `*doc-out` |
| `*exit` | é€€å‡ºAgent | `*exit` |

### Agent 2: Product Owner Agent (Sarah ğŸ“)

**æ¿€æ´»**: `/po`

| å‘½ä»¤ | æè¿° | ç¤ºä¾‹ |
|------|------|------|
| `*help` | æ˜¾ç¤ºæ‰€æœ‰å‘½ä»¤ | `*help` |
| `*execute-checklist-po` | è¿è¡ŒPOæ£€æŸ¥æ¸…å• | `*execute-checklist-po` |
| `*validate-story-draft {story}` | éªŒè¯Story | `*validate-story-draft story-13.1` |
| `*correct-course` | éœ€æ±‚å˜æ›´å¤„ç† | `*correct-course` |
| `*exit` | é€€å‡ºAgent | `*exit` |

### ADRåˆ›å»ºæ—¶æœºä¸å·¥ä½œæµ â­ è¡ŒåŠ¨æŒ‡å—

**ADR (Architecture Decision Record)** ç”¨äºè®°å½•é‡è¦çš„æŠ€æœ¯é€‰å‹å†³ç­–ï¼Œéµå¾ªMichael Nygardæ ¼å¼ã€‚

#### ä½•æ—¶åˆ›å»ºADRï¼Ÿ

| è§¦å‘æ¡ä»¶ | ç¤ºä¾‹ | ä¼˜å…ˆçº§ |
|----------|------|--------|
| **æŠ€æœ¯é€‰å‹å†³ç­–** | é€‰æ‹©LanceDBè€ŒéChroma | P0 å¿…éœ€ |
| **æ¶æ„æ¨¡å¼é€‰æ‹©** | é€‰æ‹©å¾®æœåŠ¡è€Œéå•ä½“ | P0 å¿…éœ€ |
| **æ¡†æ¶/åº“é€‰æ‹©** | é€‰æ‹©LangGraphè€ŒéLangChain | P0 å¿…éœ€ |
| **æ•°æ®å­˜å‚¨å†³ç­–** | é€‰æ‹©Neo4jå­˜å‚¨çŸ¥è¯†å›¾è°± | P0 å¿…éœ€ |
| **é‡å¤§æŠ€æœ¯è½¬å‘** | ä»RESTæ”¹ä¸ºGraphQL | P0 å¿…éœ€ |
| **å›¢é˜Ÿé—®"ä¸ºä»€ä¹ˆé€‰Aä¸é€‰B?"** | ä»»ä½•éœ€è¦è§£é‡Šçš„æŠ€æœ¯é€‰æ‹© | P1 æ¨è |

#### ADRåœ¨Phase 3çš„ä½ç½®

```
Phase 3 å·¥ä½œæµ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                         â”‚
â”‚  1. /planning âš¡ (åˆå§‹åŒ–è¿­ä»£)                            â”‚
â”‚     â””â”€ *init "Architecture Design"                      â”‚
â”‚     â””â”€ åˆ›å»ºå¿«ç…§ï¼Œè·Ÿè¸ªSpecs/ADRå˜æ›´                       â”‚
â”‚                                                         â”‚
â”‚  2. /architect                                          â”‚
â”‚     â””â”€ *create-backend-architecture (æˆ–å…¶ä»–æ¶æ„å‘½ä»¤)     â”‚
â”‚     â””â”€ åˆ›å»ºOpenAPI specså’ŒJSON Schemas                  â”‚
â”‚                                                         â”‚
â”‚  3. åˆ›å»ºADR (é’ˆå¯¹æ¯ä¸ªé‡è¦æŠ€æœ¯å†³ç­–)  â­ å…³é”®æ­¥éª¤          â”‚
â”‚     â””â”€ *create-adr "æŠ€æœ¯é€‰å‹æ ‡é¢˜"                       â”‚
â”‚     â””â”€ é‡å¤ç›´åˆ°æ‰€æœ‰å†³ç­–éƒ½å·²è®°å½•                         â”‚
â”‚                                                         â”‚
â”‚  4. *doc-out (è¾“å‡ºæ¶æ„æ–‡æ¡£)                              â”‚
â”‚                                                         â”‚
â”‚  5. /planning âš¡ (éªŒè¯å¹¶å®Œæˆè¿­ä»£)                        â”‚
â”‚     â””â”€ *validate (æ£€æµ‹Breaking Changes)                 â”‚
â”‚     â””â”€ *finalize (Git tag: arch-v1)                     â”‚
â”‚                                                         â”‚
â”‚  6. /po                                                 â”‚
â”‚     â””â”€ *execute-checklist-po (éªŒè¯æ¶æ„å’ŒADR)            â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**âš ï¸ é‡è¦**: Phase 3ä¹Ÿéœ€è¦ä½¿ç”¨Planning Iteration Management (`/planning`)æ¥è·Ÿè¸ªOpenAPI specså’ŒJSON Schemasçš„å˜æ›´ã€‚è¿™ç¡®ä¿ï¼š
- Specsç‰ˆæœ¬è¢«è®°å½•
- Breaking Changesè¢«æ£€æµ‹
- å¯ä»¥å›æ»šåˆ°ä¹‹å‰çš„æ¶æ„ç‰ˆæœ¬

#### å·¥ä½œæµè¦ç‚¹

1. **å…ˆæ¶æ„ï¼ŒåADR**: åœ¨`*create-backend-architecture`è¿‡ç¨‹ä¸­è¯†åˆ«éœ€è¦ADRçš„å†³ç­–ç‚¹
2. **æ¯ä¸ªå†³ç­–ä¸€ä¸ªADR**: ä¸è¦åˆå¹¶å¤šä¸ªå†³ç­–åˆ°ä¸€ä¸ªADR
3. **ADRç¼–å·è‡ªåŠ¨é€’å¢**: ç³»ç»Ÿè‡ªåŠ¨æ£€æµ‹æœ€é«˜ç¼–å·å¹¶é€’å¢
4. **å¼•ç”¨PRD/Epic**: åœ¨ADRçš„Referencesä¸­å…³è”å¯¹åº”çš„PRDç« èŠ‚å’ŒEpic

### ç¤ºä¾‹æµç¨‹ (å«ADR)

```bash
# Step 0: åˆå§‹åŒ–è¿­ä»£ âš¡ æ–°å¢æ­¥éª¤
/planning

Marcus (Planning Orchestrator):
ğŸ¯ ä½ å¥½ï¼æˆ‘æ˜¯Marcusï¼Œä½ çš„è§„åˆ’åè°ƒå‘˜ã€‚

*init "Phase 3 - Architecture Design"

Marcus:
âœ… Initializing Iteration...
   â””â”€ Snapshot: iterations/iteration-arch-001.json
ğŸ“‹ Ready for Architecture changes

# Step 1: åˆ›å»ºæ¶æ„
/architect

Winston (Architect):
ğŸ—ï¸ ä½ å¥½ï¼æˆ‘æ˜¯Winstonï¼Œä½ çš„æ¶æ„å¸ˆã€‚

*create-backend-architecture

Winston:
ğŸ” åˆ†æPRDéœ€æ±‚...
ğŸ“ è®¾è®¡ç³»ç»Ÿæ¶æ„...
âš ï¸ æ£€æµ‹åˆ°3ä¸ªéœ€è¦ADRçš„å†³ç­–ç‚¹:
   1. Vector Databaseé€‰å‹
   2. Agentæ¡†æ¶é€‰å‹
   3. çŸ¥è¯†å›¾è°±å­˜å‚¨æ–¹æ¡ˆ
âœ… æ¶æ„æ–‡æ¡£å·²ç”Ÿæˆ

# Step 2: ä¸ºæ¯ä¸ªå†³ç­–åˆ›å»ºADR â­ å…³é”®æ­¥éª¤
*create-adr "Vector Database Selection"

Winston:
ğŸ“ åˆ›å»ºADR-0006...
[äº¤äº’å¼æ”¶é›†å†³ç­–ä¿¡æ¯]
âœ… å·²ä¿å­˜: docs/architecture/decisions/0006-vector-database-selection.md

*create-adr "Agent Framework Selection"

Winston:
ğŸ“ åˆ›å»ºADR-0007...
âœ… å·²ä¿å­˜: docs/architecture/decisions/0007-agent-framework-selection.md

# Step 3: è¾“å‡ºæ¶æ„æ–‡æ¡£
*doc-out

Winston:
âœ… å·²ä¿å­˜: docs/architecture.md

# Step 4: éªŒè¯å¹¶å®Œæˆè¿­ä»£ âš¡ æ–°å¢æ­¥éª¤
/planning

Marcus:
ğŸ¯ è§„åˆ’åè°ƒå‘˜å·²æ¿€æ´»

*validate

Marcus:
â³ Running validation...
   â””â”€ OpenAPI: No breaking changes âœ…
   â””â”€ Schemas: Compatible âœ…
   â””â”€ ADRs: 3 new ADRs detected âœ…
âœ… Validation Passed!

*finalize

Marcus:
âœ… Git tag: arch-v1
ğŸ‰ Architecture Iteration Complete!

# Step 5: POéªŒè¯ (å«ADRæ£€æŸ¥)
/po

Sarah (Product Owner):
ğŸ“ ä½ å¥½ï¼æˆ‘æ˜¯Sarahï¼Œä½ çš„äº§å“è´Ÿè´£äººã€‚

*execute-checklist-po

Sarah:
âœ… PRDå®Œæ•´æ€§: Pass
âœ… StoryéªŒæ”¶æ ‡å‡†: Pass
âœ… æ¶æ„å¯¹é½: Pass
âœ… ADRå®Œæ•´æ€§: æ£€æµ‹åˆ°3ä¸ªADRï¼Œè¦†ç›–æ‰€æœ‰ä¸»è¦å†³ç­–
ğŸ‰ Ready for Implementation!
```

### é˜¶æ®µäº§å‡º

- `docs/architecture.md` æˆ– `docs/architecture/*.md`
- `docs/architecture/decisions/*.md` (ADRs) â­ **æ¯ä¸ªæŠ€æœ¯å†³ç­–å¯¹åº”ä¸€ä¸ªADR**
- `specs/api/*.yml` (OpenAPIè§„èŒƒ)
- `specs/data/*.json` (JSON Schema)

### è¿›å…¥ä¸‹ä¸€é˜¶æ®µä¿¡å·

- æ¶æ„æ–‡æ¡£å®Œæˆ
- POæ£€æŸ¥æ¸…å•é€šè¿‡

---

## Phase 4: Implementation (å®ç°)

**ç›®çš„**: å¼€å‘Storyã€ä»£ç å®¡æŸ¥ã€è´¨é‡æµ‹è¯•

**ä½•æ—¶ä½¿ç”¨**: æ¶æ„å®Œæˆå

### Agent 1: Scrum Master Agent (Bob ğŸƒ)

**æ¿€æ´»**: `/sm`

| å‘½ä»¤ | æè¿° | ç¤ºä¾‹ |
|------|------|------|
| `*help` | æ˜¾ç¤ºæ‰€æœ‰å‘½ä»¤ | `*help` |
| `*draft` | ä»Epicåˆ›å»ºä¸‹ä¸€ä¸ªStory | `*draft` |
| `*story-checklist` | éªŒè¯Storyè‰ç¨¿ | `*story-checklist` |
| `*correct-course` | èŒƒå›´å˜æ›´å¤„ç† | `*correct-course "æŠ€æœ¯è½¬å‘"` |
| `*exit` | é€€å‡ºAgent | `*exit` |

### Agent 2: Developer Agent (James ğŸ’»)

**æ¿€æ´»**: `/dev`

| å‘½ä»¤ | æè¿° | ç¤ºä¾‹ |
|------|------|------|
| `*help` | æ˜¾ç¤ºæ‰€æœ‰å‘½ä»¤ | `*help` |
| `*develop-story` | å®ç°Storyå«æµ‹è¯• | `*develop-story story-13.1` |
| `*run-tests` | è¿è¡Œæµ‹è¯• | `*run-tests` |
| `*review-qa` | åº”ç”¨QAä¿®å¤ | `*review-qa` |
| `*exit` | é€€å‡ºAgent | `*exit` |

### Agent 3: QA Agent (Quinn ğŸ§ª)

**æ¿€æ´»**: `/qa`

| å‘½ä»¤ | æè¿° | ç¤ºä¾‹ |
|------|------|------|
| `*help` | æ˜¾ç¤ºæ‰€æœ‰å‘½ä»¤ | `*help` |
| `*risk-profile {story}` | è¯„ä¼°é£é™© | `*risk-profile story-13.1` |
| `*test-design {story}` | è®¾è®¡æµ‹è¯•åœºæ™¯ | `*test-design story-13.1` |
| `*review {story}` | ç»¼åˆQAå®¡æŸ¥ | `*review story-13.1` |
| `*gate {story}` | è´¨é‡é—¨ç¦å†³ç­– | `*gate story-13.1` |
| `*exit` | é€€å‡ºAgent | `*exit` |

### Agent 4: Parallel Dev Coordinator (Alex âš¡) âš¡ Canvasæ‰©å±•

**æ¿€æ´»**: `/parallel`

**ç›®çš„**: åè°ƒå¤šStoryå¹¶è¡Œå¼€å‘ï¼Œç®¡ç†Git worktree

| å‘½ä»¤ | æè¿° | ç¤ºä¾‹ |
|------|------|------|
| `*help` | æ˜¾ç¤ºæ‰€æœ‰å‘½ä»¤ | `*help` |
| `*analyze` | åˆ†æStoryä¾èµ–å’Œå†²çª | `*analyze "13.1, 13.2, 13.3"` |
| `*init` | åˆ›å»ºå¹¶è¡Œworktree | `*init "13.1, 13.2"` |
| `*status` | æ˜¾ç¤ºæ‰€æœ‰worktreeè¿›åº¦ | `*status` |
| `*merge` | åˆå¹¶å®Œæˆçš„worktree | `*merge 13.1` æˆ– `*merge --all` |
| `*cleanup` | æ¸…ç†å·²åˆå¹¶worktree | `*cleanup` |
| `*exit` | é€€å‡ºAgent | `*exit` |

### æ ‡å‡†Storyå¼€å‘æµç¨‹

```bash
# Step 1: SMåˆ›å»ºStory
/sm

Bob (Scrum Master):
ğŸƒ ä½ å¥½ï¼æˆ‘æ˜¯Bobï¼Œä½ çš„Scrum Masterã€‚

*draft

Bob:
ğŸ“ ä»Epic 13åˆ›å»ºStory...
âœ… Storyè‰ç¨¿: story-13.1.md
   åŒ…å«å®Œæ•´Dev Noteså’ŒéªŒæ”¶æ ‡å‡†

# Step 2: Devå®ç°Story
/dev

James (Developer):
ğŸ’» ä½ å¥½ï¼æˆ‘æ˜¯Jamesï¼Œä½ çš„å¼€å‘è€…ã€‚

*develop-story story-13.1

James:
â³ è¯»å–Storyéœ€æ±‚...
â³ å®ç°åŠŸèƒ½...
â³ ç¼–å†™æµ‹è¯•...
âœ… å®ç°å®Œæˆ

*run-tests

James:
â³ Running pytest...
âœ… 12/12 tests passed

# Step 3: QAå®¡æŸ¥
/qa

Quinn (QA):
ğŸ§ª ä½ å¥½ï¼æˆ‘æ˜¯Quinnï¼Œä½ çš„QAå·¥ç¨‹å¸ˆã€‚

*review story-13.1

Quinn:
ğŸ” ä»£ç å®¡æŸ¥...
ğŸ” æµ‹è¯•è¦†ç›–...
ğŸ” å®‰å…¨æ£€æŸ¥...
âœ… Reviewå®Œæˆ

*gate story-13.1

Quinn:
âœ… PASS - Story 13.1é€šè¿‡è´¨é‡é—¨ç¦
   - æµ‹è¯•: 12/12
   - è¦†ç›–ç‡: 95%
   - å®‰å…¨: No issues
```

### å¹¶è¡Œå¼€å‘æµç¨‹

```bash
# Step 1: åˆ†æä¾èµ–
/parallel

Alex (Parallel Dev Coordinator):
âš¡ ä½ å¥½ï¼æˆ‘æ˜¯Alexï¼Œä½ çš„å¹¶è¡Œå¼€å‘åè°ƒå‘˜ã€‚

*analyze "13.1, 13.2, 13.3, 13.4"

Alex:
âœ… Safe to parallelize: 13.1, 13.2, 13.4
âš ï¸ Conflict: 13.1 â†” 13.3 on src/review_engine.py

Recommended:
- Group 1: 13.1, 13.2, 13.4 (parallel)
- Group 2: 13.3 (after 13.1)

# Step 2: åˆ›å»ºworktree
*init "13.1, 13.2, 13.4"

Alex:
âœ… Created 3 worktrees:
   â””â”€ Canvas-develop-13.1
   â””â”€ Canvas-develop-13.2
   â””â”€ Canvas-develop-13.4

## Launch Parallel Sessions

### Option 1: Full Automation (æ¨è)
.\scripts\parallel-develop-auto.ps1 -Stories 13.1,13.2,13.4

### Option 2: Manual Interactive
# ...æ‰‹åŠ¨æ‰“å¼€ç»ˆç«¯...

# Step 3: åœ¨å„worktreeä¸­å¼€å‘ (Dev + QA)
# Window 1: cd Canvas-develop-13.1 && claude
# Window 2: cd Canvas-develop-13.2 && claude
# Window 3: cd Canvas-develop-13.4 && claude

# æ¯ä¸ªçª—å£ä¸­æ‰§è¡Œå®Œæ•´çš„Dev+QAæµç¨‹:
# Phase 1: Development
/dev
*develop-story story-13.X
*run-tests

# Phase 2: Quality Review
/qa
*review story-13.X
*gate story-13.X

# Step 4: ç›‘æ§è¿›åº¦ (å›åˆ°main repo)
*status

Alex:
| Worktree | Story | Status | Tests | QA Gate | Ready |
|----------|-------|--------|-------|---------|-------|
| Canvas-develop-13.1 | 13.1 | âœ… ready-to-merge | Passed | PASS | âœ… |
| Canvas-develop-13.2 | 13.2 | ğŸ”„ dev-complete | Passed | - | âŒ |
| Canvas-develop-13.4 | 13.4 | ğŸ”„ qa-reviewing | Passed | CONCERNS | âŒ |

Ready to merge: 1/3

# Step 5: åˆå¹¶å®Œæˆçš„å·¥ä½œ (åªåˆå¹¶QA Gate=PASS)
*merge --all

Alex:
âœ… Merged: 13.1 (QA Gate = PASS)
ğŸ”„ Skipped: 13.2 (needs QA review)
âš ï¸ Skipped: 13.4 (QA Gate = CONCERNS)

# Step 6: æ¸…ç†
*cleanup
```

### é˜¶æ®µäº§å‡º

- `docs/stories/story-{epic}.{story}.md`
- `src/**/*.py` (å®ç°ä»£ç )
- `src/tests/**/*.py` (æµ‹è¯•ä»£ç )

---

## å®Œæ•´å·¥ä½œæµç¤ºä¾‹

### æ–°é¡¹ç›®ä»é›¶å¼€å§‹

```bash
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Phase 1: Analysis
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
/analyst
*create-project-brief
# å›ç­”é—®é¢˜...
*doc-out
*exit

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Phase 2: Planning
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# åˆå§‹åŒ–è¿­ä»£
/planning
*init "Initial PRD - v1.0"

# åˆ›å»ºPRD
/pm
*create-prd
*doc-out

# éªŒè¯å¹¶å®Œæˆè¿­ä»£
/planning
*validate
*finalize

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Phase 3: Solutioning
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
/architect
*create-backend-architecture

# â­ ä¸ºæ¯ä¸ªé‡è¦æŠ€æœ¯å†³ç­–åˆ›å»ºADR
*create-adr "Vector Database Selection"
*create-adr "Agent Framework Selection"

*doc-out
*exit

/po
*execute-checklist-po
*exit

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Phase 4: Implementation
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# å¾ªç¯: SM â†’ Dev â†’ QA
/sm
*draft

/dev
*develop-story story-1.1
*run-tests

/qa
*review story-1.1
*gate story-1.1

# é‡å¤ç›´åˆ°æ‰€æœ‰Storyå®Œæˆ...
```

---

## å¿«é€Ÿå‚è€ƒè¡¨

### æ‰€æœ‰Agentå‘½ä»¤ä¸€è§ˆ

| Phase | Agent | æ¿€æ´»å‘½ä»¤ | æ ¸å¿ƒå‘½ä»¤ |
|-------|-------|----------|----------|
| 1 | Business Analyst | `/analyst` | `*create-project-brief`, `*brainstorm` |
| 2 | PM | `/pm` | `*create-prd`, `*create-epic`, `*correct-course` |
| 2 | Planning Orchestrator âš¡ | `/planning` | `*init`, `*validate`, `*finalize` |
| 3 | Architect | `/architect` | `*create-adr`, `*create-backend-architecture`, `*research` |
| 3 | Product Owner | `/po` | `*execute-checklist-po`, `*validate-story-draft` |
| 4 | Scrum Master | `/sm` | `*draft`, `*story-checklist`, `*correct-course` |
| 4 | Developer | `/dev` | `*develop-story`, `*run-tests` |
| 4 | QA | `/qa` | `*review`, `*gate`, `*risk-profile` |
| 4 | Parallel Coordinator âš¡ | `/parallel` | `*analyze`, `*init`, `*merge` |

### é˜¶æ®µè½¬æ¢ä¿¡å·

| è½¬æ¢ | è§¦å‘æ¡ä»¶ | å‘½ä»¤ |
|------|----------|------|
| Start â†’ Phase 1 | æ–°é¡¹ç›®éœ€è¦æ¢ç´¢ | `/analyst` |
| Phase 1 â†’ 2 | é¡¹ç›®ç®€æŠ¥å®Œæˆ | `/pm` â†’ `*create-prd` |
| Phase 2 â†’ 3 | PRDéªŒè¯é€šè¿‡ | `/architect` |
| Phase 3 â†’ 4 | æ¶æ„å®Œæˆ | `/sm` â†’ `*draft` |
| Phase 4 è¿­ä»£ | Storyå¼€å‘å¾ªç¯ | `/dev` â†’ `/qa` â†’ `/sm` |
| Phase 4 å¹¶è¡Œ | å¤šStoryå°±ç»ª | `/parallel` â†’ `*analyze` |
| Phase 4 â†’ 2 | é‡å¤§éœ€æ±‚å˜æ›´ | `/planning` â†’ `*init` |

### ADRåˆ›å»ºæ—¶æœºå¿«é€Ÿå‚è€ƒ â­

| é˜¶æ®µ | ä½•æ—¶åˆ›å»ºADR | å‘½ä»¤ |
|------|-------------|------|
| **Phase 3** (ä¸»è¦é˜¶æ®µ) | æŠ€æœ¯é€‰å‹ã€æ¡†æ¶é€‰æ‹©ã€æ¶æ„æ¨¡å¼ã€æ•°æ®å­˜å‚¨å†³ç­– | `/architect` â†’ `*create-adr "æ ‡é¢˜"` |
| **Phase 4** (è¡¥å……) | å¼€å‘ä¸­é‡å¤§æŠ€æœ¯è½¬å‘ã€å‘ç°æ›´å¥½æ–¹æ¡ˆéœ€è¦æ›¿æ¢ | `/architect` â†’ `*create-adr "æ ‡é¢˜"` |
| **Phase 2** (ç½•è§) | éœ€æ±‚çº¦æŸå¯¼è‡´çš„æŠ€æœ¯é¢„é€‰ | `/architect` â†’ `*create-adr "æ ‡é¢˜"` |

**ADRéªŒè¯**: åœ¨`/planning` â†’ `*validate`æ—¶è‡ªåŠ¨æ£€æŸ¥ADRå®Œæ•´æ€§

---

## å¸¸è§åœºæ™¯æŒ‡å—

### åœºæ™¯1: PRDéœ€è¦ä¿®æ”¹

```bash
/planning
*init "PRD v2.0 - æ·»åŠ æ–°åŠŸèƒ½"

/pm
*correct-course "æ·»åŠ Epic 13"

/planning
*validate
*finalize
```

### åœºæ™¯2: Sprintä¸­æŠ€æœ¯è½¬å‘

```bash
# Step 1: åˆ†æå˜æ›´å½±å“
/sm
*correct-course "å‘ç°éœ€è¦OAuthè€ŒéJWT"
# ç”Ÿæˆå˜æ›´ææ¡ˆï¼Œè¯„ä¼°å½±å“

# Step 2: å¦‚æœæ˜¯é‡å¤§æŠ€æœ¯å†³ç­–å˜æ›´ï¼Œåˆ›å»ºADR â­
/architect
*create-adr "Authentication Method Change - OAuth vs JWT"
# è®°å½•ä¸ºä»€ä¹ˆéœ€è¦ä»JWTæ”¹ä¸ºOAuth

*exit
```

**âš ï¸ æ³¨æ„**: Phase 4ä¸­çš„æŠ€æœ¯è½¬å‘å¦‚æœå½±å“æ¶æ„å†³ç­–ï¼Œä¹Ÿåº”è¯¥åˆ›å»ºADRæ¥è®°å½•åŸå› å’Œå½±å“ã€‚

### åœºæ™¯3: é«˜é£é™©Storyå¼€å‘

```bash
# å¼€å‘å‰è¯„ä¼°é£é™©
/qa
*risk-profile story-13.1
*test-design story-13.1

# å¼€å‘
/dev
*develop-story story-13.1

# ä¸¥æ ¼å®¡æŸ¥
/qa
*review story-13.1
*gate story-13.1
```

### åœºæ™¯4: Breaking Changeså¤„ç†

```bash
/planning
*validate

Marcus:
âŒ Breaking Changes Detected!
   - DELETE /api/cache/{id} removed
   - Required field added

# é€‰é¡¹:
# A. ä¿®å¤åé‡æ–°éªŒè¯
# B. æ¥å—breaking changes
*finalize --accept-breaking
```

### åœºæ™¯5: åˆ›å»ºæ¶æ„å†³ç­–è®°å½•(ADR)

```bash
# å½“éœ€è¦è®°å½•é‡è¦æŠ€æœ¯é€‰å‹å†³ç­–æ—¶
/architect

Winston (Architect):
ğŸ—ï¸ ä½ å¥½ï¼æˆ‘æ˜¯Winstonï¼Œä½ çš„æ¶æ„å¸ˆã€‚

*create-adr "Vector Database Selection"

Winston:
ğŸ“ å¼€å§‹åˆ›å»ºADR-0006...

Step 1: å·²æ£€æµ‹åˆ°ç°æœ‰æœ€é«˜ç¼–å·ä¸º0005
Step 2: è¯·æä¾›é—®é¢˜èƒŒæ™¯...
Step 3: è¯·åˆ—å‡ºå€™é€‰æ–¹æ¡ˆï¼ˆLanceDB, Chroma, Pineconeï¼‰...
Step 4: é€‰æ‹©æœ€ç»ˆæ–¹æ¡ˆ...
Step 5: æè¿°å†³ç­–å½±å“...
Step 6: æ·»åŠ å¼•ç”¨...
Step 7: âœ… å·²ä¿å­˜: docs/architecture/decisions/0006-vector-database-selection.md

# éªŒè¯ADRï¼ˆå¯é€‰ï¼‰
python scripts/validate-adr.py
```

---

## é™„å½•: Canvasè‡ªå®šä¹‰æ‰©å±•è¯´æ˜

### Planning Orchestrator (Marcus ğŸ¯)

**ä¸ºä»€ä¹ˆéœ€è¦**: BMadå®˜æ–¹æ²¡æœ‰Phase 2è¿­ä»£è·Ÿè¸ªï¼Œå¤šæ¬¡PRDç¼–è¾‘ä¼šè¦†ç›–å†å²ã€‚

**åŠŸèƒ½**:
- åˆ›å»ºè¿­ä»£å¿«ç…§
- æ£€æµ‹Breaking Changes (OpenAPI, JSON Schema)
- Git tagç‰ˆæœ¬ç®¡ç†
- è¿­ä»£å¯¹æ¯”å’Œå›æ»š

### Parallel Dev Coordinator (Alex âš¡)

**ä¸ºä»€ä¹ˆéœ€è¦**: æé«˜å¼€å‘æ•ˆç‡ï¼Œæ”¯æŒå¤šStoryå¹¶è¡Œå¼€å‘ã€‚

**åŠŸèƒ½**:
- åˆ†æStoryæ–‡ä»¶ä¾èµ–
- æ£€æµ‹æ½œåœ¨å†²çª
- ç®¡ç†Git worktree
- ç›‘æ§å¹¶è¡Œè¿›åº¦ï¼ˆå«QA GateçŠ¶æ€ï¼‰
- åè°ƒåˆå¹¶ï¼ˆåªåˆå¹¶QA Gate=PASSï¼‰

**å…³é”®è®¾è®¡**: æ¯ä¸ªworktreeå¿…é¡»å®Œæˆå®Œæ•´çš„Dev+QAæµç¨‹æ‰èƒ½åˆå¹¶

**çŠ¶æ€æµè½¬**: `initialized â†’ in-progress â†’ dev-complete â†’ qa-reviewing â†’ ready-to-merge`

**å…¨è‡ªåŠ¨åŒ–æ¨¡å¼**: ä½¿ç”¨`parallel-develop-auto.ps1`è„šæœ¬ï¼Œé€šè¿‡Claude Codeçš„`-p`éäº¤äº’æ¨¡å¼è‡ªåŠ¨æ‰§è¡Œå®Œæ•´Dev+QAæµç¨‹ï¼š
```powershell
.\scripts\parallel-develop-auto.ps1 -Stories 13.1,13.2,13.4
```

æ¯ä¸ªä¼šè¯ä½¿ç”¨:
- `--dangerously-skip-permissions` - è·³è¿‡æ‰€æœ‰ç¡®è®¤
- `--allowedTools "..."` - é¢„æˆæƒå·¥å…·
- `--max-turns 200` - è¿­ä»£æ¬¡æ•°é™åˆ¶

---

## SDDé©±åŠ¨å¼€å‘æµç¨‹ (Specification-Driven Development)

### æ¦‚è¿°

Canvas Learning Systemé‡‡ç”¨**SDDï¼ˆè§„èŒƒé©±åŠ¨å¼€å‘ï¼‰**æ–¹æ³•ï¼Œç¡®ä¿å¼€å‘è¿‡ç¨‹ä¸­ï¼š
- æ‰€æœ‰APIç«¯ç‚¹æœ‰OpenAPIè§„èŒƒå®šä¹‰
- æ‰€æœ‰æ•°æ®ç»“æ„æœ‰JSON Schemaå®šä¹‰
- æ‰€æœ‰æŠ€æœ¯å†³ç­–æœ‰ADRè®°å½•
- Storyå’Œä»£ç éƒ½èƒ½è¿½æº¯åˆ°è§„èŒƒæ¥æº

### SDDå·¥ä»¶ä½ç½®

| å·¥ä»¶ç±»å‹ | ä½ç½® | åˆ›å»ºæ—¶æœº | æ¶ˆè´¹è€… |
|----------|------|----------|--------|
| OpenAPI Specs | `specs/api/*.openapi.yml` | Phase 3 (Architect) | SM, Dev, QA |
| JSON Schemas | `specs/data/*.schema.json` | Phase 3 (Architect) | SM, Dev, QA |
| Gherkin Specs | `specs/behavior/*.feature` | Phase 3 (Architect) | SM, Dev, QA |
| ADRs | `docs/architecture/decisions/*.md` | Phase 3 (Architect) | SM, Dev |

### SDDåœ¨å„Phaseçš„è§’è‰²

```
Phase 2: Planning Iteration Management
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ *validate éªŒè¯OpenAPI/Schemaå˜æ›´    â”‚
â”‚ - æ£€æµ‹Breaking Changes              â”‚
â”‚ - æ£€æŸ¥ç‰ˆæœ¬å·é€’å¢                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
Phase 3: Solutioning
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ /architect åˆ›å»ºSDDå·¥ä»¶              â”‚
â”‚ - *create-backend-architecture      â”‚
â”‚ - *create-adr                       â”‚
â”‚ - åˆ›å»ºOpenAPI specs                 â”‚
â”‚ - åˆ›å»ºJSON Schemas                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
Phase 4: Implementation
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ /sm *draft è¯»å–å¹¶å¼•ç”¨SDD            â”‚
â”‚ - Step 3.3: è¯»å–specs/ç›®å½•          â”‚
â”‚ - Step 3.4: å…³è”ç›¸å…³ADR             â”‚
â”‚ - StoryåŒ…å«SDDè§„èŒƒå‚è€ƒSection       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ validate-story-sdd.py å¥‘çº¦éªŒè¯      â”‚
â”‚ - éªŒè¯APIç«¯ç‚¹åœ¨OpenAPIä¸­å®šä¹‰        â”‚
â”‚ - éªŒè¯æ•°æ®æ¨¡å‹åœ¨Schemaä¸­å®šä¹‰        â”‚
â”‚ - éªŒè¯ADRå¼•ç”¨å­˜åœ¨                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ /dev *develop-story                 â”‚
â”‚ - åŸºäºStoryä¸­çš„SDDå¼•ç”¨å¼€å‘          â”‚
â”‚ - devLoadAlwaysFilesåŠ è½½specs       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ /qa *review                         â”‚
â”‚ - å¯é€‰è¿è¡ŒSDDå¥‘çº¦éªŒè¯               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### SMç¼–å†™Storyæ—¶çš„SDDé›†æˆ

SMä½¿ç”¨`*draft`å‘½ä»¤æ—¶ï¼Œè‡ªåŠ¨æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š

1. **Step 3.3 è¯»å–SDDè§„èŒƒ**:
   - è¯»å–`specs/api/*.openapi.yml`
   - è¯»å–`specs/data/*.schema.json`
   - æå–ä¸Storyç›¸å…³çš„ç«¯ç‚¹å’ŒSchema

2. **Step 3.4 å…³è”ADR**:
   - æ‰«æ`docs/architecture/decisions/`
   - æ ¹æ®StoryæŠ€æœ¯æ ˆå…³è”ç›¸å…³ADR
   - æå–ADRä¸­çš„çº¦æŸå’Œå½±å“

3. **Step 5 å¡«å†™Storyæ¨¡æ¿**:
   - **SDDè§„èŒƒå‚è€ƒ (å¿…å¡«)**ï¼šAPIç«¯ç‚¹å’ŒSchemaå¼•ç”¨
   - **ADRå†³ç­–å…³è” (å¿…å¡«)**ï¼šæŠ€æœ¯å†³ç­–åŠå…¶å½±å“

### Storyæ¨¡æ¿ä¸­çš„SDD Sectionç¤ºä¾‹

```markdown
## Dev Notes

### SDDè§„èŒƒå‚è€ƒ (å¿…å¡«)

**APIç«¯ç‚¹**:
- `POST /api/canvas/analyze`
  - æ¥æº: [Source: specs/api/canvas-api.openapi.yml#L156-L180]
  - è¯·æ±‚Schema: CanvasAnalyzeRequest
  - å“åº”Schema: AnalysisResult

**æ•°æ®Schema**:
- CanvasNode: [Source: specs/data/canvas-node.schema.json]
  - å¿…å¡«å­—æ®µ: id, type, x, y, width, height
- AgentResponse: [Source: specs/data/agent-response.schema.json]

### ADRå†³ç­–å…³è” (å¿…å¡«)

| ADRç¼–å· | å†³ç­–æ ‡é¢˜ | å¯¹Storyçš„å½±å“ |
|---------|----------|---------------|
| ADR-002 | Vector Databaseé€‰å‹(LanceDB) | å‘é‡å­˜å‚¨ä½¿ç”¨LanceDB API |
| ADR-003 | Agentic RAGæ¶æ„ | é‡‡ç”¨Router-Fusion-Rerankingæ¨¡å¼ |

**å…³é”®çº¦æŸ**:
- LanceDBè¦æ±‚embeddingç»´åº¦ä¸º1536
- RAGæŸ¥è¯¢å¿…é¡»ç»è¿‡Routeråˆ¤æ–­
```

### Phase 4 SDDå¥‘çº¦éªŒè¯

åœ¨Storyç¼–å†™å®Œæˆåæˆ–QA Reviewæ—¶ï¼Œè¿è¡Œå¥‘çº¦éªŒè¯ï¼š

```bash
# éªŒè¯å•ä¸ªStory
python scripts/validate-story-sdd.py --story docs/stories/12.1.story.md

# Strictæ¨¡å¼ï¼ˆwarningsè§†ä¸ºerrorsï¼‰
python scripts/validate-story-sdd.py --story docs/stories/12.1.story.md --strict

# æŒ‡å®šè¾“å‡ºè·¯å¾„
python scripts/validate-story-sdd.py --story docs/stories/12.1.story.md --output validation-report.md
```

**éªŒè¯å†…å®¹**:
- âœ… SDDè§„èŒƒå‚è€ƒSectionå­˜åœ¨ä¸”éç©º
- âœ… ADRå†³ç­–å…³è”Sectionå­˜åœ¨ä¸”éç©º
- âœ… APIç«¯ç‚¹åœ¨OpenAPI specä¸­å®šä¹‰
- âœ… Schemaå¼•ç”¨åœ¨specs/data/ä¸­å­˜åœ¨
- âœ… ADRå¼•ç”¨åœ¨decisions/ç›®å½•ä¸­å­˜åœ¨

**éªŒè¯ç»“æœ**:
- **PASSED**: Storyå¯ä»¥è¿›å…¥å¼€å‘
- **PASSED WITH WARNINGS**: å»ºè®®ä¿®å¤ä½†å¯ä»¥è¿›å…¥å¼€å‘
- **FAILED**: å¿…é¡»ä¿®å¤åæ‰èƒ½è¿›å…¥å¼€å‘

### å®Œæ•´SDDå·¥ä½œæµç¤ºä¾‹

```bash
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Phase 2: éªŒè¯OpenAPI/Schemaå˜æ›´
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
/planning
*init "Epic 12 - Three-Layer Memory"

# ä¿®æ”¹specsåéªŒè¯
*validate

Marcus:
â³ Running validation...
   â””â”€ PRD: Validated
   â””â”€ OpenAPI: No breaking changes âœ…
   â””â”€ Schemas: Compatible âœ…
âœ… Validation Passed!

*finalize

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Phase 3: åˆ›å»ºSDDå·¥ä»¶
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
/architect

*create-adr "Vector Database Selection"
# â†’ docs/architecture/decisions/0002-vector-database-selection.md

*create-adr "Agentic RAG Architecture"
# â†’ docs/architecture/decisions/0003-agentic-rag-architecture.md

# æ‰‹åŠ¨åˆ›å»ºæˆ–æ›´æ–°OpenAPI specs
# â†’ specs/api/canvas-api.openapi.yml
# â†’ specs/data/canvas-node.schema.json

*exit

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Phase 4: SMç¼–å†™Storyï¼ˆåŒ…å«SDDå¼•ç”¨ï¼‰
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
/sm

*draft

Bob (SM):
â³ Reading specs/api/*.openapi.yml...
â³ Reading specs/data/*.schema.json...
â³ Scanning ADRs for LanceDB, LangGraph...
âœ… Found 2 related ADRs: ADR-002, ADR-003

ğŸ“ Story 12.1 created with:
   - SDDè§„èŒƒå‚è€ƒ: 3 API endpoints, 2 Schemas
   - ADRå†³ç­–å…³è”: ADR-002, ADR-003

*exit

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Phase 4: SDDå¥‘çº¦éªŒè¯
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
python scripts/validate-story-sdd.py --story docs/stories/12.1.story.md

âœ… VALIDATION PASSED: Story ready for development

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Phase 4: Devå¼€å‘ï¼ˆåŸºäºSDDï¼‰
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
/dev

*develop-story story-12.1

James (Dev):
â³ Loading devLoadAlwaysFiles (includes specs)...
â³ Reading Story SDDè§„èŒƒå‚è€ƒ...
â³ Implementing based on specs/api/canvas-api.openapi.yml...
âœ… Implementation follows SDD contract
```

### å¸¸è§é—®é¢˜

#### Q: å¦‚æœStoryæ¶‰åŠçš„APIç«¯ç‚¹æœªåœ¨OpenAPIä¸­å®šä¹‰æ€ä¹ˆåŠï¼Ÿ

**A**: SMä¼šåœ¨Step 3.3è´¨é‡é—¨ç¦å¤„HALTï¼Œå¹¶æç¤ºï¼š
```
âš ï¸ APIç«¯ç‚¹ POST /api/memory/store æœªåœ¨OpenAPI specä¸­å®šä¹‰
â†’ è¯·é€šçŸ¥Architectè¡¥å……è§„èŒƒåå†ç»§ç»­
```

éœ€è¦å…ˆåœ¨Phase 3è¡¥å……OpenAPI specï¼Œç„¶åSMç»§ç»­ç¼–å†™Storyã€‚

#### Q: å¦‚æœæ²¡æœ‰ç›¸å…³ADRæ€ä¹ˆåŠï¼Ÿ

**A**: SMä¼šåœ¨ADRå†³ç­–å…³è”sectionä¸­è¯´æ˜ï¼š
```
**æ³¨æ„**: æœ¬Storyæ¶‰åŠçš„OAuthè®¤è¯æŠ€æœ¯æ ˆå°šæ— å¯¹åº”ADRã€‚
å»ºè®®Architectåˆ›å»ºADRè®°å½•æ­¤æŠ€æœ¯é€‰å‹å†³ç­–ã€‚
```

Storyå¯ä»¥ç»§ç»­ï¼Œä½†å»ºè®®è¡¥å……ADRä»¥ä¿æŒæ¶æ„å†³ç­–å¯è¿½æº¯æ€§ã€‚

#### Q: Dev Agentå¦‚ä½•ä½¿ç”¨SDDè§„èŒƒï¼Ÿ

**A**: Dev Agenté€šè¿‡ä»¥ä¸‹æ–¹å¼è·å–SDDä¸Šä¸‹æ–‡ï¼š
1. `devLoadAlwaysFiles`è‡ªåŠ¨åŠ è½½`specs/api/*.yml`å’Œ`specs/data/*.json`
2. Storyçš„Dev Notesä¸­åŒ…å«å®Œæ•´çš„SDDå¼•ç”¨
3. ä»£ç ä¸­æ·»åŠ æ¥æºæ ‡æ³¨ï¼š`# [Source: specs/api/canvas-api.openapi.yml#L156]`

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.1
**æ›´æ–°æ—¥æœŸ**: 2025-11-21
**é€‚ç”¨äº**: Canvas Learning System + BMad 4.0
**æ–°å¢**: SDDé©±åŠ¨å¼€å‘æµç¨‹ã€validate-story-sdd.pyå·¥å…·
