Execute complete Dev鈫扱A鈫扜it workflow for Story 21.5.1.1.

===============================================================================
STRICT WORKFLOW RULES - MUST FOLLOW EXACTLY
===============================================================================
1. ALWAYS read .ai-context.md first
2. HALT immediately if tests fail - do NOT proceed to QA
3. HALT immediately if QA Gate = FAIL - do NOT commit
4. If QA Gate = CONCERNS: attempt 1 fix cycle, re-run gate, then decide
5. ONLY commit if QA Gate = PASS or WAIVED
6. ALWAYS write .worktree-result.json at workflow end

===============================================================================
PHASE 1: DEVELOPMENT
===============================================================================
Step 1: Read .ai-context.md to understand Story context
Step 2: Activate Developer Agent: /dev
Step 3: Implement the Story: *develop-story 21.5.1.1
Step 4: Run all tests: *run-tests

**DECISION POINT A - TEST RESULTS**:
- If ALL tests PASS:
  - Update .worktree-status.yaml: status="dev-complete", tests_passed=true
  - PROCEED to Phase 2
- If ANY test FAILS:
  - Update .worktree-status.yaml: status="dev-blocked", tests_passed=false
  - Write .worktree-result.json with outcome="DEV_BLOCKED"
  - HALT WORKFLOW HERE - Do not proceed to QA

===============================================================================
PHASE 2: QUALITY ASSURANCE (Full QA Sequence)
===============================================================================
Step 5: Activate QA Agent: /qa
Step 6: Trace requirements coverage: *trace 21.5.1.1
Step 7: Assess non-functional requirements: *nfr-assess 21.5.1.1
Step 8: Comprehensive code review: *review 21.5.1.1
Step 9: Quality gate decision: *gate 21.5.1.1

**DECISION POINT B - QA GATE RESULT**:
- If gate = PASS:
  - Update .worktree-status.yaml: status="ready-to-merge", qa_gate="PASS"
  - PROCEED to Phase 3
- If gate = WAIVED:
  - Update .worktree-status.yaml: status="ready-to-merge", qa_gate="WAIVED"
  - PROCEED to Phase 3
- If gate = CONCERNS:
  - Attempt to fix the identified issues
  - Re-run tests: *run-tests
  - Re-run gate: *gate 21.5.1.1
  - If now PASS/WAIVED: PROCEED to Phase 3
  - If still CONCERNS or FAIL after 1 fix attempt:
    - Update status: qa_gate="CONCERNS"
    - Write .worktree-result.json with outcome="QA_CONCERNS_UNFIXED"
    - HALT WORKFLOW HERE
- If gate = FAIL:
  - Update .worktree-status.yaml: status="qa-blocked", qa_gate="FAIL"
  - Write .worktree-result.json with outcome="QA_BLOCKED"
  - HALT WORKFLOW HERE - Do not commit

===============================================================================
PHASE 3: GIT COMMIT (Only if QA Gate = PASS or WAIVED)
===============================================================================
Step 10: Stage all changes: git add -A
Step 11: Create commit with structured message:
         git commit -m "Story 21.5.1.1: [Brief Description]

         QA Gate: [PASS/WAIVED]
         Tests: [PASS]

         馃 Generated with [Claude Code](https://claude.com/claude-code)
         Co-Authored-By: Claude <noreply@anthropic.com>"

Step 12: Update .worktree-status.yaml: status="ready-to-merge"

**Note**: Pre-commit hooks will automatically validate:
- JSON Schema syntax
- OpenAPI spec validity
- Gherkin syntax
- SDD coverage
- Content consistency

If pre-commit fails, fix issues and re-commit.

===============================================================================
PHASE 4: RESULT OUTPUT (ALWAYS Execute)
===============================================================================
Step 13: Write .worktree-result.json with ENHANCED status (include dev_record and qa_record):

{
  "story_id": "21.5.1.1",
  "story_title": "[Story title from Story file]",
  "outcome": "SUCCESS|DEV_BLOCKED|QA_BLOCKED|QA_CONCERNS_UNFIXED",
  "tests_passed": true|false,
  "test_count": [number],
  "test_coverage": [percentage, e.g. 94.0],
  "qa_gate": "PASS|CONCERNS|FAIL|WAIVED"|null,
  "commit_sha": "[sha from git log -1 --format=%H]"|null,
  "blocking_reason": "[reason if blocked]"|null,
  "fix_attempts": 0|1,
  "timestamp": "[ISO-8601 timestamp]",
  "duration_seconds": [total seconds from start],

  "dev_record": {
    "agent_model": "Claude Code (claude-sonnet-4-5)",
    "duration_seconds": [seconds],
    "files_created": [
      {"path": "path/to/file.py", "description": "What was created"}
    ],
    "files_modified": [
      {"path": "path/to/existing.py", "description": "What changed"}
    ],
    "completion_notes": "[Brief summary of implementation]"
  },

  "qa_record": {
    "quality_score": [0-100],
    "ac_coverage": {
      "AC1": {"status": "PASS|FAIL", "evidence": "[test name or file]"},
      "AC2": {"status": "PASS|FAIL", "evidence": "[test name or file]"}
    },
    "issues_found": [
      {"severity": "low|medium|high", "description": "[issue]"}
    ],
    "recommendations": ["[recommendation 1]", "[recommendation 2]"]
  }
}

===============================================================================
PHASE 5: STORY FILE UPDATE (ALWAYS Execute After Phase 4)
===============================================================================
Step 14: Find and update Story file's "## Dev Agent Record" section:

    1. Locate Story file: docs/stories/21.5.1.1.story.md or story-21.5.1.1.md

    2. Replace "## Dev Agent Record" section content with:

       ### Agent Model Used
       Claude Code (claude-sonnet-4-5)

       ### Debug Log References
       - Session ID: [from progress file or auto-generated]
       - Process: Automated via /parallel

       ### Completion Notes List
       - [Summary of AC implementation]
       - Tests: PASS/FAIL ([test_count] tests, [coverage]% coverage)
       - QA Gate: [PASS/CONCERNS/FAIL/WAIVED]

       ### Commit Info
       - **Commit SHA**: [sha]
       - **Duration**: [seconds]s
       - **Completed At**: [ISO timestamp]
       - **Retry Count**: [0 or 1]

       ### File List
       **鏂板垱寤?**
       - path/file.py - [description]
       **淇敼:**
       - path/existing.py - [what changed]

Step 15: Update Story file's "## QA Results" section:

    **楠岃瘉鏂瑰紡**: /parallel 鑷姩鍖栭獙璇佹祦绋?
    **楠岃瘉鏃堕棿**: [YYYY-MM-DD]
    **楠岃瘉鐘舵€?*: 鉁?PASSED / 鈿狅笍 CONCERNS / 鉂?FAILED

    ### Review Date: [YYYY-MM-DD]
    ### Reviewed By: Quinn (Test Architect) - Automated

    ### Gate Status
    **Gate: [PASS/CONCERNS/FAIL/WAIVED]**
    **Quality Score**: [score]/100

    ### AC Coverage
    | AC | Status | Evidence |
    |----|--------|----------|
    | AC1 | PASS/FAIL | [test or file reference] |

    ### Issues Found
    [list of issues or "鏃?]

    ### Gate File Reference
    docs/qa/gates/21.5.1.1-[slug].yml

    **楠岃瘉娴佺▼**:
    - [x] 鍗曞厓娴嬭瘯閫氳繃
    - [x] *trace - 闇€姹傝鐩栬拷婧?
    - [x] *nfr-assess - 闈炲姛鑳介渶姹傝瘎浼?
    - [x] *review - 缁煎悎瀹℃煡
    - [x] *gate - 璐ㄩ噺闂ㄧ ([GATE STATUS])

Step 16: Set story_file_updated in .worktree-result.json:
    - If Story file was successfully updated: "story_file_updated": true
    - If update failed or skipped: "story_file_updated": false

===============================================================================
IMPORTANT REMINDERS
===============================================================================
- Follow all coding standards in CLAUDE.md
- Run tests BEFORE QA review
- Document any issues in the QA assessment files
- Do NOT push from worktree - orchestrator handles merge
- Update .worktree-status.yaml at EVERY decision point
