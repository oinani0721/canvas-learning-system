# Worktree Context for Parallel Development

> This file is automatically generated by `init-worktrees.ps1` and provides
> context for the Claude session running in this worktree.

---

## Story Information

- **Story ID**: {story}
- **Phase**: {phase}
- **Epic**: [To be filled from story file]
- **Sprint**: [Current sprint number]

---

## File Scope

### Affected Files (CAN modify)

These are the only files this Story should modify. They were declared in the
Story's `affected_files` field and verified by `analyze-dependencies.ps1`.

```yaml
affected_files:
  # Will be populated from story file
  - [List files here]
```

### Read-Only Files (DO NOT modify)

The following files are shared across all parallel sessions and must NOT be
modified to prevent merge conflicts:

```yaml
read_only:
  # Specifications
  - specs/api/*.yml
  - specs/data/*.json

  # Global state
  - .bmad-core/data/canvas-project-status.yaml

  # Shared configuration
  - .bmad-core/core-config.yaml
  - CLAUDE.md

  # Other worktree contexts
  - .ai-context.md  # in other worktrees
```

---

## Session Guidelines

### 1. File Modification Rules

- **Only modify files listed in "Affected Files"**
- If you need to modify a file not in the list, STOP and notify user
- Read-only files can be read but NEVER modified

### 2. Testing Requirements

- Run all tests before marking as dev-complete
- Ensure tests pass: `pytest src/tests/`
- Update `.worktree-status.yaml` with test results

### 3. Status Updates

When development is complete:

1. Run all tests and ensure they pass
2. Update `.worktree-status.yaml`:
   ```yaml
   status: "dev-complete"
   completed_at: "[current timestamp]"
   tests_passed: true
   test_count: [number]
   test_failures: 0
   ```

### 4. Git Operations

- **DO NOT** push directly from this worktree
- **DO NOT** merge branches manually
- The orchestrator will handle all merging
- You can commit to your local branch: `story-{story}`

### 5. Communication

- If you encounter blockers, document them in `.worktree-status.yaml`
- If you need files not in your scope, note this for the user

---

## Quick Commands

```bash
# Check current status
cat .worktree-status.yaml

# Run tests
pytest src/tests/ -v

# Check which branch you're on
git branch --show-current

# View your commits
git log --oneline -5
```

---

## Status File Location

This worktree's status is tracked in: `.worktree-status.yaml`

The orchestrator monitors this file to track progress across all parallel sessions.

---

## Related Documentation

- **Story File**: `docs/stories/story-{story}.md`
- **Epic File**: [Check story file for epic reference]
- **Orchestrator Guide**: `.claude/agents/parallel-dev-orchestrator.md`

---

## Troubleshooting

### "File not in affected_files"

If you need to modify a file not in your scope:
1. This may indicate a dependency issue
2. Notify the user to update the Story's affected_files
3. Or defer this change to a separate Story

### "Tests failing"

1. Check if you have all dependencies
2. Ensure you're not modifying shared files
3. Review test output for specific failures

### "Need to read another Story's code"

1. You can read any file in the codebase
2. Only writing is restricted to affected_files
3. Use Grep/Read tools freely for research

---

**Generated by**: Parallel Dev Orchestrator
**Template Version**: 1.0.0
